<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Alejandro Such">
<title>AngularJS</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>AngularJS</h1>
<div class="details">
<span id="author" class="author">Alejandro Such</span><br>
<span id="email" class="email"><a href="mailto:alejandro.such@ua.es">alejandro.such@ua.es</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion12">12. Automatización y testing</a>
<ul class="sectlevel2">
<li><a href="#_instalaci%C3%B3n_de_grunt_cli">12.1. Instalación de Grunt CLI</a></li>
<li><a href="#_instalaci%C3%B3n_de_bower">12.2. Instalación de Bower</a></li>
<li><a href="#_estructura_inicial_de_nuestro_proyecto">12.3. Estructura inicial de nuestro proyecto</a>
<ul class="sectlevel3">
<li><a href="#_gesti%C3%B3n_de_dependencias">12.3.1. Gestión de dependencias</a></li>
<li><a href="#_testing_de_filtros_nuestro_primer_test">12.3.2. Testing de filtros: nuestro primer test</a></li>
<li><a href="#_testing_de_servicios">12.3.3. Testing de servicios</a></li>
<li><a href="#_sobre_el_m%C3%A9todo_code_inject_code">12.3.4. Sobre el método <code>inject</code></a></li>
<li><a href="#_testing_de_controladores_y_em_mocking_em_de_peticiones_http">12.3.5. Testing de controladores y <em>Mocking</em> de peticiones HTTP.</a></li>
<li><a href="#_testing_de_directivas">12.3.6. Testing de directivas</a></li>
</ul>
</li>
<li><a href="#_automatizando_tareas_con_grunt_dise%C3%B1ando_nuestro_em_workflow_em">12.4. Automatizando tareas con Grunt. Diseñando nuestro <em>workflow</em></a>
<ul class="sectlevel3">
<li><a href="#_verificaci%C3%B3n_de_c%C3%B3digo">12.4.1. Verificación de código</a></li>
<li><a href="#_testing">12.4.2. Testing</a></li>
<li><a href="#_generando_c%C3%B3digo_de_distribuci%C3%B3n">12.4.3. Generando código de distribución</a></li>
<li><a href="#_observando_cambios_para_lanzar_tests">12.4.4. Observando cambios para lanzar tests</a></li>
<li><a href="#_otros_plugins_de_utilidad">12.4.5. Otros plugins de utilidad</a></li>
</ul>
</li>
<li><a href="#_un_paso_m%C3%A1s_all%C3%A1">12.5. Un paso más allá</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion12">12. Automatización y testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A lo largo de este capítulo iremos echando un vistazo a las herramientas de las que disponemos para poder seguir un <em>workflow</em> de desarrollo en AngularJS, que integre automatización y testing de nuestras aplicaciones.</p>
</div>
<div class="paragraph">
<p>Partimos de la base de que tenemos instalado en nuestro equipo tanto <a href="http://nodejs.org/">node.js</a> como <a href="https://www.npmjs.org/">npm</a>.</p>
</div>
<div class="sect2">
<h3 id="_instalación_de_grunt_cli">12.1. Instalación de Grunt CLI</h3>
<div class="paragraph">
<p><em>Grunt Command Line Interface</em> (Grunt CLI) es un módulo de node.js que nos permite ejecutar tareas de Grunt en nuestro proyecto, vía línea de comandos. Así, podremos ejecutar cada tarea relacionada con el proceso de desarrollo de nuestra aplicación (verificación de sintaxis, ejecución de los tests unitarios, minificación, &#8230;&#8203;). De esta manera, grunt se convierte en el único asistente que necesitamos para cubrir las necesidades de nuestro proyecto.</p>
</div>
<div class="paragraph">
<p>Podemos instalar el Grunt CLI a través de npm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">npm install -g grunt-cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>La opción <em>-g</em> hace que <code>grunt-cli</code> se instale de manera <strong>global</strong> y podremos ejecutarla a través del comando <code>grunt</code>. Grunt necesita una serie de componentes adicionales, que se instalarán de manera local a nuestro proyecto.</p>
</div>
</div>
<div class="sect2">
<h3 id="_instalación_de_bower">12.2. Instalación de Bower</h3>
<div class="paragraph">
<p>Otro elemento global que necesitaremos es <a href="http://bower.io/">Bower</a>. Bower es a las librerías JavaScript de front-end lo que NPM a las librerías de backend de node.js. Este gestor de paquetes nos puede descargar librerías como AngularJS, ui-router, jQuery, etc. De manera que ya no es necesario irse al sitio web del framework/librería para descargarnos lo que necesitemos.</p>
</div>
<div class="paragraph">
<p>Bower se instala de manera similar a como hemos hecho para Grunt CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">npm install -g bower</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_estructura_inicial_de_nuestro_proyecto">12.3. Estructura inicial de nuestro proyecto</h3>
<div class="sect3">
<h4 id="_gestión_de_dependencias">12.3.1. Gestión de dependencias</h4>
<div class="paragraph">
<p>Vamos a definir las dependencias de nuestro proyecto. Necesitaremos una serie de librerías de backend, que gestionará npm, y de frontend, que gestionará Bower. Ambas herramientas necesitan un fichero de configuración JSON que define estas dependencias.</p>
</div>
<div class="paragraph">
<p>El fichero de configuración de node.js se llama <code>package.json</code>, y podemos inicializarlo lanzando, desde consola, el comando <code>npm init</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>npm init
This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sane defaults.

See <span class="tok-sb">`</span>npm <span class="tok-nb">help </span>json<span class="tok-sb">`</span> <span class="tok-k">for</span> definitive documentation on these fields
and exactly what they <span class="tok-k">do</span>.

Use <span class="tok-sb">`</span>npm install &lt;pkg&gt; --save<span class="tok-sb">`</span> afterwards to install a package and
save it as a dependency in the package.json file.

Press ^C at any <span class="tok-nb">time </span>to quit.
name: <span class="tok-o">(</span>angular-automation-testing<span class="tok-o">)</span>
version: <span class="tok-o">(</span>0.0.0<span class="tok-o">)</span>
description:
entry point: <span class="tok-o">(</span>index.js<span class="tok-o">)</span>
<span class="tok-nb">test command</span>:
git repository:
keywords:
author:
license: <span class="tok-o">(</span>ISC<span class="tok-o">)</span>
About to write to /Volumes/MSL64/tmp/angular-automation-testing/package.json:

<span class="tok-o">{</span>
  <span class="tok-s2">&quot;name&quot;</span>: <span class="tok-s2">&quot;angular-automation-testing&quot;</span>,
  <span class="tok-s2">&quot;version&quot;</span>: <span class="tok-s2">&quot;0.0.0&quot;</span>,
  <span class="tok-s2">&quot;description&quot;</span>: <span class="tok-s2">&quot;&quot;</span>,
  <span class="tok-s2">&quot;main&quot;</span>: <span class="tok-s2">&quot;index.js&quot;</span>,
  <span class="tok-s2">&quot;scripts&quot;</span>: <span class="tok-o">{</span>
    <span class="tok-s2">&quot;test&quot;</span>: <span class="tok-s2">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  <span class="tok-o">}</span>,
  <span class="tok-s2">&quot;author&quot;</span>: <span class="tok-s2">&quot;&quot;</span>,
  <span class="tok-s2">&quot;license&quot;</span>: <span class="tok-s2">&quot;ISC&quot;</span>
<span class="tok-o">}</span>


Is this ok? <span class="tok-o">(</span>yes<span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El fichero de configuración de bower se llama <code>bower.json</code>, y se inicializa con el comando <code>bower init</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>bower init
? name: angular-automation-testing
? version: 0.0.0
? description:
? main file:
? what types of modules does this package expose?:
? keywords:
? authors: Alejandro Such Berenguer &lt;alejandro.such@gmail.com&gt;
? license: MIT
? homepage:
? <span class="tok-nb">set </span>currently installed components as dependencies?: Yes
? add commonly ignored files to ignore list?: Yes
? would you like to mark this package as private which prevents it from being accidentally published to the registry?: No

<span class="tok-o">{</span>
  name: <span class="tok-s1">&#39;angular-automation-testing&#39;</span>,
  version: <span class="tok-s1">&#39;0.0.0&#39;</span>,
  authors: <span class="tok-o">[</span>
    <span class="tok-s1">&#39;Alejandro Such Berenguer &lt;alejandro.such@gmail.com&gt;&#39;</span>
  <span class="tok-o">]</span>,
  license: <span class="tok-s1">&#39;MIT&#39;</span>,
  ignore: <span class="tok-o">[</span>
    <span class="tok-s1">&#39;**/.*&#39;</span>,
    <span class="tok-s1">&#39;node_modules&#39;</span>,
    <span class="tok-s1">&#39;bower_components&#39;</span>,
    <span class="tok-s1">&#39;test&#39;</span>,
    <span class="tok-s1">&#39;tests&#39;</span>
  <span class="tok-o">]</span>
<span class="tok-o">}</span>

? Looks good?: Yes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Aunque vamos a querer introducir en nuestro sistema de control de versiones estos ficheros de configuración, vamos a querer ignorar las dependencias descargadas por bower y npm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span><span class="tok-nb">echo</span> <span class="tok-s2">&quot;node_modules/&quot;</span> &gt;&gt; .gitignore
<span class="tok-nv">$ </span><span class="tok-nb">echo</span> <span class="tok-s2">&quot;bower_components/&quot;</span> &gt;&gt; .gitignore</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ahora las dependencias. En la parte de front-end vamos a instalar las dependencias vistas en las sesiones de este módulo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AngularJS</p>
</li>
<li>
<p>ui-router</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>bower install angular --save
<span class="tok-nv">$ </span>bower install angular-ui-router --save</code></pre>
</div>
</div>
<div class="paragraph">
<p>Añadimos la opción <code>-g</code>, para que las dependencias aparezcan en el fichero de configuración:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;angular-automation-testing&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;0.0.0&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;authors&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-s2">&quot;Alejandro Such Berenguer &lt;alejandro.such@gmail.com&gt;&quot;</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;license&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;MIT&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;ignore&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-s2">&quot;**/.*&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;node_modules&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;bower_components&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;test&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;tests&quot;</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;dependencies&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;angular&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;~1.3.2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;angular-ui-router&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;~0.2.11&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En cuanto a las dependencias de grunt, se instalan de la siguiente manera:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>npm install angular-mocks --save-dev
<span class="tok-nv">$ </span>npm install grunt --save-dev
<span class="tok-nv">$ </span>npm install grunt-exec --save-dev
<span class="tok-nv">$ </span>npm install grunt-contrib-clean --save-dev
<span class="tok-nv">$ </span>npm install grunt-contrib-jshint --save-dev
<span class="tok-nv">$ </span>npm install grunt-contrib-watch --save-dev
<span class="tok-nv">$ </span>npm install grunt-contrib-concat --save-dev
<span class="tok-nv">$ </span>npm install grunt-contrib-copy --save-dev
<span class="tok-nv">$ </span>npm install grunt-contrib-uglify --save-dev
<span class="tok-nv">$ </span>npm install karma --save-dev
<span class="tok-nv">$ </span>npm install grunt-karma --save-dev
<span class="tok-nv">$ </span>npm install karma-jasmine --save-dev
<span class="tok-nv">$ </span>npm install load-grunt-tasks --save-dev
<span class="tok-nv">$ </span>npm install karma-phantomjs-launcher --save-dev
<span class="tok-nv">$ </span>npm install jquery --save-dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>También podemos ver que esas dependencias han aparecido en el fichero <code>package.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;angular-automation-testing&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;0.0.0&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;main&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;index.js&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scripts&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;test&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;author&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;license&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;ISC&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;devDependencies&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;angular-mocks&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^1.3.2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.4.5&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-contrib-clean&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.6.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-contrib-concat&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.5.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-contrib-copy&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.7.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-contrib-jshint&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.10.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-contrib-uglify&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.6.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-contrib-watch&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.6.1&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-exec&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.4.6&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;grunt-karma&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.9.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;jquery&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.1.3&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;karma&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.12.24&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;karma-jasmine&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.2.3&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;karma-phantomjs-launcher&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.1.4&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;load-grunt-tasks&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^1.0.0&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Utilizaremos la opción <code>--save-dev</code> para indicar que todas estas dependendencias son depenedencias de desarrollo, y no las utilizaremos nunca en un entorno de producción, ni son necesarias para que la aplicación se ejecute.</p>
</div>
<div class="paragraph">
<p>Muy importante la librería <a href="https://docs.angularjs.org/api/ngMock"><code>angular-mocks</code></a>. Ésta nos dará soporte para inyectar y <em>mockear</em> servicios de AngularJS en nuestros tests unitarios. También extiende varios servicios del <em>core</em> de AngularJS para que sean controlados de manera síncrona en nuestros tests (como veremos, por ejemplo, a la hora de hacer <em>mocks</em> de servicios HTTP).</p>
</div>
</div>
<div class="sect3">
<h4 id="_testing_de_filtros_nuestro_primer_test">12.3.2. Testing de filtros: nuestro primer test</h4>
<div class="paragraph">
<p>Probaremos nuestra infraestructura. Para ello, seguiremos el paradigma <em>TDD</em>, diseñando un test para un filtro. El filtro se llamará <code>textOrDefault</code>, y devolverá la cadena que se le pase. En caso de no pasarse una cadena, se devolverá un valor por defecto (<code>-</code>), o el valor que se le pase como atributo (ej: <code>N/D</code>, <code>desconocido</code>, etc).</p>
</div>
<div class="paragraph">
<p>El fichero será <code>test/filters/textOrDefaultSpec.js</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</div></td><td class="code"><span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>

<span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;filter: textOrDefault&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
  <span class="tok-kd">var</span> <span class="tok-nx">textOrDefault</span><span class="tok-p">;</span>

  <span class="tok-c1">//Inicializar el módulo indicado antes de caa test</span>
  <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;filters.textordefault&#39;</span><span class="tok-p">));</span>

  <span class="tok-c1">//Inyección de dependencias textOrDefault se apuntará al filtro inyectado</span>
  <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">_textOrDefaultFilter_</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-nx">textOrDefault</span> <span class="tok-o">=</span> <span class="tok-nx">_textOrDefaultFilter_</span><span class="tok-p">;</span>
  <span class="tok-p">}));</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s2">&quot;should return &#39;-&#39;&quot;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-s1">&#39;-&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-s1">&#39;-&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-s1">&#39;   &#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-s1">&#39;-&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s2">&quot;should return &#39;N/D&#39;&quot;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-s1">&#39;  \n\t &#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s2">&quot;should return the same value&quot;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-kd">var</span> <span class="tok-nx">hello</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-nx">hello</span><span class="tok-p">,</span> <span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-nx">hello</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-nx">hello</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-nx">hello</span><span class="tok-p">);</span>

    <span class="tok-kd">var</span> <span class="tok-nx">helloWithSpaces</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;   hello   &#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-nx">helloWithSpaces</span><span class="tok-p">,</span> <span class="tok-s1">&#39;N/D&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-nx">helloWithSpaces</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">textOrDefault</span><span class="tok-p">(</span><span class="tok-nx">helloWithSpaces</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-nx">helloWithSpaces</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
<span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Como su nombre indica, la función <code>beforeEach</code> es llamada antes de que se ejecute cada test dentro del <code>describe</code>.</p>
</div>
<div class="paragraph">
<p>Utilizaremos esta función <code>beforeEach</code> para cargar el el módulo donde se encuentra nuestro filtro.</p>
</div>
<div class="paragraph">
<p>Definimos cada uno de nuestros tests dentro de una función <code>if</code>. Y ahí utilizaremos <em>expectations</em>, con la función <code>expect</code>. Ésta recibe un valor, llamado <strong>valor real</strong>, que se encadenará con una función de <em>matching</em> para compararlo con el valor esperado.</p>
</div>
<div class="paragraph">
<p><a href="http://jasmine.github.io/edge/introduction.html">La página de introducción a Jasmine</a> dispone de ejemplos de todos y cada uno de los matchers por defecto.</p>
</div>
<div class="paragraph">
<p>Ahora, debemos establecer la configuración de <a href="http://karma-runner.github.io/0.12/index.html">Karma</a>, para poder lanzar el test. Para ello, en la raíz del proyecto lanzaremos el comando <code>karma init</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>karma init

Which testing framework <span class="tok-k">do</span> you want to use ?
Press tab to list possible options. Enter to move to the next question.
&gt; jasmine

Do you want to use Require.js ?
This will add Require.js plugin.
Press tab to list possible options. Enter to move to the next question.
&gt; no

Do you want to capture any browsers automatically ?
Press tab to list possible options. Enter empty string to move to the next question.
&gt; PhantomJS
&gt;

What is the location of your <span class="tok-nb">source </span>and <span class="tok-nb">test </span>files ?
You can use glob patterns, eg. <span class="tok-s2">&quot;js/*.js&quot;</span> or <span class="tok-s2">&quot;test/**/*Spec.js&quot;</span>.
Enter empty string to move to the next question.
&gt; <span class="tok-nb">test</span>/**/*Spec.js
&gt; src/**/*.js

Should any of the files included by the previous patterns be excluded ?
You can use glob patterns, eg. <span class="tok-s2">&quot;**/*.swp&quot;</span>.
Enter empty string to move to the next question.
&gt;

Do you want Karma to watch all the files and run the tests on change ?
Press tab to list possible options.
&gt; yes


Config file generated at <span class="tok-s2">&quot;[RUTA_DEL_PROYECTO]/karma.conf.js&quot;</span>.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta inicialización nos habrá creado el fichero <code>karma.conf.js</code>. Modificaremos el atributo <code>files</code> (listado de ficheros que se cargarán en el navegador en el momento de realizar los tests), dejándolo de la siguiente manera:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span class="tok-c1">// list of files / patterns to load in the browser</span>
<span class="tok-nx">files</span><span class="tok-o">:</span> <span class="tok-p">[</span>
  <span class="tok-s1">&#39;bower_components/angular/angular.js&#39;</span><span class="tok-p">,</span>
  <span class="tok-s1">&#39;node_modules/angular-mocks/angular-mocks.js&#39;</span><span class="tok-p">,</span>
  <span class="tok-s1">&#39;bower_components/angular-ui-router/release/angular-ui-router.js&#39;</span><span class="tok-p">,</span>
  <span class="tok-s1">&#39;src/**/*.js&#39;</span><span class="tok-p">,</span>
  <span class="tok-s1">&#39;test/**/*Spec.js&#39;</span>
<span class="tok-p">],</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si lanzamos los tests con <code>karma start karma.conf.js</code>, veremos cómo se levanta el navegador PhantomJS y nos devuelve un error. Esto se debe a que el test se ha lanzado, pero no se encuentra el módulo a testear. Crearemos el fichero <code>src/filters/testOrDefault.js</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;filters.textordefault&#39;</span><span class="tok-p">,</span> <span class="tok-p">[])</span>
        <span class="tok-p">.</span><span class="tok-nx">filter</span><span class="tok-p">(</span><span class="tok-s1">&#39;textOrDefault&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-k">return</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">input</span><span class="tok-p">,</span> <span class="tok-nx">defaultValue</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">return</span> <span class="tok-nx">input</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>
        <span class="tok-p">});</span>
<span class="tok-p">})();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Volviendo a lanzar los tests, veremos que ahora éstos fallan porque el filtro no está devolviendo los valores que esperábamos.</p>
</div>
<div class="paragraph">
<p>Modificaremos el código de nuestro filtro para que realice la funcionalidad esperada:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;filters.textordefault&#39;</span><span class="tok-p">,</span> <span class="tok-p">[])</span>
        <span class="tok-p">.</span><span class="tok-nx">filter</span><span class="tok-p">(</span><span class="tok-s1">&#39;textOrDefault&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-k">return</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">input</span><span class="tok-p">,</span> <span class="tok-nx">defaultValue</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-nx">defaultValue</span> <span class="tok-o">=</span> <span class="tok-nx">defaultValue</span> <span class="tok-o">||</span> <span class="tok-s1">&#39;-&#39;</span><span class="tok-p">;</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">input</span><span class="tok-p">)</span>
                    <span class="tok-k">return</span> <span class="tok-nx">defaultValue</span><span class="tok-p">;</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">isString</span><span class="tok-p">(</span><span class="tok-nx">input</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">input</span><span class="tok-p">.</span><span class="tok-nx">toString</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                        <span class="tok-nx">input</span> <span class="tok-o">=</span> <span class="tok-nx">input</span><span class="tok-p">.</span><span class="tok-nx">toString</span><span class="tok-p">();</span>
                    <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
                        <span class="tok-k">return</span> <span class="tok-nx">defaultValue</span><span class="tok-p">;</span>
                    <span class="tok-p">}</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">input</span><span class="tok-p">.</span><span class="tok-nx">trim</span><span class="tok-p">().</span><span class="tok-nx">length</span> <span class="tok-o">&gt;</span> <span class="tok-mi">0</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">input</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-nx">defaultValue</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>
        <span class="tok-p">});</span>
<span class="tok-p">})();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Al realizar estos cambios, los tests pasarán exitosamente.</p>
</div>
<div class="paragraph">
<p>Una cosa que podemos ver es que se detectan los cambios "en caliente". A medida que modificamos el código de nuestro filtro, si salvamos, se volverán a lanzar los tests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_testing_de_servicios">12.3.3. Testing de servicios</h4>
<div class="paragraph">
<p>Veamos ahora cómo testear un servicio de cualquier tipo (provider, factory o service). Haremos nuestro ejemplo con un provider, ya que tiene un componente de configuración que el resto de servicios no tiene.</p>
</div>
<div class="paragraph">
<p>La idea es crear un servicio de validaciones. Tendremos por una parte una serie de validaciones predefinidas, y además podremos añadir los validadores <em>custom</em> al servicio.</p>
</div>
<div class="paragraph">
<p>El código de nuestro test (<code>test/providers/expertoJeeValidationProviderSpec.js</code>) será el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479</div></td><td class="code"><span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>

<span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;provider: expertoJeeValidation&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-kd">var</span> <span class="tok-nx">validationProvider</span><span class="tok-p">;</span>
    <span class="tok-kd">var</span> <span class="tok-nx">undefinedVar</span><span class="tok-p">;</span>
    <span class="tok-kd">var</span> <span class="tok-nx">validationService</span><span class="tok-p">;</span>

    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;providers.validation&#39;</span><span class="tok-p">));</span>

    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-c1">// Creamos un módulo de pega, al que inyectamos el provider y definimos una función de configuración</span>
        <span class="tok-kd">var</span> <span class="tok-nx">fakeModule</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span>
            <span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;test.app.config&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span><span class="tok-p">(){}).</span><span class="tok-nx">config</span><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">expertoJeeValidationProvider</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-nx">validationProvider</span> <span class="tok-o">=</span> <span class="tok-nx">expertoJeeValidationProvider</span><span class="tok-p">;</span>

                <span class="tok-nx">validationProvider</span><span class="tok-p">.</span><span class="tok-nx">addConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;customConstraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">needsToBeFive</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">needsToBeFive</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                        <span class="tok-k">return</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-mi">5</span><span class="tok-p">;</span>
                    <span class="tok-p">}</span>

                    <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
                <span class="tok-p">});</span>
            <span class="tok-p">});</span>

        <span class="tok-c1">// Cargamos los módulos</span>
        <span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;test.app.config&#39;</span><span class="tok-p">);</span>
   <span class="tok-p">});</span>

  <span class="tok-nx">beforeEach</span><span class="tok-p">(</span>
        <span class="tok-c1">//Inyectar los servicios en los tests</span>
        <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">_expertoJeeValidation_</span><span class="tok-p">){</span>
          <span class="tok-nx">validationService</span> <span class="tok-o">=</span> <span class="tok-nx">_expertoJeeValidation_</span><span class="tok-p">;</span>
        <span class="tok-p">})</span>
    <span class="tok-p">);</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the providers has been injected&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">validationProvider</span><span class="tok-p">).</span><span class="tok-nx">not</span><span class="tok-p">.</span><span class="tok-nx">toBeUndefined</span><span class="tok-p">();</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">validationService</span><span class="tok-p">).</span><span class="tok-nx">not</span><span class="tok-p">.</span><span class="tok-nx">toBeUndefined</span><span class="tok-p">();</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the blank constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">blankConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">blank</span><span class="tok-p">;</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">blankConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tets the creditCard constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">creditCardConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">creditCard</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">creditCardConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;CreditCard constraint: Not implemented yet&#39;</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the email constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">emailConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">email</span><span class="tok-p">;</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>


        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin.&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin.&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin.com&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">emailConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin.com&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the inList constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">inListConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">inList</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-mi">1</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-p">{</span> <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;John&#39;</span><span class="tok-p">,</span> <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Locke&#39;</span><span class="tok-p">});</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;InList constraint only applies to Arrays&#39;</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;InList constraint only applies to Arrays&#39;</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;InList constraint only applies to Arrays&#39;</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;b&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;c&#39;</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;d&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;b&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;c&#39;</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;b&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;c&#39;</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;1&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;2&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;3&#39;</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;b&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;c&#39;</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;b&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;c&#39;</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">inListConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;b&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;c&#39;</span><span class="tok-p">,</span> <span class="tok-kc">null</span><span class="tok-p">])).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the regex constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">matchesConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">matches</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">emailRegex</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;^[a-z0-9!#$%&amp;\&#39;*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn4</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">matchesConstraint</span><span class="tok-p">([],</span> <span class="tok-nx">emailRegex</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn5</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">matchesConstraint</span><span class="tok-p">({},</span> <span class="tok-nx">emailRegex</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;Matches constraint only applies to Strings&#39;</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;Matches constraint only applies to Strings&#39;</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;Matches constraint only applies to Strings&#39;</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn4</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;Matches constraint only applies to Strings&#39;</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn5</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;Matches constraint only applies to Strings&#39;</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin&#39;</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@&#39;</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin&#39;</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin.&#39;</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">matchesConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;admin@admin.com&#39;</span><span class="tok-p">,</span> <span class="tok-nx">emailRegex</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the max constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">maxConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">max</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Max constraint only applies to numbers&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;5&#39;</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn4</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxConstraint</span><span class="tok-p">([],</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn5</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxConstraint</span><span class="tok-p">({},</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn4</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn5</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxConstraint</span><span class="tok-p">(</span><span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the maxSize constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">maxSizeConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">maxSize</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;MaxSize constraint only applies to Arrays and Strings&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr2</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Argument maxSize should be a number&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxSizeConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-s1">&#39;&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxSizeConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxSizeConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn5</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">maxSizeConstraint</span><span class="tok-p">({},</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr2</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn5</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxSizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxSizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxSizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-mi">6</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxSizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxSizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">maxSizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">6</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the min constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">minConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">min</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Min constraint only applies to numbers&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;5&#39;</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn4</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minConstraint</span><span class="tok-p">([],</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn5</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minConstraint</span><span class="tok-p">({},</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn4</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn5</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minConstraint</span><span class="tok-p">(</span><span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the minSize constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">minSizeConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">minSize</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;MinSize constraint only applies to Arrays and Strings&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr2</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Argument minSize should be a number&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minSizeConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-s1">&#39;&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minSizeConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minSizeConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn5</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">minSizeConstraint</span><span class="tok-p">({},</span> <span class="tok-mi">4</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr2</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn5</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minSizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minSizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minSizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span> <span class="tok-mi">6</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minSizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">4</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minSizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">minSizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">6</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the notEqual constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">notEqualConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">notEqual</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">notEqualConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">1</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-s1">&#39;NotEqual constraint: Not implemented yet&#39;</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the nullable constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">nullableConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">nullable</span><span class="tok-p">;</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">nullableConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">nullableConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">nullableConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">nullableConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">nullableConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">nullableConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the numeric constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">numericConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">numeric</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Numeric constraint expects two arguments&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-kc">null</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-nx">undefinedVar</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;5&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;5&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">([],</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">([],</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">({},</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">numericConstraint</span><span class="tok-p">({},</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the range constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">rangeConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">range</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Range constraint expects three arguments&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr2</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;All three values must be numbers&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;1&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;1&#39;</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr2</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-mi">10</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">rangeConstraint</span><span class="tok-p">(</span><span class="tok-mi">11</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the size constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">sizeConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">size</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Size constraint expects three arguments&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr2</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Size constraint only applies to Arrays and Strings&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr3</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Start and end values must be numbers&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">sizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;1&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">sizeConstraint</span><span class="tok-p">({},</span> <span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">sizeConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;1&#39;</span><span class="tok-p">,</span> <span class="tok-mi">10</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr2</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr3</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello&quot;</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">(</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">(</span><span class="tok-s2">&quot;hi&quot;</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello world&quot;</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">],</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">([],</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">],</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sizeConstraint</span><span class="tok-p">([</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">3</span><span class="tok-p">,</span> <span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-mi">6</span><span class="tok-p">,</span> <span class="tok-mi">7</span><span class="tok-p">,</span> <span class="tok-mi">8</span><span class="tok-p">,</span> <span class="tok-mi">9</span><span class="tok-p">],</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">5</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the unique constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">uniqueConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">unique</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Unique constraint: not implemented yet&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">uniqueConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests the url constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">urlConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">url</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Url constraint: expected 2 arguments&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr2</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Url constraint: value expected to be a string&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr3</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Url constraint: url expected to be a boolean&#39;</span><span class="tok-p">;</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn2</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-kd">var</span> <span class="tok-nx">testFn3</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;1&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;true&#39;</span><span class="tok-p">);</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn2</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr2</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn3</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr3</span><span class="tok-p">);</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;www.ua.es&#39;</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;asdf&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;www.ua.es&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">urlConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;http://www.ua.es&#39;</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;tests a custom constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">customConstraint</span> <span class="tok-o">=</span> <span class="tok-nx">validationService</span><span class="tok-p">.</span><span class="tok-nx">customConstraint</span><span class="tok-p">;</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">customConstraint</span><span class="tok-p">(</span><span class="tok-mi">5</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">customConstraint</span><span class="tok-p">(</span><span class="tok-mi">4</span><span class="tok-p">,</span> <span class="tok-kc">false</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">customConstraint</span><span class="tok-p">(</span><span class="tok-mi">54</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should fail trying to override an existing constraint&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-kd">var</span> <span class="tok-nx">throwErr</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Cannot override a default constraint&#39;</span><span class="tok-p">;</span>
        <span class="tok-kd">var</span> <span class="tok-nx">testFn</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-nx">validationProvider</span><span class="tok-p">.</span><span class="tok-nx">addConstraint</span><span class="tok-p">(</span><span class="tok-s1">&#39;url&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">needsToBeFive</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">needsToBeFive</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-mi">5</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">});</span>
        <span class="tok-p">};</span>

        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">testFn</span><span class="tok-p">).</span><span class="tok-nx">toThrow</span><span class="tok-p">(</span><span class="tok-nx">throwErr</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>
<span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>La función <code>module</code> se utiliza para indicar al test que deberían prepararse los servicios del módulo indicado.
El rol de este método es similar al de la directiva <code>ng-app</code> en una vista.</p>
</div>
<div class="paragraph">
<p>La función <a href="https://docs.angularjs.org/api/ngMock/function/angular.mock.inject"><code>inject</code></a> tiene la responsabilidad de inyectar los servicios en nuestros tests.</p>
</div>
<div class="paragraph">
<p>Por su parte, el código del provider será:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306</div></td><td class="code"><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>

    <span class="tok-nx">angular</span>
        <span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;providers.validation&#39;</span><span class="tok-p">)</span>
        <span class="tok-p">.</span><span class="tok-nx">provider</span><span class="tok-p">(</span><span class="tok-s1">&#39;expertoJeeValidation&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
            <span class="tok-kd">var</span> <span class="tok-nx">instance</span> <span class="tok-o">=</span> <span class="tok-p">{};</span>
            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a String value is not blank</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param blank</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">blank</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">blank</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;undefined&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-kc">null</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;string&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">String</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Blank constraint only applies to strings&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-kd">var</span> <span class="tok-nx">isBlank</span> <span class="tok-o">=</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;undefined&#39;</span> <span class="tok-o">||</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-kc">null</span> <span class="tok-o">||</span> <span class="tok-nx">value</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">===</span> <span class="tok-mi">0</span> <span class="tok-o">||</span> <span class="tok-o">!</span><span class="tok-nx">value</span><span class="tok-p">.</span><span class="tok-nx">trim</span><span class="tok-p">();</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">blank</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-o">!</span><span class="tok-nx">isBlank</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a String value is a valid credit card number</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param creditCard</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">creditCard</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">creditCard</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">throw</span> <span class="tok-s1">&#39;CreditCard constraint: Not implemented yet&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">//                return false;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a String value is a valid email address.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param email</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">email</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">email</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-kd">var</span> <span class="tok-nx">emailRegex</span> <span class="tok-o">=</span> <span class="tok-sr">/^[a-z0-9!#$%&amp;&#39;*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i</span><span class="tok-p">;</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">email</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">emailRegex</span><span class="tok-p">.</span><span class="tok-nx">test</span><span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">);</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a value is within a range or collection of constrained values.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param array</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">inList</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">array</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">array</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Array</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;InList constraint only applies to Arrays&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-nx">array</span><span class="tok-p">.</span><span class="tok-nx">indexOf</span><span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">)</span> <span class="tok-o">!==</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a String value matches a given regular expression.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param expr</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">matches</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">expr</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;string&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">String</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Matches constraint only applies to Strings&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-kd">var</span> <span class="tok-nx">regexp</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nb">RegExp</span><span class="tok-p">(</span><span class="tok-nx">expr</span><span class="tok-p">);</span>

                <span class="tok-k">return</span> <span class="tok-nx">regexp</span><span class="tok-p">.</span><span class="tok-nx">test</span><span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">);</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a value does not exceed the given maximum value.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param max</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">max</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">max</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;number&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Number</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Max constraint only applies to numbers&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-nx">value</span> <span class="tok-o">&lt;=</span> <span class="tok-nx">max</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a value&#39;s size does not exceed the given maximum value.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param maxSize</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">maxSize</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">maxSize</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Array</span> <span class="tok-o">||</span> <span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">String</span> <span class="tok-o">||</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">value</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">&lt;=</span> <span class="tok-nx">maxSize</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">maxSize</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;number&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">maxSize</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Number</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Argument maxSize should be a number&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">throw</span> <span class="tok-s1">&#39;MaxSize constraint only applies to Arrays and Strings&#39;</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a value does not fall below the given minimum value.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param min</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">min</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">min</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;number&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Number</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Min constraint only applies to numbers&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-nx">value</span> <span class="tok-o">&gt;=</span> <span class="tok-nx">min</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a value&#39;s size does not fall below the given minimum value.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param minSize</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">minSize</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">minSize</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Array</span> <span class="tok-o">||</span> <span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">String</span> <span class="tok-o">||</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">value</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">&gt;=</span> <span class="tok-nx">minSize</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">minSize</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;number&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">minSize</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Number</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Argument minSize should be a number&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">throw</span> <span class="tok-s1">&#39;MinSize constraint only applies to Arrays and Strings&#39;</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that that a property is not equal to the specified value</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param otherValue</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">notEqual</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">otherValue</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">throw</span> <span class="tok-s1">&#39;NotEqual constraint: Not implemented yet&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">//                return value !== otherValue;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Allows a property to be set to null - defaults to true. Undefined is considered null in this constraint</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param nullable</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">nullable</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">nullable</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">arguments</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">!==</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Constraint error. Must provide a boolean value for nullable&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">nullable</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-kc">null</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;undefined&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Ensures that the given value should be numeric</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param numeric</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">numeric</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">numeric</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">arguments</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">!==</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Numeric constraint expects two arguments&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-kd">var</span> <span class="tok-nx">isNumeric</span> <span class="tok-o">=</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;number&#39;</span> <span class="tok-o">||</span> <span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Number</span><span class="tok-p">;</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">numeric</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">isNumeric</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Ensures that a property&#39;s value occurs within a specified range</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param start</span>
<span class="tok-cm">             * @param end</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">range</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-nx">end</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">arguments</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">!==</span> <span class="tok-mi">3</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Range constraint expects three arguments&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">numeric</span><span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)</span> <span class="tok-o">||</span> <span class="tok-o">!</span><span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">numeric</span><span class="tok-p">(</span><span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)</span> <span class="tok-o">||</span> <span class="tok-o">!</span><span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">numeric</span><span class="tok-p">(</span><span class="tok-nx">end</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;All three values must be numbers&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-nx">value</span> <span class="tok-o">&gt;=</span> <span class="tok-nb">Math</span><span class="tok-p">.</span><span class="tok-nx">min</span><span class="tok-p">(</span><span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-nx">end</span><span class="tok-p">)</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-nx">value</span> <span class="tok-o">&lt;=</span> <span class="tok-nb">Math</span><span class="tok-p">.</span><span class="tok-nx">max</span><span class="tok-p">(</span><span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-nx">end</span><span class="tok-p">);</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Restricts the size of a collection or the length of a String.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param start</span>
<span class="tok-cm">             * @param end</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">size</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-nx">end</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">arguments</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">!==</span> <span class="tok-mi">3</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Size constraint expects three arguments&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">numeric</span><span class="tok-p">(</span><span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">)</span> <span class="tok-o">||</span> <span class="tok-o">!</span><span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">numeric</span><span class="tok-p">(</span><span class="tok-nx">end</span><span class="tok-p">,</span> <span class="tok-kc">true</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Start and end values must be numbers&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Array</span> <span class="tok-o">||</span> <span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">String</span> <span class="tok-o">||</span> <span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">value</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">&gt;=</span> <span class="tok-nb">Math</span><span class="tok-p">.</span><span class="tok-nx">min</span><span class="tok-p">(</span><span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-nx">end</span><span class="tok-p">)</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-nx">value</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">&lt;=</span> <span class="tok-nb">Math</span><span class="tok-p">.</span><span class="tok-nx">max</span><span class="tok-p">(</span><span class="tok-nx">start</span><span class="tok-p">,</span> <span class="tok-nx">end</span><span class="tok-p">);</span>
                <span class="tok-p">}</span>

                <span class="tok-k">throw</span> <span class="tok-s1">&#39;Size constraint only applies to Arrays and Strings&#39;</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Constrains a property as unique at the database level</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param unique</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">unique</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">unique</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">throw</span> <span class="tok-s1">&#39;Unique constraint: not implemented yet&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">//                return false;</span>
            <span class="tok-p">};</span>

            <span class="tok-cm">/**</span>
<span class="tok-cm">             * Validates that a String value is a valid URL.</span>
<span class="tok-cm">             * @param value</span>
<span class="tok-cm">             * @param url</span>
<span class="tok-cm">             * @returns {boolean}</span>
<span class="tok-cm">             */</span>
            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">url</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">,</span> <span class="tok-nx">url</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-nx">arguments</span><span class="tok-p">.</span><span class="tok-nx">length</span> <span class="tok-o">!==</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Url constraint: expected 2 arguments&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">value</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;string&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">value</span> <span class="tok-k">instanceof</span> <span class="tok-nb">String</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Url constraint: value expected to be a string&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">url</span> <span class="tok-o">!==</span> <span class="tok-s1">&#39;boolean&#39;</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-nx">url</span> <span class="tok-k">instanceof</span> <span class="tok-nb">Boolean</span><span class="tok-p">))</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Url constraint: url expected to be a boolean&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-kd">var</span> <span class="tok-nx">urlRegex</span> <span class="tok-o">=</span> <span class="tok-sr">/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&amp;%@!\-\/]))?$/</span><span class="tok-p">;</span>

                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">url</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">return</span> <span class="tok-nx">urlRegex</span><span class="tok-p">.</span><span class="tok-nx">test</span><span class="tok-p">(</span><span class="tok-nx">value</span><span class="tok-p">);</span>
                <span class="tok-p">}</span>

                <span class="tok-k">return</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-kd">var</span> <span class="tok-nx">defaultConstraints</span> <span class="tok-o">=</span> <span class="tok-p">[];</span>
            <span class="tok-k">for</span> <span class="tok-p">(</span><span class="tok-kd">var</span> <span class="tok-nx">i</span> <span class="tok-k">in</span> <span class="tok-nx">instance</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-nx">defaultConstraints</span><span class="tok-p">.</span><span class="tok-nx">push</span><span class="tok-p">(</span><span class="tok-nx">i</span><span class="tok-p">);</span>
            <span class="tok-p">}</span>

            <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">addConstraint</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">constraintName</span><span class="tok-p">,</span> <span class="tok-nx">fn</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">defaultConstraints</span><span class="tok-p">.</span><span class="tok-nx">indexOf</span><span class="tok-p">(</span><span class="tok-nx">constraintName</span><span class="tok-p">)</span> <span class="tok-o">!==</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                    <span class="tok-k">throw</span> <span class="tok-s1">&#39;Cannot override a default constraint&#39;</span><span class="tok-p">;</span>
                <span class="tok-p">}</span>

                <span class="tok-nx">instance</span><span class="tok-p">[</span><span class="tok-nx">constraintName</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-nx">fn</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">setErrorMessage</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">constraintName</span><span class="tok-p">,</span> <span class="tok-nx">message</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-nx">instance</span><span class="tok-p">[</span><span class="tok-nx">constraintName</span> <span class="tok-o">+</span> <span class="tok-s1">&#39;Message&#39;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-nx">message</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>

            <span class="tok-nx">instance</span><span class="tok-p">.</span><span class="tok-nx">getErrorMessage</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">constraintName</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-k">return</span> <span class="tok-nx">instance</span><span class="tok-p">[</span><span class="tok-nx">constraintName</span> <span class="tok-o">+</span> <span class="tok-s1">&#39;Message&#39;</span><span class="tok-p">];</span>
            <span class="tok-p">};</span>

            <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">getInstance</span> <span class="tok-o">=</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">$get</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
                <span class="tok-k">return</span> <span class="tok-nx">instance</span><span class="tok-p">;</span>
            <span class="tok-p">};</span>
        <span class="tok-p">});</span>
<span class="tok-p">})();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lanzando ahora el test nos dará error. Esto se debe a que el módulo del provider no está correctamente definido. Lo corregiremos para que todo funcione correctamente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span class="tok-nx">angular</span>
    <span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;providers.validation&#39;</span><span class="tok-p">,</span> <span class="tok-p">[])</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sobre_el_método_code_inject_code">12.3.4. Sobre el método <code>inject</code></h4>
<div class="paragraph">
<p><code>inject</code> permite que el servicio a inyectar tenga su nombre habitual (ej: <code>$http</code>), o bien su nombre habitual, envuelto por guiones bajos (ej: <code><em>$http</em></code>). Estos guiones son ignorados por el inyector a la hora de resolver el nombre del servicio, y puede ser de gran utilidad si preferimos usar su nombre habitual en nuestros tests.</p>
</div>
<div class="paragraph">
<p>Así estos dos tests serían equivalentes, solo que en un caso mantendríamos el nombre del servicio en lugar de una variable con otro nombre:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;provider: expertoJeeValidation&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-kd">var</span> <span class="tok-nx">expertoJeeValidation</span><span class="tok-p">;</span>

    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;providers.validation&#39;</span><span class="tok-p">));</span>

    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span>
        <span class="tok-c1">//Inyectar los servicios en los tests</span>
        <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">_expertoJeeValidation_</span><span class="tok-p">){</span>
          <span class="tok-nx">expertoJeeValidation</span> <span class="tok-o">=</span> <span class="tok-nx">_expertoJeeValidation_</span><span class="tok-p">;</span>
        <span class="tok-p">})</span>
    <span class="tok-p">);</span>

    <span class="tok-c1">// Resto del test. Usaremos &#39;expertoJeeValidation&#39;,</span>
    <span class="tok-c1">// que es lo mismo que usaríamos en el código</span>
    <span class="tok-c1">// de nuestra aplicación</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;provider: expertoJeeValidation&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-kd">var</span> <span class="tok-nx">theService</span><span class="tok-p">;</span>

    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;providers.validation&#39;</span><span class="tok-p">));</span>

    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span>
        <span class="tok-c1">//Inyectar los servicios en los tests</span>
        <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">expertoJeeValidation</span><span class="tok-p">){</span>
          <span class="tok-nx">theService</span> <span class="tok-o">=</span> <span class="tok-nx">expertoJeeValidation</span><span class="tok-p">;</span>
        <span class="tok-p">})</span>
    <span class="tok-p">);</span>

    <span class="tok-c1">//Resto del test. Usaremos &#39;theService&#39;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_testing_de_controladores_y_em_mocking_em_de_peticiones_http">12.3.5. Testing de controladores y <em>Mocking</em> de peticiones HTTP.</h4>
<div class="paragraph">
<p>Vamos ahora a ver qué sería necesario para testear un controlador. Supondremos un controlador que expondrá en el <code>scope</code> un método llamado <code>getUsers</code>, que se conectará a un servicio HTTP (<code>/users</code>) y devolverá un listado de usuarios. El controlador también deberá contemplar posibles errores en la llamada al servicio.</p>
</div>
<div class="paragraph">
<p>Si se produjera algún error, existe una variable en el <code>scope</code> llamada <code>hasError</code> que pasaría a tener un valor cierto. Los usuarios se guardarán en una variable del <code>scope</code> llamada <code>users</code>.</p>
</div>
<div class="paragraph">
<p>El código del test (<code>test/controller/usersCtrlSpec.js</code>) será el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</div></td><td class="code"><span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>

<span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;Controller: usersCtrl&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span><span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-kd">var</span> <span class="tok-nx">scope</span><span class="tok-p">,</span> <span class="tok-nx">controller</span><span class="tok-p">,</span> <span class="tok-nx">httpBackend</span><span class="tok-p">;</span>

    <span class="tok-c1">// Inicializar el módulo antes de cada test</span>
    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;expertojee.controllers&#39;</span><span class="tok-p">));</span>

    <span class="tok-c1">// Inyección de dependencias, mockearemos $http con el servicio $httpBackend</span>
    <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">$rootScope</span><span class="tok-p">,</span> <span class="tok-nx">$controller</span><span class="tok-p">,</span> <span class="tok-nx">$httpBackend</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-nx">scope</span> <span class="tok-o">=</span> <span class="tok-nx">$rootScope</span><span class="tok-p">.</span><span class="tok-nx">$new</span><span class="tok-p">();</span>
        <span class="tok-nx">controller</span> <span class="tok-o">=</span> <span class="tok-nx">$controller</span><span class="tok-p">;</span>
        <span class="tok-nx">httpBackend</span> <span class="tok-o">=</span> <span class="tok-nx">$httpBackend</span><span class="tok-p">;</span>
    <span class="tok-p">}));</span>

    <span class="tok-nx">iit</span><span class="tok-p">(</span><span class="tok-s1">&#39;should query the webservice&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span><span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-c1">// Definimos qué petición HTTP esperamos, y qué resultado queremos devolver</span>
        <span class="tok-nx">httpBackend</span>
          <span class="tok-p">.</span><span class="tok-nx">expectGET</span><span class="tok-p">(</span><span class="tok-s1">&#39;/users&#39;</span><span class="tok-p">)</span>
          <span class="tok-p">.</span><span class="tok-nx">respond</span><span class="tok-p">(</span><span class="tok-s1">&#39;[{&quot;firstName&quot;: &quot;Alejandro&quot;, &quot;lastName&quot;: &quot;Such&quot;}, {&quot;firstName&quot;: &quot;Domingo&quot;, &quot;lastName&quot;: &quot;Gallardo&quot;}]&#39;</span><span class="tok-p">);</span>

        <span class="tok-c1">// Inicializamos el controlador</span>
        <span class="tok-nx">controller</span><span class="tok-p">(</span><span class="tok-s1">&#39;usersCtrl&#39;</span><span class="tok-p">,</span> <span class="tok-p">{</span><span class="tok-s1">&#39;$scope&#39;</span><span class="tok-o">:</span> <span class="tok-nx">scope</span> <span class="tok-p">});</span>

        <span class="tok-c1">//Llamamos al método del controlador</span>
        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">getUsers</span><span class="tok-p">()</span>

        <span class="tok-c1">// Responder a todas las peticiones HTTP</span>
        <span class="tok-nx">httpBackend</span><span class="tok-p">.</span><span class="tok-nx">flush</span><span class="tok-p">();</span>

        <span class="tok-c1">// Lanzamos scope.$apply() para que se resuelvan todas las promesas</span>
        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>

        <span class="tok-c1">// Evaluar los valores esperados</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">users</span><span class="tok-p">.</span><span class="tok-nx">length</span><span class="tok-p">).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-mi">2</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">hasError</span><span class="tok-p">).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span>
    <span class="tok-p">});</span>

    <span class="tok-nx">iit</span><span class="tok-p">(</span><span class="tok-s1">&#39;should catch an error&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span><span class="tok-p">()</span> <span class="tok-p">{</span>
        <span class="tok-c1">// Cuando se realice una petición a /users, responder con un error 500</span>
        <span class="tok-nx">httpBackend</span>
          <span class="tok-p">.</span><span class="tok-nx">expectGET</span><span class="tok-p">(</span><span class="tok-s1">&#39;/users&#39;</span><span class="tok-p">)</span>
          <span class="tok-p">.</span><span class="tok-nx">respond</span><span class="tok-p">(</span><span class="tok-mi">500</span><span class="tok-p">,</span> <span class="tok-kc">null</span><span class="tok-p">);</span>

        <span class="tok-c1">// Inicializar el controlador</span>
        <span class="tok-nx">controller</span><span class="tok-p">(</span><span class="tok-s1">&#39;usersCtrl&#39;</span><span class="tok-p">,</span> <span class="tok-p">{</span><span class="tok-s1">&#39;$scope&#39;</span><span class="tok-o">:</span> <span class="tok-nx">scope</span> <span class="tok-p">});</span>

        <span class="tok-c1">// Llamamos al método del controlador</span>
        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">getUsers</span><span class="tok-p">()</span>

        <span class="tok-c1">// Responder a todas las peticiones HTTP</span>
        <span class="tok-nx">httpBackend</span><span class="tok-p">.</span><span class="tok-nx">flush</span><span class="tok-p">();</span>

        <span class="tok-c1">// Lanzamos scope.$apply() para que se resuelvan todas las promesas</span>
        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>

        <span class="tok-c1">// Evaluar los valores esperados</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">hasError</span><span class="tok-p">).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
        <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">users</span><span class="tok-p">).</span><span class="tok-nx">toBeNull</span><span class="tok-p">();</span>
    <span class="tok-p">});</span>
<span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A destacar que cada test se define con la función <code>iit</code> en lugar de <code>it</code>. Si en algún momento introducimos alguna función <code>iit</code> el resto de funciones definidas con <code>it</code> serán ignoradas. Esto es cómodo si nos queremos centrar en algún test en concreto.</p>
</div>
<div class="paragraph">
<p>Vemos cómo inicializamos el controlador con el servicio <code>$controller</code>, e inyectándole un <code>scope</code> que hemos creado en la función <code>beforeEach</code> (<code>scope = $rootScope.$new()</code>).</p>
</div>
<div class="paragraph">
<p>Lo más importante es el uso del servicio <a href="https://docs.angularjs.org/api/ngMock/service/$httpBackend">$httpBackend</a>. Éste nos permite implementar llamadas falsas a un servicio y simular los resultados que queramos obtener en cada test. Al inicio de nuestro test escribimos el resultado que queremos probar en cada caso, y una vez llamada a la función que hace uso del servicio, deberemos realizar una llamada al método <code>$httpBackend.flush()</code> para que todas las llamadas al servicio <code>$http</code> que se hayan hecho en el controlador reciban su respuesta.</p>
</div>
<div class="paragraph">
<p>Aunque en el código que implementaremos no es necesario, en algunas ocasiones, dado que las peticiones http trabajan con promesas de resultados, tendremos que llamar a <code>scope.$digest()</code> o <code>scope.$apply()</code> para que los resultados pasen al <code>scope</code>.</p>
</div>
<div class="paragraph">
<p>Un código de controlador que pasaría los dos tests escritos es (<code>src/controller/usersCtrl.js</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</div></td><td class="code"><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(){</span>
  <span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>

  <span class="tok-nx">angular</span>
      <span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;expertojee.controllers&#39;</span><span class="tok-p">,</span> <span class="tok-p">[])</span>
      <span class="tok-p">.</span><span class="tok-nx">controller</span><span class="tok-p">(</span><span class="tok-s1">&#39;usersCtrl&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">$scope</span><span class="tok-p">,</span> <span class="tok-nx">$http</span><span class="tok-p">){</span>
        <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">hasError</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-p">;</span>
        <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">users</span> <span class="tok-o">=</span> <span class="tok-kc">null</span>

        <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">getUsers</span> <span class="tok-o">=</span> <span class="tok-kd">function</span><span class="tok-p">(){</span>
          <span class="tok-nx">$http</span>
            <span class="tok-p">.</span><span class="tok-nx">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/users&#39;</span><span class="tok-p">)</span>
            <span class="tok-p">.</span><span class="tok-nx">success</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(</span><span class="tok-nx">users</span><span class="tok-p">){</span>
              <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">users</span> <span class="tok-o">=</span> <span class="tok-nx">users</span><span class="tok-p">;</span>
              <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">hasError</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-p">;</span>
            <span class="tok-p">})</span>
            <span class="tok-p">.</span><span class="tok-k">catch</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(){</span>
              <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">users</span> <span class="tok-o">=</span> <span class="tok-kc">null</span>
              <span class="tok-nx">$scope</span><span class="tok-p">.</span><span class="tok-nx">hasError</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
            <span class="tok-p">});</span>
        <span class="tok-p">};</span>
      <span class="tok-p">});</span>
<span class="tok-p">})();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_testing_de_directivas">12.3.6. Testing de directivas</h4>
<div class="paragraph">
<p>Finalmente, veremos cómo podemos realizar tests unitarios de directivas. Aunque pueda parecer más difícil, veremos como el proceso es bastante similar a lo que hemos hecho hasta ahora.</p>
</div>
<div class="paragraph">
<p>El truco está en que necesitaremos <em>compilar</em> el código HTML. Para ello utilizaremos el servicio <a href="https://docs.angularjs.org/api/ng/service/$compile">$compile</a>. Compilar consiste en introducir una cadena HTML en el ciclo de AngularJS, asociándole un <em>scope</em>.</p>
</div>
<div class="paragraph">
<p>Para testear una directiva vamos a tener que compilarla, realizar la tarea que tenemos que realizar (si fuese necesario), y finalmente invocar al método <code>$apply()</code> o <code>$digest()</code> del <em>scope</em> para que procesar los cambios.</p>
</div>
<div class="paragraph">
<p>Supongamos la siguiente directiva (<code>src/directive/scheduleEvent.js</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</div></td><td class="code"><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
  <span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>
  <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;directives.schedule&#39;</span><span class="tok-p">,</span> <span class="tok-p">[])</span>
  <span class="tok-p">.</span><span class="tok-nx">directive</span><span class="tok-p">(</span><span class="tok-s1">&#39;scheduleEvent&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-k">return</span> <span class="tok-p">{</span>
      <span class="tok-nx">restrict</span><span class="tok-o">:</span> <span class="tok-s1">&#39;E&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">scope</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">event</span><span class="tok-o">:</span> <span class="tok-s1">&#39;=&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">deleteAction</span><span class="tok-o">:</span> <span class="tok-s1">&#39;&amp;&#39;</span>
      <span class="tok-p">},</span>
      <span class="tok-nx">template</span><span class="tok-o">:</span> <span class="tok-s1">&#39;&lt;div=&quot;schedule-event&quot;&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;h2&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;span ng-if=&quot;isToday&quot;&gt;&lt;i class=&quot;icon ion-ios7-time-outline&quot;&gt;&lt;/i&gt;&lt;/span&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;span ng-if=&quot;!isToday&quot;&gt;&lt;i class=&quot;icon ion-ios7-calendar-outline&quot;&gt;&lt;/i&gt; {{ event.date | date }} - &lt;/span&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;span ng-bind=&quot;event.date | date:\&#39;HH:mm\&#39;&quot;&gt;&lt;/span&gt;. &lt;span ng-bind=&quot;event.title&quot;&gt;&lt;/span&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;p ng-if=&quot;showHolder&quot; ng-bind=&quot;event.contact.name + \&#39; \&#39; + event.contact.middleName + \&#39; \&#39; + event.contact.lastName&quot;&gt;&lt;/p&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;/h2&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;a class=&quot;button&quot; ng-click=&quot;deleteAction()&quot;&gt;Eliminar&lt;/a&gt; &#39;</span> <span class="tok-o">+</span>
      <span class="tok-s1">&#39;&lt;/div&gt;&#39;</span><span class="tok-p">,</span>

      <span class="tok-nx">link</span><span class="tok-o">:</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">,</span> <span class="tok-nx">element</span><span class="tok-p">,</span> <span class="tok-nx">attrs</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">isToday</span> <span class="tok-o">=</span> <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$eval</span><span class="tok-p">(</span><span class="tok-nx">attrs</span><span class="tok-p">.</span><span class="tok-nx">isToday</span><span class="tok-p">);</span>
        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">showHolder</span> <span class="tok-o">=</span> <span class="tok-o">!!</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span><span class="tok-p">.</span><span class="tok-nx">contact</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-o">!</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$eval</span><span class="tok-p">(</span><span class="tok-nx">attrs</span><span class="tok-p">.</span><span class="tok-nx">hideContact</span><span class="tok-p">);</span>

        <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$on</span><span class="tok-p">(</span><span class="tok-s1">&#39;$destroy&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span><span class="tok-p">(){</span>
          <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">).</span><span class="tok-nx">remove</span><span class="tok-p">();</span>
        <span class="tok-p">});</span>
      <span class="tok-p">}</span>
    <span class="tok-p">};</span>
  <span class="tok-p">});</span>
<span class="tok-p">})();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ésta consiste en una entrada de agenda, que puede estar o no asociada a un contacto. Mostrará un botón "Eliminar" Acepta los siguientes atributos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>event</em>: Entrada de agenda. Objeto con los atributos <em>title</em> y <em>contact</em>. <em>contact</em> tiene, a su vez, los atributos <em>firstName</em>, <em>middleName</em> y <em>lastName</em>.</p>
</li>
<li>
<p><em>hideContact</em>: Ocultar el nombre del contacto.</p>
</li>
<li>
<p><em>isToday</em>: el evento es del día de hoy. Acepta los valores "true" o "false".
_ <em>deleteAction</em>: acción a realizar cuando se hace click en el botón de eliminar</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Como hemos comentado, en el test habrá que compilar primero un bloque HTML. Para ello, necesitaremos inyectar el servicio <code>$compile</code> antes de cada test. Como hemos dicho que este servicio asocia una cadena HTML a un <em>scope</em>, también haremos uso del <code>$rootScope</code>, donde definiremos la acción a realizar cuando hagamos click en el botón <em>delete</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">$compile</span><span class="tok-p">,</span> <span class="tok-nx">$rootScope</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-nx">scope</span> <span class="tok-o">=</span> <span class="tok-nx">$rootScope</span><span class="tok-p">;</span>
  <span class="tok-nx">compile</span> <span class="tok-o">=</span> <span class="tok-nx">$compile</span><span class="tok-p">;</span>

  <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">deleteEvent</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">console</span><span class="tok-p">.</span><span class="tok-nx">log</span><span class="tok-p">(</span><span class="tok-s1">&#39;deleting event&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">};</span>
<span class="tok-p">}));</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>En cada uno de nuestros tests, compilaremos el código HTML que deseemos probar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span class="tok-c1">//Añadir un evento al scope</span>
<span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
  <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">(),</span>
  <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">,</span>
  <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-p">{</span>
    <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Juan&#39;</span><span class="tok-p">,</span>
    <span class="tok-nx">middleName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span><span class="tok-p">,</span>
    <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span>
  <span class="tok-p">}</span>
<span class="tok-p">};</span>

<span class="tok-c1">//Crear nuestra plantilla</span>
<span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; is-today=&quot;true&quot; delete-action=&quot;deleteEvent(event)&quot; edit-action=&quot;editEvent(event)&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>

<span class="tok-c1">//Compilar la plantilla</span>
<span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
<span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Una batería de tests para esta directiva podría ser la siguiente, donde iremos probando distintas combinaciones de atributos para ver si hace lo que queremos (<code>test/directive/scheduleEventSpec.js</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</div></td><td class="code"><span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>

<span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;directive: scheduleEvent&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
  <span class="tok-kd">var</span> <span class="tok-nx">element</span><span class="tok-p">;</span>
  <span class="tok-kd">var</span> <span class="tok-nx">scope</span><span class="tok-p">;</span>
  <span class="tok-kd">var</span> <span class="tok-nx">compile</span><span class="tok-p">;</span>

  <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-kd">function</span><span class="tok-p">(){</span>
    <span class="tok-nx">module</span><span class="tok-p">(</span><span class="tok-s1">&#39;directives.schedule&#39;</span><span class="tok-p">)</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">beforeEach</span><span class="tok-p">(</span><span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">$compile</span><span class="tok-p">,</span> <span class="tok-nx">$rootScope</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-nx">scope</span> <span class="tok-o">=</span> <span class="tok-nx">$rootScope</span><span class="tok-p">;</span>
    <span class="tok-nx">compile</span> <span class="tok-o">=</span> <span class="tok-nx">$compile</span><span class="tok-p">;</span>

    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">deleteEvent</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
      <span class="tok-nx">console</span><span class="tok-p">.</span><span class="tok-nx">log</span><span class="tok-p">(</span><span class="tok-s1">&#39;deleting event&#39;</span><span class="tok-p">);</span>
    <span class="tok-p">};</span>
  <span class="tok-p">}));</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should show a today event&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
      <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">(),</span>
      <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Entregar los ejercicios de la sesión 1&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Juan&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">middleName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">};</span>

    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; is-today=&quot;true&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>
    <span class="tok-kd">var</span> <span class="tok-nx">i</span> <span class="tok-o">=</span> <span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">find</span><span class="tok-p">(</span><span class="tok-s1">&#39;i&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">i</span><span class="tok-p">.</span><span class="tok-nx">hasClass</span><span class="tok-p">(</span><span class="tok-s1">&#39;ion-ios7-time-outline&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should show a future event&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
      <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">()</span> <span class="tok-o">+</span> <span class="tok-mi">86400000</span><span class="tok-p">,</span> <span class="tok-c1">//+2 days</span>
      <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;JPA 3,4&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Juan&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">middleName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">};</span>

    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; is-today=&quot;false&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>
    <span class="tok-kd">var</span> <span class="tok-nx">i</span> <span class="tok-o">=</span> <span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">find</span><span class="tok-p">(</span><span class="tok-s1">&#39;i&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">i</span><span class="tok-p">.</span><span class="tok-nx">hasClass</span><span class="tok-p">(</span><span class="tok-s1">&#39;ion-ios7-calendar-outline&#39;</span><span class="tok-p">)).</span><span class="tok-nx">toBe</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should show the contact block&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
      <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">(),</span>
      <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Juan&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">middleName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">};</span>

    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; hide-contact=&quot;false&quot; is-today=&quot;true&quot; delete-action=&quot;deleteEvent(event)&quot; edit-action=&quot;editEvent(event)&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>

    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">find</span><span class="tok-p">(</span><span class="tok-s1">&#39;p&#39;</span><span class="tok-p">)[</span><span class="tok-mi">0</span><span class="tok-p">]).</span><span class="tok-nx">not</span><span class="tok-p">.</span><span class="tok-nx">toBeUndefined</span><span class="tok-p">();</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">text</span><span class="tok-p">()).</span><span class="tok-nx">toContain</span><span class="tok-p">(</span><span class="tok-s1">&#39;Juan Perez Perez&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">text</span><span class="tok-p">()).</span><span class="tok-nx">toContain</span><span class="tok-p">(</span><span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should\&#39;t show the contact block&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
      <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">(),</span>
      <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-kc">null</span>
    <span class="tok-p">};</span>

    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; is-today=&quot;true&quot; delete-action=&quot;deleteEvent(event)&quot; edit-action=&quot;editEvent(event)&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>

    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">find</span><span class="tok-p">(</span><span class="tok-s1">&#39;p&#39;</span><span class="tok-p">)[</span><span class="tok-mi">0</span><span class="tok-p">]).</span><span class="tok-nx">toBeUndefined</span><span class="tok-p">();</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">text</span><span class="tok-p">()).</span><span class="tok-nx">toContain</span><span class="tok-p">(</span><span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should\&#39;t show the contact block despite it has a contact&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
      <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">(),</span>
      <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Juan&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">middleName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">};</span>

    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; is-today=&quot;true&quot; delete-action=&quot;deleteEvent(event)&quot; edit-action=&quot;editEvent(event)&quot; hide-contact=&quot;true&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>

    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">find</span><span class="tok-p">(</span><span class="tok-s1">&#39;p&#39;</span><span class="tok-p">)[</span><span class="tok-mi">0</span><span class="tok-p">]).</span><span class="tok-nx">toBeUndefined</span><span class="tok-p">();</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">text</span><span class="tok-p">()).</span><span class="tok-nx">toContain</span><span class="tok-p">(</span><span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should trigger a delete event&#39;</span><span class="tok-p">,</span> <span class="tok-kd">function</span> <span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-nx">spyOn</span><span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">,</span> <span class="tok-s1">&#39;deleteEvent&#39;</span><span class="tok-p">);</span>

    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">event</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
      <span class="tok-nx">date</span><span class="tok-o">:</span> <span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-nb">Date</span><span class="tok-p">()).</span><span class="tok-nx">getTime</span><span class="tok-p">(),</span>
      <span class="tok-nx">title</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Entrega ejercicios sesión 1&#39;</span><span class="tok-p">,</span>
      <span class="tok-nx">contact</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">name</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Juan&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">middleName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">lastName</span><span class="tok-o">:</span> <span class="tok-s1">&#39;Perez&#39;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">};</span>

    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-s1">&#39;&lt;schedule-event event=&quot;event&quot; is-today=&quot;true&quot; delete-action=&quot;deleteEvent(event)&quot; edit-action=&quot;editEvent(event)&quot;&gt;&lt;/schedule-event&gt;&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">element</span> <span class="tok-o">=</span> <span class="tok-nx">compile</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">)(</span><span class="tok-nx">scope</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>

    <span class="tok-kd">var</span> <span class="tok-nx">editBtn</span> <span class="tok-o">=</span> <span class="tok-nx">angular</span><span class="tok-p">.</span><span class="tok-nx">element</span><span class="tok-p">(</span><span class="tok-nx">element</span><span class="tok-p">.</span><span class="tok-nx">find</span><span class="tok-p">(</span><span class="tok-s1">&#39;a&#39;</span><span class="tok-p">)[</span><span class="tok-mi">0</span><span class="tok-p">]);</span>
    <span class="tok-nx">editBtn</span><span class="tok-p">.</span><span class="tok-nx">triggerHandler</span><span class="tok-p">(</span><span class="tok-s1">&#39;click&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">$apply</span><span class="tok-p">();</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">scope</span><span class="tok-p">.</span><span class="tok-nx">deleteEvent</span><span class="tok-p">).</span><span class="tok-nx">toHaveBeenCalled</span><span class="tok-p">();</span>
  <span class="tok-p">});</span>
<span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Cabe destacar el último test, donde utilizamos un <em>spy</em>, una funcionalidad de Jasmine que nos permite determinar si una función en concreto ha sido llamada.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_automatizando_tareas_con_grunt_diseñando_nuestro_em_workflow_em">12.4. Automatizando tareas con Grunt. Diseñando nuestro <em>workflow</em></h3>
<div class="paragraph">
<p>Ahora vamos a ver lo útil que puede resultarnos grunt para automatizar una serie de tareas. Para ello, crearemos un fichero llamado <code>Gruntfile.js</code> en la raíz de nuestro proyecto, que inicialmente será el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span class="tok-nx">module</span><span class="tok-p">.</span><span class="tok-nx">exports</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">grunt</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-c1">// load all grunt tasks matching the `grunt-*` pattern</span>
  <span class="tok-nx">require</span><span class="tok-p">(</span><span class="tok-s1">&#39;load-grunt-tasks&#39;</span><span class="tok-p">)(</span><span class="tok-nx">grunt</span><span class="tok-p">);</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">initConfig</span><span class="tok-p">({});</span>
  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;default&#39;</span><span class="tok-p">,</span> <span class="tok-p">[]);</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>En él, ya hemos introducido un módulo, llamado <code>load-grunt-tasks</code>, que nos permite cargar de manera más cómoda el resto de módulos que incluyamos en nuestro fichero.</p>
</div>
<div class="sect3">
<h4 id="_verificación_de_código">12.4.1. Verificación de código</h4>
<div class="paragraph">
<p>Dado que JavaScript es un lenguaje tan permisivo, siempre es importante establecer unas convenciones de código. Es ahí donde entra <a href="http://jshint.com/">JSHint</a>, una herramienta <em>open source</em> que detecta errores y problemas potenciales en nuestro código JavaScript, y establece una serie de convenciones. Es muy restrictivo, y podemos relajarlo en base a nuestras necesidades y las de nuestro proyecto.</p>
</div>
<div class="paragraph">
<p>Para configurar JSHint en nuestro proyecto, modificaremos el fichero <code>Gruntfile.js</code> de la siguiente manera:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</div></td><td class="code"><span class="tok-nx">module</span><span class="tok-p">.</span><span class="tok-nx">exports</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">grunt</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-c1">// load all grunt tasks matching the `grunt-*` pattern</span>
  <span class="tok-nx">require</span><span class="tok-p">(</span><span class="tok-s1">&#39;load-grunt-tasks&#39;</span><span class="tok-p">)(</span><span class="tok-nx">grunt</span><span class="tok-p">);</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">initConfig</span><span class="tok-p">({</span>
    <span class="tok-s1">&#39;jshint&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-nx">options</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">curly</span><span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
        <span class="tok-nx">eqeqeq</span><span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
        <span class="tok-nx">eqnull</span><span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
        <span class="tok-nx">browser</span><span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
        <span class="tok-nx">globals</span><span class="tok-o">:</span> <span class="tok-p">{</span>
          <span class="tok-nx">jQuery</span><span class="tok-o">:</span> <span class="tok-kc">true</span>
        <span class="tok-p">},</span>
      <span class="tok-p">},</span>
      <span class="tok-k">default</span> <span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s1">&#39;src/**/*.js&#39;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;default&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">]);</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si ahora lanzamos el comando <code>grunt</code> en nuestra terminal, se ejecutará la tarea <em>default</em>, que realiza la validación de todos los ficheros con extensión <code>.js</code> en alguna de las subcarpetas de <code>src</code>.</p>
</div>
<div class="paragraph">
<p>Veremos que nos da error en el fichero <code>src/controller/AccessController.js</code> porque hay un par de líneas que no hemos finalizado con punto y coma. También, nos dirá que hay una sentencia <code>if</code> en el fichero <code>src/filters/textOrDefault.js</code> que no tiene llaves</p>
</div>
<div class="paragraph">
<p>Una vez corregidos estos dos errores, la tarea se ejecutará correctamente.</p>
</div>
</div>
<div class="sect3">
<h4 id="_testing">12.4.2. Testing</h4>
<div class="paragraph">
<p>Una vez verificado el código, haremos que los tests se lancen automáticamente con karma. Para ello, añadiremos karma a nuestro <em>workflow</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span class="tok-nx">module</span><span class="tok-p">.</span><span class="tok-nx">exports</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">grunt</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-c1">//...</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">initConfig</span><span class="tok-p">({</span>
    <span class="tok-s1">&#39;jshint&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-c1">//...</span>
    <span class="tok-p">},</span>

    <span class="tok-s1">&#39;karma&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-s1">&#39;default&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-s1">&#39;configFile&#39;</span> <span class="tok-o">:</span> <span class="tok-s1">&#39;karma.conf.js&#39;</span><span class="tok-p">,</span>
        <span class="tok-s1">&#39;options&#39;</span><span class="tok-o">:</span> <span class="tok-p">{</span>
          <span class="tok-nx">singleRun</span><span class="tok-o">:</span> <span class="tok-kc">true</span>
        <span class="tok-p">}</span>
      <span class="tok-p">}</span>
    <span class="tok-p">}</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;default&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;karma&#39;</span><span class="tok-p">]);</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Como véis, hemos sobreescrito la opción <code>singleRun</code> para asegurarnos de que no se queda a la espera de cambios para volver a lanzar la batería de tests.</p>
</div>
<div class="paragraph">
<p>Ahora, al lanzar <code>grunt</code> se ejecutará JSHint y, si pasa correctamente, se lanzarán después los tests que habíamos hecho con karma.</p>
</div>
</div>
<div class="sect3">
<h4 id="_generando_código_de_distribución">12.4.3. Generando código de distribución</h4>
<div class="paragraph">
<p>En tiempo de desarrollo, es muy cómodo y recomendable tener varios ficheros de código fuente. Sin embargo, a la hora de ir a producción, lo normal es tener un único fichero fuente con todo el código, ya sea minificado o no. El mismo angularJS, como podemos ver en su <a href="https://github.com/angular/angular/tree/master/modules">GitHub</a>, tiene un sinfín de ficheros pero nosotros únicamente importamos el fichero <code>angular.js</code> o <code>angular.min.js</code>. Esto se realiza de una manera sencilla con los plugins <code>grunt-contrib-concat</code> y <code>grunt-contrib-uglify</code>. El primero de ellos se encargará de concatenar todos los ficheros en uno solo, mientras que el segundo utilizará este resultado para generar un fichero minificado.</p>
</div>
<div class="paragraph">
<p>Como esto no lo realizaremos siempre, registraremos una tarea, que llamaremos <code>dist</code>, que realizará esta labor. Es muy importante que los tests pasen correctamente antes de generar un fichero de distribución, con lo que repetiremos las vistas anteriormente.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</div></td><td class="code"><span class="tok-nx">module</span><span class="tok-p">.</span><span class="tok-nx">exports</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">grunt</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-c1">// ...</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">initConfig</span><span class="tok-p">({</span>
    <span class="tok-s1">&#39;pkg&#39;</span><span class="tok-o">:</span> <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">file</span><span class="tok-p">.</span><span class="tok-nx">readJSON</span><span class="tok-p">(</span><span class="tok-s1">&#39;package.json&#39;</span><span class="tok-p">),</span>

    <span class="tok-s1">&#39;jshint&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-c1">// ...</span>
    <span class="tok-p">},</span>

    <span class="tok-s1">&#39;karma&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-c1">// ...</span>
    <span class="tok-p">},</span>

    <span class="tok-s1">&#39;concat&#39;</span><span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-s1">&#39;dist&#39;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-s1">&#39;src&#39;</span> <span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s1">&#39;src/**/*.js&#39;</span><span class="tok-p">],</span>
        <span class="tok-s1">&#39;dest&#39;</span><span class="tok-o">:</span> <span class="tok-s1">&#39;dist/&lt;%=pkg.name%&gt;-&lt;%=pkg.version%&gt;.js&#39;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">},</span>

    <span class="tok-s1">&#39;uglify&#39;</span><span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-s1">&#39;options&#39;</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-s1">&#39;mangle&#39;</span><span class="tok-o">:</span><span class="tok-kc">false</span>
      <span class="tok-p">},</span>
      <span class="tok-s1">&#39;dist&#39;</span><span class="tok-o">:</span><span class="tok-p">{</span>
        <span class="tok-s1">&#39;files&#39;</span><span class="tok-o">:</span> <span class="tok-p">{</span>
          <span class="tok-s1">&#39;dist/&lt;%=pkg.name%&gt;-&lt;%=pkg.version%&gt;.min.js&#39;</span> <span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s1">&#39;dist/&lt;%=pkg.name%&gt;-&lt;%=pkg.version%&gt;.js&#39;</span><span class="tok-p">]</span>
        <span class="tok-p">}</span>
      <span class="tok-p">}</span>
    <span class="tok-p">}</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;default&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;karma&#39;</span><span class="tok-p">]);</span>
  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;dist&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;karma&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;concat:dist&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;uglify:dist&#39;</span><span class="tok-p">]);</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lanzando el comando <code>grunt dist</code>, veremos que se ejecuta todo, y finalmente se habrá creado una carpeta <code>dist</code> con dos nuevos ficheros:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">.
├── Gruntfile.js
├── bower_components
├── dist
│   ├── angular-automation-testing-0.0.0.js
│   └── angular-automation-testing-0.0.0.min.js
├── karma.conf.js
├── node_modules
├── src
│   ├── controller
│   ├── directive
│   ├── filters
│   └── providers
└── <span class="tok-nb">test</span>
    ├── controller
    ├── directive
    ├── filters
    └── providers</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_observando_cambios_para_lanzar_tests">12.4.4. Observando cambios para lanzar tests</h4>
<div class="paragraph">
<p>Otra tarea muy interesante que podemos programar es que los tests se lancen automáticamente tan pronto salvemos los cambios de algún fichero javascript. Para ello nos valdremos de la ayuda del plugin <code>grunt-contrib-watch</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</div></td><td class="code"><span class="tok-nx">module</span><span class="tok-p">.</span><span class="tok-nx">exports</span> <span class="tok-o">=</span> <span class="tok-kd">function</span> <span class="tok-p">(</span><span class="tok-nx">grunt</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-c1">// ...</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">initConfig</span><span class="tok-p">({</span>

    <span class="tok-c1">// ...</span>

    <span class="tok-nx">watch</span><span class="tok-o">:</span> <span class="tok-p">{</span>
      <span class="tok-nx">scripts</span><span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-nx">files</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s1">&#39;src/**/*.js&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;test/**/*.js&#39;</span><span class="tok-p">],</span>
        <span class="tok-nx">tasks</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;karma&#39;</span><span class="tok-p">],</span>
        <span class="tok-nx">options</span><span class="tok-o">:</span> <span class="tok-p">{</span>
          <span class="tok-nx">spawn</span><span class="tok-o">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
        <span class="tok-p">},</span>
      <span class="tok-p">},</span>
    <span class="tok-p">},</span>
  <span class="tok-p">});</span>

  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;default&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;karma&#39;</span><span class="tok-p">]);</span>
  <span class="tok-nx">grunt</span><span class="tok-p">.</span><span class="tok-nx">registerTask</span><span class="tok-p">(</span><span class="tok-s1">&#39;dist&#39;</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-s1">&#39;jshint&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;karma&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;concat:dist&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;uglify:dist&#39;</span><span class="tok-p">]);</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lanzando ahora el comando <code>grunt watch</code>, veremos que la terminal se pone en espera. Modificando cualquier fichero, vemos cómo se registra el cambio y se lanzan los tests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_otros_plugins_de_utilidad">12.4.5. Otros plugins de utilidad</h4>
<div class="paragraph">
<p>Hemos visto unos cuantos plugins que son de gran utilidad para nuestros, y ampliamente usados.</p>
</div>
<div class="paragraph">
<p>Otros plugins interesantes podrían ser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/alexgorbatchev/grunt-angular-injector"><code>grunt-angular-injector</code></a>: modifica nuestro código AngularJS para ayudarnos a solventar el problema de la minificación de código y la inyección de dependencias.</p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/grunt-html2js"><code>grunt-html2js</code></a>: introduce en el servicio <code>$templateCache</code> todas nuestras vistas. De esta manera, ya están cacheadas y no se tienen que pedir por AJAX.</p>
</li>
<li>
<p><a href="https://github.com/Couto/grunt-groundskeeper"><code>grunt-groundskeeper</code></a>: elimina los <code>console.log</code> y <code>debugger</code> de nuestro código.</p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/grunt-contrib-cssmin"><code>grunt-contrib-cssmin</code></a>: al igual que minificamos javascript, también podemos hacerlo con nuestros CSS.</p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/grunt-contrib-less"><code>grunt-contrib-less</code></a>: compila nuestro código LESS a CSS.</p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/grunt-contrib-imagemin"><code>grunt-contrib-imagemin</code></a>: optimiza nuestras imágenes para un entorno web.</p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/grunt-contrib-htmlmin"><code>grunt-contrib-htmlmin</code></a>: minifica nuestro código HTML.</p>
</li>
<li>
<p><a href="https://github.com/jsoverson/grunt-open"><code>grunt-open</code></a>: podría usarse, por ejemplo, para abrir el navegador una vez generado el código.</p>
</li>
<li>
<p><a href="https://github.com/sindresorhus/grunt-concurrent"><code>grunt-concurrent</code></a>: nos permite lanzar tareas de grunt de manera concurrente.</p>
</li>
<li>
<p><a href="https://github.com/btford/grunt-conventional-changelog"><code>grunt-conventional-changelog</code></a>: genera un <em>changelog</em> a partir de los metadatos de Git.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_un_paso_más_allá">12.5. Un paso más allá</h3>
<div class="paragraph">
<p>Hoy en día tenemos una gran cantidad de servidores de integración continua que nos permiten realizar estas tareas automáticas una vez hemos hecho push en nuestro repositorio. <a href="https://travis-ci.org/">Travis</a>, por ejemplo, nos da este servicio de manera gratuita para proyectos <em>open source</em>. Podemos generar un <em>hook</em> que lanza los tests y genera el código de distribución, y luego despliega <em>releases</em> en el repositorio de nuestro proyecto.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-05 18:57:19 CEST
</div>
</div>
</body>
</html>