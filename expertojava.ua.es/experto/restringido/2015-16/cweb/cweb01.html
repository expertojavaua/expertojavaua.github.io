<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Miguel Angel Lozano">
<title>Componentes Web</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Componentes Web</h1>
<div class="details">
<span id="author" class="author">Miguel Angel Lozano</span><br>
<span id="email" class="email"><a href="mailto:malozano@ua.es">malozano@ua.es</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion01">1. Introducción a las aplicaciones web</a>
<ul class="sectlevel2">
<li><a href="#__qu%C3%A9_es_una_aplicaci%C3%B3n_web">1.1. ¿Qué es una aplicación web?</a>
<ul class="sectlevel3">
<li><a href="#_aplicaciones_en_el_lado_del_servidor">1.1.1. Aplicaciones en el lado del servidor</a></li>
<li><a href="#_aplicaciones_en_el_lado_del_cliente">1.1.2. Aplicaciones en el lado del cliente</a></li>
</ul>
</li>
<li><a href="#_aplicaciones_web_java_ee">1.2. Aplicaciones web Java EE</a>
<ul class="sectlevel3">
<li><a href="#_estructura_de_la_aplicaci%C3%B3n">1.2.1. Estructura de la aplicación</a></li>
<li><a href="#_rutas_relativas_al_contexto">1.2.2. Rutas relativas al contexto</a></li>
<li><a href="#_empaquetamiento_de_aplicaciones_web_en_ficheros_war">1.2.3. Empaquetamiento de aplicaciones web en ficheros WAR</a></li>
</ul>
</li>
<li><a href="#_creaci%C3%B3n_y_despliegue_de_aplicaciones_web_con_intellij_y_wildfly">1.3. Creación y despliegue de aplicaciones web con IntelliJ y WildFly</a>
<ul class="sectlevel3">
<li><a href="#_creaci%C3%B3n_de_un_proyecto_web_con_intellij">1.3.1. Creación de un proyecto web con IntelliJ</a></li>
<li><a href="#_despliegue_del_proyecto_en_wildfly_desde_l%C3%ADnea_de_comando">1.3.2. Despliegue del proyecto en WildFly desde línea de comando</a></li>
<li><a href="#_despliegue_del_proyecto_en_wildfly_con_intellij">1.3.3. Despliegue del proyecto en WildFly con IntelliJ</a></li>
</ul>
</li>
<li><a href="#_componentes_de_la_aplicaci%C3%B3n_java_ee">1.4. Componentes de la aplicación Java EE</a>
<ul class="sectlevel3">
<li><a href="#_el_descriptor_de_despliegue">1.4.1. El descriptor de despliegue</a></li>
<li><a href="#_servlets">1.4.2. Servlets</a></li>
<li><a href="#_jsp">1.4.3. JSP</a></li>
</ul>
</li>
<li><a href="#_ejercicios">1.5. Ejercicios</a>
<ul class="sectlevel3">
<li><a href="#_aplicaci%C3%B3n_web_en_wildfly_0_5_puntos">1.5.1. Aplicación web en WildFly (0.5 puntos)</a></li>
<li><a href="#_hola_mundo_con_intellij_0_5_puntos">1.5.2. Hola mundo con IntelliJ (0.5 puntos)</a></li>
<li><a href="#_servlet_que_muestra_la_fecha_y_hora_actuales_0_5_puntos">1.5.3. Servlet que muestra la fecha y hora actuales (0.5 puntos)</a></li>
<li><a href="#_servlet_que_muestra_par%C3%A1metros_de_inicio_0_5_puntos">1.5.4. Servlet que muestra parámetros de inicio (0.5 puntos)</a></li>
<li><a href="#_configurar_em_logging_em_en_servlets_0_5_puntos">1.5.5. Configurar <em>logging</em> en servlets (0.5 puntos)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion01">1. Introducción a las aplicaciones web</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="__qué_es_una_aplicación_web">1.1. ¿Qué es una aplicación web?</h3>
<div class="paragraph">
<p>Una aplicación web es una aplicación a la que accedemos mediante protocolo HTTP utilizando un navegador web. El protocolo HTTP especifica el modo de comunicación entre una máquina cliente y una máquina servidor, de modo que el cliente solicita un documento del espacio de direcciones del servidor, y éste se lo sirve.</p>
</div>
<div class="sect3">
<h4 id="_aplicaciones_en_el_lado_del_servidor">1.1.1. Aplicaciones en el lado del servidor</h4>
<div class="paragraph">
<p>En el lado del servidor, tenemos que conseguir que nuestro servidor HTTP sea capaz de ejecutar programas de aplicación que recojan los parámetros de peticiones del cliente, los procesen y devuelvan al servidor un documento que éste pasará a su vez al cliente.</p>
</div>
<div class="paragraph">
<p>Así, para el cliente el servidor no habrá hecho nada distinto a lo estipulado en el protocolo HTTP, pero el servidor podrá valerse de herramientas externas para procesar y servir la petición solicitada, pudiendo así no limitarse a servir páginas estáticas, sino utilizar otras aplicaciones (servlets, JSP, PHP, etc) para servir documentos con contenido dinámico.</p>
</div>
<div class="paragraph">
<p>Los programas de aplicación son típicamente programas que realizan consultas a bases de datos, procesan la información resultante y devuelven la salida al servidor, entre otras tareas.</p>
</div>
</div>
<div class="sect3">
<h4 id="_aplicaciones_en_el_lado_del_cliente">1.1.2. Aplicaciones en el lado del cliente</h4>
<div class="paragraph">
<p>Se tienen muchas tecnologías relacionadas con extensiones del lado del cliente (entendiendo cliente como un navegador que interpreta código HTML). El código HTML es un código estático que sólo permite formatear la apariencia de una página y definir enlaces a otras páginas o URLs. Esto no es suficiente si queremos que el navegador realice funciones más complicadas: validar entradas de formularios, mostrar la evolución del precio de unas acciones, etc.</p>
</div>
<div class="paragraph">
<p>Para ampliar las funcionalidades del navegador (respetando el protocolo HTTP), se utilizan tecnologías como JavaScript, Applets, Flash, etc. Estas se basan en hacer que el navegador ejecute código que le pasa el servidor, bien embebido en documentos HTML (como es el caso de JavaScript), o bien mediante ficheros compilados multiplataforma (como es el caso de los Applets Java o los ficheros Flash).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_aplicaciones_web_java_ee">1.2. Aplicaciones web Java EE</h3>
<div class="paragraph">
<p>Vamos a centrarnos en las aplicaciones web Java EE, en las que los componentes dinámicos que recibirán las peticiones HTTP en el servidor serán los servlets y JSPs. Estos componentes podrán analizar esta petición y utilizar otros componentes Java para realizar las acciones necesarias (beans, EJBs, etc).</p>
</div>
<div class="sect3">
<h4 id="_estructura_de_la_aplicación">1.2.1. Estructura de la aplicación</h4>
<div class="paragraph">
<p>Una aplicación web JavaEE que utilice servlets o páginas JSP debe tener una estructura de ficheros y directorios determinada:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En el directorio raíz de la aplicación se colocan los <strong>documentos web</strong> HTML o JSP, junto a los recursos que necesiten, como por ejemplo imágenes, hojas de estilo, ficheros de código JavaScript u otros ficheros referenciados desde los documentos web (podemos dividirlas también en directorios si queremos)</p>
</li>
<li>
<p>Colgando del directorio inicial de la aplicación, se tiene un directorio <code>WEB-INF</code>, que contiene la información Web relevante para la aplicación. Esta información se divide en:</p>
<div class="ulist">
<ul>
<li>
<p>Fichero <strong>descriptor de despliegue</strong> de la aplicación: es el fichero descriptor de la aplicación web. Es un fichero XML (llamado <code>web.xml</code>) que contiene información genérica sobre la aplicación. Lo veremos con más detalle más adelante.</p>
</li>
<li>
<p>Subdirectorio <code>classes</code>: en él irán todas las clases Java utilizadas en la aplicación (ficheros <code>.class</code>), es decir, clases externas a la API de Java que se utilicen en las páginas JSP, servlets, etc. Las clases deberán mantener la estructura de paquetes, es decir, si queremos colocar la clase <code>paquete1.subpaquete1.MiClase</code> dentro de <code>classes</code>, se quedará almacenada en el directorio <code>classes/paquete1/subpaquete1/MiClase</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Es recomendable utilizar como nombre de paquete nuestra URL al revés, por ejemplo si tenemos la dirección <code>expertojava.org</code> podríamos utilizar para nuestros proyectos paquetes como <code>org.expertojava.web.servlets</code>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Subdirectorio <code>lib</code>: aquí colocaremos las clases Java que estén empaquetadas en ficheros JAR (es decir, colocaremos los ficheros JAR de nuestra aplicación Web, y las librerías ajenas a la API de JDK o de servlets y JSP que se necesiten)</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Los ficheros <code>.class</code> se separan de los ficheros JAR, colocando los primeros en el directorio <code>classes</code> y los segundos en <code>lib</code>.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Esta estructura estará contenida dentro de algún directorio, que será el directorio correspondiente a la aplicación Web, y que podremos, si lo hacemos convenientemente, copiar en el servidor que nos convenga. Es decir, cualquier servidor Web JavaEE soporta esta estructura en una aplicación Web, sólo tendremos que copiarla en el directorio adecuado de cada servidor.</p>
</div>
<div class="paragraph">
<p>Cada aplicación web JavaEE es un <strong>contexto</strong>, una unidad que comprende un conjunto de recursos, clases Java y su configuración. Cuando hablemos de contexto, nos estaremos refiriendo a la aplicación web en conjunto. Por ello utilizaremos indistintamente los términos aplicación web y contexto.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rutas_relativas_al_contexto">1.2.2. Rutas relativas al contexto</h4>
<div class="paragraph">
<p>Cada contexto (aplicación web) instalado en el servidor tendrá asociado una ruta para acceder a él desde la web. Por ejemplo, podemos asociar nuestro contexto la ruta <code>/aplic</code>, de forma que accediendo a la siguiente URL:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/aplic/index.htm" class="bare">http://localhost:8080/aplic/index.htm</a></p>
</div>
<div class="paragraph">
<p>Estaremos leyendo el recurso <code>/index.htm</code> de nuestro contexto.</p>
</div>
<div class="paragraph">
<p>Supongamos que tenemos alguna imagen o recurso al que queremos acceder desde otro, en nuestra aplicación Web. Por ejemplo, supongamos que colgando del directorio raíz de la aplicación tenemos la imagen <code>miImagen.jpg</code> dentro de la carpeta <code>imagenes</code> (es decir, <code>imagenes/miImagen.jpg</code>).</p>
</div>
<div class="paragraph">
<p>Podemos acceder a esta imagen de varias formas, aunque a veces podemos tener problemas con alguna, porque luego el contenedor Web tome la ruta relativa al lugar desde donde queremos cargar la imagen (o recurso, en general). Este problema lo podemos tener accediendo a elementos desde servlets, sobre todo.</p>
</div>
<div class="paragraph">
<p>Una solución para evitar esto es acceder a todos los elementos de la aplicación a partir de la ruta del contexto. Por ejemplo, si nuestro contexto tiene la ruta <code>/aplic</code> asociada, para acceder a la imagen desde una página HTML, pondríamos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;img</span> <span class="tok-na">src=</span><span class="tok-s">&quot;/aplic/imagenes/miImagen.jpg&quot;</span><span class="tok-nt">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_empaquetamiento_de_aplicaciones_web_en_ficheros_war">1.2.3. Empaquetamiento de aplicaciones web en ficheros WAR</h4>
<div class="paragraph">
<p>Una forma de distribuir aplicaciones Web Java EE es empaquetar toda la aplicación (a partir de su directorio inicial) dentro de un fichero WAR (de forma parecida a como se hace con un TAR o un JAR), y distribuir dicho fichero. Podemos crear un fichero WAR de la misma forma que creamos un JAR, utilizando la herramienta JAR.</p>
</div>
<div class="paragraph">
<p>Estos ficheros WAR son un estándar de Java EE, por lo que podremos utilizarlos en los diferentes servidores de aplicaciones Java EE existentes.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, si tenemos en el directorio <code>web/ejemplo</code> los siguientes ficheros:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>web/ejemplo/
    index.html
        WEB-INF/
            web.xml
            classes/
                ClaseServlet.class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para crear la aplicación WAR se siguen los pasos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Crear el WAR colocándonos en dicho directorio <code>web/ejemplo</code> y escribiendo:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>jar cMvf ejemplo.war *</code></pre>
</div>
</div>
<div class="paragraph">
<p>Las opciones <code>c</code>, <code>v</code> y <code>f</code> son para crear el WAR como un JAR comprimido normal. La opción <code>M</code> (mayúscula) es para que no se añada el fichero <code>MANIFEST</code>.</p>
</div>
<div class="paragraph">
<p>También es IMPORTANTE destacar que no debe haber subdirectorios desde la raíz de la aplicación, es decir, la estructura del fichero WAR debe ser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>index.html
WEB-INF/
    web.xml
    classes/
        ClaseServlet.class</code></pre>
</div>
</div>
<div class="paragraph">
<p>sin ningún subdirectorio previo (ni <code>ejemplo/</code> ni <code>web/ejemplo/</code> ni nada por el estilo).</p>
</div>
</li>
<li>
<p>Copiar el fichero WAR al servidor web para poner en marcha la aplicación. Veremos esto con detalle para un servidor de aplicaciones concreto en el siguiente apartado.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
El empaquetamiento en archivos WAR es algo estándar, pero no así el proceso de despliegue, que es dependiente del servidor. No obstante, la mayoría de servidores Java EE funcionan en este aspecto de modo similar: permiten desplegar las aplicaciones desde una consola de administración y también "dejando caer" el fichero en determinado directorio.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_y_despliegue_de_aplicaciones_web_con_intellij_y_wildfly">1.3. Creación y despliegue de aplicaciones web con IntelliJ y WildFly</h3>
<div class="paragraph">
<p>Vamos a pasar ahora a ver la forma de crear y desplegar aplicaciones web Java EE con un IDE y un servidor de aplicaciones concreto. Vamos a utilizar el IDE IntelliJ IDEA y el servidor de aplicaciones WildFly (JBoss 8.1).</p>
</div>
<div class="sect3">
<h4 id="_creación_de_un_proyecto_web_con_intellij">1.3.1. Creación de un proyecto web con IntelliJ</h4>
<div class="paragraph">
<p>Empezaremos creando un nuevo proyecto web Java EE desde el IDE IntelliJ. Encontramos dos formas de hacer esto:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Crearlo como proyecto web IntelliJ, con <em>New Project</em> &gt; <em>Java Enterprise</em> &gt; <em>Web Application</em>. El proyecto web tendrá ficheros de configuración propios de este IDE.</p>
</li>
<li>
<p>Crearlo como proyecto Maven dentro de IntelliJ, con <em>New Project</em> &gt; <em>Maven</em>, y seleccionando un arquetipo que genere un proyecto web Java EE 7. De esta forma tendremos un proyecto que se podrá construir con Maven fuera del entorno IntelliJ y podrá ser importado por otros IDEs, y que además contará con los ficheros de configuración propios de IntelliJ para poder trabajar con él dentro de este entorno. Cuando se produzcan cambios en la configuración de Maven del proyecto, podremos importar dichos cambios a la configuración del proyecto IntelliJ.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Vamos a utilizar la segunda opción, dada la flexibilidad que nos proporciona Maven para poder construir el proyecto de forma independiente al IDE utilizado. En la pantalla de creación del proyecto deberemos marcar la casilla <em>Create from archetype</em>, y pulsar sobre el botón <em>Add archetype &#8230;&#8203;</em>, ya que el arquetipo que vamos a necesitar (aplicación web Java EE 7) no está en la lista por defecto:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/new-project-1.png" alt="Creación de un nuevo proyecto web" width="66%">
</div>
</div>
<div class="paragraph">
<p>Del arquetipo introduciremos los siguientes datos:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/new-project-2-add-archetype.png" alt="Añadir un nuevo arquetipo Maven" width="33%">
</div>
</div>
<div class="paragraph">
<p>Una vez seleccionado el arquetipo deberemos introducir la configuración del módulo Maven (<code>artifactId</code>, <code>groupId</code>, y <code>version</code>):</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/new-project-3-maven-conf.png" alt="Configuración del módulo Maven" width="66%">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;groupId&gt;</span>org.codehaus.mojo.archetypes<span class="tok-nt">&lt;/groupId&gt;</span>
<span class="tok-nt">&lt;artifactId&gt;</span>webapp-javaee7<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;version&gt;</span>1.1<span class="tok-nt">&lt;/version&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Tras esto, introduciremos el nombre que va a tener el proyecto dentro de IntelliJ. Esto ya no es configuración de Maven, sino del propio IDE:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/new-project-4-name.png" alt="Nombre del proyecto IntelliJ" width="50%">
</div>
</div>
<div class="paragraph">
<p>Con esto habremos finalizado, y veremos nuestro nuevo proyecto con la siguiente organización:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/new-project-5-layout-proyecto-web.png" alt="Layout del proyecto web en IntelliJ" width="33%">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Es posible que durante la creación del proyecto IntelliJ nos pregunte repetidas veces si queremos recargar la información de Maven en el proyecto. Responderemos siempre que si y podemos indicar que esta información se importe de forma automática cuando haya cambios (<em>Enable Auto-Import</em>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_despliegue_del_proyecto_en_wildfly_desde_línea_de_comando">1.3.2. Despliegue del proyecto en WildFly desde línea de comando</h4>
<div class="paragraph">
<p>Podemos desplegar nuestro proyecto en el servidor de aplicaciones WildFly directamente desde línea de comando, al igual que ocurre con la mayoría de servidores de aplicaciones Java EE.</p>
</div>
<div class="paragraph">
<p>En primer lugar deberemos poner el servidor WildFly en marcha. Por el momento será suficiente con poner el servidor <em>standalone</em>, que contiene una única instancia del servidor de aplicaciones. Para poner en marcha el servidor ejecutaremos el siguiente comando desde el directorio <code>$WILDFLY_HOME/bin</code>, siendo <code>$WILDFLY_HOME</code> el directorio de instalación de este servidor de aplicaciones:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>./standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Con el servidor WilfFly en marcha podremos desplegar una aplicación simplemente "dejando caer" el fichero <em>war</em> en el directorio <code>$WILDFLY_HOME/standalone/desployments</code>. Pasados unos segundos desde la copia del fichero la aplicación se habrá desplegado y podremos acceder a ella mediante un navegador. Por ejemplo, si copiamos un fichero <code>miaplicacion.war</code>, por defecto podremos acceder a ella mediante:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/miaplicacion/" class="bare">http://localhost:8080/miaplicacion/</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_despliegue_del_proyecto_en_wildfly_con_intellij">1.3.3. Despliegue del proyecto en WildFly con IntelliJ</h4>
<div class="paragraph">
<p>Una vez tenemos un proyecto web creado podemos desplegarlo en un servidor de aplicaciones. Para ello deberemos en primer lugar configurar en IntelliJ el servidor donde queramos desplegar la aplicación, y en segundo lugar crear un perfil de ejecución que le indique a WildFly cómo debe hacer el despliegue de nuestra aplicación web.</p>
</div>
<div class="sect4">
<h5 id="_configuración_de_wildfly_en_intellij">Configuración de WildFly en IntelliJ</h5>
<div class="paragraph">
<p>En primer lugar deberemos configurar el servidor de aplicaciones a utilizar. Para ello entraremos en <em>File</em> &gt; <em>Settings &#8230;&#8203;</em> &gt; <em>Application Servers</em>. En dicha sección pulsaremos sobre el botón para añadir un nuevo servidor de tipo JBoss:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/conf-jboss-1.png" alt="Añadir un nuevo servidor JBoss" width="25%">
</div>
</div>
<div class="paragraph">
<p>Nos pedirá el directorio donde está instalado WildFly:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/conf-jboss-2.png" alt="Directorio de instalación de JBoss" width="33%">
</div>
</div>
<div class="paragraph">
<p>Tras introducirlo veremos el servidor JBoss configurado y ya podremos desplegar el proyecto en él:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/conf-jboss-3.png" alt="Servidor JBoss configurado" width="66%">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
También se podría configurar el servidor en el momento de la creación del perfil de ejecución.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_creación_de_un_perfil_de_ejecución">Creación de un perfil de ejecución</h5>
<div class="paragraph">
<p>Para poder desplegar nuestra aplicación web deberemos crear un perfil de ejecución para ella dentro de IntelliJ.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Necesitaremos un perfil de ejecución por cada aplicación web que queramos poder desplegar.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>En primer lugar seleccionaremos <em>Run</em> &gt; <em>Edit configurations &#8230;&#8203;</em>. Dentro de esta pantalla pulsaremos el botón <code>+</code> y añadiremos un nuevo perfil de tipo <em>JBoss Server</em> &gt; <em>Local</em>. Veremos un formulario como el siguiente:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/run-1-profile.png" alt="Creación de un perfil de ejecución" width="66%">
</div>
</div>
<div class="paragraph">
<p>En el campo <em>Name</em> podemos darle un nombre al nuevo perfil de ejecución. Si ya hemos configurado el servidor JBoss, veremos que ya aparece seleccionado como servidor en el que desplegar. En caso contrario, podríamos configurarlo desde esta pantalla.</p>
</div>
<div class="paragraph">
<p>Veremos también que en la parte inferior aparece un <em>Warning</em> indicando que no hay seleccionados artefactos para ser desplegados. Deberemos indicar qué artefacto va a ser desplegado en el servidor cuando ejecutemos este perfil. Podemos indicarlo pulsando sobre el botón <em>Fix</em> o pasando de forma manual a la pestaña <em>Deployment</em>. Desde esta pestaña podemos añadir un nuevo artefacto a desplegar pulsando sobre el botón <code>+</code>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/run-2-artifacts.png" alt="Selección de artefactos" width="50%">
</div>
</div>
<div class="paragraph">
<p>Tenemos dos artefactos configurados por defecto:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>war</em>: Despliega la aplicación web empaquetada en un fichero WAR</p>
</li>
<li>
<p><em>war exploded</em>: Despliega la aplicación web publicando el directorio sin empaquetar.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Seleccionaremos uno de ellos y nos aparecerá como artefacto a desplegar:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/run-3-deployment.png" alt="Artefactos a desplegar" width="66%">
</div>
</div>
<div class="paragraph">
<p>Ahora ya podremos guardar el perfil de ejecución y pulsar el botón <em>Run</em> para realizar el despliegue. A partir de este momento podremos lanzar este perfil en cualquier momento para volver a realizar el despliegue de la aplicación.</p>
</div>
</div>
<div class="sect4">
<h5 id="_configuración_de_artefactos">Configuración de artefactos</h5>
<div class="paragraph">
<p>Podemos configurar los artefactos generados por el proyecto en la pantalla <em>File</em> &gt; <em>Project Structure &#8230;&#8203;</em> &gt; <em>Artifacts</em>. Aquí veremos los dos artefactos que se crear por defecto para las aplicaciones web, y podremos editarlos o crear nuevos:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/project-structure-1-artifacts.png" alt="Configuración de artefactos" width="100%">
</div>
</div>
<div class="paragraph">
<p>Por ejemplo, podríamos modificar el nombre del fichero WAR para así cambiar el nombre del contexto donde se desplegará la aplicación.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Si queremos cambiar el nombre del contexto en el que se despliega la aplicación es mejor hacerlo introduciendo en el fichero <code>pom-xml</code> el elemento <code>&lt;finalName&gt;</code> dentro de la etiqueta <code>&lt;build&gt;</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;project&gt;</span>
    ...
    <span class="tok-nt">&lt;build&gt;</span>
        <span class="tok-nt">&lt;finalName&gt;</span>MiAplicacionWeb<span class="tok-nt">&lt;/finalName&gt;</span>
        ...
    <span class="tok-nt">&lt;/build&gt;</span>
<span class="tok-nt">&lt;/project&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_depuración_y_cambios_en_caliente">Depuración y cambios en caliente</h5>
<div class="paragraph">
<p>El entorno IntelliJ nos permite realizar cambios en caliente dentro de nuestra aplicación web, es decir, conforme modificamos el código de la aplicación se aplicarán los cambios a la aplicación en ejecución sin necesidad de volver a desplegar. Para poder realizar cambios en caliente deberemos desplegar de la siguiente forma:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Seleccionaremos como artefacto a generar la aplicación web descomprimida (<em>war exploded</em>).</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Deberemos renombrar el artefacto de tipo <em>war exploded</em> de forma que acabe con <code>.war</code>, ya que de no ser así obtendremos un error en IntelliJ.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Desplegaremos la aplicación en modo <em>debug</em>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Con esto, cada vez que realicemos un cambio se aplicará a la aplicación ya desplegada en el servidor. Además, la ejecución en modo <em>debug</em> nos permitirá añadir puntos de parada y realizar la ejecución paso a paso inspeccionando el valor de cada variable.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_componentes_de_la_aplicación_java_ee">1.4. Componentes de la aplicación Java EE</h3>
<div class="sect3">
<h4 id="_el_descriptor_de_despliegue">1.4.1. El descriptor de despliegue</h4>
<div class="paragraph">
<p>Como hemos dicho anteriormente, el directorio <code>WEB-INF</code> de una aplicación web con servlets y/o páginas JSP, debe haber un fichero descriptor de despliegue (llamado <code>web.xml</code>) que contenga la información relativa a la aplicación. Este descriptor de despliegue es el mecanismo estándar para configurar aplicaciones web JavaEE.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A partir de la API de servlets 3.0 (Java EE 7) el descriptor de despliegue es opcional, pero es recomendable contar con él ya que será necesario para configurar determinados elementos.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>El <code>web.xml</code> es estándar en JavaEE y por tanto todo lo visto en esta sección es igualmente aplicable a cualquier servidor compatible JavaEE, aunque no sea WildFly.</p>
</div>
<div class="sect4">
<h5 id="_estructura_del_descriptor_de_despliegue">Estructura del descriptor de despliegue</h5>
<div class="paragraph">
<p>Es un fichero XML, que comienza con una cabecera XML que indica la versión y la codificación de caracteres, y un <code>DOCTYPE</code> que indica el tipo de documento, y la especificación de servlets que se sigue. La etiqueta raíz del documento XML es <code>web-app</code>. Así, un ejemplo de fichero podría ser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;web-app</span> <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee&quot;</span>
  <span class="tok-na">xmlns:web=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>
  <span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee</span>
<span class="tok-s">                      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>
  <span class="tok-na">id=</span><span class="tok-s">&quot;WebApp_ID&quot;</span> <span class="tok-na">version=</span><span class="tok-s">&quot;3.0&quot;</span><span class="tok-nt">&gt;</span>

	<span class="tok-nt">&lt;display-name&gt;</span>
		Mi Aplicacion Web
	<span class="tok-nt">&lt;/display-name&gt;</span>
	<span class="tok-nt">&lt;description&gt;</span>
		Esta es una aplicacion web sencilla a modo de ejemplo
	<span class="tok-nt">&lt;/description&gt;</span>
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este caso se está utilizando la especificación 3.0 de servlets. Algunos servidores permiten omitir la cabecera <code>xml</code> y el <code>DOCTYPE</code>, pero sí es una buena costumbre el ponerlas.</p>
</div>
<div class="paragraph">
<p>Dentro de la etiqueta raíz <code>&lt;web-app&gt;</code> podemos colocar otros elementos que ayuden a establecer la configuración de nuestra aplicación web. Veremos a continuación los elementos de configuración general de la aplicación. Conforme veamos cada característica de la API de servlets, repasaremos los elementos del descriptor del despliegue que hagan referencia a ella.</p>
</div>
</div>
<div class="sect4">
<h5 id="_información_general_de_la_aplicación">Información general de la aplicación</h5>
<div class="paragraph">
<p>Tenemos dos etiquetas que nos permiten especificar información sobre la aplicación que se mostrará cuando se presente en una interfaz gráfica, y nos servirán para identificarla:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;display-name&gt;</code></strong>: nombre con que deben utilizar las aplicaciones
gráficas para referenciar a la aplicación</p>
</li>
<li>
<p><strong><code>&lt;description&gt;</code></strong>: texto descriptivo de la aplicación</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_páginas_de_inicio">Páginas de inicio</h5>
<div class="paragraph">
<p>Podemos también indicar la página (o posibles páginas) que se devolverán por defecto si no se especifica ninguna concreta en la URL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>&lt;welcome-file-list&gt;</code></strong>: para indicar qué páginas debe buscar el servidor como páginas de inicio en el caso de que en la URL se indique el directorio, pero no la página, como por ejemplo:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/unadireccion/dir/" class="bare">http://localhost:8080/unadireccion/dir/</a></p>
</div>
<div class="paragraph">
<p>Para ello, esta etiqueta tiene una o varias subetiquetas <strong><code>&lt;welcome-file&gt;</code></strong> para indicar cada una de las posibles páginas</p>
</div>
<div class="paragraph">
<p>Por ejemplo, podemos indicar que las páginas por defecto sean <code>index.html</code> o <code>index.jsp</code> con:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;welcome-file-list&gt;</span>
	<span class="tok-nt">&lt;welcome-file&gt;</span>index.html<span class="tok-nt">&lt;/welcome-file&gt;</span>
	<span class="tok-nt">&lt;welcome-file&gt;</span>index.jsp<span class="tok-nt">&lt;/welcome-file&gt;</span>
<span class="tok-nt">&lt;/welcome-file-list&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Las páginas se buscan en el orden en que se especifican en esta etiqueta.</p>
</div>
</div>
<div class="sect4">
<h5 id="_creación_del_descriptor_de_despliegue_con_intellij">Creación del descriptor de despliegue con IntelliJ</h5>
<div class="paragraph">
<p>Al crear un proyecto Java EE 7 (o superior) con IntelliJ nos da la opción de crear o no el descriptor de despliegue. Esto es debido a que, como se ha comentado anteriormente, en esta versión de la plataforma es opcional contar con este fichero. Cuando el proyecto es creado con el arquetipo <code>webapp-javaee7</code> de Maven el descriptor de despliegue no se crea. A pesar de ser un fichero opcional, si no se ha creado de forma automática al crear el proyecto es recomendable crearlo posteriormente.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
En algunas versiones de IntelliJ no funciona correctamente la creación de servlets si no se cuenta con un descriptor de despliegue. Se trata de un <em>bug</em>, ya que no es necesario contar con un descriptor de despligue para crear servlets en Java EE 7.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para crear el descriptor de despliegue con IntelliJ en un proyecto que todavía no cuenta con él, podemos entrar en <em>File</em> &gt; Project Structure &#8230;&#8203;_ &gt; <em>Facets</em>, y seleccionar el <em>facet Web</em>. Dentro de esta pantalla pulsaremos el botón <code>+</code> para crear un nuevo descriptor de despliegue en la aplicación. Deberemos indicar el directorio donde crearlo, que al ser un proyecto de Maven deberá ser el siguiente:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/project-structure-2-add-deployment-descriptor.png" alt="Añadir el descriptor de despligue" width="66%">
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
En el proyecto Maven IntelliJ no detecta correctamente el directorio donde crear el fichero <code>web.xml</code>. Es importante que esté en <code>src/main/webapp/WEB-INF</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Una vez creado, veremos que la aplicación ya cuenta con un <em>Web Module Deployment Description</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/project-structure-3-facets-web.png" alt="Descriptor de despliegue en _facet_ web" width="100%">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_servlets">1.4.2. Servlets</h4>
<div class="paragraph">
<p>Un <strong>servlet</strong> es un programa Java que se ejecuta en un servidor Web y construye o sirve
páginas web. De esta forma se pueden construir páginas dinámicas, basadas en diferentes fuentes variables:
datos proporcionados por el usuario, fuentes de información variable (páginas de noticias, por ejemplo),
o programas que extraigan información de bases de datos.</p>
</div>
<div class="paragraph">
<p>Comparado con un CGI, un servlet es más sencillo de utilizar, más eficiente (se arranca un hilo por
cada petición y no un proceso entero), más potente y portable. Con los servlets podremos, entre otras
cosas, procesar, sincronizar y coordinar múltiples peticiones de clientes, reenviar peticiones a otros
servlets o a otros servidores, etc.</p>
</div>
<div class="sect4">
<h5 id="_recursos_de_servlets_y_jsp">Recursos de servlets y JSP</h5>
<div class="paragraph">
<p>Normalmente al hablar de servlets se habla de JSP y viceversa, puesto que ambos conceptos están
muy interrelacionados. Para trabajar con ellos se necesitan tener presentes algunos recursos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un <strong>servidor web</strong> que dé soporte a servlets / JSP (contenedor de servlets y páginas JSP). Ejemplos de estos servidores son Apache Tomcat, Resin, JRun, Java Web Server, BEA WebLogic, etc.</p>
</li>
<li>
<p>Las <strong>librerías</strong> (clases) necesarias para trabajar con servlets / JSP. Normalmente vienen en ficheros JAR en un directorio <code>lib</code> del servidor. Al desarrollar nuestra aplicación, deberemos tener las librerías necesarias en el <em>classpath</em> para que compilen los ficheros (sólo necesitaremos compilar los servlets, no los JSP).</p>
</li>
<li>
<p>La <strong>documentación</strong> sobre la API de servlets / JSP (no necesaria, pero sí recomendable)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Cuando trabajemos con un entorno como IntelliJ, al crear un proyecto de aplicación web se añadirán de forma automática referencias a las librerías de componentes web del servidor.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_arquitectura_del_paquete_servlet">Arquitectura del paquete servlet</h5>
<div class="paragraph">
<p>Dentro del paquete <strong><code>javax.servlet</code></strong> tenemos toda la infraestructura para poder trabajar con servlets. El elemento central es la interfaz <strong><code>Servlet</code></strong>, que define los métodos para cualquier servlet. La clase <strong><code>GenericServlet</code></strong> es una clase abstracta que implementa dicha interfaz para un servlet genérico, independiente del protocolo. Para definir un servlet que se utilice vía web, se tiene la clase <strong><code>HttpServlet</code></strong> dentro del subpaquete <strong><code>javax.servlet.http</code></strong>. Esta clase hereda de <code>GenericServlet</code>, y también es una clase abstracta, de la que heredaremos para construir los servlets para nuestras aplicaciones web.
Cuando un servlet acepta una petición de un cliente, se reciben dos objetos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un objeto de tipo <strong><code>ServletRequest</code></strong> que contiene los datos de la petición del usuario (toda la información entrante). Con esto se accede a los parámetros pasados por el cliente, el protocolo empleado, etc. Se puede obtener también un objeto <strong><code>ServletInputStream</code></strong> para obtener datos del cliente que realiza la petición. La subclase <strong><code>HttpServletRequest</code></strong> procesa peticiones de tipo HTTP.</p>
</li>
<li>
<p>Un objeto de tipo <strong><code>ServletResponse</code></strong> que contiene (o contendrá) la respuesta del servlet ante la petición (toda la información saliente). Se puede obtener un objeto <strong><code>ServletOutputStream</code></strong>, y un <code>Writer</code>, para poder escribir la respuesta. La clase <strong><code>HttpServletResponse</code></strong> se emplea para respuestas a peticiones HTTP.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ciclo_de_vida_de_un_servlet">Ciclo de vida de un servlet</h5>
<div class="paragraph">
<p>Todos los servlets tienen el mismo ciclo de vida:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un servidor <strong>carga e inicializa</strong> el servlet.</p>
</li>
<li>
<p>El servlet <strong>procesa</strong> cero o más peticiones de clientes. Por cada petición se lanza un hilo, ejecutándose estos hilos de forma concurrente en sobre un mismo objeto <em>servlet</em>.</p>
</li>
<li>
<p>El servidor <strong>destruye</strong> el servlet, normalmente en momentos en los que no tiene peticiones o cuando se apaga el servidor.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>1. Inicialización</strong></p>
</div>
<div class="paragraph">
<p>En cuanto a la inicialización de un servlet, se tiene una por defecto en el método <strong><code>init()</code></strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">init</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span>
<span class="tok-o">{</span>
  <span class="tok-o">...</span>
<span class="tok-o">}</span>

<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">init</span><span class="tok-o">(</span><span class="tok-n">ServletConfig</span> <span class="tok-n">conf</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span>
<span class="tok-o">{</span>
  <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">init</span><span class="tok-o">(</span><span class="tok-n">conf</span><span class="tok-o">);</span>
  <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El primer método se utiliza si el servlet no necesita parámetros de configuración externos. El segundo se emplea para tomar dichos parámetros del objeto <code>ServletConfig</code> que se le pasa. La llamada a <code>super.init(&#8230;&#8203;)</code> al principio del método es MUY importante, porque el servlet utiliza esta configuración en otras zonas.
Si queremos definir nuestra propia inicialización, deberemos sobreescribir alguno de estos métodos. Si ocurre algún error al inicializar y el servlet no es capaz de atender peticiones, debemos lanzar una excepción de tipo <code>UnavailableException</code>.
Podemos utilizar la inicialización para establecer una conexión con una base de datos (si trabajamos con base de datos), abrir ficheros, o cualquier tarea que se necesite hacer una sola vez antes de que el servlet comience a funcionar.</p>
</div>
<div class="paragraph">
<p><strong>2. Procesamiento de peticiones</strong></p>
</div>
<div class="paragraph">
<p>Una vez inicializado, cada petición de usuario lanza un hilo que llama al método <strong><code>service()</code></strong> del servlet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">service</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
        <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
<span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Este método obtiene el tipo de petición que se ha realizado (GET, POST, PUT, DELETE). Dependiendo del tipo de petición que se tenga, se llama luego a uno de los métodos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>doGet()</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
      <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
<span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Para peticiones de tipo GET (aquellas realizadas al escribir una dirección en un navegador, pinchar un enlace o rellenar un formulario que no tenga METHOD=POST)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>doPost()</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doPost</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
       <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
<span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Para peticiones POST (aquellas realizadas al rellenar un formulario que tenga METHOD=POST)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>doXXX()</code>: normalmente sólo se emplean los dos métodos anteriores, pero se tienen otros métodos para peticiones de tipo DELETE (<code>doDelete()</code>), PUT (<code>doPut()</code>), OPTIONS (<code>doOptions()</code>) y TRACE (<code>doTrace()</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>3. Destrucción</strong></p>
</div>
<div class="paragraph">
<p>El método <code>destroy()</code> de los servlets se emplea para eliminar un servlet y sus recursos asociados.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">destroy</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Aquí debe deshacerse cualquier elemento que se construyó en la inicialización (cerrar conexiones con bases de datos, cerrar ficheros, etc).
El servidor llama a <code>destroy()</code> cuando todas las llamadas de servicios del servlet han concluido, o cuando haya pasado un determinado número de segundos (lo que ocurra primero). Si esperamos que el servlet haga tareas que requieran mucho tiempo, tenemos que asegurarnos de que dichas tareas se completarán. Podemos hacer lo siguiente:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Definir un contador de tareas activas, que se incremente cada vez que una tarea comienza (entendemos por <em>tarea</em> cada petición que se realice al servlet), y se decremente cada vez que una termina. Podemos utilizar bloques de código <code>synchronized</code> para evitar problemas de concurrencia.</p>
</li>
<li>
<p>Hacer que el método <code>destroy()</code> no termine hasta que lo hagan todas las tareas pendientes (comprobando el contador de tareas pendientes)</p>
</li>
<li>
<p>Hacer que las tareas pendientes terminen su trabajo si se quiere cerrar el servlet (comprobando algún flag que indique si el servlet se va a cerrar o no).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_estructura_básica_de_un_servlet">Estructura básica de un servlet</h5>
<div class="paragraph">
<p>La plantilla común para implementar un servlet es:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.http.*</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClaseServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                    <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
               <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
    <span class="tok-c1">// ... codigo para una peticion GET</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doPost</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                     <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
               <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
    <span class="tok-c1">// ... codigo para una peticion POST</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El servlet hereda de la clase <code>HttpServlet</code>. Normalmente se deben sobreescribir los métodos <code>doGet()</code>, <code>doPost()</code> o ambos, colocando el código que queremos que se ejecute cuando se reciba una petición GET o POST, respectivamente. Conviene definir los dos para distinguir ambas peticiones. En caso de que queramos hacer lo mismo para GET o POST, definimos el código en uno de ellos, y hacemos que el otro lo llame.
Aparte de estos métodos, podemos utilizar otros de los que hemos visto: <code>init()</code> (para inicializaciones), <code>doXXX()</code> (para tratar otros tipos de peticiones (PUT, DELETE, etc)), <code>destroy()</code> (para finalizar el servlet), etc, así como nuestros propios métodos internos de la clase.</p>
</div>
</div>
<div class="sect4">
<h5 id="_configuración_de_servlets_en_aplicaciones_web">Configuración de servlets en aplicaciones web</h5>
<div class="paragraph">
<p>Para instalar un servlet en una aplicación web, se coloca la clase compilada del servlet dentro del directorio <code>WEB-INF/classes</code> de la aplicación (respetando también la estructura de paquetes, creando tantos subdirectorios como sea necesario).</p>
</div>
<div class="paragraph">
<p>De forma alternativa, también podríamos empaquetar nuestros servlets en un JAR y poner esta librería de clases dentro del directorio <code>WEB-INF/lib</code>. De cualquiera de las dos formas la clase del servlet estará localizable para la aplicación. Veremos ahora las formas que tenemos de invocar a ese servlet.</p>
</div>
<div class="sect5">
<h6 id="_mapeo_de_servlets_en_el_fichero_descriptor">Mapeo de servlets en el fichero descriptor</h6>
<div class="paragraph">
<p>Los servlets se invocarán cuando desde un cliente hagamos una
petición a una URL determinada. Para especificar la URL a la que
está asociada cada servlet, deberemos configurar dicho servlet
en el fichero descriptor de despliegue (<code>web.xml</code>).</p>
</div>
<div class="paragraph">
<p>En primer lugar deberemos introducir una marca <code>&lt;servlet&gt;</code> para declarar cada servlet de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;servlet-class&gt;</span>unpaquete.ClaseServlet<span class="tok-nt">&lt;/servlet-class&gt;</span>
<span class="tok-nt">&lt;/servlet&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Donde <code>&lt;servlet-name&gt;</code> es un nombre identificativo y arbitrario del servlet, y <code>&lt;servlet-class&gt;</code> es la clase del servlet.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Al declarar un servlet, debe indicarse el nombre
completo de la clase en la que está implementado, incluyendo paquetes
y subpaquetes. Esto es así porque en el <code>web.xml</code> no tenemos
ningún "import" que nos permita desambiguar entre posibles diferentes
clases con el mismo nombre.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Una vez declarado nuestro servlet, deberemos mapearlo a una URL.
Esto se consigue mediante las etiquetas <code>&lt;servlet-mapping&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet-mapping&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;url-pattern&gt;</span>/ejemploservlet<span class="tok-nt">&lt;/url-pattern&gt;</span>
<span class="tok-nt">&lt;/servlet-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En la subetiqueta <code>&lt;servlet-name&gt;</code>
se pone el nombre del servlet al que se quiere asignar la URL
(será uno de los nombres dados en alguna etiqueta
<code>&lt;servlet&gt;</code> previa), y en
<code>&lt;url-pattern&gt;</code> colocamos la URL
que le asignamos al servlet, que debe comenzar con '/'.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Destacamos que primero se colocan todas las etiquetas
<code>&lt;servlet&gt;</code>, y luego las <code>&lt;servlet-mapping&gt;</code>
que se requieran. En las actuales versiones de los servidores web el
orden es indiferente, pero si queremos garantizar la compatibilidad
con versiones anteriores, deberemos respetarlo.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Así, con lo anterior, podremos llamar al servlet identificado
con <code>nombre</code> accediendo a la URL a la que se encuentra
mapeado:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/%3Cdir%3E/ejemploservlet" class="bare">http://localhost:8080/&lt;dir&gt;/ejemploservlet</a></p>
</div>
<div class="paragraph">
<p>siendo <code>&lt;dir&gt;</code> el directorio en el que se encuentra el contexto de nuestra aplicación Web.</p>
</div>
<div class="paragraph">
<p>También podemos asignar en <code>&lt;url-pattern&gt;</code> expresiones como:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet-mapping&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;url-pattern&gt;</span>/ejemploservlet/*<span class="tok-nt">&lt;/url-pattern&gt;</span>
<span class="tok-nt">&lt;/servlet-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>o como:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet-mapping&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;url-pattern&gt;</span>/ejemploservlet/*.do<span class="tok-nt">&lt;/url-pattern&gt;</span>
<span class="tok-nt">&lt;/servlet-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Con el primero, cualquier URL del directorio de nuestra
aplicación Web que comience con <code>/ejemploservlet/</code>
se redirigirá y llamará al servlet identificado con
<code>nombre</code>. Por ejemplo, las direcciones:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/%3Cdir%3E/ejemploservlet/unapagina.html" class="bare">http://localhost:8080/&lt;dir&gt;/ejemploservlet/unapagina.html</a></p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/%3Cdir%3E/ejemploservlet/login.do" class="bare">http://localhost:8080/&lt;dir&gt;/ejemploservlet/login.do</a></p>
</div>
<div class="paragraph">
<p>acabarían llamando al servlet <code>nombre</code>.</p>
</div>
<div class="paragraph">
<p>Con el segundo, cualquier llamada a un recurso acabado en
<code>.do</code> del directorio <code>/ejemploservlet/</code>
de nuestra aplicación se redirigiría al servlet
<code>nombre</code>. Podemos hacer que distintas URLs llamen
a un mismo servlet, sin más que añadir varios grupos
<code>&lt;servlet-mapping&gt;</code>, uno por cada patrón de
URL diferente, y todos con el mismo <code>&lt;servlet-name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Este mismo procedimiento se puede aplicar también si
en lugar de un servlet queremos tratar una página JSP. Para
declarar una página <strong>JSP</strong>, sustituiremos la
etiqueta <code>&lt;servlet-class&gt;</code> por la etiqueta
<strong><code>&lt;jsp-file&gt;</code></strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre2<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;jsp-file&gt;</span>/mipagina.jsp<span class="tok-nt">&lt;/jsp-file&gt;</span>
<span class="tok-nt">&lt;/servlet&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta página se podrá mapear a diferentes URLs de la misma
forma en la que lo hacemos para un servlet.</p>
</div>
</div>
<div class="sect5">
<h6 id="_mapeo_de_servlets_mediante_anotaciones">Mapeo de servlets mediante anotaciones</h6>
<div class="paragraph">
<p>En la API de Servlets 3.0 se incluyen una serie de importantes novedades dirigidas
principalmente a facilitar el desarrollo de los componentes web. Esto se consigue mediante el uso
de anotaciones para configurar los servlets, en lugar de tener que declararlos
en el fichero <code>web.xml</code>. Esto supone un cambio importante en la forma
de trabajar con servlets. Ahora bastará con anotar la clase en la que implementamos
el servlet de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;miServlet&quot;</span><span class="tok-o">,</span> <span class="tok-n">urlPatterns</span><span class="tok-o">=</span><span class="tok-s">&quot;/UrlServlet&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClaseServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                      <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-o">...</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doPost</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                       <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-o">...</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En la anotación <code>@WebServlet</code> se debe especificar obligatoriamente el
atributo <code>urlPatterns</code>, con el que se especifica la URL a la que queremos
mapear el servlet. Si no necesitamos más parámetros que la URL, podemos especificarla como valor
por defecto de la anotación:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-s">&quot;/UrlServlet&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Con esto ya no se necesitará declarar el servlet en el fichero <code>web.xml</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_asignar_parámetros_de_inicio_a_un_servlet_o_página_jsp">Asignar parámetros de inicio a un servlet o página JSP</h6>
<div class="paragraph">
<p>El hecho de asignar un nombre a un servlet o página JSP mediante la etiqueta <code>&lt;servlet&gt;</code> y sus subetiquetas nos permite identificarlo con ese nombre, y también poderle asignar parámetros de inicio. Para asignar parámetros se colocan etiquetas <strong><code>&lt;init-param&gt;</code></strong> dentro de la etiqueta <code>&lt;servlet&gt;</code> del servlet o página JSP al que le queremos asignar parámetros. Dichas etiquetas tienen como subetiquetas un <strong><code>&lt;param-name&gt;</code></strong> (con el nombre del parámetro) y un <strong><code>&lt;param-value&gt;</code></strong> (con el valor del parámetro). Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;servlet-class&gt;</span>ClaseServlet<span class="tok-nt">&lt;/servlet-class&gt;</span>
  <span class="tok-nt">&lt;init-param&gt;</span>
    <span class="tok-nt">&lt;param-name&gt;</span>param1<span class="tok-nt">&lt;/param-name&gt;</span>
    <span class="tok-nt">&lt;param-value&gt;</span>valor1<span class="tok-nt">&lt;/param-value&gt;</span>
  <span class="tok-nt">&lt;/init-param&gt;</span>
  <span class="tok-nt">&lt;init-param&gt;</span>
    <span class="tok-nt">&lt;param-name&gt;</span>param2<span class="tok-nt">&lt;/param-name&gt;</span>
    <span class="tok-nt">&lt;param-value&gt;</span>valor2<span class="tok-nt">&lt;/param-value&gt;</span>
  <span class="tok-nt">&lt;/init-param&gt;</span>
<span class="tok-nt">&lt;/servlet&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si estamos utilizando Servlet 3.0, podemos también utilizar la anotación <code>@WebServlet</code> para configurar los
parámetros de inicio:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-n">urlPatterns</span><span class="tok-o">=</span><span class="tok-s">&quot;/UrlServlet&quot;</span><span class="tok-o">,</span>
         <span class="tok-n">initParams</span> <span class="tok-o">={</span>
             <span class="tok-nd">@InitParam</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;param1&quot;</span><span class="tok-o">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;valor1&quot;</span><span class="tok-o">),</span>
             <span class="tok-nd">@InitParam</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;param2&quot;</span><span class="tok-o">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;valor2&quot;</span><span class="tok-o">)</span> <span class="tok-o">})</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Estos parámetros también pueden ser declarados por separado con la anotación
<code>@WebInitParam</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebInitParam</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;param1&quot;</span><span class="tok-o">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;valor1&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Para obtener luego los parámetros desde el servlet se utiliza <strong><code>getServletConfig().getInitParameter(nombre)</code></strong> donde <code>nombre</code> es el valor <code>&lt;param-name&gt;</code> del parámetro que se busca, y devuelve el valor (elemento <code>&lt;param-value&gt;</code> asociado), que es de tipo <code>String</code> siempre. Para obtener estos valores desde páginas JSP se emplean otros métodos.
Los parámetros de inicio sólo se aplican cuando accedemos al servlet o página JSP a través del nombre asignado en <code>&lt;servlet-name&gt;</code>, o a través de la URL asociada en un <code>&lt;servlet-mapping&gt;</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_cargar_servlets_al_inicio">Cargar servlets al inicio</h6>
<div class="paragraph">
<p>A veces nos puede interesar que un servlet se cargue al arrancar el servidor, y no con la primera petición de un cliente. Para hacer eso, incluimos una etiqueta <strong><code>&lt;load-on-startup&gt;</code></strong> dentro de la etiqueta <code>&lt;servlet&gt;</code>. Dicha etiqueta puede estar vacía:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;servlet-class&gt;</span>ClaseServlet<span class="tok-nt">&lt;/servlet-class&gt;</span>
  <span class="tok-nt">&lt;load-on-startup/&gt;</span>
<span class="tok-nt">&lt;/servlet&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>o contener un número:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;servlet&gt;</span>
  <span class="tok-nt">&lt;servlet-name&gt;</span>nombre<span class="tok-nt">&lt;/servlet-name&gt;</span>
  <span class="tok-nt">&lt;servlet-class&gt;</span>ClaseServlet<span class="tok-nt">&lt;/servlet-class&gt;</span>
  <span class="tok-nt">&lt;load-on-startup&gt;</span>2<span class="tok-nt">&lt;/load-on-startup&gt;</span>
<span class="tok-nt">&lt;/servlet&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>que indica el orden en que el servidor irá cargando los servlets (de menor a mayor valor).</p>
</div>
<div class="paragraph">
<p>Como en los casos anteriores, esto también puede ser indicado mediante la anotación <code>@WebServlet</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;miServlet&quot;</span><span class="tok-o">,</span> <span class="tok-n">urlPatterns</span><span class="tok-o">=</span><span class="tok-s">&quot;/UrlServlet&quot;</span><span class="tok-o">,</span> <span class="tok-n">loadOnStartup</span><span class="tok-o">=</span><span class="tok-s">&quot;2&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_logging_en_aplicaciones_java_ee_con_servlets">Logging en aplicaciones Java EE con servlets</h5>
<div class="paragraph">
<p>Utilizaremos Log4J como librería de <em>logging</em>, pero encapsulada dentro de la librería <em>commons-logging</em> de Jakarta. Para poder imprimir mensajes de log en una aplicación que contenga servlets se deben seguir estos pasos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Añadir los ficheros JAR de las librerías (<code>commons-logging-X.X.jar</code> y <code>log4j-X.X.X.jar</code>) en la carpeta <code>WEB-INF/lib</code> de nuestra aplicación (o añadirlas como dependencias de Maven).</p>
</li>
<li>
<p>Colocar dos ficheros <code>.properties</code> en el CLASSPATH de la aplicación (carpeta <code>WEB-INF/classes</code>):</p>
<div class="ulist">
<ul>
<li>
<p>Un fichero <code>commons-logging.properties</code> indicando que vamos a utilizar Log4J como librería subyacente.</p>
</li>
<li>
<p>Un fichero <code>log4j.properties</code> con la configuración de logging para Log4J.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Estos ficheros los colocaremos en una carpeta fuente llamada <code>resources</code>, para que al compilarse la aplicación se vuelquen a <code>/WEB-INF/classes</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Finalmente, sólo queda en cada servlet o clase Java colocar los mensajes de log donde queramos. Veremos cómo hacerlo en servlets y páginas JSP en el siguiente módulo. Aquí vemos un ejemplo de cómo ponerlos en cada servlet:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-o">...</span>

<span class="tok-kn">import</span> <span class="tok-nn">org.apache.commons.logging.*</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ServletLog4J1</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span>

  <span class="tok-kd">static</span> <span class="tok-n">Log</span> <span class="tok-n">logger</span> <span class="tok-o">=</span> <span class="tok-n">LogFactory</span><span class="tok-o">.</span><span class="tok-na">getLog</span><span class="tok-o">(</span><span class="tok-n">ServletLog4J1</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>

  <span class="tok-c1">// Metodo para procesar una peticion GET</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                    <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
                        <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
    <span class="tok-n">logger</span><span class="tok-o">.</span><span class="tok-na">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Atendiendo peticion Servlet Log4J&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">PrintWriter</span> <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">getWriter</span><span class="tok-o">();</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;Servlet sencillo de prueba para logging&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">logger</span><span class="tok-o">.</span><span class="tok-na">debug</span><span class="tok-o">(</span><span class="tok-s">&quot;Fin de procesamiento de petición&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ejemplos_básicos_de_servlets">Ejemplos básicos de servlets</h5>
<div class="sect5">
<h6 id="_servlet_que_genera_texto_plano">Servlet que genera texto plano</h6>
<div class="paragraph">
<p>El siguiente ejemplo de servlet muestra una página con un mensaje de saludo: "Este es un servlet de prueba". Lo cargamos mediante petición GET.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">ejemplos</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">java.io.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.http.*</span><span class="tok-o">;</span>

<span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;ejemplo1_1&quot;</span><span class="tok-o">,</span> <span class="tok-n">urlPatterns</span><span class="tok-o">=</span><span class="tok-s">&quot;/ejemploservlet&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClaseServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                    <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
                 <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
    <span class="tok-n">PrintWriter</span> <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">getWriter</span><span class="tok-o">();</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;Este es un servlet de prueba&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Se obtiene un <code>Writer</code> para poder enviar datos al usuario. Simplemente se le envía la cadena que se mostrará en la página generada.</p>
</div>
</div>
<div class="sect5">
<h6 id="_servlet_que_genera_una_página_html">Servlet que genera una página HTML</h6>
<div class="paragraph">
<p>Este otro ejemplo escribe código HTML para mostrar una página web.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">ejemplos</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">java.io.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.http.*</span><span class="tok-o">;</span>

<span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;ejemplo1_2&quot;</span><span class="tok-o">,</span> <span class="tok-n">urlPatterns</span><span class="tok-o">=</span><span class="tok-s">&quot;/ejemploservletHTML&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClaseServletHTML</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                    <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
                 <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
    <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">setContentType</span><span class="tok-o">(</span><span class="tok-s">&quot;text/html&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">PrintWriter</span> <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">getWriter</span><span class="tok-o">();</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;&quot;</span><span class="tok-o">+</span>
                 <span class="tok-s">&quot;-//W3C//DTD HTML 4.0 &quot;</span> <span class="tok-o">+</span>
                 <span class="tok-s">&quot;Transitional//EN\&quot;&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;HTML&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;BODY&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;h1&gt;Titulo&lt;/h1&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;br&gt;Servlet que genera HTML&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;/BODY&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;/HTML&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Para generar una página HTML con un servlet debemos seguir dos pasos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Indicar que el contenido que se va a enviar es HTML (mediante el método <code>setContentType()</code> de <code>HttpServletResponse</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">setContentType</span><span class="tok-o">(</span><span class="tok-s">&quot;text/html&quot;</span><span class="tok-o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta línea es una cabecera de respuesta, que veremos más adelante cómo utilizar. Hay que ponerla antes de obtener el <code>Writer</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Escribir en el flujo de salida el texto necesario para generar la página HTML. La línea que genera el DOCTYPE no es necesaria, aunque sí muy recomendada para que se sepa qué versión de HTML se está empleando.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_servlet_que_utiliza_parámetros_de_inicialización">Servlet que utiliza parámetros de inicialización</h6>
<div class="paragraph">
<p>Este otro ejemplo utiliza dos parámetros de inicialización externos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">ejemplos</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">java.io.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.*</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.servlet.http.*</span><span class="tok-o">;</span>

<span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;ejemplo1_3&quot;</span><span class="tok-o">,</span> <span class="tok-n">urlPatterns</span><span class="tok-o">=</span><span class="tok-s">&quot;/ejemploservletInit&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClaseServletInit</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span>

  <span class="tok-c1">// Mensaje que se va a mostrar en la pagina</span>
  <span class="tok-n">String</span> <span class="tok-n">mensaje</span> <span class="tok-o">=</span> <span class="tok-s">&quot;&quot;</span><span class="tok-o">;</span>
  <span class="tok-c1">// Numero de veces que se va a repetir el mensaje</span>
  <span class="tok-kt">int</span> <span class="tok-n">contador</span> <span class="tok-o">=</span> <span class="tok-mi">1</span><span class="tok-o">;</span>

  <span class="tok-c1">// Metodo de inicializacion</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">init</span><span class="tok-o">(</span><span class="tok-n">ServletConfig</span> <span class="tok-n">conf</span><span class="tok-o">)</span>
                           <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span> <span class="tok-o">{</span>
    <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">init</span><span class="tok-o">(</span><span class="tok-n">conf</span><span class="tok-o">);</span>	<span class="tok-c1">// MUY IMPORTANTE</span>

    <span class="tok-n">mensaje</span> <span class="tok-o">=</span> <span class="tok-n">conf</span><span class="tok-o">.</span><span class="tok-na">getInitParameter</span><span class="tok-o">(</span><span class="tok-s">&quot;mensaje&quot;</span><span class="tok-o">);</span>
    <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">mensaje</span> <span class="tok-o">==</span> <span class="tok-kc">null</span><span class="tok-o">)</span>
      <span class="tok-n">mensaje</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Hola&quot;</span><span class="tok-o">;</span>

    <span class="tok-k">try</span>
    <span class="tok-o">{</span>
      <span class="tok-n">contador</span> <span class="tok-o">=</span> <span class="tok-n">Integer</span><span class="tok-o">.</span><span class="tok-na">parseInt</span><span class="tok-o">(</span>
         <span class="tok-n">conf</span><span class="tok-o">.</span><span class="tok-na">getInitParameter</span><span class="tok-o">(</span><span class="tok-s">&quot;contador&quot;</span><span class="tok-o">));</span>
    <span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">NumberFormatException</span> <span class="tok-n">e</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">contador</span> <span class="tok-o">=</span> <span class="tok-mi">1</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>

  <span class="tok-c1">// Metodo para procesar una peticion GET</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                    <span class="tok-n">HttpServletResponse</span> <span class="tok-n">response</span><span class="tok-o">)</span>
               <span class="tok-kd">throws</span> <span class="tok-n">ServletException</span><span class="tok-o">,</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
    <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">setContentType</span><span class="tok-o">(</span><span class="tok-s">&quot;text/html&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">PrintWriter</span> <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">getWriter</span><span class="tok-o">();</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;&quot;</span><span class="tok-o">+</span>
                 <span class="tok-s">&quot;-//W3C//DTD HTML 4.0 &quot;</span> <span class="tok-o">+</span>
                 <span class="tok-s">&quot;Transitional//EN\&quot;&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;HTML&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;BODY&gt;&quot;</span><span class="tok-o">);</span>

    <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">contador</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">++)</span>
    <span class="tok-o">{</span>
      <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-n">mensaje</span><span class="tok-o">);</span>
      <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;BR&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;/BODY&gt;&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;&lt;/HTML&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Se utiliza el método <code>init()</code> con un parámetro <code>ServletConfig</code> para poder tomar los parámetros externos. Es importante la llamada a <code>super</code> al principio del método.</p>
</li>
<li>
<p>Mediante el método <code>getInitParameter()</code> de <code>ServletConfig</code> obtenemos dos parámetros: <code>mensaje</code> y <code>contador</code>, que asignamos a las variables del mismo nombre. El primero indica el mensaje que se va a mostrar en la página, y el segundo el número de veces que se va a mostrar.</p>
</li>
<li>
<p>En <code>doGet()</code> hacemos uso de esos parámetros obtenidos, para mostrar el mensaje las veces indicadas.</p>
</li>
<li>
<p>Necesitaremos definir en el fichero <code>web.xml</code> los parámetros de inicio que el servlet va a leer.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jsp">1.4.3. JSP</h4>
<div class="paragraph">
<p>JSP (<strong>JavaServer Pages</strong>) es una tecnología que permite
incluir código Java en páginas web. El denominado <em>contenedor
JSP</em> (que sería un componente del servidor web) es el
encargado de tomar la página, sustituir el código Java
que contiene por el resultado de su ejecución, y enviarla al
cliente. Así, se pueden dise&ntilde;ar fácilmente
páginas con partes fijas y partes variables. El siguiente es un
ejemplo muy sencillo de página JSP:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="jsp"><span class="tok-cp">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;</span>
<span class="tok-nt">&lt;html&gt;</span>
<span class="tok-nt">&lt;head&gt;</span>
<span class="tok-nt">&lt;title&gt;</span>Mi primera página JSP
<span class="tok-nt">&lt;/head&gt;</span>
<span class="tok-nt">&lt;body&gt;</span>
<span class="tok-nt">&lt;h1&gt;</span> Hoy es:
<span class="tok-k">&lt;%=</span> <span class="tok-k">new</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">util</span><span class="tok-o">.</span><span class="tok-na">Date</span><span class="tok-o">()</span> <span class="tok-k">%&gt;</span>
<span class="tok-nt">&lt;/h1&gt;</span>
<span class="tok-nt">&lt;/body&gt;</span>
<span class="tok-nt">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Para ejecutar la página basta con colocarla en una
aplicación web (por ejemplo, en WildFly, dentro de <code>webapps/ROOT</code>).
No es necesario que sea en un directorio específico como ocurre
con los servlets, sino que puede ir en cualquier directorio en el que
se colocaría normalmente un HTML.</p>
</div>
<div class="paragraph">
<p>Aunque JSP y servlets parecen a primera vista tecnologías
distintas, en realidad el servidor web traduce internamente el JSP a un
servlet, lo compila y finalmente lo ejecuta cada vez que el cliente
solicita la página JSP. Por ello, en principio, JSPs y servlets
ofrecen la misma funcionalidad, aunque sus características los
hacen apropiados para distinto tipo de tareas. Los JSP son mejores para
generar páginas con gran parte de contenido estático. Un
servlet que realice la misma función debe incluir gran cantidad
de sentencias del tipo <code>out.println()</code> para producir el
HTML. Por el contrario, los servlets son mejores en tareas que generen
poca salida, datos binarios o páginas con gran parte de
contenido variable. En proyectos más complejos, lo recomendable
es combinar ambas tecnologías: los servlets para el
procesamiento de información y los JSP para presentar los datos
al cliente.</p>
</div>
<div class="sect4">
<h5 id="_traducción_de_los_jsp_a_servlets">Traducción de los JSP a servlets</h5>
<div class="paragraph">
<p>Como se ha comentado, la primera vez que se solicita una
página JSP, el servidor genera el servlet equivalente, lo
compila y lo ejecuta. Para las siguientes solicitudes, solo es
necesario ejecutar el código compilado. El servlet generado de
manera automática tiene un método <code>_jspService</code>
que es el equivalente al <code>service</code> de los servlets
"generados manualmente". En este método es donde se genera el
código HTML, mediante instrucciones <code>println</code> y
donde se ejecuta el código Java insertado en la página.
Por ejemplo, la página <code>primera.jsp</code> podría generar
un servlet con estructura similar al siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">_jspService</span><span class="tok-o">(</span><span class="tok-n">HttpServletRequest</span> <span class="tok-n">request</span><span class="tok-o">,</span>
                        <span class="tok-n">HttpServletResponse</span>  <span class="tok-n">response</span><span class="tok-o">)</span>
                        <span class="tok-kd">throws</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">io</span><span class="tok-o">.</span><span class="tok-na">IOException</span><span class="tok-o">,</span> <span class="tok-n">ServletException</span> <span class="tok-o">{</span>
  <span class="tok-n">JspWriter</span> <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-kc">null</span><span class="tok-o">;</span>
  <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">setContentType</span><span class="tok-o">(</span><span class="tok-s">&quot;text/html;ISO-8859-1&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD HTML 4.0</span>
<span class="tok-s">                Transitional//EN\&quot;&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;html&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;head&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;title&gt;Mi primera pagina JSP&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;/head&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;body&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">print</span><span class="tok-o">(</span><span class="tok-s">&quot;Hoy es &quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">util</span><span class="tok-o">.</span><span class="tok-na">Date</span><span class="tok-o">());</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;/body&gt;&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;&lt;/html&gt;&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El directorio donde se coloca el servlet generado, así como su
nombre, dependen del servidor de aplicaciones.</p>
</div>
</div>
<div class="sect4">
<h5 id="_inserción_de_código_en_páginas_jsp">Inserción de código en páginas JSP</h5>
<div class="paragraph">
<p>Hay tres formas de insertar código Java en una página
JSP:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Expresiones</strong> de la forma <code>&lt;%= expresión %&gt;</code>: en este caso, la expresión se evalúa, su
resultado se convierte a <code>String</code> y se inserta en la
salida.</p>
</li>
<li>
<p><strong>Scriptlets</strong> de la forma <code>&lt;% código %&gt;</code> : el código se ejecuta dentro del método <code>_jspService</code>
del servlet generado.</p>
</li>
<li>
<p><strong>Declaraciones</strong> de la forma <code>&lt;%! código %&gt;</code>: se insertan en el cuerpo del servlet generado, fuera de
sus métodos.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_expresiones">Expresiones</h6>
<div class="paragraph">
<p>Como se ha visto, se evalúan, su resultado se convierte a un <code>String</code>
y se escriben en la salida (el objeto predefinido <code>out</code>).
La forma de traducir una expresión a código de servlet es
imprimiéndola en <code>out</code> (mediante una sentencia <code>out.write(<em>expresion</em>)</code>)
o similar.</p>
</div>
</div>
<div class="sect5">
<h6 id="__em_scriptlets_em"><em>Scriptlets</em></h6>
<div class="paragraph">
<p>Permiten ejecutar código arbitrario, cuyo resultado no es
necesario enviar a la salida. Si desde un <em>scriptlet</em> se desea
escribir algo en ésta, bastará con utilizar el objeto
predefinido <code>out</code>. Un uso común de los <em>scriptlets</em>
es hacer que ciertas partes de código HTML aparezcan o no en
función de una condición. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="jsp"><span class="tok-k">&lt;%</span>
  <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">util</span><span class="tok-o">.</span><span class="tok-na">Calendar</span> <span class="tok-n">ahora</span> <span class="tok-o">=</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">util</span><span class="tok-o">.</span><span class="tok-na">Calendar</span><span class="tok-o">.</span><span class="tok-na">getInstance</span><span class="tok-o">();</span>
  <span class="tok-kt">int</span> <span class="tok-n">hora</span> <span class="tok-o">=</span> <span class="tok-n">ahora</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">util</span><span class="tok-o">.</span><span class="tok-na">Calendar</span><span class="tok-o">.</span><span class="tok-na">HOUR_OF_DAY</span><span class="tok-o">);</span>
<span class="tok-k">%&gt;</span>
<span class="tok-nt">&lt;b&gt;</span> Hola mundo, <span class="tok-nt">&lt;i&gt;</span>
<span class="tok-k">&lt;%</span> <span class="tok-k">if</span> <span class="tok-o">((</span><span class="tok-n">hora</span><span class="tok-o">&gt;</span><span class="tok-mi">20</span><span class="tok-o">)||(</span><span class="tok-n">hora</span><span class="tok-o">&lt;</span><span class="tok-mi">6</span><span class="tok-o">))</span> <span class="tok-o">{</span> <span class="tok-k">%&gt;</span>
     buenas noches
<span class="tok-k">&lt;%</span> <span class="tok-o">}</span>
   <span class="tok-k">else</span> <span class="tok-nf">if</span> <span class="tok-o">((</span><span class="tok-n">hora</span><span class="tok-o">&gt;=</span><span class="tok-mi">6</span><span class="tok-o">)&amp;&amp;(</span><span class="tok-n">hora</span><span class="tok-o">&lt;=</span><span class="tok-mi">12</span><span class="tok-o">))</span> <span class="tok-o">{</span> <span class="tok-k">%&gt;</span>
          buenos días
<span class="tok-k">&lt;%</span>      <span class="tok-o">}</span>
	<span class="tok-k">else</span> <span class="tok-o">{</span> <span class="tok-k">%&gt;</span>
          buenas tardes
<span class="tok-k">&lt;%</span>      <span class="tok-o">}</span> <span class="tok-k">%&gt;</span>
<span class="tok-nt">&lt;/i&gt;</span> <span class="tok-nt">&lt;/b&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_declaraciones">Declaraciones</h6>
<div class="paragraph">
<p>Permiten definir variables o métodos que se insertarán
dentro del cuerpo del servlet generado. Esto da la posibilidad de
sobreescribir los métodos <code>jspInit</code> y <code>jspDestroy</code>
que son el equivalente en JSP del <code>init</code> y <code>destroy</code>
de los servlets. Las variables declaradas conservarán su valor
entre sucesivas llamadas a la página, ya que son variables
miembro del servlet y no locales al método <code>jspService</code>.
Esto nos permite, por ejemplo, crear un contador de accesos a la
página:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="jsp"><span class="tok-k">&lt;%!</span> <span class="tok-kd">private</span> <span class="tok-kt">int</span> <span class="tok-n">accesos</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-k">%&gt;</span>
<span class="tok-nt">&lt;h1&gt;</span> Visitas: <span class="tok-k">&lt;%=</span> <span class="tok-o">++</span><span class="tok-n">accesos</span> <span class="tok-k">%&gt;</span> <span class="tok-nt">&lt;/h1&gt;</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ejercicios">1.5. Ejercicios</h3>
<div class="paragraph">
<p>Antes de empezar a crear los proyectos, debes descargarte el repositorio git <code>java_ua/ejercicios-cweb</code>
en el que vas a crear los proyectos del módulo. El repositorio remoto contiene las plantillas que vamos a usar a lo largo del módulo.</p>
</div>
<div class="paragraph">
<p>En primer lugar deberemos acceder a dicho repositorio en <em>bitbucket</em> y realizar un <em>Fork</em> en nuestra cuenta personal.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/bitbucket-fork.png" alt="Realizar un Fork en bitbucket" width="33%">
</div>
</div>
<div class="paragraph">
<p>De esta forma tendremos una copia propia con permisos de escritura. Una vez contamos con nuestra copia podremos realizar un <em>Clone</em> en nuestra máquina. En primer lugar consultamos en <em>bitbucket</em> el comando necesario para hacer el <em>Clone</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Images/bitbucket-clone.png" alt="Dirección para clonar el repositorio de bitbucket" width="33%">
</div>
</div>
<div class="paragraph">
<p>Podemos copiar el comando y pegarlo en un terminal para clonar el repositorio en nuestra máquina:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>git clone https://bitbucket.org/&lt;alumno&gt;/ejercicios-cweb</code></pre>
</div>
</div>
<div class="paragraph">
<p>De esta forma se crea en nuestro ordenador el directorio <code>ejercicios-cweb</code> y se descarga en él una plantilla inicial de los proyectos del módulo y un fichero <code>.gitignore</code>. A partir de este momento se puede trabajar con dichos proyectos y realizar <em>Commit</em> y <em>Push</em> cuando sea oportuno:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span><span class="tok-nb">cd </span>ejercicios-cweb
<span class="tok-nv">$ </span>git add .
<span class="tok-nv">$ </span>git commit -a -m <span class="tok-s2">&quot;Mensaje de commit&quot;</span>
<span class="tok-nv">$ </span>git push origin master</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_aplicación_web_en_wildfly_0_5_puntos">1.5.1. Aplicación web en WildFly (0.5 puntos)</h4>
<div class="paragraph">
<p>Vamos a probar el servidor de aplicaciones WildFly y a subir recursos estáticos a él para comprobar que funciona.</p>
</div>
<div class="paragraph">
<p><em>a)</em> Comenzaremos poniendo en marcha el servidor entrando en el directorio <code>$WILDFLY_HOME/bin</code> y ejecutando el comando:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>./standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Comprobar que WildFly ha arrancado accediendo a <code><a href="http://localhost:8080/" class="bare">http://localhost:8080/</a></code> desde cualquier navegador. Debería aparecer la página principal del servidor.</p>
</div>
<div class="paragraph">
<p><em>b)</em> Vamos a crear nuestra propia aplicación web y desplegarla en WildFly. En el directorio <code>cweb-comentarios</code> de las plantillas de la sesión hay una sencilla aplicación web que permite mantener una página y que los visitantes puedan añadir comentarios. Vamos a empaquetar y desplegar la aplicación en un fichero <em>war</em> y desplegarla.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Empaquetamiento en .war</strong>. Observad la estructura de directorios que cuelga del directorio
<code>comentarios</code>. Podemos empaquetar la aplicación mediante la herramienta <code>jar</code> incluída
en el JDK, como se especifica en los apuntes:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">jar cMvf cweb-comentarios.war *</code></pre>
</div>
</div>
<div class="paragraph">
<p>La operación anterior hay que hacerla <strong>desde dentro del directorio <code>cweb-comentarios</code></strong>, es decir, el <code>.war</code> creado no debe contener la carpeta "cweb-comentarios" propiamente dicha, sino lo que contiene ésta.</p>
</div>
</li>
<li>
<p><strong>Despliegue manual en WildFly</strong>. Para desplegar el .war manualmente basta con dejarlo en la carpeta <code>$WILDFLY_HOME/standalone/deployments</code>. Observad que transcurridos unos segundos el <code>.war</code> se desplegará de forma automática. Para probar la aplicación abre un navegador y accede a la URL:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>http://localhost:8080/cweb-comentarios/comentarios.jsp</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_hola_mundo_con_intellij_0_5_puntos">1.5.2. Hola mundo con IntelliJ (0.5 puntos)</h4>
<div class="paragraph">
<p>Vamos a crear y desplegar una aplicación <em>Hola mundo</em> mediante IntelliJ.</p>
</div>
<div class="paragraph">
<p><em>a)</em> Configuramos el servidor WildFly en IntelliJ.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Crear una instancia del servidor WildFly:</strong> Con la opción <em>File &gt; Settings … &gt; Application Servers</em> crearemos una nueva instancia de WildFly dentro de IntelliJ. En el cuadro deplegable para añadir un servidor simplemente tenemos que asegurarnos de elegir <em>JBoss 8.1.0 Final &gt; Local</em>, e indicar la ruta donde está instalado (<code>/usr/local/wildfly</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>b)</em> <strong>Crearemos un proyecto Maven</strong> de tipo <em>webapp-javaee7</em> desde IntelliJ.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creamos el proyecto con el arquetipo <code>webapp-javaee7</code> (deberemos añadir el arquetipo a la lista si es la primera vez que lo utilizamos).</p>
</li>
<li>
<p>Como <em>GroupId</em> utilizaremos <code>org.expertojava.cweb</code>.</p>
</li>
<li>
<p>Como <em>ArtifactId</em> introduciremos: <code>cweb-hola</code>. Utilizaremos este mismo nombre posteriormente como nombre del proyecto IntelliJ.</p>
</li>
<li>
<p>Dejamos la versión como <code>1.0-SNAPSHOT</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>c)</em> <strong>Desplegamos el proyecto</strong> que acabamos de crear en WildFly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Introducimos el elemento <code>finalName</code> en el fichero <code>pom.xml</code> para que la aplicación se despliegue en un contexto <code>cweb-hola</code>.</p>
</li>
<li>
<p>Creamos un perfil de ejecución que utilice el servidor configurado en el primer paso (<em>Run &gt; Edit Configurations &#8230;&#8203;</em>).</p>
</li>
<li>
<p>Añadimos al perfil de ejecución el artefacto de tipo <code>war</code> que tenemos creado por defecto (pestaña <em>Deployments</em>).</p>
</li>
<li>
<p>Lanzamos el despliegue. Veremos la página de prueba que ha creado como plantilla.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>d)</em> <strong>Añadimos</strong> desde IntelliJ un fichero <code>web.xml</code> al proyecto.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entramos en <em>File &gt; Project Structure &#8230;&#8203; &gt; Facets</em>.</p>
</li>
<li>
<p>Seleccionamos el <em>facet</em> <em>Web</em> y añadimos un descriptor de despliegue.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>e)</em> <strong>Crear un nuevo servlet</strong> dentro del proyecto, en un
  paquete <code>org.expertojava.cweb.hola</code>, con nombre
  <code>HolaMundoServlet</code>. Mapearemos el servlet a la dirección
  <code>/HolaMundoServlet</code> utilizando anotaciones.</p>
</div>
<div class="paragraph">
<p><em>f)</em> <strong>Introducir</strong> en el método <code>doGet</code> del servlet
  el código para que muestre como salida el texto <code>"Hola Mundo"</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-n">PrintWriter</span> <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">getWriter</span><span class="tok-o">();</span>
<span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span> <span class="tok-o">(</span><span class="tok-s">&quot;Hola Mundo&quot;</span><span class="tok-o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>g)</em> <strong>Ejecutar la aplicación web</strong> en WildFly y comprobar que el servlet funciona correctamente, accediendo a la dirección a la que está mapeado.</p>
</div>
<div class="paragraph">
<p><em>h)</em> Vamos a hacer que el <em>servlet</em> que hemos añadido se muestre de forma automática como <strong>página principal</strong> de nuestra aplicación web. En el <code>web.xml</code> hay una sección llamada <code>welcome-file-list</code> que lista las páginas que el servidor debe buscar cuando se llame a la aplicación sin especificar la página a mostrar. Indicar únicamente <code>/HolaMundoServlet</code> en esta lista y comprobar que funciona adecuadamente, es decir que al llamar a <code><a href="http://localhost:8080/cweb-hola" class="bare">http://localhost:8080/cweb-hola</a></code> aparece dicho <em>servlet</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_servlet_que_muestra_la_fecha_y_hora_actuales_0_5_puntos">1.5.3. Servlet que muestra la fecha y hora actuales (0.5 puntos)</h4>
<div class="paragraph">
<p>Completar el servlet <code>org.expertojava.cweb.ejercicios.FechaServlet</code> de la aplicación <code>cweb-servlets</code> para que, tanto por GET como por POST, muestre una página HTML con la fecha y hora actuales en una cabecera <code>&lt;h3&gt;</code>, y en el <code>&lt;title&gt;</code> de la página. Para ello podéis utilizar la clase <code>java.util.Date</code>, y sacar por la salida del servlet la hora en formato cadena:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(...)</span> <span class="tok-kd">throws</span> <span class="tok-o">...</span>
<span class="tok-o">{</span>
  <span class="tok-n">String</span> <span class="tok-n">fecha</span> <span class="tok-o">=</span> <span class="tok-s">&quot;&quot;</span> <span class="tok-o">+</span> <span class="tok-k">new</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">util</span><span class="tok-o">.</span><span class="tok-na">Date</span><span class="tok-o">();</span>
  <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">setContentType</span><span class="tok-o">(...);</span>
  <span class="tok-n">out</span> <span class="tok-o">=</span> <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-na">getWriter</span><span class="tok-o">();</span>
  <span class="tok-o">...</span> <span class="tok-c1">// sacar la fecha tanto en el TITLE como en una cabecera H3</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Una vez hecho, configurad el descriptor de la aplicación para que el servlet se mapee a la dirección <code>/FechaHora</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_servlet_que_muestra_parámetros_de_inicio_0_5_puntos">1.5.4. Servlet que muestra parámetros de inicio (0.5 puntos)</h4>
<div class="paragraph">
<p>Crear un servlet <code>org.expertojava.cweb.ejercicios.ParamIniServlet</code> en la aplicación <code>cweb-servlets</code> que muestre en una tabla el nombre y el valor de todos los parámetros de inicio que se tengan configurados para ese servlet en el fichero descriptor (<code>web.xml</code>). La tabla tendrá dos columnas: una con el nombre del parámetro y otra con el valor.</p>
</div>
<div class="paragraph">
<p>Una vez hecho, probadlo añadiéndole en el fichero <code>web.xml</code> 3 parámetros de inicio con nombres <code>param1</code>, <code>param2</code>
  y <code>param3</code> y valores <code>val1</code>, <code>val2</code> y <code>val3</code>. Para ello deberéis dar un nombre al servlet (el nombre es arbitrario).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">doGet</span><span class="tok-o">(...)</span> <span class="tok-kd">throws</span><span class="tok-o">...</span>
<span class="tok-o">{</span>
    <span class="tok-n">Enumeration</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">nombres</span> <span class="tok-o">=</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">getInitParameterNames</span><span class="tok-o">();</span>
    <span class="tok-k">while</span> <span class="tok-o">(</span><span class="tok-n">nombres</span><span class="tok-o">.</span><span class="tok-na">hasMoreElements</span><span class="tok-o">())</span> <span class="tok-o">{</span>
        <span class="tok-n">String</span> <span class="tok-n">nombre</span> <span class="tok-o">=</span> <span class="tok-n">nombres</span><span class="tok-o">.</span><span class="tok-na">nextElement</span><span class="tok-o">();</span>
        <span class="tok-n">String</span> <span class="tok-n">valor</span> <span class="tok-o">=</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">getInitParameter</span><span class="tok-o">(</span><span class="tok-n">nombre</span><span class="tok-o">);</span>
        <span class="tok-o">...</span> <span class="tok-c1">// Mostrar nombre y valor en una tabla</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configurar_em_logging_em_en_servlets_0_5_puntos">1.5.5. Configurar <em>logging</em> en servlets (0.5 puntos)</h4>
<div class="paragraph">
<p>En la aplicación <code>cweb-servlets</code> tenemos dos servlets, <code>ServletLog4J1</code> y <code>ServletLog4J2</code> en el paquete
  <code>org.expertojava.cweb.ejercicios</code>. Queremos configurar las librerías de logging para poder ver los mensajes que emiten. Se pide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Comprobar que las librerías de logging de <em>commons-logging</em> y <em>log4j</em> están correctamente configuradas como dependencias en el <code>pom.xml</code>.</p>
</li>
<li>
<p>Comprobar que los ficheros de configuración <code>commons-logging.properties</code> y
<code>log4j.properties</code> están en la carpeta de fuentes llamada <code>resources</code>. Estos ficheros están configurados para que volcar los mensajes de ambos servlets (de tipo INFO o superior) a un fichero <code>/home/expertojava/errores.log</code>, con el formato:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>dd/MM/aaaa hh:mm:ss - prioridad - texto del mensaje - salto de línea</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>El servlet <code>ServletLog4J2</code> no saca mensajes de <em>log</em>. Añadid las líneas de código necesarias para que saque un mensaje de tipo INFO
cuando empiece a procesar la petición (al inicio del <code>doGet</code>) y otro cuando la termine, anotando el tiempo transcurrido entre ambos
mensajes (puede serte de utilidad el método <code>System.currentTimeMillis()</code> de Java).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Probad a llamar a los servlets <code>ServletLog4J1</code> o <code>ServletLog4J2</code> alguna vez, y que generen logs en el fichero <code>errores.log</code>
  que viene por defecto en el fichero de configuración.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-06 12:16:54 CEST
</div>
</div>
</body>
</html>