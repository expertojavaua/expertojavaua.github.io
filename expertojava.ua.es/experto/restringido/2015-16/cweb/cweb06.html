<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Miguel Angel Lozano">
<title>Componentes Web</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Componentes Web</h1>
<div class="details">
<span id="author" class="author">Miguel Angel Lozano</span><br>
<span id="email" class="email"><a href="mailto:malozano@ua.es">malozano@ua.es</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion06">6. Seguridad en aplicaciones web</a>
<ul class="sectlevel2">
<li><a href="#_mecanismos_de_autentificaci%C3%B3n">6.1. Mecanismos de autentificación</a></li>
<li><a href="#_usuarios_y_roles">6.2. Usuarios y roles</a></li>
<li><a href="#_autentificaci%C3%B3n_en_aplicaciones_web_java_ee">6.3. Autentificación en aplicaciones web Java EE</a>
<ul class="sectlevel3">
<li><a href="#_autentificaci%C3%B3n_basada_en_formularios">6.3.1. Autentificación basada en formularios</a></li>
<li><a href="#_autentificaci%C3%B3n_em_basic_em">6.3.2. Autentificación <em>basic</em></a></li>
</ul>
</li>
<li><a href="#_anotaciones_relacionadas_con_la_seguridad">6.4. Anotaciones relacionadas con la seguridad</a></li>
<li><a href="#_acceso_a_la_informaci%C3%B3n_de_seguridad">6.5. Acceso a la información de seguridad</a></li>
<li><a href="#_ejercicios">6.6. Ejercicios</a>
<ul class="sectlevel3">
<li><a href="#_seguridad_b%C3%A1sica_0_3_puntos">6.6.1. Seguridad básica (0.3 puntos)</a></li>
<li><a href="#_seguridad_basada_en_formularios_0_4_puntos">6.6.2. Seguridad basada en formularios (0.4 puntos)</a></li>
<li><a href="#_seguridad_mediante_anotaciones_0_3_puntos">6.6.3. Seguridad mediante anotaciones (0.3 puntos)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion06">6. Seguridad en aplicaciones web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Podemos tener básicamente dos motivos para proteger una aplicación web:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Evitar que usuarios no autorizados accedan a determinados recursos.</p>
</li>
<li>
<p>Prevenir que se acceda a los datos que se intercambian en una transferencia a lo largo de la red.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para cubrir estos agujeros, un sistema de seguridad se apoya en tres aspectos importantes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Autentificación</strong> y <strong>autorización</strong>: La autentificación se refiere a identificar a los actores que se conectan, lo cual se hará normalmente aportando unas credenciales (<em>login</em> y <em>password</em>), mientras que la autorización se refiere a distinguir las operaciones que cada actor puede realizar.</p>
</li>
<li>
<p><strong>Confidencialidad</strong>: Asegurar que sólo los elementos que intervienen entienden el proceso de comunicación establecido.</p>
</li>
<li>
<p><strong>Integridad</strong>: Verificar que el contenido de la comunicación no se modifica durante la transmisión.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Desde el punto de vista de quién controla la seguridad en una aplicación web, existen dos formas de
		implantación:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Seguridad declarativa</strong>: Aquella estructura de seguridad sobre una aplicación que es externa a dicha aplicación. Con ella, no tendremos que preocuparnos de gestionar la seguridad en ningún servlet, página JSP, etc, de nuestra aplicación, sino que el propio servidor Web se encarga de todo. Así, ante cada petición, comprueba si el usuario se ha autentificado ya, y si no le pide login y password para ver si puede acceder al recurso solicitado. Todo esto se realiza de forma transparente al usuario. Mediante el descriptor de la aplicación principalmente (fichero <em>web.xml</em>), comprueba la configuración de seguridad que queremos dar.</p>
</li>
<li>
<p><strong>Seguridad programada</strong>: Mediante la seguridad programada, son los servlets y páginas JSP quienes, al menos parcialmente, controlan la seguridad de la aplicación.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Vamos a centrarnos en el estudio de la <strong>autentificación</strong> y <strong>autorización</strong> mediante <strong>seguridad declarativa</strong> en servidores de aplicaciones Java EE.</p>
</div>
<div class="sect2">
<h3 id="_mecanismos_de_autentificación">6.1. Mecanismos de autentificación</h3>
<div class="paragraph">
<p>Veremos ahora algunos mecanismos que pueden emplearse con HTTP para autentificar (validar) al usuario que intenta acceder a un determinado recurso.</p>
</div>
<div class="paragraph">
<p><strong>Autentificaciones elementales</strong></p>
</div>
<div class="paragraph">
<p>El protocolo HTTP incorpora un mecanismo de autentificación básico (<strong>basic</strong>) basado en cabeceras de autentificación para solicitar datos del usuario (el servidor) y para enviar los datos del usuario (el cliente), de forma que comprobando la exactitud de los datos se permitirá o no al usuario acceder a los recursos. Esta autentificación no proporciona confidencialidad ni integridad, sólo se emplea una codificación Base64.</p>
</div>
<div class="paragraph">
<p>Una variante de esto es la autentificación <strong>digest</strong>, donde, en lugar de transmitir el password por la red, se emplea un password codificado. Dicha codificación se realiza tomando el login, password, URI, método HTTP y un valor generado aleatoriamente, y todo ello se combina utilizando el método de encriptado MD5, muy seguro. De este modo, ambas partes de la comunicación conocen el password, y a partir de él pueden comprobar si los datos enviados son correctos. Sin embargo, algunos servidores no soportan este tipo de autentificación.</p>
</div>
<div class="paragraph">
<p><strong>Certificados digitales y SSL</strong></p>
</div>
<div class="paragraph">
<p>Las aplicaciones reales pueden requerir un nivel de seguridad mayor que el proporcionado por las autentificaciones <em>basic</em> o <em>digest</em>. También pueden requerir confidencialidad e integridad aseguradas. Todo esto se consigue mediante los <strong>certificados digitales</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Criptografía de clave pública</strong>:La clave de los certificados digitales reside en la <strong>criptografía de clave pública</strong>, mediante la cual cada participante en el proceso tiene dos claves, que le permiten encriptar y desencriptar la información. Una es la clave pública, que se distribuye libremente. La otra es la clave privada, que se mantiene secreta. Este par de claves es asimétrico, es decir, una clave sirve para desencriptar algo codificado con la otra. Por ejemplo, supongamos que A quiere enviar datos encriptados a B. Para ello, hay dos posibilidades:</p>
</li>
<li>
<p>A toma la clave pública de B, codifica con ella los datos y se los envía. Luego B utiliza su clave privada (que sólo él conoce) para desencriptar los datos.</p>
</li>
<li>
<p>A toma su clave privada, codifica los datos y se los envía a B, que toma la clave pública de A para descodificarlos. Con esto, B sabe que A es el remitente de los datos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El encriptado con clave pública se basa normalmente en el algoritmo RSA, que emplea números primos grandes para obtener un par de claves asimétricas. Las claves pueden darse con varias longitudes; así, son comunes claves de 1024 o 2048 bits.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Certificados digitales</strong>: Lógicamente, no es práctico teclear las claves del sistema de clave pública, pues son muy largas. Lo que se hace en su lugar es almacenar estas claves en disco en forma de <strong>certificados digitales</strong>. Estos certificados pueden cargarse por muchas aplicaciones (servidores web, navegadores, gestores de correo, etc).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notar que con este sistema se garantiza la <strong>confidencialidad</strong> (porque los datos van encriptados), y la <strong>integridad</strong> (porque si los datos se desencriptan bien, indica que son correctos). Sin embargo, no proporciona <strong>autentificación</strong> (B no sabe que los datos se los ha enviado A), a menos que A utilice su clave privada para encriptar los datos, y luego B utilice la clave pública de A para desencriptarlos. Así, B descodifica primero el mensaje con su clave privada, y luego con la pública de A. Si el proceso tiene éxito, los datos se sabe que han sido enviados por A, porque sólo A conoce su clave privada.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SSL</strong>: SSL (<em>Secure Socket Layer</em>) es una capa situada entre el protocolo a nivel de aplicación (HTTP, en este caso) y el protocolo a nivel de transporte (TCP/IP). Se encarga de gestionar la seguridad mediante criptografía de clave pública que encripta la comunicación entre cliente y servidor. La versión 2.0 de SSL (la primera mundialmente aceptada), proporciona autentificación en la parte del servidor, confidencialidad e integridad. Funciona como sigue:</p>
</li>
<li>
<p>Un cliente se conecta a un lugar seguro utilizando el protocolo HTTPS (HTTP + SSL). Podemos detectar estos sitios porque las URLs comienzan con <code>https://</code></p>
</li>
<li>
<p>El servidor envía su clave pública al cliente.</p>
</li>
<li>
<p>El navegador comprueba si la clave está firmada por un certificado de confianza. Si no es así, pregunta al cliente si quiere confiar en la clave proporcionada.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SSL 3.0 proporciona también soporte para certificados y autentificación del cliente. Funcionan de la misma forma que los explicados para el servidor, pero residiendo en el cliente.</p>
</div>
</div>
<div class="sect2">
<h3 id="_usuarios_y_roles">6.2. Usuarios y roles</h3>
<div class="paragraph">
<p>Cualquier aplicación medianamente compleja tendrá que autentificar a los usuarios que acceden a ella, y en función de quiénes son, permitirles o no la ejecución de ciertas operaciones.</p>
</div>
<div class="paragraph">
<p>Los mecanismos de autentificación en WildFly se basan en el concepto de <em>realm</em>. Un <em>realm</em> es un conjunto de usuarios, cada uno con un <em>login</em> y <em>password</em> y uno o más <em>roles</em>. Los roles determinan qué permisos tiene el usuario en una aplicación web (esto es configurable en cada aplicación a través del descriptor de despliegue, <code>web.xml</code>). El <em>login</em> y el <em>password</em> se utilizará para la autentificación de los usuarios, y los roles para su autorización.</p>
</div>
<div class="paragraph">
<p>Podemos encontrar distintos tipos de <em>realms</em>, que básicamente se diferencian en dónde están almacenados los datos de <em>logins</em>, <em>passwords</em> y <em>roles</em>. Por defecto en WildFly tenemos dos realms que almacenan estos datos en ficheros de texto de tipo <code>.properties</code>. Existen otros <em>realms</em> que leer los datos de bases de datos con JDBC, de un directorio LDAP o mediante JAAS, el API estándar de Java para autentificación.</p>
</div>
<div class="paragraph">
<p>Los dos <em>realms</em> que tenemos por defecto en WildFly son <code>ManagementRealm</code> y <code>ApplicationRealm</code>. <code>ManagementRealm</code> se utiliza para la aplicación de administración del servidor, por lo que sólo nos permite controlar la autentificación (no se indican roles porque el único rol que tienen los usuarios de este conjunto es el de administrar el servidor). Por otro lado, <code>ApplicationRealm</code> nos permite además controlar la autorización, mediante la asignación de roles a usuarios.</p>
</div>
<div class="paragraph">
<p>No será necesario editar manualmente los ficheros de usuarios de estos <em>realms</em> por defecto, ya que se proporciona una herramienta para añadir nuevos usuarios a ellos. Este herramienta se encuentra en el directorio <code>$WILDFLY_HOME/bin</code>, y se ejecuta de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>./addUser.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Nos preguntará en primer lugar en cuál de los dos <em>realms</em> por defecto queremos introducir el usuario, y a continuación nos irá pidiendo los datos del nuevo usuario. En las aplicaciones que incorporen seguridad declarativa se nos permitirá entrar con cualquiera de los usuarios del <code>ApplicationRealm</code>. Las operaciones que nos permita hacer dependerán de los roles asignados.</p>
</div>
</div>
<div class="sect2">
<h3 id="_autentificación_en_aplicaciones_web_java_ee">6.3. Autentificación en aplicaciones web Java EE</h3>
<div class="paragraph">
<p>En las aplicaciones web Java EE tenemos distintos tipos de autentificación que podemos emplear:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Autentificación <em>basic</em></strong>: Con HTTP se proporciona un mecanismo de autentificación básico, basado en cabeceras de autentificación para solicitar datos del usuario (el servidor) y para enviar los datos del usuario (el cliente). Esta autentificación no proporciona confidencialidad ni integridad, sólo se emplea una codificación Base64.</p>
</li>
<li>
<p><strong>Autentificación <em>digest</em></strong>: Existe una variante de lo anterior, la autentificación <strong>digest</strong>, donde, en lugar de transmitir el password por la red, se emplea un password codificado utilizando el método de encriptado MD5. Sin embargo, algunos servidores no soportan este tipo de autentificación.</p>
</li>
<li>
<p><strong>Autentificación basada en formularios</strong>: Con este tipo de autentificación, el usuario introduce su login y password mediante un formulario HTML (y no con un cuadro de diálogo, como las anteriores). El fichero descriptor contiene para ello entradas que indican la página con el formulario de autentificación y una página de error. Tiene el mismo inconveniente que la autentificación <em>basic</em>: el password se codifica con un mecanismo muy pobre.</p>
</li>
<li>
<p><strong>Certificados digitales y SSL</strong>: Con HTTP también se permite el uso de SSL y los certificados digitales, apoyados en los sistemas de criptografía de clave pública. Así, la capa SSL, trabajando entre TCP/IP y HTTP, asegura, mediante criptografía de clave pública, la integridad, confidencialidad y autentificación.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_autentificación_basada_en_formularios">6.3.1. Autentificación basada en formularios</h4>
<div class="paragraph">
<p>Veremos ahora con más profundidad la autentificación basada en formularios comentada anteriormente. Esta es la forma más comúnmente usada para imponer seguridad en una aplicación, puesto que se emplean <strong>formularios HTML</strong>.</p>
</div>
<div class="paragraph">
<p>El programador emplea el descriptor de despliegue para identificar los recursos a proteger, e indicar la página con el formulario a mostrar, y la página con el error a mostrar en caso de autentificación incorrecta. Así, un usuario que intente acceder a la parte restringida es redirigido automáticamente a la página del formulario, si no ha sido autentificado previamente. Si se autentifica correctamente accede al recurso, y si no se le muestra la página de error. Todo este proceso lo controla el servidor automáticamente.</p>
</div>
<div class="paragraph">
<p>Este tipo de autentificación no se garantiza que funcione cuando se emplea reescritura de URLs en el seguimiento de sesiones. También podemos incorporar SSL a este proceso, de forma que no se vea modificado el funcionamiento aparente del mismo.</p>
</div>
<div class="paragraph">
<p>Para utilizar la autentificación basada en formularios, se siguen los pasos que veremos a continuación. Sólo el primero es dependiente del servidor que se utilice.</p>
</div>
<div class="paragraph">
<p><strong>1. Establecer los logins, passwords y roles</strong></p>
</div>
<div class="paragraph">
<p>En este paso definiríamos un <em>realm</em> del modo que se ha explicado en apartados anteriores.</p>
</div>
<div class="paragraph">
<p><strong>2. Indicar al servlet que se empleará autentificación basada en formularios, e indicar las páginas de formulario y error.</strong></p>
</div>
<div class="paragraph">
<p>Se coloca para ello una etiqueta <code>&lt;login-config&gt;</code> en el descriptor de despliegue. Dentro, se emplean las subetiquetas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;auth-method&gt;</code> que en general puede valer:</p>
<div class="ulist">
<ul>
<li>
<p><code>FORM</code>: para autentificación basada en formularios (como es el caso)</p>
</li>
<li>
<p><code>BASIC</code>: para autentificación BASIC</p>
</li>
<li>
<p><code>DIGEST</code>: para autentificación DIGEST</p>
</li>
<li>
<p><code>CLIENT-CERT</code>: para SSL</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>&lt;form-login-config&gt;</code> que indica las dos páginas HTML (la del formulario y la de error) con las etiquetas:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;form-login-page&gt;</code> (para la de autentificación)</p>
</li>
<li>
<p><code>&lt;form-error-page&gt;</code> (para la página de error).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Por ejemplo, podemos tener las siguientes líneas en el descriptor de despliegue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;web-app&gt;</span>
	...
	<span class="tok-nt">&lt;login-config&gt;</span>
		<span class="tok-nt">&lt;auth-method&gt;</span>FORM<span class="tok-nt">&lt;/auth-method&gt;</span>
		<span class="tok-nt">&lt;form-login-config&gt;</span>
			<span class="tok-nt">&lt;form-login-page&gt;</span>
				/login.jsp
			<span class="tok-nt">&lt;/form-login-page&gt;</span>
			<span class="tok-nt">&lt;form-error-page&gt;</span>
				/error.html
			<span class="tok-nt">&lt;/form-error-page&gt;</span>
		<span class="tok-nt">&lt;/form-login-config&gt;</span>
	<span class="tok-nt">&lt;/login-config&gt;</span>
	...
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>3. Crear la página de login</strong></p>
</div>
<div class="paragraph">
<p>El formulario de esta página debe contener campos para introducir el login y el password, que deben llamarse <em>j_username</em> y <em>j_password</em>. La acción del formulario debe ser <em>j_security_check</em>, y el METHOD = POST (para no mostrar los datos de identificación en la barra del explorador). Por ejemplo, podríamos tener la página:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;!DOCTYPE HTML PUBLIC</span>
<span class="tok-cp">&quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;</span>
<span class="tok-nt">&lt;html&gt;</span>
<span class="tok-nt">&lt;body&gt;</span>
	<span class="tok-nt">&lt;form</span> <span class="tok-na">action=</span><span class="tok-s">&quot;j_security_check&quot;</span> <span class="tok-na">METHOD=</span><span class="tok-s">&quot;POST&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;table&gt;</span>
	<span class="tok-nt">&lt;tr&gt;</span>
		<span class="tok-nt">&lt;td&gt;</span>
			Login:<span class="tok-nt">&lt;input</span> <span class="tok-na">type=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;j_username&quot;</span><span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;/td&gt;</span>
	<span class="tok-nt">&lt;/tr&gt;</span>
	<span class="tok-nt">&lt;tr&gt;</span>
		<span class="tok-nt">&lt;td&gt;</span>
			Password:<span class="tok-nt">&lt;input</span> <span class="tok-na">type=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;j_password&quot;</span><span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;/td&gt;</span>
	<span class="tok-nt">&lt;/tr&gt;</span>
	<span class="tok-nt">&lt;tr&gt;</span>
		<span class="tok-nt">&lt;td&gt;</span>
			<span class="tok-nt">&lt;input</span> <span class="tok-na">type=</span><span class="tok-s">&quot;submit&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;Enviar&quot;</span><span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;/td&gt;</span>
	<span class="tok-nt">&lt;/tr&gt;</span>
	<span class="tok-nt">&lt;/table&gt;</span>
	<span class="tok-nt">&lt;/form&gt;</span>
<span class="tok-nt">&lt;/body&gt;</span>
<span class="tok-nt">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>4. Crear la página de error</strong></p>
</div>
<div class="paragraph">
<p>La página puede tener el mensaje de error que se quiera. Ante fallos de autentificación, se redirigirá a esta página con un código 401. Un ejemplo de página sería:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;!DOCTYPE HTML PUBLIC</span>
<span class="tok-cp">&quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;</span>
<span class="tok-nt">&lt;html&gt;</span>
<span class="tok-nt">&lt;body&gt;</span>
	<span class="tok-nt">&lt;h1&gt;</span>ERROR AL AUTENTIFICAR USUARIO<span class="tok-nt">&lt;/h1&gt;</span>
<span class="tok-nt">&lt;/body&gt;</span>
<span class="tok-nt">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>5. Indicar qué direcciones deben protegerse con autentificación</strong></p>
</div>
<div class="paragraph">
<p>Para ello utilizamos etiquetas <code>&lt;security-constraint&gt;</code> en el descriptor de despliegue. Dichos elementos debe ir inmediatamente antes de <code>&lt;login-config&gt;</code>, y utilizan las subetiquetas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;display-name&gt;</code> para dar un nombre identificativo a emplear (opcional)</p>
</li>
<li>
<p><code>&lt;web-resource-collection&gt;</code> para especificar los patrones de URL que se protegen (requerido). Se permiten varias entradas de este tipo para especificar recursos de varios lugares. Cada uno contiene:</p>
<div class="ulist">
<ul>
<li>
<p>Una etiqueta <code>&lt;web-resource-name&gt;</code> que da un nombre identificativo arbitrario al recurso o recursos</p>
</li>
<li>
<p>Una etiqueta <code>&lt;url-pattern&gt;</code> que indica las URLs que deben protegerse</p>
</li>
<li>
<p>Una etiqueta <code>&lt;http-method&gt;</code> que indica el método o métodos HTTP a los que se aplicará la restricción (opcional)</p>
</li>
<li>
<p>Una etiqueta <code>&lt;description&gt;</code> con documentación sobre el conjunto de recursos a proteger (opcional)</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
este modo de restricción se aplica sólo cuando se accede al recurso directamente, no a través de arquitecturas MVC (Modelo-Vista-Controlador), con un <em>RequestDispatcher</em>. Es decir, si por ejemplo un servlet accede a una página JSP protegida, este mecanismo no tiene efecto, pero sí cuando se intenta a acceder a la página JSP directamente.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>&lt;auth-constraint&gt;</code> indica los roles de usuario que pueden acceder a los recursos indicados (opcional) Contiene:</p>
<div class="ulist">
<ul>
<li>
<p>Uno o varios subelementos <code>&lt;role-name&gt;</code> indicando cada rol que tiene permiso de acceso. Si queremos dar permiso a todos los roles, utilizamos una etiqueta <code>&lt;role-name&gt;*&lt;/role-name&gt;</code>.</p>
</li>
<li>
<p>Una etiqueta <code>&lt;description&gt;</code> indicando la descripción de los mismos.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>En teoría esta etiqueta es opcional, pero omitiéndola indicamos que ningún rol tiene permiso de acceso. Aunque esto puede parecer absurdo, recordar que este sistema sólo se aplica al acceso directo a las URLs (no a través de un modelo MVC), con lo que puede tener su utilidad.</p>
</div>
<div class="paragraph">
<p>Añadimos alguna dirección protegida al fichero que vamos construyendo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;web-app&gt;</span>
	<span class="tok-nt">&lt;security-constraint&gt;</span>
		<span class="tok-nt">&lt;web-resource-collection&gt;</span>
			<span class="tok-nt">&lt;web-resource-name&gt;</span>
				Prueba
			<span class="tok-nt">&lt;/web-resource-name&gt;</span>
			<span class="tok-nt">&lt;url-pattern&gt;</span>
				/prueba/*
			<span class="tok-nt">&lt;/url-pattern&gt;</span>
		<span class="tok-nt">&lt;/web-resource-collection&gt;</span>
		<span class="tok-nt">&lt;auth-constraint&gt;</span>
			<span class="tok-nt">&lt;role-name&gt;</span>admin<span class="tok-nt">&lt;/role-name&gt;</span>
			<span class="tok-nt">&lt;role-name&gt;</span>subadmin<span class="tok-nt">&lt;/role-name&gt;</span>
		<span class="tok-nt">&lt;/auth-constraint&gt;</span>
	<span class="tok-nt">&lt;/security-constraint&gt;</span>

	<span class="tok-nt">&lt;login-config&gt;</span>
		...
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este caso protegemos todas las URLs de la forma <code>http//host/ruta_aplicacion/prueba/*</code>, de forma que sólo los usuarios que tengan roles de <em>admin</em> o de <em>subadmin</em> podrán acceder a ellas.</p>
</div>
</div>
<div class="sect3">
<h4 id="_autentificación_em_basic_em">6.3.2. Autentificación <em>basic</em></h4>
<div class="paragraph">
<p>El método de autentificación basada en formularios tiene algunos inconvenientes: si el navegador no soporta cookies, el proceso tiene que hacerse mediante reescritura de URLs, con lo que no se garantiza el funcionamiento.</p>
</div>
<div class="paragraph">
<p>Por ello, una alternativa es utilizar el modelo de autentificación <em>basic</em> de HTTP, donde se emplea un cuadro de diálogo para que el usuario introduzca su login y password, y se emplea la cabecera <em>Authorization</em> de petición para recordar qué usuarios han sido autorizados y cuáles no. Una diferencia con respecto al método anterior es que es difícil entrar como un usuario distinto una vez que hemos entrado como un determinado usuario (habría que cerrar el navegador y volverlo a abrir).</p>
</div>
<div class="paragraph">
<p>Al igual que en el caso anterior, podemos utilizar SSL sin ver modificado el resto del esquema del proceso.</p>
</div>
<div class="paragraph">
<p>El método de autentificación <em>basic</em> consta de los siguientes pasos:</p>
</div>
<div class="paragraph">
<p><strong>1. Establecer los logins, passwords y roles</strong></p>
</div>
<div class="paragraph">
<p>Este paso es exactamente igual que el visto para la autentificación basada en formularios.</p>
</div>
<div class="paragraph">
<p><strong>2. Indicar al servlet que se empleará autentificación BASIC, y designar los dominios</strong></p>
</div>
<div class="paragraph">
<p>Se utiliza la misma etiqueta <code>&lt;login-config&gt;</code> vista antes, pero ahora una etiqueta <code>&lt;auth-method&gt;</code> con valor BASIC. Se emplea una subetiqueta <code>&lt;realm-name&gt;</code> para indicar qué dominio se empleará en la autorización. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;web-app&gt;</span>
	...
	<span class="tok-nt">&lt;login-config&gt;</span>
		<span class="tok-nt">&lt;auth-method&gt;</span>BASIC<span class="tok-nt">&lt;/auth-method&gt;</span>
		<span class="tok-nt">&lt;realm-name&gt;</span>dominio<span class="tok-nt">&lt;/realm-name&gt;</span>
	<span class="tok-nt">&lt;/login-config&gt;</span>
	...
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>3. Indicar qué direcciones deben protegerse con autentificación</strong></p>
</div>
<div class="paragraph">
<p>Este paso también es idéntico al visto en la autentificación basada en formularios.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_anotaciones_relacionadas_con_la_seguridad">6.4. Anotaciones relacionadas con la seguridad</h3>
<div class="paragraph">
<p>Con la especificación 3.0 de servlets se introduce la posibilidad de configurar los permisos de acceso mediante
		anotaciones en lugar de en el <code>web.xml</code>, lo que hace la configuración menos farragosa y más clara. La
		anotación principal que utilizaremos es <code>@ServletSecurity</code>, que toma dos parámetros:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>value</code>: Define la restricción de seguridad, mediante una anotación de tipo <code>@HttpConstraint</code>.</p>
</li>
<li>
<p><code>httpMethodConstraints</code>: Permite definir una lista de restricciones sobre los métodos HTTP que pueden
acceder al servlet. Se definen mediante una anotación de tipo <code>@HttpMethodConstraint</code>. De esta manera no damos
una restricción general para todos los métodos, sino que podemos personalizar las restricciones que se aplicarán
para cada uno de ellos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La anotación <code>@HttpConstraint</code> acepta los siguientes parámetros:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>rolesAllowed</code>: Nos permite definir la lista de roles que pueden acceder al servlet.</p>
</li>
<li>
<p><code>transportGuarantee</code>: Puede tomar los valores <code>TransportGuarantee.NONE</code> o <code>TransportGuarantee.CONFIDENTIAL</code>.
Con el segundo de ellos sólo estaremos permitiendo acceder al servlet si la conexión se realiza mediante SSL.</p>
</li>
<li>
<p><code>value</code>: Nos permite establecer la política de acceso a llevar a cabo independientemente del rol del usuario. Las opciones son
admitir todas las peticiones (<code>EmptyRoleSemantic.PERMIT</code>) o denegarlas (<code>EmptyRoleSemantic.DENY</code>). Definiremos estas
políticas cuando no se especifique una lista de roles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Un caso común es aquel en el que queremos permitir acceso al servlet a unos roles determinados:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-s">&quot;/MiServlet&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@ServletSecurity</span><span class="tok-o">(</span><span class="tok-nd">@HttpConstraint</span><span class="tok-o">(</span><span class="tok-n">rolesAllowed</span><span class="tok-o">={</span><span class="tok-s">&quot;rol1&quot;</span><span class="tok-o">,</span><span class="tok-s">&quot;rol2&quot;</span><span class="tok-o">}))</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si queremos permitir el acceso a cualquier usuario (aunque no esté autentificado), pero siempre mediante SSL, podemos indicarlo
		de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-s">&quot;/MiServlet&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@ServletSecurity</span><span class="tok-o">(</span><span class="tok-nd">@HttpConstraint</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-n">EmptyRoleSemantic</span><span class="tok-o">.</span><span class="tok-na">PERMIT</span><span class="tok-o">,</span>
              <span class="tok-n">transportGuarantee</span><span class="tok-o">=</span><span class="tok-n">TransportGuarantee</span><span class="tok-o">.</span><span class="tok-na">CONFIDENTIAL</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Como alternativa, podemos definir diferentes restricciones para cada método HTTP. Para ello utilizaremos la anotación <code>@HttpMethodConstraint</code>,
		que podrá tomar los siguientes parámetros:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>value</code>: Indica el método para el que vamos a definir las restricciones de acceso. Por ejemplo <code>"GET"</code>, <code>"POST"</code>, etc.</p>
</li>
<li>
<p><code>rolesAllowed</code>: Define la lista de roles que pueden acceder al servlet mediante el método indicado.</p>
</li>
<li>
<p><code>transportGuarantee</code>: Indica si sólo se permite acceder al método indicado mediante SSL. Se define de la misma forma que
en el caso de <code>@HttpConstraint</code>.</p>
</li>
<li>
<p><code>emptyRoleSemantic</code>: Nos permite establecer la política de acceso a llevar a cabo independientemente del rol del usuario para el método
especificado. Se define de la misma forma que en el caso de <code>@HttpConstraint</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Si sólo se especifica el método (sin añadir más parámetros), se considera que siempre se permite el acceso mediante dicho método. Por ejemplo, podemos
		definir políticas diferentes para los métodos <code>GET</code>, <code>POST</code> y <code>PUT</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@WebServlet</span><span class="tok-o">(</span><span class="tok-s">&quot;/MiServlet&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@ServletSecurity</span><span class="tok-o">(</span><span class="tok-n">httpMethodConstraints</span><span class="tok-o">={</span>
   <span class="tok-nd">@HttpMethodConstraint</span><span class="tok-o">(</span><span class="tok-s">&quot;GET&quot;</span><span class="tok-o">),</span>
   <span class="tok-nd">@HttpMethodConstraint</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;POST&quot;</span><span class="tok-o">,</span><span class="tok-n">rolesAllowed</span><span class="tok-o">=</span><span class="tok-s">&quot;admin&quot;</span><span class="tok-o">),</span>
   <span class="tok-nd">@HttpMethodConstraint</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;PUT&quot;</span><span class="tok-o">,</span>
                         <span class="tok-n">emptyRoleSemantic</span><span class="tok-o">=</span><span class="tok-n">EmptyRoleSemantic</span><span class="tok-o">.</span><span class="tok-na">DENY</span><span class="tok-o">)})</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este ejemplo, se permite acceder a todos los usuarios con <code>GET</code>, pero con <code>POST</code> sólo podrán acceder los que tengan rol
		<code>admin</code>, y con <code>PUT</code> no podrá acceder nadie.</p>
</div>
<div class="paragraph">
<p>También podemos combinar una política particular para una serie de métodos, y una política general para el resto:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@ServletSecurity</span><span class="tok-o">(</span>
   <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-nd">@HttpConstraint</span><span class="tok-o">(</span><span class="tok-n">EmptyRoleSemantic</span><span class="tok-o">.</span><span class="tok-na">PERMIT</span><span class="tok-o">),</span>
   <span class="tok-n">httpMethodConstraints</span><span class="tok-o">={</span>
     <span class="tok-nd">@HttpMethodConstraint</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;POST&quot;</span><span class="tok-o">,</span><span class="tok-n">rolesAllowed</span><span class="tok-o">=</span><span class="tok-s">&quot;admin&quot;</span><span class="tok-o">)</span>
     <span class="tok-nd">@HttpMethodConstraint</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;PUT&quot;</span><span class="tok-o">,</span>
         <span class="tok-n">transportGuarantee</span><span class="tok-o">=</span><span class="tok-n">TransportGuarantee</span><span class="tok-o">.</span><span class="tok-na">CONFIDENTIAL</span><span class="tok-o">)})</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiServlet</span> <span class="tok-kd">extends</span> <span class="tok-n">HttpServlet</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este caso sólo los usuarios con rol <code>admin</code> podrán acceder mediante <code>POST</code>, y sólo se podrán establecer conexiones <code>PUT</code>
		mediante SSL, pero para el resto de métodos se permitirá acceder a cualquier usuario sin necesidad de utilizar SSL.</p>
</div>
</div>
<div class="sect2">
<h3 id="_acceso_a_la_información_de_seguridad">6.5. Acceso a la información de seguridad</h3>
<div class="paragraph">
<p>Es muy probable que necesitemos acceder desde el código de la aplicación a información del contexto de seguridad del servidor, como
		puede ser el nombre del usuario autentificado actualmente, o sus roles. Podemos acceder a esta información a través del objeto
		<code>HttpServletRequest</code>.</p>
</div>
<div class="paragraph">
<p>En primer lugar, podemos obtener los datos del usuario autentificado actualmente con el método <code>getUserPrincipal()</code> de
		la petición. Esto nos devolverá un objeto de tipo <code>Principal</code>, del que podremos sacar el nombre del usuario. De forma alternativa,
		este nombre también se puede obtener mediante el método <code>getRemoteUser()</code> del mismo objeto.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-n">Principal</span> <span class="tok-n">p</span> <span class="tok-o">=</span> <span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-na">getUserPrincipal</span><span class="tok-o">();</span>
<span class="tok-k">if</span><span class="tok-o">(</span><span class="tok-n">p</span><span class="tok-o">!=</span><span class="tok-kc">null</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;El usuario autentificado es &quot;</span> <span class="tok-o">+</span> <span class="tok-n">p</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>
<span class="tok-o">}</span> <span class="tok-k">else</span> <span class="tok-o">{</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;No hay ningun usuario autentificado&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>También puede interesarnos comprobar si el usuario actual pertenece a un determinado rol, para así saber si debemos darle permiso o
		no para realizar una operación dada. Esto lo podemos realizar con el método <code>isUserInRole(rol)</code> del objeto petición.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-k">if</span><span class="tok-o">(</span><span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-na">isUserInRole</span><span class="tok-o">(</span><span class="tok-s">&quot;admin&quot;</span><span class="tok-o">))</span> <span class="tok-o">{</span>
    <span class="tok-n">usuarioDao</span><span class="tok-o">.</span><span class="tok-na">altaUsuario</span><span class="tok-o">(</span><span class="tok-n">usuario</span><span class="tok-o">);</span>
<span class="tok-o">}</span> <span class="tok-k">else</span> <span class="tok-o">{</span>
    <span class="tok-n">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Solo los administradores pueden realizar altas&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Otros métodos que nos aportan información sobre el contexto de seguridad son <code>getAuthType()</code>, que nos dice el tipo de autentificación
		que estamos utilizando (<code>BASIC</code>, <code>DIGEST</code>, <code>FORM</code>, <code>CLIENT-CERT</code>), y <code>isSecure()</code> que
		nos indica si estamos realizando una conexión segura (SSL) o no.</p>
</div>
<div class="paragraph">
<p>Para finalizar, si estamos utilizando seguridad basada en formulario podremos cerrar la sesión de forma sencilla llamando al método
		<code>invalidate()</code> del objeto <code>HttpSession</code>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="_ejercicios">6.6. Ejercicios</h3>
<div class="sect3">
<h4 id="_seguridad_básica_0_3_puntos">6.6.1. Seguridad básica (0.3 puntos)</h4>
<div class="paragraph">
<p>En las plantillas de la sesión tenemos un proyecto llamado <code>cweb-seguridad</code>, en el que hay un directorio
	<code>restringido</code> que deberemos proteger para que sólo los usuarios autentificados puedan acceder a su
	contenido. Se pide:</p>
</div>
<div class="paragraph">
<p><em>a)</em> Crear en el <em>realm</em> <code>ApplicationRealm</code> los roles <code>admin</code> y <code>registrado</code>,
	y un usuario que tenga esos roles.</p>
</div>
<div class="paragraph">
<p><em>b)</em> Añadir al fichero <code>web.xml</code> la configuración necesaria para proteger el directorio
	<code>restringido</code> y todo su contenido mediante autentificación de tipo <code>BASIC</code> para que
	sólo los dos roles que hemos creado puedan acceder.</p>
</div>
<div class="paragraph">
<p><em>c)</em> Entrar en <code>restringido/index.jsp</code> para comprobar que
	está protegido, y que introduciendo el usuario que hemos creado nos deja acceder correctamente. Podemos encontrar
	una enlace a dicho recurso protegido desde la página principal <code>index.html</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_seguridad_basada_en_formularios_0_4_puntos">6.6.2. Seguridad basada en formularios (0.4 puntos)</h4>
<div class="paragraph">
<p>Vamos a cambiar el tipo de seguridad por autentificación basada en formularios. Se pide:</p>
</div>
<div class="paragraph">
<p><em>a)</em> Crear los ficheros <code>login.jsp</code> y <code>error.jsp</code> (puedes utilizar el código de los
	apuntes).</p>
</div>
<div class="paragraph">
<p><em>b)</em> Modificar <code>web.xml</code> para cambiar el tipo de seguridad por autentificación basada en formularios,
	que utilice las páginas creadas en el apartado anterior.</p>
</div>
<div class="paragraph">
<p><em>c)</em> Probar a acceder ahora al área restringida y comprobar que los formularios funcionan correctamente.
	Ahora podemos aprovechar la página <code>logout.jsp</code> de la plantilla para cerrar la sesión y así poder
	probar otro usuario.</p>
</div>
</div>
<div class="sect3">
<h4 id="_seguridad_mediante_anotaciones_0_3_puntos">6.6.3. Seguridad mediante anotaciones (0.3 puntos)</h4>
<div class="paragraph">
<p>En el proyecto tenemos un servlet de nombre <code>SeguridadServlet</code>. Vamos a añadir anotaciones de seguridad
	para protegerlo. Se pide:</p>
</div>
<div class="paragraph">
<p><em>a)</em> Añadir la anotación necesaria para que sólo los roles <code>registrado</code> y <code>admin</code> puedan
	acceder al servlet. Comprobar que las anotaciones funcionan correctamente.</p>
</div>
<div class="paragraph">
<p><em>b)</em> Comprobar dentro del servlet si el usuario es administrador, y en tal caso mostrar un mensaje en la
	página que lo indique.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-06 12:16:54 CEST
</div>
</div>
</body>
</html>