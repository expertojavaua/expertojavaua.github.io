<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Fran GarcÃ­a">
<title>Grails</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Grails</h1>
<div class="details">
<span id="author" class="author">Fran GarcÃ­a</span><br>
<span id="email" class="email">&lt;<a href="mailto:fgarciarico@gmail.com">fgarciarico@gmail.com</a>&gt;</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Ãndice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion02">2. Aspectos avanzados del Lenguaje Groovy. MetaprogramaciÃ³n.</a>
<ul class="sectlevel2">
<li><a href="#_closures">2.1. Closures</a></li>
<li><a href="#_groovy_como_lenguaje_orientado_a_objetos">2.2. Groovy como lenguaje orientado a objetos</a></li>
<li><a href="#_metaprogramaci%C3%B3n">2.3. MetaprogramaciÃ³n</a></li>
<li><a href="#_groovy_builders">2.4. Groovy Builders</a></li>
<li><a href="#_ejercicios">2.5. Ejercicios</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion02">2. Aspectos avanzados del Lenguaje Groovy. MetaprogramaciÃ³n.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En la sesiÃ³n anterior hacÃ­amos un repaso completo sobre los tipos de tipos de datos simples y algunas caracterÃ­sticas. Posteriormente hablÃ¡bamos sobre colecciones y comentÃ¡bamos las excelencias de los rangos, una tipo de datos propio de Groovy, ademÃ¡s de los anteriormente conocidos listas y mapas.</p>
</div>
<div class="paragraph">
<p>Por Ãºltimo, echÃ¡bamos un vistazo a las estructuras de control que podÃ­amos utilizar en Groovy y a la combinaciÃ³n de Ã©stas con los nuevos tipos de datos.</p>
</div>
<div class="paragraph">
<p>En esta sesiÃ³n, veremos a fondo un nuevo concepto llamado <em>closure</em>. Ya hemos comentado algo sobre ellos en la sesiÃ³n anterior, pero en esta veremos todas sus caracterÃ­sticas.</p>
</div>
<div class="paragraph">
<p>Una vez vistos los closures, pasaremos a hablar sobre las caracterÃ­sticas de Groovy como lenguaje orientado a objetos y terminaremos viendo un concepto conocido como <em>metaprogramaciÃ³n</em> que te permitirÃ¡ extender la funcionalidad del lenguaje Groovy de forma muy sencilla.</p>
</div>
<div class="sect2">
<h3 id="_closures">2.1. Closures</h3>
<div class="paragraph">
<p>Aunque en apartados anteriores ya hayamos visto algunos ejemplos de closures, es conveniente dedicarle mÃ¡s tiempo a su explicaciÃ³n, ya que son una de las partes mÃ¡s importantes del lenguaje Groovy y mÃ¡s utilizados en Grails, y al mismo tiempo, puede ser un concepto difÃ­cil de entender, ya que no aparece en otros lenguajes de programaciÃ³n. AsÃ­ que volveremos a ver lo que son los closures, como se declaran y como pueden ser posteriormente referenciados.</p>
</div>
<div class="paragraph">
<p>MÃ¡s adelante, pasaremos a ver otros mÃ©todos disponibles en los closures y el Ã¡mbito de aplicaciÃ³n de los mismos, es decir, quien puede acceder a los mismos. Finalmente, definiremos varias tareas comunes que pueden ser realizadas con los closures, que hasta ahora se hacen de otras formas.</p>
</div>
<div class="sect3">
<h4 id="_definiciÃ³n_de_closure">2.1.1. DefiniciÃ³n de closure</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">DefiniciÃ³n</div>
<div class="paragraph">
<p>Un <em>closure</em> es un trozo de cÃ³digo empaquetado como un objeto y definido entre llaves. ActÃºa como un mÃ©todo, al cual se le pueden pasar parÃ¡metros y pueden devolver valores. Es un objeto normal y corriente al cual se pasa una referencia de la misma forma que se le pasa a cualquier otro objeto.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Posiblemente estÃ©s pensando, que de momento los closures no te aportan nada que no puedas hacer nada con cualquier otro lenguaje de programaciÃ³n y posiblemente sea cierto. Sin embargo, los closures nos aportan agilidad a la hora de programar, que es lo que en principio buscamos utilizando un lenguaje como Groovy.</p>
</div>
</div>
<div class="sect3">
<h4 id="_declarando_closures">2.1.2. Declarando closures</h4>
<div class="paragraph">
<p>Como comentÃ¡bamos anteriormente, los closures son bloques de cÃ³digo encerrado entre llaves {}. Y para entrar en calor, vamos a definir un closure para imprimir nuestro nombre.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">nombre</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Juan&#39;</span>
<span class="tok-kt">def</span> <span class="tok-n">imprimeNombre</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">println</span> <span class="tok-s2">&quot;Mi nombre es $nombre&quot;</span><span class="tok-o">}</span>

<span class="tok-n">imprimeNombre</span><span class="tok-o">()</span>

<span class="tok-n">nombre</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Yolanda&quot;</span>
<span class="tok-n">imprimeNombre</span><span class="tok-o">()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En primer lugar, cabe destacar en el ejemplo el uso de una variable dentro del closure definido fuera del Ã¡mbito del mismo. Es lo que se conoce <em>free variable</em>.</p>
</div>
<div class="paragraph">
<p>AdemÃ¡s, te habrÃ¡s dado cuenta de que el closure que acabamos de crear no estÃ¡ parametrizado, con lo que si se cambiara el nombre de nuestra variable, el closure no se ejecutarÃ­a correctamente. Para definir parÃ¡metros en nuestros closures, podemos hacerlo al inicio del mismo introduciendo el nombre de nuestros parÃ¡metros (separados por comas si hay mÃ¡s de uno) seguido de los caracteres &#8594;. El ejemplo anterior parametrizado quedarÃ­a asÃ­:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">imprimeNombre</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">nombre</span> <span class="tok-o">-&gt;</span> <span class="tok-n">println</span> <span class="tok-s2">&quot;Mi nombre es ${nombre}&quot;</span><span class="tok-o">}</span>

<span class="tok-n">imprimeNombre</span><span class="tok-o">(</span><span class="tok-s2">&quot;Juan&quot;</span><span class="tok-o">)</span>
<span class="tok-n">imprimeNombre</span> <span class="tok-s2">&quot;Yolanda&quot;</span> <span class="tok-c1">//Los parÃ©ntesis son opcionales</span>

<span class="tok-c1">//Con mÃºltiples parÃ¡metros</span>
<span class="tok-kt">def</span> <span class="tok-n">quintetoInicial</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">base</span><span class="tok-o">,</span> <span class="tok-n">escolta</span><span class="tok-o">,</span> <span class="tok-n">alero</span><span class="tok-o">,</span> <span class="tok-n">alapivot</span><span class="tok-o">,</span> <span class="tok-n">pivot</span> <span class="tok-o">-&gt;</span> <span class="tok-n">println</span> <span class="tok-s2">&quot;Quinteto inicial compuesto por: $base, $escolta, $alero, $alapivot y $pivot&quot;</span><span class="tok-o">}</span>

<span class="tok-n">quintetoInicial</span> <span class="tok-s2">&quot;CalderÃ³n&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;Navarro&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;JimÃ©nez&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;Garbajosa&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;Pau Gasol&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En aquellos closures que sÃ³lo tienen un parÃ¡metro, es posible obviar su declaraciÃ³n al inicio del closure, puesto que Groovy pone a nuestra disposiciÃ³n la variable <em>it</em>. El siguiente ejemplo es idÃ©ntico al closure <em>imprimeNombre</em> anterior, pero sin declarar sus parÃ¡metros.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">imprimeNombre</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">println</span> <span class="tok-s2">&quot;Mi nombre es $it&quot;</span> <span class="tok-o">}</span>

<span class="tok-n">imprimeNombre</span><span class="tok-o">(</span><span class="tok-s2">&quot;Juan&quot;</span><span class="tok-o">)</span>
<span class="tok-n">imprimeNombre</span> <span class="tok-s2">&quot;Yolanda&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Por Ãºltimo, existe otra forma de declarar un closure y es aprovechando un mÃ©todo ya existente. Con el operador <em>referencia &amp;</em> podemos declarar un closure a partir de un mÃ©todo de una clase ya creada. El siguiente ejemplo, tenemos la clase MetodoClosureEjemplo, en la que existe un mÃ©todo para comprobar si la longitud de la cadena pasada por parÃ¡metro es superior a un lÃ­mite. A partir de este mÃ©todo, crearemos un closure sobre dos instancias de esta clase creadas con lÃ­mites diferentes. Se puede comprobar como ejecutando el mismo mÃ©todo, obtenemos resultado diferentes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">MetodoClosureEjemplo</span> <span class="tok-o">{</span>
    <span class="tok-kt">int</span> <span class="tok-n">limite</span>

    <span class="tok-nf">MetodoClosureEjemplo</span> <span class="tok-o">(</span><span class="tok-kt">int</span> <span class="tok-n">limite</span><span class="tok-o">){</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">limite</span> <span class="tok-o">=</span> <span class="tok-n">limite</span>
    <span class="tok-o">}</span>

    <span class="tok-kt">boolean</span> <span class="tok-nf">validar</span> <span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">valor</span><span class="tok-o">){</span>
        <span class="tok-k">return</span> <span class="tok-n">valor</span><span class="tok-o">.</span><span class="tok-na">length</span><span class="tok-o">()</span> <span class="tok-o">&lt;=</span> <span class="tok-n">limite</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-n">MetodoClosureEjemplo</span> <span class="tok-n">primero</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MetodoClosureEjemplo</span><span class="tok-o">(</span><span class="tok-mi">8</span><span class="tok-o">)</span>
<span class="tok-n">MetodoClosureEjemplo</span> <span class="tok-n">segundo</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MetodoClosureEjemplo</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">)</span>

<span class="tok-n">Closure</span> <span class="tok-n">primerClosure</span> <span class="tok-o">=</span> <span class="tok-n">primero</span><span class="tok-o">.&amp;</span><span class="tok-n">validar</span>

<span class="tok-kt">def</span> <span class="tok-n">palabras</span> <span class="tok-o">=</span> <span class="tok-o">[</span><span class="tok-s2">&quot;cadena larga&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;mediana&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;corta&quot;</span><span class="tok-o">]</span>

<span class="tok-k">assert</span> <span class="tok-s2">&quot;mediana&quot;</span> <span class="tok-o">==</span> <span class="tok-n">palabras</span><span class="tok-o">.</span><span class="tok-na">find</span><span class="tok-o">(</span><span class="tok-n">primerClosure</span><span class="tok-o">)</span>
<span class="tok-k">assert</span> <span class="tok-s2">&quot;corta&quot;</span> <span class="tok-o">==</span> <span class="tok-n">palabras</span><span class="tok-o">.</span><span class="tok-na">find</span><span class="tok-o">(</span><span class="tok-n">segundo</span><span class="tok-o">.&amp;</span><span class="tok-n">validar</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Con la variable <em>primero</em> estamos creando una instancia de la clase <em>MetodoClosureEjemplo</em> que validarÃ¡ aquellas palabras que tengan como mucho 8 caracteres, mientras que la variable <em>segundo</em> validarÃ¡ aquellas palabras con 5 caracteres o menos. Posteriormente, el closure <em>primerClosure</em> devolverÃ¡ la primera palabra encontrada con 8 o menos caracteres y de la lista de palabras coincidirÃ­a con la palabra "mediana". En el segundo closure, el que valida la palabras de 5 o menos caracteres, la palabra devuelta serÃ­a "corta".</p>
</div>
<div class="paragraph">
<p>Otra caracterÃ­stica interesante de los closures se refiere a la posibilidad de ejecutar diferentes mÃ©todos en funciÃ³n de los parÃ¡metros pasados y se conoce como <em>multimÃ©todo</em>. La idea es crear una clase que sobrecarga un determinado mÃ©todo y posteriormente crear un closure a partir de ese mÃ©todo sobrecargado.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">MultimetodoClosureEjemplo</span><span class="tok-o">{</span>

    <span class="tok-kt">int</span> <span class="tok-nf">metodoSobrecargado</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">cadena</span><span class="tok-o">){</span>
        <span class="tok-k">return</span> <span class="tok-n">cadena</span><span class="tok-o">.</span><span class="tok-na">length</span><span class="tok-o">()</span>
    <span class="tok-o">}</span>

    <span class="tok-kt">int</span> <span class="tok-nf">metodoSobrecargado</span><span class="tok-o">(</span><span class="tok-n">List</span> <span class="tok-n">lista</span><span class="tok-o">){</span>
        <span class="tok-k">return</span> <span class="tok-n">lista</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">()</span>
    <span class="tok-o">}</span>

    <span class="tok-kt">int</span> <span class="tok-nf">metodoSobrecargado</span><span class="tok-o">(</span><span class="tok-kt">int</span> <span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-kt">int</span> <span class="tok-n">y</span><span class="tok-o">){</span>
        <span class="tok-k">return</span> <span class="tok-n">x</span> <span class="tok-o">*</span> <span class="tok-n">y</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-n">MultimetodoClosureEjemplo</span> <span class="tok-n">instancia</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MultimetodoClosureEjemplo</span><span class="tok-o">()</span>
<span class="tok-n">Closure</span> <span class="tok-n">multiclosure</span> <span class="tok-o">=</span> <span class="tok-n">instancia</span><span class="tok-o">.&amp;</span><span class="tok-n">metodoSobrecargado</span>

<span class="tok-k">assert</span> <span class="tok-mi">21</span> <span class="tok-o">==</span> <span class="tok-n">multiclosure</span><span class="tok-o">(</span><span class="tok-s2">&quot;una cadena cualquiera&quot;</span><span class="tok-o">)</span>
<span class="tok-k">assert</span> <span class="tok-mi">4</span> <span class="tok-o">==</span> <span class="tok-n">multiclosure</span><span class="tok-o">([</span><span class="tok-s1">&#39;una&#39;</span><span class="tok-o">,</span><span class="tok-s1">&#39;lista&#39;</span><span class="tok-o">,</span><span class="tok-s1">&#39;de&#39;</span><span class="tok-o">,</span><span class="tok-s1">&#39;valores&#39;</span><span class="tok-o">])</span>
<span class="tok-k">assert</span> <span class="tok-mi">21</span> <span class="tok-o">==</span> <span class="tok-n">multiclosure</span><span class="tok-o">(</span><span class="tok-mi">7</span><span class="tok-o">,</span> <span class="tok-mi">3</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_los_closures_como_objetos">2.1.3. Los closures como objetos</h4>
<div class="paragraph">
<p>Anteriormente comentÃ¡bamos que los closures son objetos y que como tales, pueden ser pasados como parÃ¡metros a funciones. Un ejemplo de este caso que ya hemos visto con anterioridad es el mÃ©todo <em>each()</em> de las listas, al cual se le puede pasar un closure para realizar una determinada operaciÃ³n sobre cada elemento de la lista.</p>
</div>
<div class="paragraph">
<p>Si echamos un vistazo al API de Groovy, veremos que el mÃ©todo each recibe como parÃ¡metro un objecto de tipo <em>Closure</em> <a href="http://groovy.codehaus.org/api/org/codehaus/groovy/runtime/DefaultGroovyMethods.html" class="bare">http://groovy.codehaus.org/api/org/codehaus/groovy/runtime/DefaultGroovyMethods.html</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">quintetoInicial</span> <span class="tok-o">=</span> <span class="tok-o">[</span><span class="tok-s2">&quot;CalderÃ³n&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;Navarro&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;JimÃ©nez&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;Garbajosa&quot;</span><span class="tok-o">,</span> <span class="tok-s2">&quot;Pau Gasol&quot;</span><span class="tok-o">]</span>

<span class="tok-n">salida</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;&#39;</span>
<span class="tok-n">quintetoInicial</span><span class="tok-o">.</span><span class="tok-na">each</span> <span class="tok-o">{</span>
    <span class="tok-n">salida</span> <span class="tok-o">+=</span> <span class="tok-n">it</span> <span class="tok-o">+</span><span class="tok-s1">&#39;, &#39;</span>
<span class="tok-o">}</span>
<span class="tok-k">assert</span> <span class="tok-n">salida</span><span class="tok-o">.</span><span class="tok-na">take</span><span class="tok-o">(</span><span class="tok-n">salida</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">()-</span><span class="tok-mi">2</span><span class="tok-o">)</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;CalderÃ³n, Navarro, JimÃ©nez, Garbajosa, Pau Gasol&#39;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_usos_de_los_closures">2.1.4. Usos de los closures</h4>
<div class="paragraph">
<p>Ahora que ya sabemos como declarar los closures, vamos a ver como utilizarlos y como podemos invocarlos. Si tenemos definido un <em>Closure x</em>  y queremos llamarlo podemos hacerlo de dos formas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>x.call()</p>
</li>
<li>
<p>x()</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">suma</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">y</span> <span class="tok-o">-&gt;</span>
<span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span>
<span class="tok-k">assert</span> <span class="tok-mi">10</span> <span class="tok-o">==</span> <span class="tok-n">suma</span><span class="tok-o">(</span><span class="tok-mi">7</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">)</span>
<span class="tok-k">assert</span> <span class="tok-mi">13</span> <span class="tok-o">==</span> <span class="tok-n">suma</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">(</span><span class="tok-mi">7</span><span class="tok-o">,</span><span class="tok-mi">6</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuaciÃ³n, veremos un ejemplo sobre como pasar un closure como parÃ¡metro a un mÃ©todo. El ejemplo nos permitirÃ¡ tener un campo de pruebas para comprobar que cÃ³digo es mÃ¡s rÃ¡pido.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-nf">campodepruebas</span><span class="tok-o">(</span><span class="tok-n">repeticiones</span><span class="tok-o">,</span> <span class="tok-n">Closure</span> <span class="tok-n">proceso</span><span class="tok-o">){</span>
   <span class="tok-n">inicio</span> <span class="tok-o">=</span> <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">currentTimeMillis</span><span class="tok-o">()</span>
   <span class="tok-n">repeticiones</span><span class="tok-o">.</span><span class="tok-na">times</span><span class="tok-o">{</span><span class="tok-n">proceso</span><span class="tok-o">(</span><span class="tok-n">it</span><span class="tok-o">)}</span>
   <span class="tok-n">fin</span> <span class="tok-o">=</span> <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">currentTimeMillis</span><span class="tok-o">()</span>
   <span class="tok-k">return</span> <span class="tok-n">fin</span> <span class="tok-o">-</span> <span class="tok-n">inicio</span>
<span class="tok-o">}</span>

<span class="tok-n">lento</span> <span class="tok-o">=</span> <span class="tok-n">campodepruebas</span><span class="tok-o">(</span><span class="tok-mi">999999</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">(</span><span class="tok-kt">int</span><span class="tok-o">)</span> <span class="tok-n">it</span> <span class="tok-s">/ 2 }</span>
<span class="tok-s">rapido = campodepruebas(999999) { it.intdiv(2) }</span>

<span class="tok-s">/</span><span class="tok-o">/</span><span class="tok-n">El</span> <span class="tok-n">m</span><span class="tok-err">Ã©</span><span class="tok-n">todo</span> <span class="tok-n">lento</span> <span class="tok-n">es</span> <span class="tok-n">al</span> <span class="tok-n">menos</span> <span class="tok-mi">3</span> <span class="tok-n">m</span><span class="tok-err">Ã¡</span><span class="tok-n">s</span> <span class="tok-n">lento</span> <span class="tok-n">que</span> <span class="tok-n">el</span> <span class="tok-n">r</span><span class="tok-err">Ã¡</span><span class="tok-n">pido</span>
<span class="tok-k">assert</span> <span class="tok-n">rapido</span> <span class="tok-o">*</span> <span class="tok-mi">3</span> <span class="tok-o">&lt;</span> <span class="tok-n">lento</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Cuando ejecutamos <em>campodepruebas(999999)</em> le estamos pasando el primer parÃ¡metro, el que indica el nÃºmero de repeticiones del cÃ³digo a ejecutar, mientras que el cÃ³digo encerrado entre llaves se corresponde con el <em>Closure</em> pasado como segundo parÃ¡metro. Cuando definimos un mÃ©todo que recibe como parÃ¡metro un closure, es obligatorio que Ã©ste sea definido el Ãºltimo parÃ¡metro del mÃ©todo.</p>
</div>
</div>
<div class="sect3">
<h4 id="_valores_por_defecto">2.1.5. Valores por defecto</h4>
<div class="paragraph">
<p>Hasta el momento, siempre que hemos creado un closure con parÃ¡metros, le hemos pasado tantas variables como parÃ¡metros tenÃ­a el closure. Sin embargo, al igual que en los mÃ©todos, es posible establecer un valor por defecto para los parÃ¡metros de un closure de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">suma</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-o">=</span><span class="tok-mi">3</span> <span class="tok-o">-&gt;</span>
  <span class="tok-n">suma</span> <span class="tok-o">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span>
<span class="tok-k">assert</span> <span class="tok-mi">7</span> <span class="tok-o">==</span> <span class="tok-n">suma</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">)</span>
<span class="tok-k">assert</span> <span class="tok-mi">7</span> <span class="tok-o">==</span> <span class="tok-n">suma</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mÃ¡s_mÃ©todos_de_los_closures">2.1.6. MÃ¡s mÃ©todos de los closures</h4>
<div class="paragraph">
<p>La clase <em>groovy.lang.Closure</em> (<a href="http://groovy.codehaus.org/api/groovy/lang/Closure.html" class="bare">http://groovy.codehaus.org/api/groovy/lang/Closure.html</a>) es una clase como cualquier otra, aunque es cierto que con una potencia increÃ­ble. Hasta ahora, sÃ³lo hemos visto la existencia del mÃ©todo <em>call()</em>, pero existen muchos mÃ¡s, de los que vamos a ver los mÃ¡s importantes.</p>
</div>
<div class="paragraph">
<p>Es probable que en alguna ocasiÃ³n necesites conocer el nÃºmero de parÃ¡metros pasados a un closure para saber como actuar y para ello, los Closures disponen del mÃ©todo <em>getParameterTypes()</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-nf">llamador</span> <span class="tok-o">(</span><span class="tok-n">Closure</span> <span class="tok-n">closure</span><span class="tok-o">){</span>
    <span class="tok-n">closure</span><span class="tok-o">.</span><span class="tok-na">getParameterTypes</span><span class="tok-o">().</span><span class="tok-na">size</span><span class="tok-o">()</span>
<span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-n">llamador</span> <span class="tok-o">{</span> <span class="tok-n">uno</span> <span class="tok-o">-&gt;</span> <span class="tok-o">}</span> <span class="tok-o">==</span> <span class="tok-mi">1</span>
<span class="tok-k">assert</span> <span class="tok-n">llamador</span> <span class="tok-o">{</span> <span class="tok-n">uno</span><span class="tok-o">,</span> <span class="tok-n">dos</span> <span class="tok-o">-&gt;</span> <span class="tok-o">}</span> <span class="tok-o">==</span> <span class="tok-mi">2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Existe una tÃ©cnica en programaciÃ³n llamada <em>currying</em> en honor a su creador <em>Haskell Brooks Curry</em>, que consiste en transformar una funciÃ³n con mÃºltiples parÃ¡metros en otra con menos parÃ¡metros. Un ejemplo puede ser la funciÃ³n que suma dos valores. Si tenemos esta funciÃ³n con dos parÃ¡metros, y queremos crear otra que acepte un sÃ³lo parÃ¡metro, estÃ¡ claro que debe ser perdiendo el segundo parÃ¡metro, lo que conlleva a sumar siempre el mismo valor en esta nueva funciÃ³n. El mÃ©todo <em>curry()</em> devuelve un clon de la funciÃ³n principal, eliminando uno o mÃ¡s parÃ¡metros de la misma.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">suma</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">y</span> <span class="tok-o">-&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span> <span class="tok-o">}</span>
<span class="tok-kt">def</span> <span class="tok-n">sumaUno</span> <span class="tok-o">=</span> <span class="tok-n">suma</span><span class="tok-o">.</span><span class="tok-na">curry</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">)</span>

<span class="tok-k">assert</span> <span class="tok-nf">suma</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">)</span> <span class="tok-o">==</span> <span class="tok-mi">7</span>
<span class="tok-k">assert</span> <span class="tok-nf">sumaUno</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">)</span> <span class="tok-o">==</span> <span class="tok-mi">6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El nuevo closure <em>sumaUno</em> siempre toma como segundo parÃ¡metro el valor 1.</p>
</div>
</div>
<div class="sect3">
<h4 id="_valores_devueltos_en_los_closures">2.1.7. Valores devueltos en los closures</h4>
<div class="paragraph">
<p>Los <em>closures</em> tienen dos formas de devolver valores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>De forma implÃ­cita</em>. El resultado de la Ãºltima expresiÃ³n evaluada por el closure, es lo que Ã©ste devuelve. Esto lo que hemos hecho hasta ahora.</p>
</li>
<li>
<p><em>De forma explÃ­cita</em>. La palabra reservada <em>return</em> tambiÃ©n nos servirÃ¡ en los closures para devolver valores</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>En el siguiente cÃ³digo de ejemplo, ambos closures tienen el mismo efecto, que es la duplicaciÃ³n de los valores de la lista.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-k">assert</span> <span class="tok-o">[</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">6</span><span class="tok-o">]</span> <span class="tok-o">==</span> <span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">,</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">].</span><span class="tok-na">collect</span> <span class="tok-o">{</span> <span class="tok-n">it</span> <span class="tok-o">*</span> <span class="tok-mi">2</span> <span class="tok-o">}</span>
<span class="tok-k">assert</span> <span class="tok-o">[</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">6</span><span class="tok-o">]</span> <span class="tok-o">==</span> <span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">,</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">].</span><span class="tok-na">collect</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">it</span> <span class="tok-o">*</span> <span class="tok-mi">2</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si queremos salir de un closure de forma prematura, tambiÃ©n podemos hacer uso del return. Por ejemplo, si en el ejemplo anterior sÃ³lo queremos duplicar aquellos valores impares, deberÃ­amos tener algo asÃ­.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-k">assert</span> <span class="tok-o">[</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">2</span><span class="tok-o">,</span> <span class="tok-mi">6</span><span class="tok-o">]</span> <span class="tok-o">==</span> <span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">,</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">].</span><span class="tok-na">collect</span> <span class="tok-o">{</span>
    <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">it</span><span class="tok-o">%</span><span class="tok-mi">2</span><span class="tok-o">==</span><span class="tok-mi">1</span><span class="tok-o">)</span>
        <span class="tok-k">return</span> <span class="tok-n">it</span> <span class="tok-o">*</span> <span class="tok-mi">2</span>
    <span class="tok-k">return</span> <span class="tok-n">it</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_groovy_como_lenguaje_orientado_a_objetos">2.2. Groovy como lenguaje orientado a objetos</h3>
<div class="paragraph">
<p>Un concepto errÃ³neo que se suele decir de los lenguajes scripts, debido a su dejadez con el tipado de datos y determinadas estructuras de control, es que son lenguajes destinados mÃ¡s a los hackers que a los programadores serios. Esta reputaciÃ³n viene de las primeras versiones del lenguaje Perl, donde la falta de encapsulaciÃ³n y la falta de otras caracterÃ­sticas tÃ­picas del modelo orientado a objetos, provocaba un mala gestiÃ³n del cÃ³digo, con frecuentes trozos de cÃ³digo duplicados e indescifrables fallos de programaciÃ³n.</p>
</div>
<div class="paragraph">
<p>Sin embargo, este panorama ha cambiado drÃ¡sticamente en los Ãºltimos aÃ±os, ya que lenguajes como el mismo Perl, Python y mÃ¡s recientemente, Ruby, han aÃ±adido caracterÃ­sticas del modelo orientado a objetos, que los hacen incluso mÃ¡s productivos que lenguajes como Java o C++. Groovy tambiÃ©n se ha subido al carro de estos lenguajes ofreciendo caracterÃ­sticas similares, con lo que ha pasado de ser un lenguaje de script basado en Java, a ser un lenguaje que nos ofrece nuevas caracterÃ­sticas del modelo orientado a objetos.</p>
</div>
<div class="paragraph">
<p>Hasta ahora hemos visto que Groovy nos ofrece tipos de datos referencia donde Java simplemente nos ofrecÃ­a tipos de datos simples, tenemos rangos y closures, y muchas estructuras de control para trabajar de forma muy Ã¡gil y sencilla con colecciones de objetos. Pero esto es sÃ³lo la punta del iceberg, y a partir de ahora veremos otras caracterÃ­sticas, que hacen de Groovy un lenguaje con mucho futuro. Empezaremos repasando las clases y los scripts en Groovy, seguiremos por la organizaciÃ³n de nuestras clases y terminaremos viendo caracterÃ­sticas avanzadas del modelo orientado a objetos en Groovy.</p>
</div>
<div class="sect3">
<h4 id="_clases_y_scripts">2.2.1. Clases y scripts</h4>
<div class="paragraph">
<p>La definiciÃ³n de clases en Groovy es prÃ¡cticamente idÃ©ntica a como se hace en Java. Las clases se declaran utilizando la palabra reservada <em>class</em> y una clase puede tener <em>campos</em>, <em>constructores</em> y <em>mÃ©todos</em>. Los mÃ©todos y los constructores pueden utilizar <em>variables locales</em>. Por otro lado tenemos los <em>scripts</em> que puede contener la definiciÃ³n de variables y mÃ©todos, asÃ­ como la declaraciÃ³n de clases.</p>
</div>
<div class="paragraph">
<p>La <strong>declaraciÃ³n de variables</strong> debe realizarse antes de que se utilicen. Declarar una variable supone indicar un nombre a la misma y un tipo, aunque en Groovy esto es opcional.</p>
</div>
<div class="paragraph">
<p>Groovy utiliza los mismos modificadores que Java, que son: <em>private</em>, <em>protected</em> y <em>public</em> para modificar la visibilidad de las variables; <em>final</em> para evitar la modificaciÃ³n de variables; y <em>static</em> para la declaraciÃ³n de las variables de la clase.</p>
</div>
<div class="paragraph">
<p>La definiciÃ³n del tipo de la variable es opcional en Groovy y cuando no se especifica, debemos introducir previamente al nombre de la variable, la palabra reserva <em>def</em>. Por Ãºltimo y aunque pueda resultar obvio, en Groovy es imposible asignar valores a variables que no coincidan en el tipo. Por ejemplo, un valor numÃ©rico no puede ser asignado a una variable definida de tipo <em>String</em>. Como vimos anteriormente, Groovy se encarga de hacer el llamado <em>autoboxing</em> siempre y cuando sea posible.</p>
</div>
<div class="paragraph">
<p>Otro aspecto interesante de Groovy es la asignaciÃ³n de valores a las propiedades de las clases. Si hemos definido un campo en una clase en Groovy, podemos acceder al valor del mismo de la forma habitual <em>objeto.campo</em> o bien <em>objeto['campo']</em>. Esto nos permite una mayor facilidad para acceder a los campos de las clases de forma dinÃ¡mica, tal y como se hace en el siguiente fragmento de cÃ³digo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">miClase</span> <span class="tok-o">{</span>
    <span class="tok-kd">public</span> <span class="tok-n">campo1</span><span class="tok-o">,</span> <span class="tok-n">campo2</span><span class="tok-o">,</span> <span class="tok-n">campo3</span><span class="tok-o">,</span> <span class="tok-n">campo4</span> <span class="tok-o">=</span> <span class="tok-mi">0</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">miobjeto</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">miClase</span><span class="tok-o">()</span>

<span class="tok-n">miobjeto</span><span class="tok-o">.</span><span class="tok-na">campo1</span> <span class="tok-o">=</span> <span class="tok-mi">2</span>
<span class="tok-k">assert</span> <span class="tok-n">miobjeto</span><span class="tok-o">.</span><span class="tok-na">campo1</span> <span class="tok-o">==</span> <span class="tok-mi">2</span>

<span class="tok-n">miobjeto</span><span class="tok-o">[</span><span class="tok-s1">&#39;campo2&#39;</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-mi">3</span>
<span class="tok-k">assert</span> <span class="tok-n">miobjeto</span><span class="tok-o">.</span><span class="tok-na">campo2</span> <span class="tok-o">==</span> <span class="tok-mi">3</span>

<span class="tok-k">for</span><span class="tok-o">(</span><span class="tok-n">i</span><span class="tok-o">=</span><span class="tok-mi">1</span><span class="tok-o">;</span><span class="tok-n">i</span><span class="tok-o">&lt;=</span><span class="tok-mi">4</span><span class="tok-o">;</span><span class="tok-n">i</span><span class="tok-o">++)</span>
    <span class="tok-n">miobjeto</span><span class="tok-o">[</span><span class="tok-s1">&#39;campo&#39;</span><span class="tok-o">+</span><span class="tok-n">i</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-n">i</span> <span class="tok-o">-</span> <span class="tok-mi">1</span>

<span class="tok-k">assert</span> <span class="tok-n">miobjeto</span><span class="tok-o">.</span><span class="tok-na">campo1</span> <span class="tok-o">==</span> <span class="tok-mi">0</span>
<span class="tok-k">assert</span> <span class="tok-n">miobjeto</span><span class="tok-o">[</span><span class="tok-s1">&#39;campo2&#39;</span><span class="tok-o">]</span> <span class="tok-o">==</span> <span class="tok-mi">1</span>
<span class="tok-k">assert</span> <span class="tok-n">miobjeto</span><span class="tok-o">.</span><span class="tok-na">campo3</span> <span class="tok-o">==</span> <span class="tok-mi">2</span>
<span class="tok-k">assert</span> <span class="tok-n">miobjeto</span><span class="tok-o">[</span><span class="tok-s1">&#39;campo4&#39;</span><span class="tok-o">]</span> <span class="tok-o">==</span> <span class="tok-mi">3</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La <strong>declaraciÃ³n de los mÃ©todos</strong> sigue los mismos criterios que acabamos de ver con las variables. Se pueden utilizar los modificadores Java, es opcional devolver algo con la sentencia <em>return</em> y si no se utilizan modificadores ni queremos especificar el tipo de dato a devolver, debemos utilizar la palabra reservada <em>def</em> para declarar nuestros mÃ©todos. Por defecto, la visibilidad de los mÃ©todos en Groovy es <em>public</em>.</p>
</div>
<div class="paragraph">
<p>Veamos una clase ejemplo y con ella, algunas diferencias con la misma clase en Java.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">MiClase</span><span class="tok-o">{</span>

       <span class="tok-kd">static</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-o">){</span>
           <span class="tok-kt">def</span> <span class="tok-n">algo</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MiClase</span><span class="tok-o">()</span>
           <span class="tok-n">algo</span><span class="tok-o">.</span><span class="tok-na">metodoPublicoVacio</span><span class="tok-o">()</span>
           <span class="tok-k">assert</span> <span class="tok-s2">&quot;hola&quot;</span> <span class="tok-o">==</span> <span class="tok-n">algo</span><span class="tok-o">.</span><span class="tok-na">metodoNoTipado</span><span class="tok-o">()</span>
           <span class="tok-k">assert</span> <span class="tok-s1">&#39;adios&#39;</span> <span class="tok-o">==</span> <span class="tok-n">algo</span><span class="tok-o">.</span><span class="tok-na">metodoTipado</span><span class="tok-o">()</span>
           <span class="tok-n">metodoCombinado</span><span class="tok-o">()</span>
       <span class="tok-o">}</span>

       <span class="tok-kt">void</span> <span class="tok-nf">metodoPublicoVacio</span><span class="tok-o">(){</span>
           <span class="tok-o">;</span>
       <span class="tok-o">}</span>

       <span class="tok-kt">def</span> <span class="tok-nf">metodoNoTipado</span><span class="tok-o">(){</span>
           <span class="tok-k">return</span> <span class="tok-s1">&#39;hola&#39;</span>
       <span class="tok-o">}</span>

       <span class="tok-n">String</span> <span class="tok-nf">metodoTipado</span><span class="tok-o">(){</span>
           <span class="tok-k">return</span> <span class="tok-s1">&#39;adios&#39;</span>
       <span class="tok-o">}</span>

       <span class="tok-kd">protected</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">void</span> <span class="tok-nf">metodoCombinado</span><span class="tok-o">(){</span>

       <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En la primera sesiÃ³n comentÃ¡bamos que el mÃ©todo <em>main</em> tÃ­pico de Java y C, ya no era necesario en Groovy, puesto que podÃ­amos ejecutar nuestro cÃ³digo sin necesidad de incluirlo en dicho mÃ©todo. Sin embargo, si queremos introducir parÃ¡metros a nuestro programa, tendremos que utilizarlo, tal y como aparece en el ejemplo. No obstante, este mÃ©todo main es algo diferente al de Java, puesto que no es necesario indicarle que el mÃ©todo es pÃºblico, ya que, por defecto y salvo que se diga que lo contrario, todo mÃ©todo en Groovy es <em>public</em>. La segunda diferencia con Java es que los argumentos debÃ­an ser del tipo <em>String[]</em> mientras que en Groovy simplemente es un objeto y no es necesario especificarle el tipo. Puesto que en la funciÃ³n main no se va a devolver nada, es posible obviar la etiqueta <em>void</em> en la declaraciÃ³n del mÃ©todo. Resumiendo, mientras que en Java tendrÃ­amos esto <em>public static void main (String[] args)</em>, en Groovy quedarÃ­a algo asÃ­ <em>static main (args)</em>.</p>
</div>
<div class="paragraph">
<p>Groovy nos ahorra tambiÃ©n bastante trabajo en cuanto a la comprobaciÃ³n de errores. En este sentido, cuando intentamos llamar a un mÃ©todo o un objeto cuya referencia es <em>null</em>, obtendremos una excepciÃ³n del tipo <em>NullPointerException</em>, lo cual es muy Ãºtil para comprobar que nuestro cÃ³digo funciona tal y como debe funcionar. Veamos un ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">mapa</span> <span class="tok-o">=</span> <span class="tok-o">[</span><span class="tok-nl">a:</span><span class="tok-o">[</span><span class="tok-nl">b:</span><span class="tok-o">[</span><span class="tok-nl">c:</span><span class="tok-mi">1</span><span class="tok-o">]]]</span>

<span class="tok-k">assert</span> <span class="tok-n">mapa</span><span class="tok-o">.</span><span class="tok-na">a</span><span class="tok-o">.</span><span class="tok-na">b</span><span class="tok-o">.</span><span class="tok-na">c</span> <span class="tok-o">==</span> <span class="tok-mi">1</span>

<span class="tok-c1">//ProtecciÃ³n con cortocircuito</span>
<span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">mapa</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-n">mapa</span><span class="tok-o">.</span><span class="tok-na">a</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-n">mapa</span><span class="tok-o">.</span><span class="tok-na">a</span><span class="tok-o">.</span><span class="tok-na">x</span><span class="tok-o">){</span>
    <span class="tok-k">assert</span> <span class="tok-n">mapa</span><span class="tok-o">.</span><span class="tok-na">a</span><span class="tok-o">.</span><span class="tok-na">x</span><span class="tok-o">.</span><span class="tok-na">c</span> <span class="tok-o">==</span> <span class="tok-kc">null</span>
<span class="tok-o">}</span>

<span class="tok-c1">//ProtecciÃ³n con un bloque try/catch</span>
<span class="tok-k">try</span><span class="tok-o">{</span>
    <span class="tok-k">assert</span> <span class="tok-n">mapa</span><span class="tok-o">.</span><span class="tok-na">a</span><span class="tok-o">.</span><span class="tok-na">x</span><span class="tok-o">.</span><span class="tok-na">c</span> <span class="tok-o">==</span> <span class="tok-kc">null</span>
<span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">NullPointerException</span> <span class="tok-n">npe</span><span class="tok-o">){}</span>

<span class="tok-c1">//ProtecciÃ³n con el operador ?.</span>
<span class="tok-k">assert</span> <span class="tok-n">mapa</span><span class="tok-o">?.</span><span class="tok-na">a</span><span class="tok-o">?.</span><span class="tok-na">x</span><span class="tok-o">?.</span><span class="tok-na">c</span> <span class="tok-o">==</span> <span class="tok-kc">null</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En el ejemplo, estamos intentando acceder a una propiedad que no existe como es <em>mapa.a.x</em>. Antes de acceder a dicha propiedad, protegemos el acceso para comprobar que no sea <em>null</em> y en caso de que no lo sea, acceder a su valor. Aparecen tres tipos de protecciÃ³n de este tipo de errores. La comprobaciÃ³n en cortocircuito con un bloque <em>if</em>, es decir, que cuando se detecte una condiciÃ³n de la expresiÃ³n que sea falsa, nos salimos del if. En segundo lugar, intentamos proteger el acceso errÃ³neo con un bloque <em>try/catch</em>. Y por Ãºltimo, con el operador <em>?.</em>, el cual no es en sÃ­ una comprobaciÃ³n y es la opciÃ³n que menos cÃ³digo emplea.</p>
</div>
<div class="paragraph">
<p>Por Ãºltimo, es necesario mencionar algo sobre los constructores en Groovy. Los constructores tienen la funciÃ³n de inicializar los objetos de una determinada clase y en caso de que no se especifique ningÃºn constructor para la clase, Ã©stos son creados directamente por el compilador. Nada que no se haga ya en Java. Sin embargo, era extraÃ±o que la gente de Groovy no hiciera algo mÃ¡s y asÃ­ es, hay mÃ¡s.</p>
</div>
<div class="paragraph">
<p>Existen dos formas de llamar a los constructores de las clases creadas en Groovy. Por un lado, el mÃ©todo tradicional pasando parÃ¡metros de forma posicional, donde el primer parÃ¡metro significa una cosa, el segundo otra y asÃ­ sucesivamente. Y por otro lado, tenemos tambiÃ©n la posibilidad de pasar los parÃ¡metros a los constructores utilizando directamente los nombres de los campos. Esta caracterÃ­stica surge debido a que pasar parÃ¡metros segÃºn su posiciÃ³n tiene el inconveniente de aquellos constructores que tienen demasiados campos y no es sencillo recordar el orden de los mismos.</p>
</div>
<div class="paragraph">
<p>Cuando creamos un objeto de una clase mediante su constructor, podemos pasarle los parÃ¡metros de tres formas diferentes en Groovy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mediante la forma tradicional, pasando parÃ¡metros en orden</p>
</li>
<li>
<p>Mediante la palabra reservada <em>as</em> y una lista de parÃ¡metros</p>
</li>
<li>
<p>Mediante una lista de parÃ¡metros</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Veamos un ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">Libro</span><span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">titulo</span><span class="tok-o">,</span> <span class="tok-n">autor</span>

    <span class="tok-n">Libro</span><span class="tok-o">(</span><span class="tok-n">titulo</span><span class="tok-o">,</span> <span class="tok-n">autor</span><span class="tok-o">){</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">titulo</span> <span class="tok-o">=</span> <span class="tok-n">titulo</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">autor</span> <span class="tok-o">=</span> <span class="tok-n">autor</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-c1">//Forma tradicional</span>
<span class="tok-kt">def</span> <span class="tok-n">primero</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Libro</span><span class="tok-o">(</span><span class="tok-s1">&#39;Groovy in action&#39;</span><span class="tok-o">,</span> <span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span><span class="tok-o">)</span>

<span class="tok-c1">//Mediante la palabra reservada as y una lista de parÃ¡metros</span>
<span class="tok-kt">def</span> <span class="tok-n">segundo</span> <span class="tok-o">=</span> <span class="tok-o">[</span><span class="tok-s1">&#39;Groovy in action&#39;</span><span class="tok-o">,</span><span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span><span class="tok-o">]</span> <span class="tok-k">as</span> <span class="tok-n">Libro</span>

<span class="tok-c1">//Mediante una lista de parÃ¡metros</span>
<span class="tok-n">Libro</span> <span class="tok-n">tercero</span> <span class="tok-o">=</span> <span class="tok-o">[</span><span class="tok-s1">&#39;Groovy in action&#39;</span><span class="tok-o">,</span><span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span><span class="tok-o">]</span>

<span class="tok-k">assert</span> <span class="tok-n">primero</span><span class="tok-o">.</span><span class="tok-na">getTitulo</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Groovy in action&#39;</span>
<span class="tok-k">assert</span> <span class="tok-n">segundo</span><span class="tok-o">.</span><span class="tok-na">getAutor</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span>
<span class="tok-k">assert</span> <span class="tok-n">tercero</span><span class="tok-o">.</span><span class="tok-na">titulo</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Groovy in action&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>AdemÃ¡s del motivo de tener que recordar el orden de los parÃ¡metros pasados al constructor de la clase, otra razÃ³n para utilizar este tipo de llamadas a los constructores es que podemos ahorrarnos la creaciÃ³n de varios constructores. Imagina el caso en que tengamos dos campos de la clase, y ambos sean opcionales. Esto supone crear cuatro constructores: sin parÃ¡metros, con uno de los campos, con el otro campo y con los dos campos. Si utilizamos este tipo de llamadas a los constructores nos ahorraremos la creaciÃ³n de estos cuatro constructores. Veamos el mismo caso que antes con la clase <em>Libro</em>. En el ejemplo, dejamos que Groovy cree por nosotros los constructores.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">Libro</span> <span class="tok-o">{</span>
  <span class="tok-n">String</span> <span class="tok-n">titulo</span><span class="tok-o">,</span> <span class="tok-n">autor</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">primero</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Libro</span><span class="tok-o">()</span>
<span class="tok-kt">def</span> <span class="tok-n">segundo</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Libro</span><span class="tok-o">(</span><span class="tok-nl">titulo:</span> <span class="tok-s1">&#39;Groovy in action&#39;</span><span class="tok-o">)</span>
<span class="tok-kt">def</span> <span class="tok-n">tercero</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Libro</span><span class="tok-o">(</span><span class="tok-nl">autor:</span> <span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span><span class="tok-o">)</span>
<span class="tok-kt">def</span> <span class="tok-n">cuarto</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Libro</span><span class="tok-o">(</span><span class="tok-nl">titulo:</span> <span class="tok-s1">&#39;Groovy in action&#39;</span><span class="tok-o">,</span> <span class="tok-nl">autor:</span> <span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span><span class="tok-o">)</span>

<span class="tok-k">assert</span> <span class="tok-n">primero</span><span class="tok-o">.</span><span class="tok-na">getTitulo</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-kc">null</span>
<span class="tok-k">assert</span> <span class="tok-n">segundo</span><span class="tok-o">.</span><span class="tok-na">titulo</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Groovy in action&#39;</span>
<span class="tok-k">assert</span> <span class="tok-n">tercero</span><span class="tok-o">.</span><span class="tok-na">getAutor</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span>
<span class="tok-k">assert</span> <span class="tok-n">cuarto</span><span class="tok-o">.</span><span class="tok-na">autor</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Dierk KÃ¶nig&#39;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_organizando_nuestras_clases_y_scripts">2.2.2. Organizando nuestras clases y scripts</h4>
<div class="paragraph">
<p>En este apartado, vamos a ver como podemos organizar nuestras clases y ficheros de la aplicaciÃ³n, y la relaciÃ³n entre ellos. TambiÃ©n veremos la utilizaciÃ³n de paquetes (<em>packages</em>) y el alias de tipos. Comencemos por la relaciÃ³n entre las clases y los ficheros fuentes.</p>
</div>
<div class="paragraph">
<p>La relaciÃ³n entre los ficheros fuente y las clases en Groovy no es tan estricta como en Java y los ficheros fuente en Groovy pueden contener tantas definiciones de clases como queramos, siguiente una serie de reglas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Si el fichero <em>.groovy</em> no tiene la declaraciÃ³n de ninguna clase, Ã©ste se trata como si fuera un <em>script</em> y automÃ¡ticamente se genera una clase de tipo <em>Script</em> con el mismo nombre que el fichero <em>.groovy</em>.</p>
</li>
<li>
<p>Si el fichero <em>.groovy</em> contiene una sola clase definida con el mismo nombre que el fichero, la relaciÃ³n es la misma que en Java, es decir, un fichero .class por cada fichero <em>.groovy</em></p>
</li>
<li>
<p>Si el fichero <em>.groovy</em> contiene mÃ¡s de una clase definida, el compilador de groovy, <em>groovyc</em>, crearÃ¡ tantos ficheros <em>.class</em> como sean necesarios para cada una de las clases definidas en el fichero <em>.groovy</em>. Si quisiÃ©ramos llamar a nuestros scripts directamente a travÃ©s de la lÃ­nea de comandos, deberÃ­amos aÃ±adir el mÃ©todo <em>main()</em> a la primera de las clases definidas en el fichero <em>.groovy</em>.</p>
</li>
<li>
<p>Un fichero Groovy puede mezclar la definiciÃ³n de clases con el cÃ³digo script. En este caso, el cÃ³digo script se convierte en la clase principal a ejecutar, con lo que no se puede declarar una clase con el mismo nombre que el fichero fuente.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Otro aspecto importante para la organizaciÃ³n de los ficheros de nuestros proyectos en Groovy es la <strong>organizaciÃ³n en paquetes</strong>. En este sentido, Groovy sigue el mismo convenio que Java y su organizaciÃ³n jerÃ¡rquica. De esta forma, la estructura de paquetes se corresponde con los ficheros <em>.class</em> de la estructura de directorios.</p>
</div>
<div class="paragraph">
<p>Sin embargo, como ya se ha comentado en la sesiÃ³n anterior, no es necesario compilar nuestros archivos <em>.groovy</em>, con lo que se aÃ±ade un problema a la hora de ejecutar dichos archivos. Si no existen los archivos compilados <em>.class</em>, Â¿dÃ³nde los va a buscar? Groovy soluciona este <em>problema</em>, buscando tambiÃ©n en los archivos <em>.groovy</em> aquellas clases necesarias. AsÃ­, que el <em>classpath</em> no sÃ³lo nos va a servir para indicar los directorios donde debe buscar los archivos <em>.class</em>, sino tambiÃ©n para decirle donde pueden estar los archivos <em>.groovy</em>, en caso de que los archivos <em>.class</em> no estÃ©n. En el caso de que Groovy encuentre en el classpath, tanto ambos archivos, <em>.groovy</em> y <em>.class</em>, se quedarÃ¡ con el mÃ¡s reciente, y asÃ­ se evitarÃ¡n los problemas producidos porque se nos haya olvidado compilar nuestro archivo <em>.groovy</em>.</p>
</div>
<div class="paragraph">
<p>Al igual que en Java, las clases Groovy deben especificar su pertenencia a un paquete antes de su declaraciÃ³n. El siguiente fragmento de cÃ³digo muestra un ejemplo de un archivo con dos clases definidas que forman parte de un mismo paquete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kn">package</span> <span class="tok-n">negocio</span>

<span class="tok-kd">class</span> <span class="tok-nc">Cliente</span> <span class="tok-o">{</span>
  <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">,</span> <span class="tok-n">producto</span>
  <span class="tok-n">Direccion</span> <span class="tok-n">direccion</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Direccion</span><span class="tok-o">()</span>
<span class="tok-o">}</span>

<span class="tok-kd">class</span> <span class="tok-nc">Direccion</span> <span class="tok-o">{</span>
  <span class="tok-n">String</span> <span class="tok-n">calle</span><span class="tok-o">,</span> <span class="tok-n">ciudad</span><span class="tok-o">,</span> <span class="tok-n">provincia</span><span class="tok-o">,</span> <span class="tok-n">pais</span><span class="tok-o">,</span> <span class="tok-n">codigopostal</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Para poder utilizar las clases declaradas <em>Cliente</em> y <em>Direccion</em>, debemos <em>importar</em> el paquete correspondiente <em>negocio</em>, tal y como aparece en el siguiente ejemplo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kn">import</span> <span class="tok-nn">negocio.*</span>

<span class="tok-kt">def</span> <span class="tok-n">clienteua</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Cliente</span><span class="tok-o">()</span>
<span class="tok-n">clienteua</span><span class="tok-o">.</span><span class="tok-na">nombre</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Universidad de Alicante&#39;</span>
<span class="tok-n">clienteua</span><span class="tok-o">.</span><span class="tok-na">producto</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;Pizarras digitales&#39;</span>

<span class="tok-k">assert</span> <span class="tok-n">clienteua</span><span class="tok-o">.</span><span class="tok-na">getNombre</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Universidad de Alicante&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El Ãºltimo aspecto importante a comentar en cuanto a la organizaciÃ³n de las clases y los archivos de nuestras aplicaciones, se refiere a la posibilidad de establecer alias a los paquetes importados. Imaginad el caso de tener dos paquetes procedentes de terceras partes que contengan una clase con el mismo nombre. En Groovy podemos solucionar este conflicto de nomenclatura utilizando los alias. Veamos como:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kn">import</span> <span class="tok-nn">agenteexterno1.OtraClase</span> <span class="tok-k">as</span> <span class="tok-n">OtraClase1</span>
<span class="tok-kn">import</span> <span class="tok-nn">agenteexterno2.OtraClase</span> <span class="tok-k">as</span> <span class="tok-n">OtraClase2</span>

<span class="tok-kt">def</span> <span class="tok-n">otraClase1</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">OtraClase1</span><span class="tok-o">()</span>
<span class="tok-kt">def</span> <span class="tok-n">otraClase2</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">OtraClase2</span><span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_caracterÃ­sticas_avanzadas_del_modelo_orientado_a_objetos">2.2.3. CaracterÃ­sticas avanzadas del modelo orientado a objetos</h4>
<div class="paragraph">
<p>Ahora que ya tenemos unos conocimientos bÃ¡sicos de lo que Groovy nos permite en cuanto al modelo orientado a objetos, pasemos a ver conceptos algo mÃ¡s avanzados de los vistos hasta ahora, como son la <em>herencia</em>, los <em>interfaces</em> y los <em>multimÃ©todos</em>.</p>
</div>
<div class="paragraph">
<p>Cuando hablamos de <strong>herencia</strong> en el modelo orientado a objetos, nos referimos a la posibilidad de aÃ±adir campos y mÃ©todos a una clase a partir de una clase base. Groovy permite la herencia en los mismos tÃ©rminos que lo hace Java. Es mÃ¡s, una clase Groovy puede extender una clase Java y viceversa.</p>
</div>
<div class="paragraph">
<p>Groovy tambiÃ©n soporta el modelo de <em>interfaces</em> de Java. En Java, un interface es una clase especial en la que todos sus mÃ©todos son abstractos y pÃºblicos. Sin embargo, estos mÃ©todos no estÃ¡n implementados en la clase interface, sino que esa labor se deja para la clase que implemente esa interface. Los interfaces son lo mÃ¡s parecido a la herencia mÃºltiple, ya que una clase puede implementar mÃ¡s de un interface pero sÃ³lo puede extender una clase.</p>
</div>
<div class="paragraph">
<p>Por Ãºltimo, comentar que en Groovy el tipo de los datos se elige de manera dinÃ¡mica cuando Ã©stos son pasados como parÃ¡metros a los mÃ©todos de nuestras clases. Esta caracterÃ­stica de Groovy se le conoce como <em>multimÃ©todo</em> y lo mejor es que veamos un ejemplo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-nf">multimetodo</span><span class="tok-o">(</span><span class="tok-n">Object</span> <span class="tok-n">o</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-s1">&#39;objeto&#39;</span> <span class="tok-o">}</span>
<span class="tok-kt">def</span> <span class="tok-nf">multimetodo</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">o</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-s1">&#39;string&#39;</span> <span class="tok-o">}</span>

<span class="tok-n">Object</span> <span class="tok-n">x</span> <span class="tok-o">=</span> <span class="tok-mi">1</span>
<span class="tok-n">Object</span> <span class="tok-n">y</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;foo&#39;</span>

<span class="tok-k">assert</span> <span class="tok-s1">&#39;objeto&#39;</span> <span class="tok-o">==</span> <span class="tok-n">multimetodo</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">)</span>
<span class="tok-k">assert</span> <span class="tok-s1">&#39;string&#39;</span> <span class="tok-o">==</span> <span class="tok-n">multimetodo</span><span class="tok-o">(</span><span class="tok-n">y</span><span class="tok-o">)</span><span class="tok-c1">//En Java, esta llamada hubiera devuelto la palabra &#39;objeto&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En el ejemplo anterior, el tipo de datos estÃ¡tico de la variable <em>x</em> es <em>Object</em> mientras que su tipo dinÃ¡mico es <em>Integer</em>, mientras que el tipo estÃ¡tico de <em>y</em> es <em>Object</em> mientras que su tipo dinÃ¡mico es <em>String</em>. Debido a que Groovy intenta utilizar el tipo dinÃ¡mico de las variables, en el segundo caso se ejecuta el mÃ©todo que tiene como parÃ¡metro una variable de tipo String.</p>
</div>
</div>
<div class="sect3">
<h4 id="_groovybeans">2.2.4. GroovyBeans</h4>
<div class="paragraph">
<p>En Java, los JavaBeans se introdujeron en su momento para definir un modelo de componentes para la construcciÃ³n de aplicaciones Java. BÃ¡sicamente el modelo consiste en una serie de convenciones en cuanto a los nombres que permiten a las clases Java comunicarse unas con otras. Groovy utiliza tambiÃ©n el concepto inherente a los JavaBeans, pero lo transforma para dar paso a los GroovyBeans, con unas mejoras particulares, como facilitar el acceso a los mÃ©todos. Vayamos paso a paso.</p>
</div>
<div class="paragraph">
<p>Empecemos por la declaraciÃ³n de los GroovyBeans. Imaginemos que tenemos de nuevo la clase Libro con tan solo la propiedad tÃ­tulo. En Java tendrÃ­amos el siguiente JavaBean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Libro</span> <span class="tok-kd">implements</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">io</span><span class="tok-o">.</span><span class="tok-na">Serializable</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">titulo</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getTitulo</span><span class="tok-o">(){</span>
        <span class="tok-k">return</span> <span class="tok-n">titulo</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setTitulo</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">valor</span><span class="tok-o">){</span>
        <span class="tok-n">titulo</span> <span class="tok-o">=</span> <span class="tok-n">valor</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Mientras que en Groovy, simplemente necesitarÃ­amos tener esto otro:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">Libro</span> <span class="tok-kd">implements</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">io</span><span class="tok-o">.</span><span class="tok-na">Serializable</span> <span class="tok-o">{</span>
  <span class="tok-n">String</span> <span class="tok-n">titulo</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Las diferencias son evidentes, Â¿no crees? Pero no sÃ³lo es una cuestiÃ³n de ahorro en cÃ³digo, sino tambiÃ©n de eficiencia. Imagina simplemente que por cualquier motivo, tuvieras que cambiar el nombre al campo <em>titulo</em>, ese simple cambio en Java supondrÃ­a cambiar el cÃ³digo en tres lugares diferentes, sin embargo, en Groovy, simplemente cambiando el nombre de la propiedad lo tendrÃ­amos todo. AdemÃ¡s, Groovy tambiÃ©n nos ahorra tener que escribir los mÃ©todos <em>setTitulo()</em> y <em>getTitulo()</em>. Esto lo hace Ãºnicamente cuando no se han especificado dichos mÃ©todos en el GroovyBean. AdemÃ¡s, Groovy sabe perfectamente cuando debe especificar un mÃ©todo <em>set</em> para acceder a una propiedad. Por ejemplo, si establecemos que una propiedad de nuestro GroovyBean es <em>final</em>, esta propiedad solamente serÃ¡ de lectura, asÃ­ que Groovy no implementa su correspondiente mÃ©todo <em>set</em>.</p>
</div>
<div class="paragraph">
<p>De igual forma, Groovy tambiÃ©n permite el acceso a las propiedades utilizando el operador ., como por ejemplo <em>libro.titulo = 'Groovy in action'</em>. Pero, como siempre, hay algo mÃ¡s. Observemos detenidamente el siguiente ejemplo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">Persona</span> <span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">,</span> <span class="tok-n">apellidos</span>

    <span class="tok-n">String</span> <span class="tok-nf">getNombreCompleto</span><span class="tok-o">(){</span>
        <span class="tok-k">return</span> <span class="tok-s2">&quot;$nombre $apellidos&quot;</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">juan</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Persona</span><span class="tok-o">(</span><span class="tok-nl">nombre:</span><span class="tok-s2">&quot;Juan&quot;</span><span class="tok-o">)</span>
<span class="tok-n">juan</span><span class="tok-o">.</span><span class="tok-na">apellidos</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;MartÃ­nez&quot;</span>

<span class="tok-k">assert</span> <span class="tok-n">juan</span><span class="tok-o">.</span><span class="tok-na">nombreCompleto</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Juan MartÃ­nez&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Tenemos el mÃ©todo <em>getNombreCompleto()</em> para obtener el nombre completo de la persona en cuestiÃ³n. Pues Groovy ademÃ¡s, crea al vuelo una propiedad equivalente al mÃ©todo <em>get()</em>, en nuestro caso, <em>nombreCompleto</em>.</p>
</div>
<div class="paragraph">
<p>En ocasiones, los mÃ©todos <em>get()</em> no tienen porque devolver el valor concreto del campo en cuestiÃ³n, sino que es posible que hayan hecho algÃºn tratamiento sobre dicho campo para modificar el valor devuelto. Imaginemos una clase que duplique el valor de su Ãºnica propiedad cuando se invoca por los mÃ©todos tradicionales (bien mediante el mÃ©todo get o mediante el operador .).</p>
</div>
<div class="paragraph">
<p>AdemÃ¡s, Groovy tambiÃ©n nos ofrece la posibilidad de recuperar el valor original del campo sin pasar por su correspondiente getter con el operador <em>@</em>, tal y como aparece en la Ãºltima lÃ­nea de este ejemplo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">DobleValor</span> <span class="tok-o">{</span>
    <span class="tok-kt">def</span> <span class="tok-n">valor</span>

    <span class="tok-kt">void</span> <span class="tok-nf">setValor</span><span class="tok-o">(</span><span class="tok-n">valor</span><span class="tok-o">){</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">valor</span> <span class="tok-o">=</span> <span class="tok-n">valor</span>
    <span class="tok-o">}</span>

    <span class="tok-kt">def</span> <span class="tok-nf">getValor</span><span class="tok-o">(){</span>
        <span class="tok-n">valor</span> <span class="tok-o">*</span> <span class="tok-mi">2</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">doble</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">DobleValor</span><span class="tok-o">(</span><span class="tok-nl">valor:</span> <span class="tok-mi">300</span><span class="tok-o">)</span>

<span class="tok-k">assert</span> <span class="tok-mi">600</span> <span class="tok-o">==</span> <span class="tok-n">doble</span><span class="tok-o">.</span><span class="tok-na">getValor</span><span class="tok-o">()</span>
<span class="tok-k">assert</span> <span class="tok-mi">600</span> <span class="tok-o">==</span> <span class="tok-n">doble</span><span class="tok-o">.</span><span class="tok-na">valor</span>
<span class="tok-k">assert</span> <span class="tok-mi">300</span> <span class="tok-o">==</span> <span class="tok-n">doble</span><span class="tok-o">.</span><span class="tok-nd">@valor</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_operador">2.2.5. Operador *</h4>
<div class="paragraph">
<p>Groovy presenta ademÃ¡s, otra caracterÃ­stica conocida como el operador <em>spread *</em>. Este operador permite pasar una lista a un mÃ©todo que contiene una serie de parÃ¡metros. De esta forma, se consigue en cierta forma sobrecargar el mÃ©todo en cuestiÃ³n como si permitiese tambiÃ©n la introducciÃ³n de sus parÃ¡metros en forma de lista. Veamos un ejemplo. Imagina que tienes un mÃ©todo que devuelve una lista de resultados, los cuales deben pasados uno por uno a otro mÃ©todo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-nf">getLista</span><span class="tok-o">(){</span>
    <span class="tok-k">return</span> <span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">,</span><span class="tok-mi">2</span><span class="tok-o">,</span><span class="tok-mi">3</span><span class="tok-o">,</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">5</span><span class="tok-o">]</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-nf">suma</span><span class="tok-o">(</span><span class="tok-n">a</span><span class="tok-o">,</span> <span class="tok-n">b</span><span class="tok-o">,</span> <span class="tok-n">c</span><span class="tok-o">,</span> <span class="tok-n">d</span><span class="tok-o">,</span> <span class="tok-n">e</span><span class="tok-o">){</span>
    <span class="tok-k">return</span> <span class="tok-n">a</span> <span class="tok-o">+</span> <span class="tok-n">b</span> <span class="tok-o">+</span> <span class="tok-n">c</span> <span class="tok-o">+</span> <span class="tok-n">d</span> <span class="tok-o">+</span> <span class="tok-n">e</span>
<span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-mi">15</span> <span class="tok-o">==</span> <span class="tok-n">suma</span><span class="tok-o">(*</span><span class="tok-n">lista</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Sencillo, y sin tener que destripar la lista en varios parÃ¡metros.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metaprogramaciÃ³n">2.3. MetaprogramaciÃ³n</h3>
<div class="sect3">
<h4 id="_definiciÃ³n_de_metaprogramaciÃ³n">2.3.1. DefiniciÃ³n de metaprogramaciÃ³n</h4>
<div class="paragraph">
<p>SegÃºn Wikipedia:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>DefiniciÃ³n de MetaprogramaciÃ³n</strong></p>
</div>
<div class="paragraph">
<p>La metaprogramaciÃ³n consiste en escribir programas que escriben o manipulen otros programas (o a sÃ­ mismos) como datos, o que hacen en tiempo de compilaciÃ³n parte del trabajo que, de otra forma, se harÃ­a en tiempo de ejecuciÃ³n. Esto permite al programador ahorrar tiempo en la producciÃ³n de cÃ³digo.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>BÃ¡sicamente esto significa que en tiempo de ejecuciÃ³n nuestro programa podrÃ¡ cambiar su funcionamiento sin necesidad de ser compilado nuevamente.</p>
</div>
</div>
<div class="sect3">
<h4 id="_metaprogramaciÃ³n_en_groovy">2.3.2. MetaprogramaciÃ³n en Groovy</h4>
<div class="paragraph">
<p>Entre las mejores cualidades de Groovy como lenguaje de programaciÃ³n destaca las facilidades que presenta para realizar dicha metaprogramaciÃ³n. Â¿Y cuÃ¡les son estas caracterÃ­sticas?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Todo mÃ©todo de cualquier objecto invocado desde Groovy pasa por un intermediario (MOP - MetaObjectProtocol)</p>
</li>
<li>
<p>Posibilidad de interceptar llamadas a mÃ©todos o acceso a propiedades</p>
</li>
<li>
<p>Crear y modificar mÃ©todos en tiempo de ejecuciÃ³n para por ejemplo extender directamente la clase <em>java.lang.String</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pero veamos algÃºn ejemplo de lo que podemos hacer con metaprogramaciÃ³n en Groovy.</p>
</div>
</div>
<div class="sect3">
<h4 id="_clase_expando">2.3.3. Clase Expando</h4>
<div class="paragraph">
<p>Groovy dispone de una clase llamada <em>Expando (<a href="http://groovy.codehaus.org/api/groovy/util/Expando.html" class="bare">http://groovy.codehaus.org/api/groovy/util/Expando.html</a>)</em>. Esta es una clase especial de Groovy que nos permitirÃ¡ aÃ±adir mÃ©todos, constructores, propiedades y mÃ©todos estÃ¡ticos utilizando una sintaxis basada en closures, tal y como demuestra el siguiente ejemplo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">miExpando</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Expando</span><span class="tok-o">()</span>

<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">factor</span> <span class="tok-o">=</span> <span class="tok-mi">5</span>

<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">multiplica</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">a</span> <span class="tok-o">-&gt;</span> <span class="tok-n">factor</span> <span class="tok-o">*</span> <span class="tok-n">a</span> <span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">multiplica</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">)</span> <span class="tok-o">==</span> <span class="tok-mi">20</span>

<span class="tok-k">assert</span> <span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">resto</span> <span class="tok-o">==</span> <span class="tok-kc">null</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Â¿MÃ¡gia? Por supuesto que no. Esto es lo que realmente estÃ¡ pasando.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">factor</span> <span class="tok-o">=</span> <span class="tok-mi">5</span>
<span class="tok-c1">//Realmente...</span>
<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">setProperty</span><span class="tok-o">(</span><span class="tok-s1">&#39;factor&#39;</span><span class="tok-o">,</span><span class="tok-mi">5</span><span class="tok-o">)</span>

<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">factor</span>
<span class="tok-c1">//Realmente...</span>
<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">getProperty</span><span class="tok-o">(</span><span class="tok-s1">&#39;factor&#39;</span><span class="tok-o">)</span>

<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">multiplica</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">)</span>
<span class="tok-c1">//Realmente...</span>
<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">invokeMethod</span><span class="tok-o">(</span><span class="tok-s1">&#39;multiplica&#39;</span><span class="tok-o">,</span> <span class="tok-o">[</span><span class="tok-mi">4</span><span class="tok-o">]</span> <span class="tok-k">as</span> <span class="tok-n">Object</span><span class="tok-o">[])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Veamos otro ejemplo de lo que supone la metaprogramaciÃ³n en Groovy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kd">class</span> <span class="tok-nc">MiExpando</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-n">dynamicProperties</span> <span class="tok-o">=</span> <span class="tok-o">[:]</span>

    <span class="tok-kt">void</span> <span class="tok-nf">setProperty</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">propName</span><span class="tok-o">,</span> <span class="tok-n">val</span><span class="tok-o">){</span>
        <span class="tok-n">dynamicProperties</span><span class="tok-o">[</span><span class="tok-n">propName</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-n">val</span>
    <span class="tok-o">}</span>

    <span class="tok-kt">def</span> <span class="tok-nf">getProperty</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">propName</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">dynamicProperties</span><span class="tok-o">[</span><span class="tok-n">propName</span><span class="tok-o">]</span>
    <span class="tok-o">}</span>

    <span class="tok-kt">def</span> <span class="tok-nf">methodMissing</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">methodName</span><span class="tok-o">,</span> <span class="tok-n">args</span><span class="tok-o">){</span>
        <span class="tok-kt">def</span> <span class="tok-n">prop</span> <span class="tok-o">=</span> <span class="tok-n">dynamicProperties</span><span class="tok-o">[</span><span class="tok-n">methodName</span><span class="tok-o">]</span>
        <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">prop</span> <span class="tok-k">instanceof</span> <span class="tok-n">Closure</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-k">return</span> <span class="tok-nf">prop</span><span class="tok-o">(*</span><span class="tok-n">args</span><span class="tok-o">)</span>
        <span class="tok-o">}</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">miExpando</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MiExpando</span><span class="tok-o">()</span>
<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">a</span> <span class="tok-o">=</span> <span class="tok-mi">4</span>
<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">b</span> <span class="tok-o">=</span> <span class="tok-mi">5</span>
<span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">suma</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">y</span> <span class="tok-o">-&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span> <span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">a</span> <span class="tok-o">==</span> <span class="tok-mi">4</span>
<span class="tok-k">assert</span> <span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">b</span> <span class="tok-o">==</span> <span class="tok-mi">5</span>
<span class="tok-k">assert</span> <span class="tok-n">miExpando</span><span class="tok-o">.</span><span class="tok-na">suma</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">5</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Como podrÃ¡s imaginar, la nueva clase <em>MiExpando</em> que acabamos de crear tiene la misma funcionalidad que la clase de Groovy <em>Expando</em>. Por supuesto, la magia reside en los mÃ©todos <em>setProperty(String, Object)</em>, <em>getProperty(String)</em> y <em>methodMissing(String, Object[])</em>. Cuando en Groovy se realiza una llamada a un mÃ©todo que no existe, se intenta llamar al mÃ©todo <em>methodMissing(String, Object[])</em> con lo que si sobrecargamos ese mÃ©todo vamos a poder hacer cualquier cosa, como por ejemplo invocar un closure o bien escribir un log indicando que alguien ha llamada a un mÃ©todo que no existe.</p>
</div>
</div>
<div class="sect3">
<h4 id="_objeto_delegate">2.3.4. Objeto delegate</h4>
<div class="paragraph">
<p>Todo closure tiene asociado un objeto conocido como <em>delegate</em> que puede ser cualquier tipo de objeto y es la forma de tener un objeto que responda a determinadas llamadas a mÃ©todos y propiedades.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">miclosure</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
    <span class="tok-n">concat</span> <span class="tok-s2">&quot; Mundo!&quot;</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hola&quot;</span>
<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">delegate</span> <span class="tok-o">=</span> <span class="tok-n">s</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Hola Mundo!&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Pero, Â¿quÃ© pasarÃ­a si tuviÃ©ramos un mÃ©todo <em>concat(String)</em>? Â¿CuÃ¡l de los dos mÃ©todos se ejecutarÃ­a al realizar la llamada desde el closure?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-nf">concat</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">arg</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-s2">&quot;Concat llamado con arg = $arg&quot;</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">miclosure</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
    <span class="tok-n">concat</span> <span class="tok-s2">&quot; Mundo!&quot;</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hola&quot;</span>
<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">delegate</span> <span class="tok-o">=</span> <span class="tok-n">s</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Concat llamado con arg =  Mundo!&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Como vÃ©is, el mÃ©todo invocado ha sido el que hemos creado con lo que el objeto <em>delegate</em> no ha sido contemplado dentro del closure a la hora de invocar el mÃ©todo <em>concat(String)</em>. AquÃ­ es donde surge el concepto de la estrategia que tienen los closures para resolver las llamadas a mÃ©todos y tenemos cuatro estrategÃ­as diferentes: <em>OWNER_FIRST</em>, <em>DELEGATE_FIRST</em>, <em>OWNER_ONLY</em> y <em>DELEGATE_ONLY</em> y en funciÃ³n de que estrategÃ­a se utilice, la llamada al mÃ©todo concat se resolverÃ¡ de una forma u otra. Por defecto, la estrategia seguida si no se indica otra es <em>OWNER_FIRST</em>. Comentar tambiÃ©n que cada closure tiene un <em>owner (propietario)</em> y que siempre es aquel objeto o clase que cree el closure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-nf">concat</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">arg</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-s2">&quot;Concat llamado con arg = $arg&quot;</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">miclosure</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
    <span class="tok-n">concat</span> <span class="tok-s2">&quot; Mundo!&quot;</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hola&quot;</span>
<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">delegate</span> <span class="tok-o">=</span> <span class="tok-n">s</span>

<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">resolveStrategy</span> <span class="tok-o">==</span> <span class="tok-n">Closure</span><span class="tok-o">.</span><span class="tok-na">OWNER_FIRST</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Concat llamado con arg =  Mundo!&quot;</span>

<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">resolveStrategy</span> <span class="tok-o">=</span> <span class="tok-n">Closure</span><span class="tok-o">.</span><span class="tok-na">OWNER_FIRST</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Concat llamado con arg =  Mundo!&quot;</span>

<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">resolveStrategy</span> <span class="tok-o">=</span> <span class="tok-n">Closure</span><span class="tok-o">.</span><span class="tok-na">DELEGATE_FIRST</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Hola Mundo!&quot;</span>

<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">resolveStrategy</span> <span class="tok-o">=</span> <span class="tok-n">Closure</span><span class="tok-o">.</span><span class="tok-na">OWNER_ONLY</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Concat llamado con arg =  Mundo!&quot;</span>

<span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">resolveStrategy</span> <span class="tok-o">=</span> <span class="tok-n">Closure</span><span class="tok-o">.</span><span class="tok-na">DELEGATE_ONLY</span>
<span class="tok-k">assert</span> <span class="tok-n">miclosure</span><span class="tok-o">.</span><span class="tok-na">call</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Hola Mundo!&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Comentar por Ãºltimo que, el object <em>delegate</em> por defecto de cualquier closure siempre serÃ¡ el propietario del closure.</p>
</div>
</div>
<div class="sect3">
<h4 id="_metaclass">2.3.5. Metaclass</h4>
<div class="paragraph">
<p>Toda clase creada en Groovy tiene un objeto asociado conocido como <em>metaClass</em>. Este objeto es del tipo <em>MetaClassImpl (<a href="http://groovy.codehaus.org/gapi/groovy/lang/MetaClassImpl.html" class="bare">http://groovy.codehaus.org/gapi/groovy/lang/MetaClassImpl.html</a>)</em> y gracias a Ã©l vamos a poder por ejemplo extender en tiempo de ejecuciÃ³n cualquier clase, como por ejemplo <em>java.lang.String</em>.</p>
</div>
<div class="paragraph">
<p>Habitualmente, en cualquier proyecto con Groovy tendremos una clase llamada StringUtils donde solemos meter todo tipo de mÃ©todos estÃ¡ticos para realizar operaciones sobre las cadenas de caracteres. Sin embargo, con Groovy vamos a poder extender la clase <em>java.lang.String</em> sin necesidad de crear una nueva clase extendida. Para ello utilizaremos el objeto <em>metaClass</em> que, recordad, tienen todos las clases creadas en Groovy.</p>
</div>
<div class="paragraph">
<p>En el siguiente ejemplo vamos a modificar en tiempo de ejecuciÃ³n la clase <em>java.lang.String</em> para aÃ±adir un nuevo mÃ©todo que corte aquellas cadenas de caracteres a los primeros 140 caracteres.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">textoLargo</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;&quot;&quot;La metaprogramaciÃ³n consiste en escribir programas que escriben o manipulan otros programas</span>
<span class="tok-s2">(o a sÃ­ mismos) como datos, o que hacen en tiempo de compilaciÃ³n parte del trabajo que, de</span>
<span class="tok-s2">otra forma, se harÃ­a en tiempo de ejecuciÃ³n. Esto permite al programador ahorrar tiempo en</span>
<span class="tok-s2">la producciÃ³n de cÃ³digo.&quot;&quot;&quot;</span>

<span class="tok-kt">def</span> <span class="tok-n">textoCorto</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;La metaprogramaciÃ³n consiste en escribir programas que escriben o manipulan otros programas&quot;</span>

<span class="tok-k">assert</span> <span class="tok-n">textoLargo</span> <span class="tok-k">instanceof</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">lang</span><span class="tok-o">.</span><span class="tok-na">String</span>
<span class="tok-k">assert</span> <span class="tok-n">textoCorto</span> <span class="tok-k">instanceof</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">lang</span><span class="tok-o">.</span><span class="tok-na">String</span>


<span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">metaClass</span><span class="tok-o">.</span><span class="tok-na">cortaLosPrimeros140Caracteres</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
    <span class="tok-n">delegate</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">()</span> <span class="tok-o">&gt;=</span> <span class="tok-mi">140</span> <span class="tok-o">?</span> <span class="tok-s2">&quot;${delegate.take(137)}...&quot;</span> <span class="tok-o">:</span> <span class="tok-n">delegate</span>
<span class="tok-o">}</span>

<span class="tok-n">println</span> <span class="tok-n">textoLargo</span><span class="tok-o">.</span><span class="tok-na">cortaLosPrimeros140Caracteres</span><span class="tok-o">()</span>
<span class="tok-n">println</span> <span class="tok-n">textoCorto</span><span class="tok-o">.</span><span class="tok-na">cortaLosPrimeros140Caracteres</span><span class="tok-o">()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>AdemÃ¡s de las clases, las objetos creados en Groovy tambiÃ©n tienen el objeto <em>metaClass</em> con lo que en ocasiones es posible que nos interese simplemente modificar el comportamiento de un sÃ³lo objeto y no de todos los objetos de una determinada clase. Esto nos serÃ¡ de gran utilidad cuando veamos la parte de los tests unitarios en Grails.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">texto1</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;texto 1&quot;</span>
<span class="tok-kt">def</span> <span class="tok-n">texto2</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;texto 2&quot;</span>

<span class="tok-n">texto1</span><span class="tok-o">.</span><span class="tok-na">metaClass</span><span class="tok-o">.</span><span class="tok-na">foo</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
    <span class="tok-s2">&quot;${delegate}foo&quot;</span>
<span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-n">texto1</span><span class="tok-o">.</span><span class="tok-na">foo</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;texto 1foo&quot;</span>

<span class="tok-k">try</span> <span class="tok-o">{</span>
    <span class="tok-k">assert</span> <span class="tok-n">texto2</span><span class="tok-o">.</span><span class="tok-na">foo</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;texto 2foo&quot;</span>
<span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">MissingMethodException</span> <span class="tok-n">mme</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">println</span> <span class="tok-s2">&quot;El mÃ©todo foo no existe&quot;</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Es importante saber, que cuando no necesitemos los mÃ©todos especifados en el objeto <em>metaClass</em> debemos referenciar dicho objeto a <em>null</em> para evitar problemas.</p>
</div>
<div class="paragraph">
<p>AdemÃ¡s de poder crear nuevo mÃ©todos, tambiÃ©n vamos a poder sobreescribir aquellos ya existentes en la propia clase por nuestra propia implementaciÃ³n. En el siguiente ejemplo vamos a modificar el comportamiento del mÃ©todo <em>substring(int beginIndex)</em> de la clase <em>java.lang.String</em> para que el Ã­ndice pasado por parÃ¡metro empiece por el nÃºmero 1.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">texto</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;En Groovy podemos sobreescribir mÃ©todos ya existentes&quot;</span>

<span class="tok-kt">def</span> <span class="tok-n">textoZeroBased</span> <span class="tok-o">=</span> <span class="tok-n">texto</span><span class="tok-o">.</span><span class="tok-na">substring</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">)</span>

<span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">metaClass</span><span class="tok-o">.</span><span class="tok-na">substring</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-kt">int</span> <span class="tok-n">beginIndex</span> <span class="tok-o">-&gt;</span>
      <span class="tok-n">delegate</span><span class="tok-o">[</span><span class="tok-n">beginIndex</span><span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">..</span><span class="tok-na">delegate</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">()-</span><span class="tok-mi">1</span><span class="tok-o">]</span>
<span class="tok-o">}</span>

<span class="tok-kt">def</span> <span class="tok-n">textoOneBased</span> <span class="tok-o">=</span> <span class="tok-n">texto</span><span class="tok-o">.</span><span class="tok-na">substring</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">)</span>

<span class="tok-k">assert</span> <span class="tok-n">textoOneBased</span> <span class="tok-o">==</span> <span class="tok-n">textoZeroBased</span>

<span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">metaClass</span> <span class="tok-o">=</span> <span class="tok-kc">null</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si lo que estamos sobrecargando es un mÃ©todo estÃ¡tico, debemos hacer referencia a la metaclase de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">metaClass</span><span class="tok-o">.</span><span class="tok-s1">&#39;static&#39;</span><span class="tok-o">.</span><span class="tok-na">valueOf</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-n">Boolean</span> <span class="tok-n">b</span> <span class="tok-o">-&gt;</span>
    <span class="tok-n">b</span> <span class="tok-o">?</span> <span class="tok-s2">&quot;false&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;true&quot;</span>
<span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-s2">&quot;false&quot;</span> <span class="tok-o">==</span> <span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-kc">true</span><span class="tok-o">)</span>
<span class="tok-k">assert</span> <span class="tok-s2">&quot;true&quot;</span> <span class="tok-o">==</span> <span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-kc">false</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_groovy_builders">2.4. Groovy Builders</h3>
<div class="paragraph">
<p>Los <em>Builders</em> en Groovy se utilizan para hacer que determinadas tareas complejas se conviertan en un juego de niÃ±os. Con ellos veremos que la construcciÃ³n de archivos XML, la automatizaciÃ³n de tareas con Ant o el diseÃ±o de interfaces grÃ¡ficas se facilita muchÃ­simo. Veremos como generar archivo XML y JSON gracias a estos builders.</p>
</div>
<div class="sect3">
<h4 id="_markupbuilder">2.4.1. MarkupBuilder</h4>
<div class="paragraph">
<p>Los archivos XML son un tipo de archivo ampliamente extendido para el intercambio de informaciÃ³n entre aplicaciones, asÃ­ que Groovy quiere ayudarnos en esa labor, tratando que escribamos el cÃ³digo para construir esos archivos XML de la forma mÃ¡s sencilla y clara posible y el <em>builder</em> encargado de esa labor es <em>MarkupBuilder</em>, el cual nos ayudarÃ¡ a escribir tanto archivos XML como HTML.</p>
</div>
<div class="paragraph">
<p>El ejemplo que vamos a ver consiste en crear un archivo XML referido a facturas de una empresa. Cada factura contendrÃ¡ una serie de Ã­tems, cada uno con un producto.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">builder</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">groovy</span><span class="tok-o">.</span><span class="tok-na">xml</span><span class="tok-o">.</span><span class="tok-na">MarkupBuilder</span><span class="tok-o">()</span>
<span class="tok-kt">def</span> <span class="tok-n">facturas</span> <span class="tok-o">=</span> <span class="tok-n">builder</span><span class="tok-o">.</span><span class="tok-na">facturas</span> <span class="tok-o">{</span>
    <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">dia</span> <span class="tok-k">in</span> <span class="tok-mi">1</span><span class="tok-o">..</span><span class="tok-mi">3</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">factura</span><span class="tok-o">(</span><span class="tok-nl">fecha:</span> <span class="tok-k">new</span> <span class="tok-n">Date</span><span class="tok-o">()</span> <span class="tok-o">-</span> <span class="tok-n">dia</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-n">item</span><span class="tok-o">(</span><span class="tok-nl">id:</span><span class="tok-n">dia</span><span class="tok-o">){</span>
                <span class="tok-n">producto</span><span class="tok-o">(</span><span class="tok-nl">nombre:</span> <span class="tok-s1">&#39;Teclado&#39;</span><span class="tok-o">,</span> <span class="tok-nl">euros:</span><span class="tok-mi">876</span><span class="tok-o">)</span>
            <span class="tok-o">}</span>
        <span class="tok-o">}</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-n">facturas</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lo que producirÃ­a el siguiente archivo XML.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-o">&lt;</span><span class="tok-n">facturas</span><span class="tok-o">&gt;</span>
  <span class="tok-o">&lt;</span><span class="tok-n">factura</span> <span class="tok-n">fecha</span><span class="tok-o">=</span><span class="tok-s1">&#39;Sun Jan 03 00:00:00 CET 2014&#39;</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-n">item</span> <span class="tok-n">id</span><span class="tok-o">=</span><span class="tok-s1">&#39;1&#39;</span><span class="tok-o">&gt;</span>
      <span class="tok-o">&lt;</span><span class="tok-n">producto</span> <span class="tok-n">nombre</span><span class="tok-o">=</span><span class="tok-s1">&#39;Teclado&#39;</span> <span class="tok-n">euros</span><span class="tok-o">=</span><span class="tok-s1">&#39;876&#39;</span> <span class="tok-s">/&gt;</span>
<span class="tok-s">    &lt;/</span><span class="tok-n">item</span><span class="tok-o">&gt;</span>
  <span class="tok-o">&lt;</span><span class="tok-s">/factura&gt;</span>
<span class="tok-s">  &lt;factura fecha=&#39;Mon Jan 02 00:00:00 CET 2014&#39;&gt;</span>
<span class="tok-s">    &lt;item id=&#39;2&#39;&gt;</span>
<span class="tok-s">      &lt;producto nombre=&#39;Teclado&#39; euros=&#39;876&#39; /</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-s">/item&gt;</span>
<span class="tok-s">  &lt;/</span><span class="tok-n">factura</span><span class="tok-o">&gt;</span>
  <span class="tok-o">&lt;</span><span class="tok-n">factura</span> <span class="tok-n">fecha</span><span class="tok-o">=</span><span class="tok-s1">&#39;Tue Jan 01 00:00:00 CET 2014&#39;</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-n">item</span> <span class="tok-n">id</span><span class="tok-o">=</span><span class="tok-s1">&#39;3&#39;</span><span class="tok-o">&gt;</span>
      <span class="tok-o">&lt;</span><span class="tok-n">producto</span> <span class="tok-n">nombre</span><span class="tok-o">=</span><span class="tok-s1">&#39;Teclado&#39;</span> <span class="tok-n">euros</span><span class="tok-o">=</span><span class="tok-s1">&#39;876&#39;</span> <span class="tok-s">/&gt;</span>
<span class="tok-s">    &lt;/</span><span class="tok-n">item</span><span class="tok-o">&gt;</span>
  <span class="tok-o">&lt;</span><span class="tok-s">/factura&gt;</span>
<span class="tok-s">&lt;/</span><span class="tok-n">facturas</span><span class="tok-o">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede comprobar la limpieza del cÃ³digo utilizado para generar el archivo XML y prÃ¡cticamente, el cÃ³digo sigue el mismo tabulado que el posterior archivo XML, con lo que la lectura del cÃ³digo por terceras personas se facilita muchÃ­simo.</p>
</div>
<div class="paragraph">
<p>Pero <em>MarkupBuilder</em> no sÃ³lo nos va a servir para generar archivos XML, sino tambiÃ©n archivos HTML. No es raro, puesto que HTML es en el fondo XML. Veamos como construir el mismo ejemplo anterior para que se vea como una pÃ¡gina web. Un ejemplo de pÃ¡gina web podrÃ­a ser el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-o">&lt;</span><span class="tok-n">html</span><span class="tok-o">&gt;</span>
  <span class="tok-o">&lt;</span><span class="tok-n">head</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-n">title</span><span class="tok-o">&gt;</span><span class="tok-n">Facturas</span><span class="tok-o">&lt;</span><span class="tok-s">/title&gt;</span>
<span class="tok-s">  &lt;/</span><span class="tok-n">head</span><span class="tok-o">&gt;</span>
  <span class="tok-o">&lt;</span><span class="tok-n">body</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-n">h1</span><span class="tok-o">&gt;</span><span class="tok-n">Facturas</span><span class="tok-o">&lt;</span><span class="tok-s">/h1&gt;</span>
<span class="tok-s">    &lt;ul&gt;</span>
<span class="tok-s">      &lt;li&gt;Sun Jan 03 00:00:00 CET 2015&lt;/</span><span class="tok-n">li</span><span class="tok-o">&gt;</span>
      <span class="tok-o">&lt;</span><span class="tok-n">ul</span><span class="tok-o">&gt;</span>
        <span class="tok-o">&lt;</span><span class="tok-n">li</span><span class="tok-o">&gt;</span><span class="tok-mi">1</span><span class="tok-o">.-</span> <span class="tok-n">Teclado</span> <span class="tok-o">=&gt;</span> <span class="tok-mi">876</span><span class="tok-n">euros</span><span class="tok-o">&lt;</span><span class="tok-s">/li&gt;</span>
<span class="tok-s">      &lt;/</span><span class="tok-n">ul</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-s">/ul&gt;</span>
<span class="tok-s">    &lt;ul&gt;</span>
<span class="tok-s">      &lt;li&gt;Sun Jan 02 00:00:00 CET 2015&lt;/</span><span class="tok-n">li</span><span class="tok-o">&gt;</span>
      <span class="tok-o">&lt;</span><span class="tok-n">ul</span><span class="tok-o">&gt;</span>
        <span class="tok-o">&lt;</span><span class="tok-n">li</span><span class="tok-o">&gt;</span><span class="tok-mi">2</span><span class="tok-o">.-</span> <span class="tok-n">Teclado</span> <span class="tok-o">=&gt;</span> <span class="tok-mi">876</span><span class="tok-n">euros</span><span class="tok-o">&lt;</span><span class="tok-s">/li&gt;</span>
<span class="tok-s">      &lt;/</span><span class="tok-n">ul</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-s">/ul&gt;</span>
<span class="tok-s">    &lt;ul&gt;</span>
<span class="tok-s">      &lt;li&gt;Sun Jan 01 00:00:00 CET 2015&lt;/</span><span class="tok-n">li</span><span class="tok-o">&gt;</span>
      <span class="tok-o">&lt;</span><span class="tok-n">ul</span><span class="tok-o">&gt;</span>
        <span class="tok-o">&lt;</span><span class="tok-n">li</span><span class="tok-o">&gt;</span><span class="tok-mi">3</span><span class="tok-o">.-</span> <span class="tok-n">Teclado</span> <span class="tok-o">=&gt;</span> <span class="tok-mi">876</span><span class="tok-n">euros</span><span class="tok-o">&lt;</span><span class="tok-s">/li&gt;</span>
<span class="tok-s">      &lt;/</span><span class="tok-n">ul</span><span class="tok-o">&gt;</span>
    <span class="tok-o">&lt;</span><span class="tok-s">/ul&gt;</span>
<span class="tok-s">  &lt;/</span><span class="tok-n">body</span><span class="tok-o">&gt;</span>
<span class="tok-o">&lt;/</span><span class="tok-n">html</span><span class="tok-o">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Este ejemplo de HTML se podrÃ­a construir con el siguiente cÃ³digo, haciendo uso de MarkupBuilder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">builder</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">groovy</span><span class="tok-o">.</span><span class="tok-na">xml</span><span class="tok-o">.</span><span class="tok-na">MarkupBuilder</span><span class="tok-o">()</span>

<span class="tok-n">builder</span><span class="tok-o">.</span><span class="tok-na">html</span> <span class="tok-o">{</span>
    <span class="tok-n">head</span> <span class="tok-o">{</span>
        <span class="tok-n">title</span> <span class="tok-s1">&#39;Facturas&#39;</span>
    <span class="tok-o">}</span>

    <span class="tok-n">body</span> <span class="tok-o">{</span>
        <span class="tok-n">h1</span> <span class="tok-s1">&#39;Facturas&#39;</span>

        <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">dia</span> <span class="tok-k">in</span> <span class="tok-mi">1</span><span class="tok-o">..</span><span class="tok-mi">3</span><span class="tok-o">){</span>
            <span class="tok-n">ul</span><span class="tok-o">{</span>
                <span class="tok-n">li</span> <span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">Date</span><span class="tok-o">()</span> <span class="tok-o">-</span> <span class="tok-n">dia</span><span class="tok-o">).</span><span class="tok-na">toString</span><span class="tok-o">()</span>
                <span class="tok-n">ul</span> <span class="tok-o">{</span>
                    <span class="tok-n">li</span> <span class="tok-s2">&quot;$dia.- Teclado =&gt; 876euros&quot;</span>
                <span class="tok-o">}</span>
            <span class="tok-o">}</span>
        <span class="tok-o">}</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El cÃ³digo HTML generado por MarkupBuilder serÃ¡ compatible con los estÃ¡ndares y no tendremos incluso que preocuparnos por la conversiÃ³n de determinados caracteres como el sÃ­mbolo &lt; (&amp;lt;), ya que Ã©l mismo serÃ¡ el encargado de realizar dicha conversiÃ³n.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jsonbuilder">2.4.2. JsonBuilder</h4>
<div class="paragraph">
<p>Si en lugar de generar XML queremos generar JSON, Groovy tambiÃ©n dispone de otro builder que nos permite generar estos JSON de forma muy sencilla y de forma muy similar a como veiamos con el generador de XML. Veamos un ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-kt">def</span> <span class="tok-n">builder</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">groovy</span><span class="tok-o">.</span><span class="tok-na">json</span><span class="tok-o">.</span><span class="tok-na">JsonBuilder</span><span class="tok-o">()</span>
<span class="tok-kt">def</span> <span class="tok-n">root</span> <span class="tok-o">=</span> <span class="tok-n">builder</span><span class="tok-o">.</span><span class="tok-na">teachers</span> <span class="tok-o">{</span>
   <span class="tok-n">professor</span> <span class="tok-o">{</span>
       <span class="tok-n">firstName</span> <span class="tok-s1">&#39;Fran&#39;</span>
       <span class="tok-n">lastName</span> <span class="tok-s1">&#39;Garcia&#39;</span>
       <span class="tok-n">address</span><span class="tok-o">(</span>
               <span class="tok-nl">city:</span> <span class="tok-s1">&#39;Oxford&#39;</span><span class="tok-o">,</span>
               <span class="tok-nl">country:</span> <span class="tok-s1">&#39;UK&#39;</span><span class="tok-o">,</span>
               <span class="tok-nl">zip:</span> <span class="tok-mi">12345</span><span class="tok-o">,</span>
       <span class="tok-o">)</span>
       <span class="tok-n">married</span> <span class="tok-kc">true</span>
       <span class="tok-n">modules</span> <span class="tok-s1">&#39;Groovy&#39;</span><span class="tok-o">,</span><span class="tok-s1">&#39;Grails&#39;</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-k">assert</span> <span class="tok-n">root</span> <span class="tok-k">instanceof</span> <span class="tok-n">Map</span>

<span class="tok-k">assert</span> <span class="tok-n">builder</span><span class="tok-o">.</span><span class="tok-na">toString</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;{&quot;teachers&quot;:{&quot;professor&quot;:{&quot;firstName&quot;:&quot;Fran&quot;,&quot;lastName&quot;:&quot;Garcia&quot;,&quot;address&quot;:{&quot;city&quot;:&quot;Oxford&quot;,&quot;country&quot;:&quot;UK&quot;,&quot;zip&quot;:12345},&quot;married&quot;:true,&quot;modules&quot;:[&quot;Groovy&quot;,&quot;Grails&quot;]}}}&#39;</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="_ejercicios">2.5. Ejercicios</h3>
<div class="sect3">
<h4 id="_closures_sobre_colecciones_0_25_puntos">2.5.1. Closures sobre colecciones (0.25 puntos)</h4>
<div class="paragraph">
<p>Implementar un closure que realice la operaciÃ³n matemÃ¡tica factorial del nÃºmero pasado como parÃ¡metro.</p>
</div>
<div class="paragraph">
<p>A continuaciÃ³n crear una lista o un mapa de nÃºmeros enteros y utilizar algunos de los mÃ©todos vistos para recorrer la lista o el mapa, generar el nÃºmero factorial de cada uno de sus elementos con el closure que hemos creado acabamos de crear y mostrarlo por pantalla.</p>
</div>
<div class="paragraph">
<p>Por Ãºltimo, crear dos closures llamados ayer y maÃ±ana que devuelvan las fechas correspondientes a los dÃ­as anterior y posterior a la fecha pasada. Podemos crear fechas mediante la sentencia <em>new Date().parse("d/M/yyyy H:m:s","28/6/2008 00:30:20")</em>.</p>
</div>
<div class="paragraph">
<p>Posteriormente, crear una lista de fechas y utilizar los closures reciÃ©n creados para obtener las fechas del dÃ­a anterior y posterior a todos los elementos de la lista.</p>
</div>
</div>
<div class="sect3">
<h4 id="_clase_completa_en_groovy_0_5_puntos">2.5.2. Clase completa en Groovy (0.5 puntos)</h4>
<div class="paragraph">
<p>Crear una clase llamada <em>Calculadora</em> que permita la realizaciÃ³n de cÃ¡lculos matemÃ¡ticos con dos nÃºmero enteros. Estos cÃ¡lculos serÃ¡n la suma, resta, multiplicaciÃ³n y divisiÃ³n.</p>
</div>
<div class="paragraph">
<p>Los parÃ¡metros serÃ¡n solicitados como entrada a la aplicaciÃ³n. Para leer parÃ¡metros por lÃ­nea de comandos se pueda utilizar el siguiente closure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">in</span><span class="tok-o">.</span><span class="tok-na">withReader</span> <span class="tok-o">{</span>
  <span class="tok-n">print</span> <span class="tok-s1">&#39;Introduzca operador: &#39;</span>
  <span class="tok-n">op1</span> <span class="tok-o">=</span> <span class="tok-n">it</span><span class="tok-o">.</span><span class="tok-na">readLine</span><span class="tok-o">()</span>
  <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">op1</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El sistema nos debe pedir que introduzcamos los operandos asÃ­ como el tipo de operaciÃ³n que queremos realizar y mostrarÃ¡ por pantalla el resultado de la operaciÃ³n.</p>
</div>
</div>
<div class="sect3">
<h4 id="_metaprogramaciÃ³n_0_5_puntos">2.5.3. MetaprogramaciÃ³n (0.5 puntos)</h4>
<div class="paragraph">
<p>Utilizando los conceptos sobre metaprogramaciÃ³n vistos en la parte teÃ³rica, aÃ±ade un mÃ©todo llamado <em>moneda(String)</em> que recibirÃ¡ por parÃ¡metro una cadena que representa un determinado <em>locale</em> y en funciÃ³n de este <em>locale</em> imprimirÃ¡ un sÃ­mbolo u otro. Para simplificar, vamos a limitar el nÃºmero de posibles <em>locales</em> a tres: es_ES, en_EN y en_US. Para comprobar si tu mÃ©todo funciona correctamente, puedes pasarle las siguientes aserciones tras modificar adecuadamente la clase correspondiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-k">assert</span> <span class="tok-mf">10.2</span><span class="tok-o">.</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_EN&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;Â£10.2&quot;</span>
<span class="tok-k">assert</span> <span class="tok-mf">10.2</span><span class="tok-o">.</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_US&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;\$10.2&quot;</span>
<span class="tok-k">assert</span> <span class="tok-mf">10.2</span><span class="tok-o">.</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;es_ES&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;10.2â¬&quot;</span>

<span class="tok-k">assert</span> <span class="tok-mi">10</span><span class="tok-o">.</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_EN&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;Â£10&quot;</span>
<span class="tok-k">assert</span> <span class="tok-mi">10</span><span class="tok-o">.</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_US&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;\$10&quot;</span>
<span class="tok-k">assert</span> <span class="tok-mi">10</span><span class="tok-o">.</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;es_ES&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;10â¬&quot;</span>

<span class="tok-k">assert</span> <span class="tok-k">new</span> <span class="tok-nf">Float</span><span class="tok-o">(</span><span class="tok-mf">10.2</span><span class="tok-o">).</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_EN&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;Â£10.2&quot;</span>
<span class="tok-k">assert</span> <span class="tok-k">new</span> <span class="tok-nf">Float</span><span class="tok-o">(</span><span class="tok-mf">10.2</span><span class="tok-o">).</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_US&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;\$10.2&quot;</span>
<span class="tok-k">assert</span> <span class="tok-k">new</span> <span class="tok-nf">Float</span><span class="tok-o">(</span><span class="tok-mf">10.2</span><span class="tok-o">).</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;es_ES&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;10.2â¬&quot;</span>

<span class="tok-k">assert</span> <span class="tok-k">new</span> <span class="tok-nf">Double</span><span class="tok-o">(</span><span class="tok-mf">10.2</span><span class="tok-o">).</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_EN&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;Â£10.2&quot;</span>
<span class="tok-k">assert</span> <span class="tok-k">new</span> <span class="tok-nf">Double</span><span class="tok-o">(</span><span class="tok-mf">10.2</span><span class="tok-o">).</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;en_US&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;\$10.2&quot;</span>
<span class="tok-k">assert</span> <span class="tok-k">new</span> <span class="tok-nf">Double</span><span class="tok-o">(</span><span class="tok-mf">10.2</span><span class="tok-o">).</span><span class="tok-na">moneda</span><span class="tok-o">(</span><span class="tok-s2">&quot;es_ES&quot;</span><span class="tok-o">)</span> <span class="tok-o">==</span>  <span class="tok-s2">&quot;10.2â¬&quot;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-05 20:14:58 CEST
</div>
</div>
</body>
</html>