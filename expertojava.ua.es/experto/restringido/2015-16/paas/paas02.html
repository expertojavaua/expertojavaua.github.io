<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="José Luis Zamora Sánchez">
<title>Servidores web y PaaS</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Servidores web y PaaS</h1>
<div class="details">
<span id="author" class="author">José Luis Zamora Sánchez</span><br>
<span id="email" class="email">&lt;<a href="mailto:joseluiszamora.jlz@gmail.com">joseluiszamora.jlz@gmail.com</a>&gt;</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion02">2. Administración de recursos en WildFly</a>
<ul class="sectlevel2">
<li><a href="#_fichero_de_configuraci%C3%B3n_del_bootstrap">2.1. Fichero de configuración del Bootstrap</a></li>
<li><a href="#_estructura_de_los_ficheros_de_configuraci%C3%B3n">2.2. Estructura de los ficheros de configuración</a></li>
<li><a href="#_edici%C3%B3n_desde_las_herramientas_de_administraci%C3%B3n">2.3. Edición desde las herramientas de administración</a></li>
<li><a href="#_configuraci%C3%B3n_de_recursos">2.4. Configuración de recursos</a>
<ul class="sectlevel3">
<li><a href="#_configuraci%C3%B3n_de_datasources">2.4.1. Configuración de Datasources</a></li>
<li><a href="#_creaci%C3%B3n_del_datasource_y_los_pool">2.4.2. Creación del Datasource y los pool</a></li>
<li><a href="#_configuraci%C3%B3n_del_contenedor_de_ejb_s">2.4.3. Configuración del contenedor de EJB&#8217;s</a></li>
<li><a href="#_descriptores_de_despliegue">2.4.4. Descriptores de despliegue</a></li>
<li><a href="#_class_loading">2.4.5. Class Loading</a></li>
<li><a href="#_rendimiento">2.4.6. Rendimiento</a></li>
</ul>
</li>
<li><a href="#_referencias">2.5. Referencias</a></li>
<li><a href="#_ejercicios_de_administraci%C3%B3n_de_recursos_en_wildfly">2.6. Ejercicios de Administración de recursos en Wildfly</a>
<ul class="sectlevel3">
<li><a href="#_librer%C3%ADa_compartida_de_logs_0_6_puntos">2.6.1. Librería compartida de Logs (0.6 puntos)</a></li>
<li><a href="#_camino_a_eurovisi%C3%B3n_1_punto">2.6.2. Camino a Eurovisión (1 punto)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion02">2. Administración de recursos en WildFly</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sesión vamos a centrarnos en la configuración básica de una instancia de WildFly. Aunque hemos hablado de modalidades de trabajo en Dominio, vamos a centrarnos en los modos standalone por sencillez y porque no nos limitan el acceso a características de alta disponibilidad como en otros servidores.</p>
</div>
<div class="sect2">
<h3 id="_fichero_de_configuración_del_bootstrap">2.1. Fichero de configuración del Bootstrap</h3>
<div class="paragraph">
<p>Hay una cuestión básica que es definir cuanta memoria puede utilizar la aplicación. La forma de definir el tamaño del Heap en Wildfly es bien especificarlo como parámetro del script de arranque, o lo que es más facil, editar el fichero standalone.conf</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">	$JBOSS_HOME/bin/standalone.conf</span>

<span class="tok-go">	JAVA_OPTS=&quot;-XX:MaxPermSize=256m -Xms64m -Xmx512m&quot;</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">JDK 8</div>
En la máquina virtual de la versión 8 desaparece el espacio de memoria denominado Permanent Generation y en su lugar se define uno nuevo denominado Metaspace. La forma de limitarlo es muy similar:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">	$JBOSS_HOME/bin/standalone.conf</span>

<span class="tok-go">	JAVA_OPTS=&quot;-XX:MaxMetaspaceSize=256m -Xms64m -Xmx512m&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este fichero también podemos especificar una JVM de Java concreta, así como otras propiedades como por ejemplo el número de descriptores de ficheros que podrá utilizar WildFly</p>
</div>
</div>
<div class="sect2">
<h3 id="_estructura_de_los_ficheros_de_configuración">2.2. Estructura de los ficheros de configuración</h3>
<div class="paragraph">
<p>En la sesión anterior comentamos que las herramientas de administración modificación una configuración que físicamente se almacena en ficheros XML. Para cada modo de inicio (Standalone o Domain Managed) existen diferentes configuraciones de inicio, en el caso de operar como servidor independiente. Estos ficheros se encuentran dentro de la carpeta correspondiente a la modalidad (domain o standalone).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>standalone.xml Configuración por defecto, sin soporte JMS.</p>
</li>
<li>
<p>standalone-full.xml Añade soporte JMS (HornetQ).</p>
</li>
<li>
<p>standalone-ha.xml Soporte Clustering.</p>
</li>
<li>
<p>standalone-full-ha.xml Soporte Clustering y JMS.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Se puede especificar un fichero de configuración específico, distinto de la configuración por defecto con el parámetro "-c"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">./standalone.sh -c standalone-full.xml</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Los ficheros de configuración presentan la siguiente estructura:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/EstructuraCfg.png" alt="EstructuraCfg">
</div>
</div>
<div class="paragraph">
<p>El elemento raíz es la etiqueta &lt;server&gt; y de ella cuelgan los siguientes elementos:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Profiles</dt>
<dd>
<p>Los perfiles son configuraciones de servidor y sus distintos subsistemas. En la modalidad standalone, Wildfly sólo permite un perfil por fichero de configuración, sin embargo en el modo domain, es posible definir varios perfiles para distintos tipos de servidores dentro de un dominio. Ejemplo:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;profile&gt;</span>
  ...
  <span class="tok-nt">&lt;subsystem</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;urn:jboss:domain:deployment-scanner:2.0&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;deployment-scanner</span> <span class="tok-na">path=</span><span class="tok-s">&quot;deployments&quot;</span> <span class="tok-na">relative-to=</span><span class="tok-s">&quot;jboss.server.base.dir&quot;</span> <span class="tok-na">scan-interval=</span><span class="tok-s">&quot;5000&quot;</span><span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;/subsystem&gt;</span>
  ...
<span class="tok-nt">&lt;/profile&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Extensions</dt>
<dd>
<p>La mayor parte de las funcionalidades de WildFly se configuran como extensiones, que implementan especificaciones de Java EE.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;extensions&gt;</span>
    [...]
    <span class="tok-nt">&lt;extension</span> <span class="tok-na">module=</span><span class="tok-s">&quot;org.jboss.as.transactions&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;extension</span> <span class="tok-na">module=</span><span class="tok-s">&quot;org.jboss.as.web&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;extension</span> <span class="tok-na">module=</span><span class="tok-s">&quot;org.jboss.as.webservices&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;extension</span> <span class="tok-na">module=</span><span class="tok-s">&quot;org.jboss.as.weld&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/extensions&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Paths</dt>
<dd>
<p>Los paths son rutas a directorios o ficheros de la máquina a las que se les asocia un nombre lógico. Los paths pueden ser rutas absolutas o relativas a otro path, de modo que la configuración sea portable a otras máquinas:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;path</span> <span class="tok-na">name=</span><span class="tok-s">&quot;log.dir&quot;</span> <span class="tok-na">path=</span><span class="tok-s">&quot;/home/wildfly/logs&quot;</span> <span class="tok-nt">/&gt;</span>  <span class="tok-c">&lt;!-- Ruta absoluta --&gt;</span>

<span class="tok-nt">&lt;file</span> <span class="tok-na">relative-to=</span><span class="tok-s">&quot;log.dir&quot;</span> <span class="tok-na">path=</span><span class="tok-s">&quot;server.log&quot;</span><span class="tok-nt">/&gt;</span>    <span class="tok-c">&lt;!-- Ruta relativa a log.dir --&gt;</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Interfaces</dt>
<dd>
<p>Una interfaz es un nombre lógico asociado a un nombre de máquina/dirección IP a través de la cual podemos acceder a nuestro servidor. Por defecto se definen tres interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><strong>management</strong> La dirección que se utilizará para atender peticiones de administración.</p>
</li>
<li>
<p><strong>public</strong> Esta es la dirección de servicio que atenderá el acceso a las aplicaciones.</p>
</li>
<li>
<p><strong>unsecure</strong> Esta es la dirección que se utilizará para la invocación de objetos remotos IIOP.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;interface</span> <span class="tok-na">name=</span><span class="tok-s">&quot;management&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;inet-address</span> <span class="tok-na">value=</span><span class="tok-s">&quot;${jboss.bind.address.management:127.0.0.1}&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/interface&gt;</span>
<span class="tok-nt">&lt;interface</span> <span class="tok-na">name=</span><span class="tok-s">&quot;public&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;inet-address</span> <span class="tok-na">value=</span><span class="tok-s">&quot;${jboss.bind.address:127.0.0.1}&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/interface&gt;</span>
<span class="tok-nt">&lt;interface</span> <span class="tok-na">name=</span><span class="tok-s">&quot;unsecure&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;inet-address</span> <span class="tok-na">value=</span><span class="tok-s">&quot;${jboss.bind.address.unsecure:127.0.0.1}&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/interface&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Por defecto estas interfaces están vinculadas a propiedades del sistema, que se pueden incluso sobrescribir en el inicio del servidor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">./standalone.sh -Djboss.bind.address=192.168.1.100</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Socket binding groups</dt>
<dd>
<p>Un socket binding es básicamente la definición de un punto de escucha y se compone de la interfaz y del puerto de red concreto que se va a utilizar.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;socket-binding-group</span> <span class="tok-na">name=</span><span class="tok-s">&quot;standard-sockets&quot;</span> <span class="tok-na">default-interface=</span><span class="tok-s">&quot;public&quot;</span> <span class="tok-na">port-offset=</span><span class="tok-s">&quot;${jboss.socket.binding.port-offset:0}&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;socket-binding</span> <span class="tok-na">name=</span><span class="tok-s">&quot;management-http&quot;</span> <span class="tok-na">interface=</span><span class="tok-s">&quot;management&quot;</span> <span class="tok-na">port=</span><span class="tok-s">&quot;${jboss.management.http.port:9990}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;socket-binding</span> <span class="tok-na">name=</span><span class="tok-s">&quot;management-https&quot;</span> <span class="tok-na">interface=</span><span class="tok-s">&quot;management&quot;</span> <span class="tok-na">port=</span><span class="tok-s">&quot;${jboss.management.https.port:9993}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;socket-binding</span> <span class="tok-na">name=</span><span class="tok-s">&quot;ajp&quot;</span> <span class="tok-na">port=</span><span class="tok-s">&quot;${jboss.ajp.port:8009}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;socket-binding</span> <span class="tok-na">name=</span><span class="tok-s">&quot;http&quot;</span> <span class="tok-na">port=</span><span class="tok-s">&quot;${jboss.http.port:8080}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;socket-binding</span> <span class="tok-na">name=</span><span class="tok-s">&quot;https&quot;</span> <span class="tok-na">port=</span><span class="tok-s">&quot;${jboss.https.port:8443}&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;socket-binding-group/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El parámetro port-offset se utiliza para desplegar en una misma máquina distintas instancias de un servidor y asignar a cada una de ellas puertos distintos. El valor del offset se suma a todos los puertos especificados. Una buena práctica es establecer el valor de offset como propiedad del sistema en el inicio, en lugar de indicarlo de forma estática en la configuración.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">System properties</dt>
<dd>
<p>Estas propiedades de configuración del servidor, se pueden establecer de varias formas:</p>
<div class="ulist">
<ul>
<li>
<p>En el fichero de configuración</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;system-properties&gt;</span>
  <span class="tok-nt">&lt;property-name</span><span class="tok-err">=&quot;propiedad&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/system-properties&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>En el script de arranque del servidor standalone.sh o domain.sh.</p>
</li>
<li>
<p>Por línea de comandos, con elparámetro -D</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">./standalone.sh -Dpropiedad=true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_edición_desde_las_herramientas_de_administración">2.3. Edición desde las herramientas de administración</h3>
<div class="paragraph">
<p>Como ya hemos comentado, la forma más segura de modificar la configuración, es a través de las herramientas de configuración. Uno de los beneficios que reporta utilizar las herramientas es que WildFly crea automáticamente copias de seguridad de la configuración, por si nos equivocamos en algún cambio.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/revisiones.png" alt="revisiones">
</div>
</div>
<div class="paragraph">
<p>Sin embargo, en el caso concreto de JBoss, la edición de ficheros de configuración ha sido tradicionalmente la forma más efectiva de administración. Gracias a JBoss AS 7 y WildFly, las herramientas de administración comienzan a acercarse al nivel de otros productos.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Descriptores de despliegue</div>
Además de editar los ficheros de configuración del servidor, es posible codificar la mayor parte de los recursos en ficheros denominados descriptores de despliegue. Los descriptores de despliegue de WildFly complementan a los descriptores estándar de Java EE y permiten utilizar todas las características del servidor. Más información en: <a href="https://docs.jboss.org/author/display/WFLY8/Deployment+Descriptors+used+In+WildFly" class="bare">https://docs.jboss.org/author/display/WFLY8/Deployment+Descriptors+used+In+WildFly</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>La consola Web es una aplicación ligera que genera de forma automática vistas sobre la estructura de los ficheros de configuración, con lo que si conocemos la estructura del fichero, la representación Web nos resultará familiar:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ConfigConsola.png" alt="ConfigConsola">
</div>
</div>
<div class="paragraph">
<p>Cuando modifiquemos algunas propiedades que requieran recargar la configuración, la aplicación nos avisará:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/Avisos.png" alt="Avisos">
</div>
</div>
<div class="paragraph">
<p>La recarga de la configuración la podemos realizar desde la pestaña <em>Runtime</em>, opción <em>Server</em>.</p>
</div>
<div class="paragraph">
<p>Desde CLI, los cambios se pueden realizar más rápidamente, gracias a la forma de navegar y la ayuda para autocompletar rutas:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ConfigTexto.png" alt="ConfigTexto">
</div>
</div>
<div class="paragraph">
<p>Después de realizar cambios en la configuración, ésta se puede recargar mediante el comando <em>reload</em> o bien parando y arrancando de nuevo el servidor.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuración_de_recursos">2.4. Configuración de recursos</h3>
<div class="paragraph">
<p>La función más importante de un servidor de aplicaciones es la de proporcionar los recursos necesarios para que las aplicaciones puedan funcionar. A continuación repasaremos cómo configurar los recursos más habituales.</p>
</div>
<div class="sect3">
<h4 id="_configuración_de_datasources">2.4.1. Configuración de Datasources</h4>
<div class="paragraph">
<p>Para que las aplicaciones puedan tener acceso a base de datos previamente hay que definir un Datasource y un Pool de conexiones. El Pool de conexiones optimiza el acceso a base de datos creando un conjunto de conexiones antes de que las aplicaciones las lleguen a necesitar. El servidor de aplicaciones asigna estas conexiones dinámicamente a las aplicaciones y en cada asignación nos ahorramos el tiempo de conexión/desconexión a la base de datos.</p>
</div>
<div class="paragraph">
<p>Las propiedades más importantes que definen el comportamiento de un  Pool de conexiones en Wildfly son:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Min Pool Size</dt>
<dd>
<p>El número mínimo de conexiones creadas que puede tener un pool.</p>
</dd>
<dt class="hdlist1">Max Pool Size</dt>
<dd>
<p>El número maximo de conexiones creadas que puede tener un pool.</p>
</dd>
<dt class="hdlist1">Strict Minimum</dt>
<dd>
<p>Si se activa, impide que el número de conexiones pueda bajar más allá del mínimo definido (por ejemplo si las sesiones se liberan por timeout).</p>
</dd>
<dt class="hdlist1">Prefill Enabled</dt>
<dd>
<p>Si se activa, al iniciar un pool de conexiones se crean automáticamente el numero de conexiones indicado como mínimo.</p>
</dd>
<dt class="hdlist1">Flush Strategy</dt>
<dd>
<p>Especifica el modo en el que se liberan las conexiones de un pool ante un error.</p>
</dd>
<dt class="hdlist1">Idle Timeout</dt>
<dd>
<p>Especifica el tiempo en minutos que se puede mantener una conexión sin uso, antes de ser liberada.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Para poder crear una conexión a base de datos en primer lugar hay que instalar el driver jdbc correspondiente. Esto se puede hacer de dos formas:</p>
</div>
<div class="sect4">
<h5 id="_instalación_del_driver_como_módulo">Instalación del driver como módulo</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crear una estructura de directorio dentro de JBOSS_HOME/modules. En el caso de MySQL debemos crear:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">	JBOSS_HOME/modules/system/layers/base/com/mysql/driver/main</span></code></pre>
</div>
</div>
</li>
<li>
<p>Copiar el Jar dentro de la carpeta main</p>
</li>
<li>
<p>Crear un descriptor module.xml dentro de la carpeta main:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;module</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;urn:jboss:module:1.3&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;com.mysql.driver&quot;</span><span class="tok-nt">&gt;</span>
 <span class="tok-nt">&lt;resources&gt;</span>
  <span class="tok-nt">&lt;resource-root</span> <span class="tok-na">path=</span><span class="tok-s">&quot;mysql-connector-java-5.1.33.jar&quot;</span> <span class="tok-nt">/&gt;</span>
 <span class="tok-nt">&lt;/resources&gt;</span>
 <span class="tok-nt">&lt;dependencies&gt;</span>
  <span class="tok-nt">&lt;module</span> <span class="tok-na">name=</span><span class="tok-s">&quot;javax.api&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;module</span> <span class="tok-na">name=</span><span class="tok-s">&quot;javax.transaction.api&quot;</span><span class="tok-nt">/&gt;</span>
 <span class="tok-nt">&lt;/dependencies&gt;</span>
<span class="tok-nt">&lt;/module&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>Declarar el driver en el fichero standalone.xml. Añadir al subsistema datasources el nuevo driver</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;driver</span> <span class="tok-na">name=</span><span class="tok-s">&quot;mysql&quot;</span> <span class="tok-na">module=</span><span class="tok-s">&quot;com.mysql.driver&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;driver-class&gt;</span>com.mysql.jdbc.Driver<span class="tok-nt">&lt;/driver-class&gt;</span>
<span class="tok-nt">&lt;/driver&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_instalación_del_driver_como_despliegue">Instalación del driver como despliegue</h5>
<div class="paragraph">
<p>Si no tenemos permisos de administración, podemos simplemente copiar el fichero <em>.jar</em> con el driver de MySQL a la carpeta deployments del servidor. Al iniciar WildFly <strong>debemos revisar</strong> el nombre exacto del driver con el que se publica por si lo necesitamos referenciar en la creación de un datasource.</p>
</div>
<div class="paragraph">
<div class="title">Descarga del driver</div>
<p>NOTE:
El jar lo podéis descargar desde la página de MySQL o bien desde aquí: <a href="http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.33/mysql-connector-java-5.1.33.jar" class="bare">http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.33/mysql-connector-java-5.1.33.jar</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creación_del_datasource_y_los_pool">2.4.2. Creación del Datasource y los pool</h4>
<div class="paragraph">
<p>Nuevamente tenemos varias formas de configurar un Datasource, a continuación veremos los pasos para configurarlo desde la consola Web:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Definir el nombre del pool y el nombre JNDI del Datasource</p>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ds1.png" alt="ds1" width="50%">
</div>
</div>
</li>
<li>
<p>Seleccionar un driver de los instalados en el servidor:</p>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ds2.png" alt="ds2" width="50%">
</div>
</div>
</li>
<li>
<p>Configurar la cadena de conexión y el usuario/password.</p>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ds3.png" alt="ds3" width="50%">
</div>
</div>
</li>
<li>
<p>Activar el nuevo pool</p>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ds4.png" alt="ds4" width="50%">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">¿Se puede desplegar un Datasource como un Deployment?</div>
Si, se puede crear un fichero *-ds.xml con la configuración de uno o mas datasources. El fichero tiene la misma estructura que la del subsistema <em>datasources</em> del fichero standalone.xml y se puede copiar directamente a la carpeta deployments, o bien empaquetar dentro de una aplicación. Esta forma de crear datasources es recomendable en entornos de desarrollo, si bien, desde la consola web no es posible administrar este tipo de datasources.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;datasources&gt;</span>
	<span class="tok-nt">&lt;datasource</span> <span class="tok-na">jta=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-na">jndi-name=</span><span class="tok-s">&quot;java:jboss/datasources/portalDS&quot;</span> <span class="tok-na">pool-name=</span><span class="tok-s">&quot;portalDS&quot;</span> <span class="tok-na">enabled=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">use-ccm=</span><span class="tok-s">&quot;false&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;connection-url&gt;</span>jdbc:mysql://localhost:3306/experto<span class="tok-nt">&lt;/connection-url&gt;</span>
            <span class="tok-nt">&lt;driver-class&gt;</span>com.mysql.jdbc.Driver<span class="tok-nt">&lt;/driver-class&gt;</span>
            <span class="tok-nt">&lt;driver&gt;</span>mysql<span class="tok-nt">&lt;/driver&gt;</span>
            <span class="tok-nt">&lt;security&gt;</span>
                <span class="tok-nt">&lt;user-name&gt;</span>root<span class="tok-nt">&lt;/user-name&gt;</span>
                <span class="tok-nt">&lt;password&gt;</span>expertojavajs<span class="tok-nt">&lt;/password&gt;</span>
            <span class="tok-nt">&lt;/security&gt;</span>
            <span class="tok-nt">&lt;validation&gt;</span>
                <span class="tok-nt">&lt;validate-on-match&gt;</span>false<span class="tok-nt">&lt;/validate-on-match&gt;</span>
                <span class="tok-nt">&lt;background-validation&gt;</span>false<span class="tok-nt">&lt;/background-validation&gt;</span>
            <span class="tok-nt">&lt;/validation&gt;</span>
            <span class="tok-nt">&lt;statement&gt;</span>
                <span class="tok-nt">&lt;share-prepared-statements&gt;</span>false<span class="tok-nt">&lt;/share-prepared-statements&gt;</span>
            <span class="tok-nt">&lt;/statement&gt;</span>
        <span class="tok-nt">&lt;/datasource&gt;</span>
<span class="tok-nt">&lt;/datasources&gt;</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_empaquetar_datasources_en_la_aplicación">Empaquetar Datasources en la aplicación:</h5>
<div class="paragraph">
<p>Como hemos comentado el Datasource puede incluirse en las propias aplicaciones. Eso sí, la ubicación del fichero varía en función del tipo de aplicación:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 45%;">
<colgroup>
<col style="width: 37%;">
<col style="width: 62%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tipo Aplicación</th>
<th class="tableblock halign-left valign-top">Ubicación</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web App (.war)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WEB-INF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EJB (.jar)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">META-INF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise (.ear)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">META-INF (empaquetado principal)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_encriptación_del_password">Encriptación del password</h5>
<div class="paragraph">
<p>WildFly tiene la particularidad de trabajar con passwords en plano en lo que respecta a Datasources. Si la configuración está centralizada en el fichero standalone.xml puede no ser un problema si está protegido para que no sea accesible. Sin embargo si adjuntamos un datasource a una aplicación, o lo copiamos en la carpeta <em>deployments</em> puede ser muy sencillo el averiguar el usuario y la clave de la base de datos. La forma de evitar esto es trabajar con claves encriptadas.</p>
</div>
<div class="paragraph">
<p>Los pasos son los siguientes:</p>
</div>
<div class="listingblock">
<div class="title">Encriptar la password de la base de datos mediante la librería PicketBox</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-gp">expertojavajs@expertojavajs-VirtualBox:/usr/local/wildfly-8.2.1.Final/modules/system/layers/base/org/picketbox/main$</span> java -classpath picketbox-4.0.21.Final.jar org.picketbox.datasource.security.SecureIdentityLoginModule expertojavajs
<span class="tok-go">Encoded password: -46cea3eadea6ff81c9c59e773c1cfb95</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Definir un <em>security-domain</em> asociado a las credenciales, editando el fichero <em>standalone.xml</em>:</div>
<p>Para ello debemos definir un <em>security domain</em> en el servidor, editando el fichero <em>standalone.xml</em> y añadiendo la siguiente información dentro del subsistema urn:jboss:domain:security:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;security-domain</span> <span class="tok-na">name=</span><span class="tok-s">&quot;ds-encrypted&quot;</span> <span class="tok-na">cache-type=</span><span class="tok-s">&quot;default&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;authentication&gt;</span>
                <span class="tok-nt">&lt;login-module</span> <span class="tok-na">code=</span><span class="tok-s">&quot;org.picketbox.datasource.security.SecureIdentityLoginModule&quot;</span>
			<span class="tok-na">flag=</span><span class="tok-s">&quot;required&quot;</span><span class="tok-nt">&gt;</span>
                  <span class="tok-nt">&lt;module-option</span> <span class="tok-na">name=</span><span class="tok-s">&quot;username&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;root&quot;</span><span class="tok-nt">/&gt;</span>
		  <span class="tok-nt">&lt;module-option</span> <span class="tok-na">name=</span><span class="tok-s">&quot;password&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;-46cea3eadea6ff81c9c59e773c1cfb95&quot;</span><span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;module-option</span> <span class="tok-na">name=</span><span class="tok-s">&quot;managedConnectionFactoryName&quot;</span>
			<span class="tok-na">value=</span><span class="tok-s">&quot;jboss.jca:service=LocalTxCM,name=portalDS&quot;</span><span class="tok-nt">/&gt;</span>
            <span class="tok-nt">&lt;/login-module&gt;</span>
            <span class="tok-nt">&lt;/authentication&gt;</span>
        <span class="tok-nt">&lt;/security-domain&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sustituir la información de usuario/password del datasource por la referencia al <em>security domain</em> :</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;security&gt;</span>
	<span class="tok-nt">&lt;security-domain&gt;</span>ds-encrypted<span class="tok-nt">&lt;/security-domain&gt;</span>
<span class="tok-nt">&lt;/security&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuración_del_contenedor_de_ejb_s">2.4.3. Configuración del contenedor de EJB&#8217;s</h4>
<div class="paragraph">
<p>Los EJB son componentes que implementan principalmente la lógica de negocio de una aplicación Java EE y el servidor de aplicaciones proporciona mecanismos para maximizar la capacidad de proceso de estos componentes.</p>
</div>
<div class="paragraph">
<p>Los EJB&#8217;s se dividen en tres tipos:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Stateless Session Beans</dt>
<dd>
<p>Son objetos que implementan funciones de negocio pero no tienen un estado (valores en memoria).</p>
</dd>
<dt class="hdlist1">Stateful Session Beans</dt>
<dd>
<p>Son objetos que implementan funciones de negocio pero además tienen un estado, que se conserva durante la vida de la sesión.</p>
</dd>
<dt class="hdlist1">Message Driven Beans</dt>
<dd>
<p>Son objetos especializados en el proceso asíncrono de mensajes.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Los Session Beans se pueden instanciar desde cualquier componente de nuestra aplicación que se encuentre en el servidor (servlets, otros EJb&#8217;s, etc.) pero también se pueden ejecutar desde procesos externos al servidor, mediante el protocolo <em>Remoting</em> (basado en RMI). Los objetos MDB son componentes especializados que sólo se ejecutan en respuesta a mensajes enviados asíncronamente a través de lo que se denomina tópico o cola de mensajes.</p>
</div>
<div class="sect4">
<h5 id="_pool_de_ejb_s">Pool de EJB&#8217;s</h5>
<div class="paragraph">
<p>Los EJB&#8217;s son esencialmente POJO&#8217;s a los que se les añade anotaciones específicas para integrarlos dentro del ciclo de vida del contenedor de EJB&#8217;s. Así los objetos EJB se crean y se destruyen en función de la carga de trabajo. Al igual que ocurre con las conexiones a base de datos podemos definir el número de instancias de estos objetos de modo que podamos controlar los recursos destinados a ejecutar esta lógica de negocio. Esto es muy útil en momentos de picos de carga en los que un número excesivo de EJB&#8217;s en ejecución pueden degradar notablemente el rendimiento global del servidor.</p>
</div>
<div class="paragraph">
<p>Este mecanismo es factible para los objetos que no tienen estado, como los Stateless Session Bean y los Message Driven Beans, pero los stateful son objetos equiparables a la sesión HTTP: contienen información de trabajo que no se puede copiar de una sesión a otra. En este caso hay mecanismos que agilizan la carga de la información, pero en ningún caso se puede crear un pool de objetos.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Pool de Objetos en WildFly</div>
Antes de esta versión, existía una configuración de pool de objetos por defecto que aplicaba a todos los Stateless Session Bean. En WildFly por defecto el pool de objetos está desactivado pues se entiende que hoy en día la mejora de rendimiento derivada del pooling no es tan evidente y el uso como contención de capacidad de proceso dependerá de cada aplicación, y por tanto es responsabilidad del desarrollador (o administrador) el parametrizar estos valores. En el caso de MDB&#8217;s sigue estando activo un pool por defecto.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para habilitar el pool por defecto <em>slsb-strict-max-pool</em> (límite de 20 instancias y timeout de acceso de 5 minutos) hay que editar el fichero de configuración añadiendo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;subsystem</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;urn:jboss:domain:ejb3:2.0&quot;</span><span class="tok-nt">&gt;</span>
 <span class="tok-nt">&lt;session-bean&gt;</span>
  <span class="tok-nt">&lt;stateless&gt;</span>	<span class="tok-c">&lt;!-- Añadir tag stateless--&gt;</span>
   <span class="tok-nt">&lt;bean-instance-pool-ref</span> <span class="tok-na">pool-name=</span><span class="tok-s">&quot;slsb-strict-max-pool&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/stateless&gt;</span></code></pre>
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/EJBPool1.png" alt="EJBPool1">
</div>
</div>
<div class="paragraph">
<p>Para definir un nuevo pool podemos hacerlo desde CLI o a mano editando el fichero de configuración.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Desde CLI, el comando sería el siguiente:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">[standalone@localhost:9990 /] /subsystem=ejb3/strict-max-bean-instance-pool=nuevo-pool:add(max-pool-size=5,timeout-unit=SECONDS,timeout=30)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Con este comando definiremos un nuevo pool de hasta 5 instancias</p>
</div>
<div class="paragraph">
<p>El resultado en el fichero standalone-full.xml es el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"> <span class="tok-nt">&lt;subsystem</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;urn:jboss:domain:ejb3:2.0&quot;</span><span class="tok-nt">&gt;</span>
 ....
  <span class="tok-nt">&lt;pools&gt;</span>
   <span class="tok-nt">&lt;bean-instance-pools&gt;</span>
    <span class="tok-nt">&lt;strict-max-pool</span> <span class="tok-na">name=</span><span class="tok-s">&quot;nuevo-pool&quot;</span> <span class="tok-na">max-pool-size=</span><span class="tok-s">&quot;5&quot;</span> <span class="tok-na">instance-acquisition-timeout=</span><span class="tok-s">&quot;30&quot;</span> <span class="tok-na">instance-acquisition-timeout-unit=</span><span class="tok-s">&quot;SECONDS&quot;</span><span class="tok-nt">/&gt;</span>
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para asociar un pool a un EJB concreto, basta añadir una anotación en la clase correspondiente indicando el nombre del pool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Stateless</span>
<span class="tok-nd">@Pool</span> <span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;ranking-pool&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Ranking</span> <span class="tok-kd">implements</span> <span class="tok-n">RankingLocal</span> <span class="tok-o">{</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_descriptores_de_despliegue">2.4.4. Descriptores de despliegue</h4>
<div class="paragraph">
<p>Java Enterprise proporciona dos métodos para especificar aspectos de la configuración de una aplicación:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Descriptores de despliegue (Ficheros XML).</p>
</li>
<li>
<p>Anotaciones en código.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sin embargo hay propiedades especificas de Wildfly (comportamiento de los EJB&#8217;s del servidor Web Undertow, etc.) que no quedan cubiertas por el estándar Java EE y que pueden ser definidas desde la aplicación mediante ficheros de configuración propietarios. En la sección de referencias se encuentra un enlace a la lista de descriptores de WildFly, que a la fecha de este documento no estaba completa (se podría utilizar los propios de JBoss 7.1).</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_loading">2.4.5. Class Loading</h4>
<div class="paragraph">
<p>En este apartado trataremos brevemente el orden que sigue el servidor a la hora de localizar las clases que componen una aplicación. En la sesión anterior comentamos los distintos tipos de aplicaciones java y la forma de acceder a componentes compartidos. JBoss proporciona un mecanismo adicional: el uso de <em>módulos</em>.</p>
</div>
<div class="paragraph">
<p>Los módulos se dividen a su vez en</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Módulos estáticos</dt>
<dd>
<p>se integran en las carpetas de módulos del servidor y pueden ser definidos como accesibles por todos los despliegues del servidor.</p>
</dd>
<dt class="hdlist1">Módulos dinámicos</dt>
<dd>
<p>Se copian a la carpeta deployments y pueden ser reemplazados en caliente.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Si recordamos el caso del driver de MySQL veremos que hemos propuesto dos instalaciones, una como módulo estático y otra como módulo dinámico. Por defecto si añadimos un módulo dinámico, el nombre interno que tendrá el módulo en WildFly será:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">deployment.[nombre del fichero]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La forma de especificar que una aplicación necesita acceder a recursos de un módulo, (estático o dinámico) es indicarlo en el fichero <em>MANIFEST.MF</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="console"><span class="tok-go">Dependencies: deployment.WebExample1.war</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Por último, comentar el orden que sigue WildFly para resolver la ubicación de una clase Java. Ordenando de mayor prioridad a menor:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Dependencias del sistema: Son dependencias que el contenedor añade de forma automática a la aplicación, como por ejemplo el API de Java EE.</p>
</li>
<li>
<p>Dependencias de usuario: Son las que el desarrollador define a través del MANIFEST.MF, el Classpath para ficheros JAR o a través del fichero <em>jboss-deployment-structure.xml</em>.</p>
</li>
<li>
<p>Recursos locales. Son las clases que están ubicadas dentro del propio empaquetado de la aplicación, por ejemplo <em>WEB-INF/classes</em> o WEB-INF/lib de una aplicación WAR.</p>
</li>
<li>
<p>Dependencias compartidas. Son las dependencias compartidas entre varios componentes de una aplicación. Típicamente las librerías compartidas dentro de una aplicación EAR.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_rendimiento">2.4.6. Rendimiento</h4>
<div class="paragraph">
<p>Hablar de rendimiento en un servidor de aplicaciones nos permitiría llenar más de una sesión entera del curso, si bien, lo más importante es dimensionar los recursos del servidor (memoria, pool de objetos, conexiónes a base de datos) en función de la carga de trabajo que va a soportar. Dado que gran parte de la programación que se verá en el curso gira en torno a JavaScript, comentar que hay una forma muy sencilla de agilizar los tiempos de carga de las aplicaciones y consiste en habilitar la compresión GZIP en las comunicaciones con el servidor. Descargar con compresión código JavaScript o texto estático en HTML puede reducir el tiempo de descarga hasta un 90%, a costa de un mayor consumo de CPU en el servidor.</p>
</div>
<div class="paragraph">
<p>La forma de habilitarlo en WildFly consiste en definir un filtro y según el tipo de recurso aplicar compresión o no (es contraproducente comprimir recursos estáticos ya comprimidos como imágenes o documentos PDF).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;subsystem</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;urn:jboss:domain:undertow:1.0&quot;</span><span class="tok-nt">&gt;</span>
   <span class="tok-nt">&lt;buffer-caches&gt;</span>
      <span class="tok-nt">&lt;buffer-cache</span> <span class="tok-na">name=</span><span class="tok-s">&quot;default&quot;</span> <span class="tok-na">buffer-size=</span><span class="tok-s">&quot;1024&quot;</span> <span class="tok-na">buffers-per-region=</span><span class="tok-s">&quot;1024&quot;</span> <span class="tok-na">max-regions=</span><span class="tok-s">&quot;10&quot;</span><span class="tok-nt">/&gt;</span>
   <span class="tok-nt">&lt;/buffer-caches&gt;</span>
   <span class="tok-nt">&lt;server</span> <span class="tok-na">name=</span><span class="tok-s">&quot;default-server&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;http-listener</span> <span class="tok-na">name=</span><span class="tok-s">&quot;default&quot;</span> <span class="tok-na">socket-binding=</span><span class="tok-s">&quot;http&quot;</span><span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;host</span> <span class="tok-na">name=</span><span class="tok-s">&quot;default-host&quot;</span> <span class="tok-na">alias=</span><span class="tok-s">&quot;localhost&quot;</span><span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;location</span> <span class="tok-na">name=</span><span class="tok-s">&quot;/&quot;</span> <span class="tok-na">handler=</span><span class="tok-s">&quot;welcome-content&quot;</span> <span class="tok-nt">/&gt;</span>
          <span class="tok-nt">&lt;filter-ref</span> <span class="tok-na">name=</span><span class="tok-s">&quot;gzipFilter&quot;</span> <span class="tok-na">predicate=</span><span class="tok-s">&quot;path-suffix[&#39;.css&#39;] or path-suffix[&#39;.js&#39;]&quot;</span> <span class="tok-nt">/&gt;</span>
          <span class="tok-nt">&lt;filter-ref</span> <span class="tok-na">name=</span><span class="tok-s">&quot;server-header&quot;</span><span class="tok-nt">/&gt;</span>
          <span class="tok-nt">&lt;filter-ref</span> <span class="tok-na">name=</span><span class="tok-s">&quot;x-powered-by-header&quot;</span><span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;/host&gt;</span>
   <span class="tok-nt">&lt;/server&gt;</span>
   <span class="tok-nt">&lt;servlet-container</span> <span class="tok-na">name=</span><span class="tok-s">&quot;default&quot;</span> <span class="tok-na">default-buffer-cache=</span><span class="tok-s">&quot;default&quot;</span> <span class="tok-na">stack-trace-on-error=</span><span class="tok-s">&quot;local-only&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;jsp-config/&gt;</span>
   <span class="tok-nt">&lt;/servlet-container&gt;</span>
   <span class="tok-nt">&lt;handlers&gt;</span>
      <span class="tok-nt">&lt;file</span> <span class="tok-na">name=</span><span class="tok-s">&quot;welcome-content&quot;</span> <span class="tok-na">path=</span><span class="tok-s">&quot;${jboss.home.dir}/welcome-content&quot;</span> <span class="tok-na">directory-listing=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">/&gt;</span>
   <span class="tok-nt">&lt;/handlers&gt;</span>
   <span class="tok-nt">&lt;filters&gt;</span>
      <span class="tok-nt">&lt;response-header</span> <span class="tok-na">name=</span><span class="tok-s">&quot;server-header&quot;</span> <span class="tok-na">header-name=</span><span class="tok-s">&quot;Server&quot;</span> <span class="tok-na">header-value=</span><span class="tok-s">&quot;Wildfly 8&quot;</span><span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;response-header</span> <span class="tok-na">name=</span><span class="tok-s">&quot;x-powered-by-header&quot;</span> <span class="tok-na">header-name=</span><span class="tok-s">&quot;X-Powered-By&quot;</span> <span class="tok-na">header-value=</span><span class="tok-s">&quot;Undertow 1&quot;</span><span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;gzip</span> <span class="tok-na">name=</span><span class="tok-s">&quot;gzipFilter&quot;</span><span class="tok-nt">/&gt;</span>
   <span class="tok-nt">&lt;/filters&gt;</span>
<span class="tok-nt">&lt;/subsystem&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Se añade la referencia al filtro <em>gzipFilter</em> en la lista de filtros y en el tag <em>&lt;filter-ref name&gt;</em>  se define la expresión regular que determina si un elemento se debe comprimir o no.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_referencias">2.5. Referencias</h3>
<div class="ulist">
<ul>
<li>
<p>WildFly Administration Guide <a href="https://docs.jboss.org/author/display/WFLY8/Admin+Guide" class="bare">https://docs.jboss.org/author/display/WFLY8/Admin+Guide</a></p>
</li>
<li>
<p>Quickstart JMS <a href="http://www.mastertheboss.com/jboss-jms/how-to-code-a-remote-jms-client-for-wildfly-8" class="bare">http://www.mastertheboss.com/jboss-jms/how-to-code-a-remote-jms-client-for-wildfly-8</a></p>
</li>
<li>
<p>Descriptores de despliegue estándar Java EE 7 <a href="https://wikis.oracle.com/display/GlassFish/Java+EE+7+Maven+Coordinates" class="bare">https://wikis.oracle.com/display/GlassFish/Java+EE+7+Maven+Coordinates</a></p>
</li>
<li>
<p>Descriptores de despliegue específicos de WildFly <a href="https://docs.jboss.org/author/display/WFLY8/Deployment+Descriptors+used+In+WildFly" class="bare">https://docs.jboss.org/author/display/WFLY8/Deployment+Descriptors+used+In+WildFly</a></p>
</li>
<li>
<p>Configuración de los Pool de EJB en JBoss 7 <a href="http://www.javacodegeeks.com/2011/11/jboss-as-7-ejb3-pools-configuration.html" class="bare">http://www.javacodegeeks.com/2011/11/jboss-as-7-ejb3-pools-configuration.html</a></p>
</li>
<li>
<p>Información sobre el ClassLoading en JBoss 7 <a href="https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7" class="bare">https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7</a></p>
</li>
<li>
<p>Best Practices for speeding up your Web Site <a href="https://developer.yahoo.com/performance/rules.html" class="bare">https://developer.yahoo.com/performance/rules.html</a></p>
</li>
<li>
<p>GZip Encoding in WildFly <a href="http://rumianom.pl/rumianom/entry/gzip_content_encoding_in_wildfly" class="bare">http://rumianom.pl/rumianom/entry/gzip_content_encoding_in_wildfly</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ejercicios_de_administración_de_recursos_en_wildfly">2.6. Ejercicios de Administración de recursos en Wildfly</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">JMS y WildFly</div>
Para que se pueda acceder a determinados recursos como las connection factory o colas del servidor desde un proceso externo, hay que utilizar un nombre JNDI adicional que comience por java:jboss/exported. El cliente jboss-client de WildFly 8.x no implementa JMS 2.0, si no que se corresponde con la especificación Java EE 6.0 La clase genérica Destination no está definida.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ahora que ya tenemos una visión general sobre la configuración de recursos en WildFly, vamos a realizar una serie de ejercicios para poner en práctica lo que hemos aprendido.</p>
</div>
<div class="sect3">
<h4 id="_librería_compartida_de_logs_0_6_puntos">2.6.1. Librería compartida de Logs (0.6 puntos)</h4>
<div class="paragraph">
<p>Vuestro primer reto será crear una sencilla librería de log, que registre cualquier evento en una tabla de base de datos.  Un evento tendrá los siguientes atributos: timestamp, un mensaje y un tipo: I:informativo, D:debug W:aviso E:error.</p>
</div>
<div class="paragraph">
<p>Debéis realizar las siguientes tareas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Iniciar WildFly en modo standalone en modo Full Profile Java EE (standalone-full.xml).</p>
</li>
<li>
<p>Desplegar la libreria _apli-loglibrary- como librería compartida, que contiene las clases necesarias para implementar la interfaz de log.</p>
</li>
<li>
<p>Definir el datasource <em>java:jboss/datasources/appLogger</em> en un descriptor de despliegue con el password encriptado, que se debe incluir en la propia librería.</p>
</li>
<li>
<p>Desplegar una sencilla aplicación Web  con un único Servlet que registre en base de datos cada llamada que reciba. Debe enlazar externamente con la librería de logs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Se os proporciona un script <em>eurovision.sql</em> con la tabla de logs y la base de datos para el siguiente ejercicio. También contaréis con los tres proyectos Maven que componen esta aplicación:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Proyecto "Java Application" de nombre <em>apli-logLibrary</em> con la interfaz de Log predefinida.</p>
</li>
<li>
<p>Proyecto "Web Application", <em>apli-AppLogger</em>, con el servlet de prueba: se invocará mediante la llamada a <a href="http://localhost:8080/App/Test" class="bare">http://localhost:8080/App/Test</a></p>
</li>
<li>
<p>Proyecto "Enterprise Application" <em>apli-Enterprise Logger</em> que incluirá únicamente al proyecto Web.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Debéis desplegar tanto la librería compartida como el EAR y comprobar que se registran en la tabla las llamadas al servlet. Los entregables serán los fuentes de todos los proyectos.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Pistas</div>
Si queréis probar la librería sin desplegarla en WildFly debéis utilizar  el denominado cliente completo de WildFly. Es un jar que se utiliza en clientes pesados que incluye todas las clases de WildFly necesarias para trabajar en remoto.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para dar de alta el cliente de WildFly como una dependencia de Maven  hay que hacer lo siguiente:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Acceder a la carpeta <em>/usr/local/wildfly-8.2.1.Final/bin/client</em> .</p>
</li>
<li>
<p>Ejecutar:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn install:install-file -Dfile=jboss-client.jar \
-DgroupId=org.wildfly \
-DartifactId=jboss-client \
-Dversion=8.2.1 \
-Dpackaging=jar \
-DgeneratePom=true</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_camino_a_eurovisión_1_punto">2.6.2. Camino a Eurovisión (1 punto)</h4>
<div class="paragraph">
<p>Tenemos la tarea de desplegar un sistema de votaciones que se utilizará para determinar la próxima canción candidata española a Eurovisión. Esta aplicación presenta una estructura de proyectos típica de las aplicaciones Java Entreprise de hace algunos años. Se trata de una aplicación EAR con distintos subproyectos para cada uno de los módulos que contiene y un pom principal que compila toda la solución. Esta basada en Java EE 5 aunque tiene referencias a las librerías actuales. En resumen, algo muy parecido a lo que os podéis encontrar en el mundo laboral. Los módulos son los siguientes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Una librería con un EJB que implementa la lógica de negocio.</p>
</li>
<li>
<p>Una aplicación Web que implementa la presentación.</p>
</li>
<li>
<p>Una aplicación empresarial EAR que engloba a todo el proyecto.</p>
</li>
<li>
<p>Un cliente Java EE externo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gráficamente, la arquitectura de la aplicación es la siguiente:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/arquitectura.png" alt="arquitectura">
</div>
</div>
<div class="paragraph">
<p>Se utiliza una aplicación externa para simular una pasarela que recoge los votos emitidos mediante mensajes de móvil. La información que os interesará de dichos mensajes es el número de teléfono origen y el número de la canción votada. El formato del mensaje será el teléfono, de longitud variables, el símbolo "#" como separador y por último la palabra <em>EURO</em> más un número del 01 al 12, ejemplo: <em>654736534#EURO04</em>.</p>
</div>
<div class="paragraph">
<p>Partiréis de los proyectos Maven ya creados y un script SQL para la creación de la base de datos <em>eurovision</em>. Aunque no se estudia en detalle en esta sesión, dentro de la aplicación tenemos un ejemplo de procesamiento asíncrono mediante colas de mensajes y objetos MDB&#8217;s. Para que esta parte funcione correctamente hay que crear un usuario de aplicación denominado <strong>jmsuser</strong>. Para que este nuevo usuario tenga permisos de lectura/escritura hay que asociarlo al grupo <strong>guest</strong>.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/paas02/ejercicios1.png" alt="ejercicios1">
</div>
</div>
<div class="paragraph">
<p>Para completar el ejercicio teneis que cubrir los siguientes objetivos:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configurar la aplicación EAR para que utilice la librería compartida de logs del ejercicio anterior.</p>
</li>
<li>
<p>Ajustar la configuración del EJB Ranking que implementa la lógica de negocio añadiéndole un <strong>límite máximo</strong> de 5 objetos simultáneos para el EJB. Como esta configuración es específica de WildFly hay que añadir la siguiente dependencia al proyecto del EJB:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.wildfly<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>wildfly-ejb3<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>8.2.1.Final<span class="tok-nt">&lt;/version&gt;</span>
	<span class="tok-nt">&lt;scope&gt;</span>provided<span class="tok-nt">&lt;/scope&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>La aplicación contiene un MDB que recibe los votos y los almacena en base de datos. Hay que revisar cómo está implementado y crear la conexión a base de datos que necesita desde la consola de WildFly.</p>
</li>
<li>
<p>Configurar el usuario JMS que utilizará el cliente Java <em>apli-EnvioSMS</em>. Se trata de una aplicación Java EE que se ejecuta fuera del servidor de aplicaciones pero utiliza los servicios que ofrece, concretamente una cola JMS, denominada <em>jms/entradaMensajes</em> a donde enviará los votos del</p>
</li>
<li>
<p>Desplegar la aplicación y acceder a la consulta de votaciones para ver las posibles canciones a las que se puede votar.</p>
</li>
<li>
<p>Utilizar la aplicación cliente para enviar varios votos y asegurarse de que se contabilizan correctamente.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Los entregables del ejercicio serán:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>El fichero de configuración standalone-full.xml</p>
</li>
<li>
<p>El código fuente de todos los proyectos solicitados, <em>apli-EnvioSMS</em> y <em>Apli-CaminoAEurovision</em>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Pistas</div>
Para poder compilar la aplicación externa Java EE necesitaréis construir el cliente completo de WildFly, tal y como se explicaba en el ejercicio anterior. Estad muy pendientes del log de WildFly, que es donde se os dará una pista más clara de lo que ocurre en caso de problemas.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-16 22:32:33 CEST
</div>
</div>
</body>
</html>