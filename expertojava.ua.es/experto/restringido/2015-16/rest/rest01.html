<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="María Isabel Alfonso Galipienso">
<title>Servicios Rest</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Servicios Rest</h1>
<div class="details">
<span id="author" class="author">María Isabel Alfonso Galipienso</span><br>
<span id="email" class="email">&lt;<a href="mailto:eli@ua.es">eli@ua.es</a>&gt;</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion01">1. Introducción a REST. Diseño y creación de servicios RESTful</a>
<ul class="sectlevel2">
<li><a href="#__qu%C3%A9_es_un_servicio_web">1.1. ¿Qué es un servicio Web?</a>
<ul class="sectlevel3">
<li><a href="#_servicios_web_restful">1.1.1. Servicios Web RESTful</a></li>
</ul>
</li>
<li><a href="#_fundamentos_de_rest">1.2. Fundamentos de REST</a>
<ul class="sectlevel3">
<li><a href="#_recursos">1.2.1. Recursos</a></li>
<li><a href="#_representaci%C3%B3n_de_los_recursos">1.2.2. Representación de los recursos</a></li>
<li><a href="#_direccionabilidad_de_los_recursos_uri">1.2.3. Direccionabilidad de los recursos: URI</a></li>
<li><a href="#_uniformidad_y_restricciones_de_las_interfaces">1.2.4. Uniformidad y restricciones de las interfaces</a></li>
</ul>
</li>
<li><a href="#_dise%C3%B1o_de_servicios_web_restful">1.3. Diseño de servicios Web RESTful</a></li>
<li><a href="#_un_primer_servicio_jax_rs">1.4. Un primer servicio JAX-RS</a>
<ul class="sectlevel3">
<li><a href="#_modelo_de_objetos">1.4.1. Modelo de objetos</a></li>
<li><a href="#_modelado_de_uris">1.4.2. Modelado de URIs</a></li>
<li><a href="#_definici%C3%B3n_del_formato_de_datos">1.4.3. Definición del formato de datos</a></li>
<li><a href="#_asignaci%C3%B3n_de_m%C3%A9todos_http">1.4.4. Asignación de métodos HTTP</a></li>
<li><a href="#_implementaci%C3%B3n_del_servicio_creaci%C3%B3n_del_proyecto_maven">1.4.5. Implementación del servicio: Creación del proyecto Maven</a></li>
<li><a href="#_implementaci%C3%B3n_del_servicio_recursos_jax_rs">1.4.6. Implementación del servicio: Recursos JAX-RS</a></li>
<li><a href="#_construcci%C3%B3n_y_despliegue_del_servicio">1.4.7. Construcción y despliegue del servicio</a></li>
<li><a href="#_probando_nuestro_servicio">1.4.8. Probando nuestro servicio</a></li>
</ul>
</li>
<li><a href="#_ejercicios">1.5. Ejercicios</a>
<ul class="sectlevel3">
<li><a href="#_servicio_rest_ejemplo_0_puntos">1.5.1. Servicio REST ejemplo (0 puntos)</a></li>
<li><a href="#_servicio_rest_saludo_1_punto">1.5.2. Servicio REST saludo (1 punto)</a></li>
<li><a href="#_servicio_rest_foro_1_punto">1.5.3. Servicio REST foro (1 punto)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion01">1. Introducción a REST. Diseño y creación de servicios RESTful</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sesión vamos a introducir los conceptos de servicio Web y servicio Web RESTful, que
es el tipo de servicios con los que vamos a trabajar. Explicaremos el proceso de diseño del API
de un servicio Web RESTful, y definiremos las URIs que constituirán los "puntos de entrada"
de nuestra aplicación REST. Finalmente ilustraremos los pasos para implementar, desplegar y probar
un servicio REST, utilizando <em>Maven</em>, <em>IntelliJ</em>, y el servidor de aplicaciones <em>Wildfly</em>. También nos
familiarizaremos con <em>Postman</em>, una herramienta para poder probar de forma sencilla los servicios
web directamente desde el navegador.</p>
</div>
<div class="sect2">
<h3 id="__qué_es_un_servicio_web">1.1. ¿Qué es un servicio Web?</h3>
<div class="paragraph">
<p>El diseño del software tiende a ser cada vez más modular. Las aplicaciones están formadas por una serie de
componentes reutilizables (<strong>servicios</strong>), que pueden encontrarse distribuidos a lo largo de una serie de máquinas
conectadas en red.</p>
</div>
<div class="paragraph">
<p>El <strong>WC3</strong> (<em><strong>W</strong>orld <strong>W</strong>ide <strong>W</strong>eb Consortium</em>) define un servicio Web como un sistema software diseñado para soportar interacciones
máquina a máquina a través de la red. Dicho de otro modo, los servicios Web proporcionan una forma estándar de interoperar
entre aplicaciones software que se ejecutan en diferentes plataformas. Por lo tanto, su principal característica su gran
<strong>interoperabilidad</strong> y <strong>extensibilidad</strong> así como por proporcionar información fácilmente procesable por las máquinas gracias al
uso de XML. Los servicios Web pueden combinarse con muy bajo acoplamiento para conseguir la realización de operaciones complejas.
De esta forma, las aplicaciones que proporcionan servicios simples pueden interactuar con otras para "entregar" servicios
sofisticados añadidos.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Historia de los servicios Web</div>
<div class="paragraph">
<p>Los servicios Web fueron "inventados" para solucionar el problema de la <strong>interoperabilidad</strong> entre las aplicaciones. Al principio
de los 90, con el desarrollo de Internet/LAN/WAN, apareció el gran problema de integrar aplicaciones diferentes. Una aplicación
podía haber sido desarrollada en C++ o Java, y ejecutarse bajo Unix, un PC, o un computador mainframe. No había una forma fácil
de intercomunicar dichas aplicaciones. Fué el desarrollo de XML el que hizo posible compartir datos entre aplicaciones con
diferentes plataformas hardware a través de la red, o incluso a través de Internet. La razón de que se llamasen servicios Web
es que fueron diseñados para residir en un servidor Web, y ser llamados a través de Internet, típicamente via protocolos HTTP,
o HTTPS. De esta forma se asegura que un servicio puede ser llamado por cualquier aplicación, usando cualquier lenguaje de
programación, y bajo cualquier sistema operativo, siempre y cuándo, por supuesto, la conexión a Internet esté activa, y tenga
un puerto abierto HTTP/HTTPS, lo cual es cierto para casi cualquier computador que disponga de acceso a Internet.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>A nivel <strong>conceptual</strong>, un servicio es un componente software proporcionado a través de un <strong><em>endpoint</em></strong> accesible a través de la red.
Los servicios productores y consumidores utilizan mensajes para intercambiar información de invocaciones de petición y
respuesta en forma de documentos auto-contenidos que hacen muy pocas asunciones sobre las capacidades tecnológicas de cada uno
de los receptores.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">¿Qué es un <em>endpoint</em>?</div>
<div class="paragraph">
<p>Los servicios pueden interconectarse a través de la red. En una arquitectura orientada a servicios, cualquier interacción
punto a punto implica dos <strong><em>endpoints</em></strong>: uno que proporciona un servicio, y otro de lo consume. Es decir, que un <strong><em>endpoint</em></strong> es
cada uno de los "elementos", en nuestro caso nos referimos a servicios, que se sitúan en ambos "extremos" de la red que sirve de
canal de comunicación entre ellos. Cuando hablamos de servicios Web, un <em>endpoint</em> se especifica mediante una URI.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A nivel <strong>técnico</strong>, los servicios pueden implementarse de varias formas. En este sentido, podemos distinguir dos tipos
de servicios Web: los denominados servicios Web "grandes" (<em>"big" Web Services</em>), los llamaremos servicios Web SOAP, y
servicios "ligeros" o servicios Web RESTful.</p>
</div>
<div class="paragraph">
<p>Los servicios Web SOAP se caracterizan por utilizar mensajes XML que siguen el estándar SOAP (<em><strong>S</strong>imple <strong>O</strong>bject <strong>A</strong>ccess <strong>P</strong>rotocol</em>).
Además contienen una descripción de las operaciones proporcionadas por el servicio, escritas en
WSDL (<em><strong>W</strong>eb <strong>S</strong>ervices <strong>D</strong>escription <strong>L</strong>anguage</em>), un lenguaje basado en XML.</p>
</div>
<div class="paragraph">
<p>Los servicios Web RESTful, por el contrario, pueden intercambiar mensajes escritos en diferentes formatos, y no requieren el
publicar una descripción de las operaciones que proporcionan, por lo que necesitan una menor "infraestructura" para su
implementación. Nosotros vamos a centrarnos en el uso de estos servicios.</p>
</div>
<div class="sect3">
<h4 id="_servicios_web_restful">1.1.1. Servicios Web RESTful</h4>
<div class="paragraph">
<p>Son un tipo de Servicios Web, que se adhieren a una serie de restricciones arquitectónicas englobadas bajo
las siglas de <strong>REST</strong>, y que utilizan estándares Web tales como URIs, HTTP, XML, y JSON.</p>
</div>
<div class="paragraph">
<p>El API Java para servicios Web RESTful (<strong>JAX-RS</strong>) permite desarrollar servicios Web RESTful de forma sencilla. La versión más reciente
del API es la 2.0, cuya especificación está publicada en el documento <strong>JSR-339</strong>, y que podemos descargar desde <a href="https://jcp.org/en/jsr/detail?id=339" class="bare">https://jcp.org/en/jsr/detail?id=339</a>.
A lo largo de estas sesiones, veremos cómo utilizar
JAX-RS para desarrollar servicios Web RESTful. Dicho API utiliza anotaciones Java para reducir los esfuerzos de programación de los servicios.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fundamentos_de_rest">1.2. Fundamentos de REST</h3>
<div class="paragraph">
<p>El término REST proviene de la tesis doctoral de Roy Fielding, publicada en el año 2000, y significa <em><strong>R</strong><strong>E</strong>presentational
  <strong>S</strong>tate <strong>T</strong>ransfer</em> (podemos acceder a la tesis original en: <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" class="bare">http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm</a>).
  REST es un conjunto de restricciones que, cuando son aplicadas al diseño de un sistema, crean un
  estilo arquitectónico de software. Dicho estilo arquitectónico se caracteriza por seguir los siguientes
principios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debe ser un sistema <strong>cliente-servidor</strong></p>
</li>
<li>
<p>Tiene que ser <strong>sin estado</strong>, es decir, no hay necesidad de que los servicios guarden
las sesiones de los usuarios (cada petición al servicio tiene que ser independiente
de las demás)</p>
</li>
<li>
<p>Debe soportar un sistema de <strong>cachés</strong>: la infraestructura de la red debería soportar
caché en diferentes niveles</p>
</li>
<li>
<p>Debe ser un sistema <strong>uniformemente accesible</strong> (con una interfaz uniforme):
Esta restricción define cómo debe ser la interfaz entre clientes y servidores. La idea
es simplificar y desacoplar la arquitectura, permitiendo que cada una de sus partes
puede evolucionar de forma independiente. Una interfaz uniforme se debe caracterizar por:</p>
<div class="ulist">
<ul>
<li>
<p>Estar basada en <strong>recursos</strong>: La
abstracción utilizada para representar la información y los datos en REST es
el <strong>recurso</strong>, y cada recurso debe poder ser
accedido mediante una URI (<strong>U</strong>niform <strong>R</strong>esource <strong>I</strong>dentifier).</p>
</li>
<li>
<p>Orientada a <strong>representaciones</strong>: La interacción con los servicios tiene lugar a través de las <strong><em>representaciones</em></strong> de los
<strong><em>recursos</em></strong> que conforman dicho servicio. Un <strong>recurso</strong> referenciado por una URI puede
tener diferentes formatos (<em>representaciones</em>). Diferentes plataformas requieren formatos
diferentes. Por ejemplo, los navegadores necesitan HTML, JavaScript requiere JSON
(<strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation), y una aplicación Java puede necesitar XML.</p>
</li>
<li>
<p>Interfaz <strong>restringida</strong>: Se utiliza un pequeño conjunto de métodos bien definidos para manipular los recursos.</p>
</li>
<li>
<p>Uso de mensajes <strong>auto-descriptivos</strong>: cada mensaje debe incluir la suficiente información
como para describir cómo procesar el mensaje. Por ejemplo, se puede indicar cómo "parsear"
el mensaje indicando el tipo de contenido del mismo (xml, html, texto,&#8230;&#8203;)</p>
</li>
<li>
<p>Uso de Hipermedia como máquina de estados de la aplicacion (<strong>HATEOAS</strong>):
Los propios formatos de los datos son los que "dirigen" las transiciones entre estados
de la aplicación. Como veremos más adelante con más detalle, el uso de HATEOAS
(<strong>H</strong>ypermedia <strong>A</strong>s <strong>T</strong>he <strong>E</strong>ngine <strong>O</strong>f <strong>A</strong>pplication <strong>S</strong>tate),
va a permitir transferir de forma explícita el estado de la aplicacion en los mensajes
intercambiados, y por lo tanto, realizar interacciones con estado.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Tiene que ser un sistema por <strong>capas</strong>: un cliente no puede "discernir" si está accediendo
directamente al servidor, o a algún intermediario. Las "capas" intermedias van a permitir
soportar la escalabilidad, así como reforzar las políticas de seguridad</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A continuación analizaremos algunas de las abstracciones que constituyen un sistema RESTful: recursos, representaciones, URIs, y los
    tipos de peticiones HTTP que constituyen la interfaz uniforme utilizada en las transferencias cliente/servidor</p>
</div>
<div class="sect3">
<h4 id="_recursos">1.2.1. Recursos</h4>
<div class="paragraph">
<p>Un recurso REST es cualquier cosa que sea direccionable (y por lo tanto, accesible) a través de la Web. Por direccionable nos referimos a recursos que
   puedan ser accedidos y transferidos entre clientes y servidores. Por lo tanto, un recurso es una <strong>correspondencia lógica y
   temporal</strong> con un concepto en el <strong>dominio</strong> del problema para el cual estamos implementando una solución.</p>
</div>
<div class="paragraph">
<p>Algunos ejemplos de recursos REST son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Una noticia de un periódico</p>
</li>
<li>
<p>La temperatura de Alicante a las 4:00pm</p>
</li>
<li>
<p>Un valor de IVA almacenado en una base de datos</p>
</li>
<li>
<p>Una lista con el historial de las revisiones de código en un sistema CVS</p>
</li>
<li>
<p>Un estudiante en alguna aula de alguna universidad</p>
</li>
<li>
<p>El resultado de una búsqueda de un ítem particular en Google</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Aun cuando el mapeado de un recurso es único, diferentes peticiones a un recurso pueden devolver la misma representación
   binaria almacenada en el servidor. Por ejemplo, consideremos un recurso en el contexto de un sistema de publicaciones.
   En este caso, una petición de la "última revisión publicada" y la petición de "la revisión número 12" en algún momento
   de tiempo pueden devolver la misma representación del recurso: cuando la última revisión sea efectivamente la 12. Por lo
   tanto, cuando la última revisión publicada se incremente a la versión 13, una petición a la última revisión devolverá la
   versión 13, y una petición de la revisión 12, continuará devolviendo la versión 12. En definitiva: cada uno de los recursos
   puede ser accedido directamente y de forma independiente, pero diferentes peticiones podrían "apuntar" al mismo dato.</p>
</div>
<div class="paragraph">
<p>Debido a que estamos utilizando HTTP para comunicarnos, podemos transferir cualquier tipo de información que pueda
   transportarse entre clientes y servidores. Por ejemplo, si realizamos una petición de un fichero de texto de la CNN, nuestro
   navegador mostrará un fichero de texto. Si solicitamos una película flash a YouTube, nuestro navegador recibirá una película
   flash. En ambos casos, los datos son transferidos sobre TCP/IP y el navegador conoce cómo interpretar los <em>streams</em>
   binarios debido a la cabecera de respuesta del protocolo HTTP <em>Content-Type</em>. Por lo tanto, en un sistema RESTful,
   la representación de un recurso depende del tipo deseado por el cliente (tipo MIME), el cual está especificado en la
   petición del protocolo de comunicaciones.</p>
</div>
</div>
<div class="sect3">
<h4 id="_representación_de_los_recursos">1.2.2. Representación de los recursos</h4>
<div class="paragraph">
<p>La representación de los recursos es lo que se envía entre los servidores y clientes. Una representación muestra el estado
   temporal del dato real almacenado en algún dispositivo de almacenamiento en el momento de la petición. En términos generales,
   es un <em>stream</em> binario, juntamente con los metadatos que describen cómo dicho <em>stream</em> debe ser consumido
   por el cliente y/o servidor (los metadatos también puden contener información extra sobre el recurso, como por ejemplo
    información de validación y encriptación, o código extra para ser ejecutado dinámicamente).</p>
</div>
<div class="paragraph">
<p>A través del ciclo de vida de un servicio web, pueden haber varios clientes solicitando recursos. Clientes diferentes
   son capaces de consumir diferentes representaciones del mismo recurso. Por lo tanto, una representación puede tener
   varias formas, como por ejemplo, una imagen, un texto, un fichero XML, o un fichero JSON, pero tienen que estar disponibles
   en la misma URL.</p>
</div>
<div class="paragraph">
<p>Para respuestas generadas para humanos a través de un navegador, una representación típica tiene la forma de
   página HTML. Para respuestas automáticas de otros servicios web, la legibilidad no es importante y puede utilizarse una representación
   mucho más eficiente como por ejemplo XML.</p>
</div>
<div class="paragraph">
<p>El lenguaje para el intercambio de información con el
servicio queda a elección del desarrollador. A continuación mostramos algunos formatos comunes que podemos utilizar
para intercambiar esta información:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Ejemplos de formatos utilizados por los servicios REST</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Formato</th>
<th class="tableblock halign-left valign-top">Tipo MIME</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Texto plano</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/plain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/html</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/xml</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/json</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>De especial interés es el formato <strong>JSON</strong>. Se trata de un lenguaje ligero de intercambio
de información, que puede utilizarse en lugar de XML (que resulta considerablemente
más pesado) para aplicaciones AJAX. De hecho, en Javascript puede leerse este tipo de
formato simplemente utilizando el método <code>eval()</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_direccionabilidad_de_los_recursos_uri">1.2.3. Direccionabilidad de los recursos: URI</h4>
<div class="paragraph">
<p>Una URI, o <strong>Uniform Resource Identifier</strong>, en un servicio web RESTful es un hiper-enlace a un recurso, y es la
   única forma de intercambiar representaciones entre clientes y servidores. Un
   servicio web RESTful expone un conjunto de recursos que identifican los objetivos
      de la interacción con sus clientes.</p>
</div>
<div class="paragraph">
<p>El conjunto de restricciones REST no impone que las URIs deban ser hiper-enlaces. Simplemente hablamos de hiper-enlaces
   porque estamos utilizando la Web para crear servicios web. Si estuviésemos utilizando un conjunto diferente de tecnologías
   soportadas, una URI RESTful podría ser algo completamente diferente. Sin embargo, la idea de direccionabilidad debe permanecer.</p>
</div>
<div class="paragraph">
<p>En un sistema REST, la URI <strong>no cambia a lo largo del tiempo</strong>, ya que la implementación de la arquitectura es la que
  gestiona los servicios, localiza los recursos, negocia las representaciones, y envía respuestas con los recursos solicitados.
  Y lo que es más importante, si hubiese un cambio en la estructura del dispositivo de almacenamiento en el lado del servidor
  (por ejemplo, un cambio de servidores de bases de datos), nuestras URIs seguirán siendo las mismas y serán válidas mientras
  el servicio web siga estando "en marcha" o el contexto del recurso no cambie.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong>Sin</strong> las restricciones REST, los recursos se acceden por su localización: las direcciones web típicas son URIs fijas. Si por
   ejemplo renombramos un fichero en el servidor, la URI será diferente; si movemos el fichero a un directorio diferente, la URI
   también será diferente.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>El formato de una URI se estandariza como sigue:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>scheme://host:port/path?queryString#fragment</pre>
</div>
</div>
<div class="paragraph">
<p>En donde:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>scheme</code> es el protocolo que estamos utilizando para comunicarnos con el
servidor. Para servicios REST, normalmente el protocolo será <strong><em>http</em></strong> o <strong><em>https</em></strong>.</p>
</li>
<li>
<p>El término <code>host</code> es un nombre DNS o una dirección IP.</p>
</li>
<li>
<p>A continuación se puede indicar
de forma opcional un puerto (mediante <code>:port</code>), que es un valor numérico. El <strong><em>host</em></strong>
y el <strong><em>port</em></strong> representan la localización de nuestro recurso en la red.</p>
</li>
<li>
<p>Seguidamente aparece una expresión <code>path</code>, que es un conjunto de segmentos de texto
delimitados por el carácter <code>\</code> (pensemos en la expresión <em>path</em> como en una lista
de directorios de un fichero en nuestra máquina).</p>
</li>
<li>
<p>Esta expresión puede ir seguida, opcionalmente
por una <code>queryString</code>. El carácter <code>?</code>) separa el <em>path</em> de la <em>queryString</em>.
Esta última es una lista
de parámetros representados como pares nombre/valor. Cada par está delimitado por el
carácter <code>&amp;</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La última parte de la URI es el <code>fragment</code>, delimitado por el carácter <code>#</code>. Normalmente
se utiliza para "apuntar" a cierto "lugar" del documento al que estamos accediendo.</p>
</div>
<div class="paragraph">
<p>En una URI, no todos los caracteres están permitidos, de forma que algunos caracteres
se codificarán de acuerdo a las siguientes reglas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Los caracteres a-z, A-Z, 0-9, ., -, *, y _, permanecen igual</p>
</li>
<li>
<p>El caracter "espacio" se convierte en el carácter <code>+</code></p>
</li>
<li>
<p>El resto de caracteres se codifican como una secuencia de bits siguiendo
un esquema de codificación hexadecimal, de forma que cada dos dígitos hexadecimales
van precedidos por el carácter <code>%</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Un ejemplo de URI podría ser éste:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">http://expertojava.ua.es/recursos/clientes?apellido=Martinez<span class="tok-err">&amp;</span>codPostal=02115</code></pre>
</div>
</div>
<div class="paragraph">
<p>En el ejemplo anterior el <strong>host</strong> viene dado por <em>expertojava.ua.es</em>, el <strong>path</strong> o ruta
de acceso al recurso es <em>/recursos/clientes</em>, y hemos especificado los <strong>parámetros</strong> <em>apellido</em>
y <em>codPostal</em>, con los <strong>valores</strong> <em>Martinez</em> y <em>02115</em> respectivamente.</p>
</div>
<div class="paragraph">
<p>Si por ejemplo, en nuestra aplicación tenemos información de clientes, podríamos
acceder a la lista correspondiente mediante una URL como la siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">http://expertojava.ua.es/recursos/clientes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esto nos devolverá la lista de clientes en el formato que el desarrollador del servicio haya decidido. Hay que
destacar, por lo tanto, que en este caso debe haber un entendimiento entre el consumidor y el productor del servicio,
de forma que el primero comprenda el lenguaje utilizado por el segundo.</p>
</div>
<div class="paragraph">
<p>La URL anterior nos podría devolver un documento como el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tok-nt">&lt;clientes&gt;</span>
  <span class="tok-nt">&lt;cliente&gt;</span>http://expertojava.ua.es/recursos/clientes/1&quot;<span class="tok-nt">&lt;cliente/&gt;</span>
  <span class="tok-nt">&lt;cliente&gt;</span>http://expertojava.ua.es/recursos/clientes/2&quot;<span class="tok-nt">&lt;cliente/&gt;</span>
  <span class="tok-nt">&lt;cliente&gt;</span>http://expertojava.ua.es/recursos/clientes/4&quot;<span class="tok-nt">&lt;cliente/&gt;</span>
  <span class="tok-nt">&lt;cliente&gt;</span>http://expertojava.ua.es/recursos/clientes/6&quot;<span class="tok-nt">&lt;cliente/&gt;</span>
<span class="tok-nt">&lt;/clientes&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este documento se muestra la lista de clientes registrados en la aplicación, cada uno de ellos representado
también por una URL. Accediendo a estas URLs, a su vez, podremos obtener información sobre cada curso concreto o bien
modificarlo.</p>
</div>
</div>
<div class="sect3">
<h4 id="_uniformidad_y_restricciones_de_las_interfaces">1.2.4. Uniformidad y restricciones de las interfaces</h4>
<div class="paragraph">
<p>Ya hemos introducido los conceptos de recursos y sus representaciones. Hemos dicho que los
   <strong>recursos</strong> son correspondencias (<em>mappings</em>) de los estados reales de las entidades que son intercambiados entre los
   clientes y servidores. También hemos dicho que las <strong>representaciones</strong> son negociadas entre los clientes
   y servidores a través del protocolo de comunicación en tiempo de ejecución (a través de HTTP).
   A continuación veremos con detalle lo que significa el intercambio de estas representaciones, y lo que
   implica para los clientes y servidores el realizar acciones sobre dichos recursos.</p>
</div>
<div class="paragraph">
<p>El desarrollo de servicios web REST es similar al desarrollo de aplicaciones web. Sin embargo, la diferencia
   fundamental entre el desarrollo de aplicaciones web tradicionales y las más modernas es cómo pensamos sobre las acciones
   a realizar sobre nuestras abstracciones de datos. De forma más concreta, el desarrollo moderno está centrado
   en el concepto de <strong>nombres</strong> (intercambio de recursos); el desarrollo tradicional está centrado
   en el concepto de verbos (acciones remotas a realizar sobre los datos). Con la primera forma, estamos implementando
   un servicio web RESTful; con la segunda un servicio similar a una llamada a procedimiento remoto- RPC). Y lo que es más,
   un servicio RESTful <strong>modifica el estado de los datos a través de la
   representación de los recursos</strong> (por el contrario, una llamada a un servicio RPC, oculta la representación de los datos
   y en su lugar envía comandos para modificar el estado de los datos en el lado del servidor). Finalmente, en el desarrollo
   moderno de aplicaciones web limitamos la ambigüedad en el diseño y la implementación debido a que tenemos <strong>cuatro</strong>
   acciones específicas que podemos realizar sobre los recursos: <em>Create, Retrieve, Update y Delete</em> (CRUD). Por otro
   lado, en el desarrollo tradicional de aplicaciones web, podemos tener otras acciones con nombres o implementaciones no estándar.</p>
</div>
<div class="paragraph">
<p>A continuación indicamos la correspondencia entre las acciones CRUD sobre los datos y los métodos HTTP asociados:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Operaciones REST sobre los recursos:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Acción sobre los datos</th>
<th class="tableblock halign-left valign-top">Protocolo HTTP equivalente</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RETRIEVE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPDATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>El principio de uniformidad de la interfaz de acceso a recursos es fundamental, y
quizá el más difícil de seguir por los programadores acostumbrados al modelo RPC (<strong>R</strong>emote
<strong>P</strong>rocedure <strong>C</strong>all).
La idea subyacente es utilizar únicamente un conjunto finito y claramente establecido
de operaciones para la interacción con los servicios. Esto significa que no tendremos
un parámetro "acción" en nuestra URI y que sólo utilizaremos los métodos HTTP para
acceder a nuestros servicios. Cada uno de los métodos tiene un propósito y
significado específicos, que mostramos a continuación:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">GET</dt>
<dd>
<p>GET es una operación <strong>sólo de lectura</strong>. Se utiliza para "recuperar" información
específica del servidor. También se trata de una operación <strong>idempotente</strong> y <strong>segura</strong>.
<strong>Idempotente</strong> significa que no importa cuántas veces invoquemos esta operación, el
 resultado (que observaremos como usuarios) debe ser siempre el mismo. <strong>Segura</strong> significa que una operación GET no
 cambia el estado del servidor en modo alguno, es decir, no debe exhibir ningún efecto
 lateral en el servidor. Por ejemplo, el hecho de "leer" un documento HTML no debería
 cambiar el estado de dicho documento.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">PUT</dt>
<dd>
<p>La operación PUT solicita al servidor el almacenar el cuerpo del mensaje enviado con
 dicha operación en la dirección proporcionada en el mensaje HTTP. Normalmente se
 modela como una inserción o actualización (nosotros la utilizaremos solamente como
 actualización). Es una propiedad <strong>idempotente</strong>. Cuando se utiliza PUT, el cliente
 conoce la identidad del recurso que está creando o actualizando. Es idempotente
 porque enviar el mismo mensaje PUT más de una vez no tiene ningún efecto sobre el
 servicio subyacente. Una analogía podría ser un documento de texto que estemos
 editando. No importa cuántas veces pulsemos el "botón" de grabar, el fichero
 que contiene el documento lógicamente será el mismo documento.</p>
</dd>
<dt class="hdlist1">DELETE</dt>
<dd>
<p>Esta operación se utiliza para eliminar recursos. También es <strong>idempotente</strong></p>
</dd>
<dt class="hdlist1">POST</dt>
<dd>
<p>Post es la única operación HTTP que no es idempotente ni segura. Cada petición
POST puede modificar el servicio de forma exclusiva. Se puede enviar, o no,
información con la petición. También podemos recibir, o no, información con la
respuesta. Para implementar servicios REST, es deseable enviar información con la
 petición y también recibir información con la respuesta.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Adicionalmente, podemos utilizar otras dos operaciones HTTP:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">HEAD</dt>
<dd>
<p>Es una operación exactamente igual que GET, excepto que en lugar de devolver
un "cuerpo de mensaje", solamente devuelve un código de respuesta y alguna
cabecera asociada con la petición.</p>
</dd>
<dt class="hdlist1">OPTIONS</dt>
<dd>
<p>Se utiliza para solicitar información sobre las opciones disponibles sobre un
recurso en el que estamos interesados. Esto permite al cliente determinar las
capacidades del servidor y del recurso sin tener que realizar ninguna petición
que provoque una acción sobre el recurso o la recuperación del mismo.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">PATCH</dt>
<dd>
<p>Se utiliza para para realiza reemplazos (actualizaciones) parciales de un documento, ya que
 la operación PUT sólo permite una actualización completa del recurso (y requiere
 indicar una representación completa del mismo) . Es útil cuando el recurso a modificar es
 complejo y solamente queremos actualizar parte de su contenido. En este caso solo necesitamos
 indicar la parte que queremos cambiar.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_diseño_de_servicios_web_restful">1.3. Diseño de servicios Web RESTful</h3>
<div class="paragraph">
<p>El diseño de servicios RESTful no es muy diferente del diseño de aplicaciones web
tradicionales: tenemos requerimientos de negocio, tenemos usuarios que quieren realizar
operaciones sobre los datos, y tenemos restricciones <em>hardware</em> que van a condicionar
nuestra arquitectura <em>software</em>. La principal diferencia reside en el hecho de que
tenemos que "buscar", a partir de los requerimientos, cuáles van a ser los <strong>recursos</strong>
que van a ser accedidos a través de los servicios, "sin preocuparnos" de qué <strong>operaciones</strong> o acciones específicas
van a poderse realizar sobre dichos recursos (el proceso de diseño depende de los
"nombres", no de los "verbos").</p>
</div>
<div class="paragraph">
<p>Podemos resumir los principios de diseño de servicios web RESTful en los siguientes
cuatro pasos:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Elicitación de requerimientos y creación del <strong>modelo de objetos</strong>: Este paso es
similar al diseño orientado a objetos. El resultado del proceso puede ser un modelo
de clases UML</p>
</li>
<li>
<p>Identificación de <strong>recursos</strong>: Este paso consiste en identificar los "objetos" de
nuestro modelo sin preocuparnos de las operaciones concretas a realizar
sobre dichos objetos</p>
</li>
<li>
<p>Definición de las <strong>URIs</strong>: Para satisfacer el principio de "direccionabilidad" de los
recursos, tendremos que definir las URIs que representarán los <em>endpoints</em> de nuestros
servicios, y que constituirán los "puntos de entrada" de los mismos</p>
</li>
<li>
<p>Definición de la <strong>representación de los recursos</strong>: Puesto que los
sistemas REST están orientados a la representación, tendremos que definir el formato
de los datos que utilizaremos para intercambiar información entre nuestros servicios
y clientes</p>
</li>
<li>
<p>Definición de los <strong>métodos de acceso</strong> a los recursos: Finalmente, tendremos que
decidir qué métodos HTTP nos permitirán acceder a las URIs que queremos exponer,
así como qué hará cada método. Es muy importante que en este paso, nos ciñamos a
las restricciones que definen los principios RESTful que hemos indicado en apartados
anteriores.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_un_primer_servicio_jax_rs">1.4. Un primer servicio JAX-RS</h3>
<div class="paragraph">
<p>Vamos a ilustrar los pasos anteriores con un ejemplo, concretamente definiremos una interfaz
RESTful para un sistema sencillo de gestión de pedidos de un hipotético comercio
por internet. Los potenciales clientes de nuestro sistema, podrán realizar compras,
modificar pedidos existentes en nuestro sistema, así como visualizar sus datos
personales o la información sobre los productos que son ofertados por el comercio.</p>
</div>
<div class="sect3">
<h4 id="_modelo_de_objetos">1.4.1. Modelo de objetos</h4>
<div class="paragraph">
<p>A partir de los requerimientos del sistema, obtenemos el modelo de objetos.
El modelo de objetos de nuestro sistema de ventas por internet es bastante sencillo.
Cada pedido en el sistema representa una única transacción de compra y está asociada
con un cliente particular. Los pedidos estarán formados por una o más líneas de pedido.
Las líneas de pedido representan el tipo y el número de unidades del producto
adquirido.</p>
</div>
<div class="paragraph">
<p>Basándonos en esta descripción de nuestro sistema, podemos extraer que los objetos
de nuestro modelo son: <strong>Pedido</strong>, <strong>Cliente</strong>, <strong>LineaPedido</strong>, y <strong>Producto</strong>. Cada
 objeto de nuestro modelo tiene un identificador único, representado por la
 propiedad <code>id</code>, dada por un valor de tipo entero. La siguiente figura muestra
 un diagrama UML de nuestro modelo:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/rest01/ModeloObjetos.png" alt="Modelo de objetos del servicio RESTful" width="66%">
</div>
</div>
<div class="paragraph">
<p>Estamos interesados en consultar todos los pedidos realizados, así como cada
 pedido de forma individual. También queremos poder realizar nuevos pedidos, así
 como actualizar pedidos existentes. El objeto ServicioPedidos representa las
 operaciones que queremos realizar sobre nuestos objetos <em>Pedido</em>, <em>Cliente</em>,
 <em>LineaPedido</em> y <em>Producto</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_modelado_de_uris">1.4.2. Modelado de URIs</h4>
<div class="paragraph">
<p>Lo primero que haremos para crear nuestra interfaz distribuida, es definir y poner
nombre a cada uno de los <em>endpoints</em> de nuestro sistema. En un sistemam RESTful,
los <em>endpoints</em> serán los <strong>recursos</strong> del sistema, que identificaremos mediante
URIs.</p>
</div>
<div class="paragraph">
<p>En nuestro modelo de objetos queremos poder interactuar con <em>Pedidos</em>, <em>Clientes</em>, y
<em>Productos</em>. Éstos serán, por lo tanto, nuestros recursos de nivel más alto. Por
otro lado, estamos interesados en obtener una lista de cada uno de estos elementos
de alto nivel, así como interactuar con los elementos indiduales de cada tipo. El objeto <em>LineaPedido</em>
es un objeto <em>agregado</em> del objeto <em>Pedido</em> por lo que no lo consideraremos com un
recurso de nivel superior. Más adelante veremos que podremos exponerlo como un <strong>subrecurso</strong>
de un <em>Pedido</em> particular, pero por ahora, asumiremos que está "oculto" por el
formato de nuestros datos. Según esto, una posible lista de URIs que expondrá
nuestro sistema podría ser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/pedidos</p>
</li>
<li>
<p>/pedidos/{id}</p>
</li>
<li>
<p>/productos</p>
</li>
<li>
<p>/productos/{id}</p>
</li>
<li>
<p>/clientes</p>
</li>
<li>
<p>/clientes/{id}</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Fíjate que hemos representado como URIs los <strong>nombres</strong> en nuestro modelo de objetos.
 Recuerda que las URIS no deberían utilizarse como mini-mecanismos de RPC ni deberían
 identificar operaciones. En vez de eso, tenemos que utilizar una combinación de
 métodos HTTP y de datos (recursos) para modelar las operaciones de nuestro sistema
 RESTful</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_definición_del_formato_de_datos">1.4.3. Definición del formato de datos</h4>
<div class="paragraph">
<p>Una de las cosas más importantes que tenemos que hacer cuando definimos la interfaz
RESTful es determinar cómo se representarán los recursos que serán accedidos por los usuarios
de nuestro API REST. Quizá XML sea el formato más popular de la web y puede ser procesado por
la mayor parte de los lenguajes de programación. Como veremos más adelante, JSON es
otro formato popular, menos "verboso" que XML, y que puede ser interpretado directamente
por <em>JavaScript</em> (lo cual es perfecto para aplicaciones Ajax por ejemplo). Por
ahora, utilizaremos el formato XML en nuestro ejemplo.</p>
</div>
<div class="paragraph">
<p>Generalmente, tendríamos que definir un esquema XML para cada representación que
queramos transimitir a traves de la red. Un esquema XML define la gramática del
formato de datos. Por simplicidad, vamos a omitir la creación de esquemas, asumiendo
que los ejemplos que proporcionamos se adhieren a sus correspondientes esquemas.</p>
</div>
<div class="paragraph">
<p>A continuación distinguiremos entre <strong>dos formatos de datos</strong>: uno para las operaciones
de lectura y actualización, y otro para la operación de creación de recursos.</p>
</div>
<div class="sect4">
<h5 id="_formato_de_datos_para_operaciones_de_lectura_y_modificación_de_los_recursos">Formato de datos para operaciones de lectura y modificación de los recursos</h5>
<div class="paragraph">
<p>Las representaciones de los recursos <em>Pedido</em>, <em>Cliente</em>, y <em>Producto</em> tendrán un <strong>elemento XML
en común</strong>, al que denominaremos <code>link</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;link rel="self" href="http://org.expertojava/..."/&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>El elemento (o etiqueta) <code>link</code> indica a los clientes que obtengan un documento
XML como representación del recurso, dónde pueden interaccionar en la red con dicho
recurso en particular. El atributo <code>self</code> le indica al cliente qué relación tiene
dicho enlace con la URI del recurso al que apunta (información contenida en el
atributo <code>href</code>). El valor <code>self</code> indica que está "apuntando" a sí mismo.
Más adelante veremos la utilidad del elemento <strong><em>link</em></strong> cuando agreguemos información
en documentos XML "más grandes".</p>
</div>
<div class="paragraph">
<p>El formato de representación del recurso <strong>Cliente</strong> podría ser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;cliente</span> <span class="tok-na">id=</span><span class="tok-s">&quot;8&quot;</span><span class="tok-nt">&gt;</span>
   <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span>
         <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/clientes/8&quot;</span><span class="tok-nt">/&gt;</span>
   <span class="tok-nt">&lt;nombre&gt;</span>Pedro<span class="tok-nt">&lt;/nombre&gt;</span>
   <span class="tok-nt">&lt;apellidos&gt;</span>Garcia Perez<span class="tok-nt">&lt;/apellidos&gt;</span>
   <span class="tok-nt">&lt;direccion&gt;</span>Calle del Pino, 5<span class="tok-nt">&lt;direccion&gt;</span>
   <span class="tok-nt">&lt;codPostal&gt;</span>08888<span class="tok-nt">&lt;/codPostal&gt;</span>
   <span class="tok-nt">&lt;ciudad&gt;</span>Madrid<span class="tok-nt">&lt;/ciudad&gt;</span>
<span class="tok-nt">&lt;/cliente&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El formato de representación del recurso <strong>Producto</strong> podría ser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;producto</span> <span class="tok-na">id=</span><span class="tok-s">&quot;34&quot;</span><span class="tok-nt">&gt;</span>
   <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span>
         <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/productos/34&quot;</span><span class="tok-nt">/&gt;</span>
   <span class="tok-nt">&lt;nombre&gt;</span>iPhone 6<span class="tok-nt">&lt;/nombre&gt;</span>
   <span class="tok-nt">&lt;precio&gt;</span>800<span class="tok-nt">&lt;/precio&gt;</span>
   <span class="tok-nt">&lt;cantidad&gt;</span>1<span class="tok-nt">&lt;/cantidad&gt;</span>
<span class="tok-nt">&lt;/producto&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finalmente, el formato de la representación del recurso <strong>Pedido</strong> podría ser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;pedido</span> <span class="tok-na">id=</span><span class="tok-s">&quot;233&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span> <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/pedidos/233&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;total&gt;</span>800<span class="tok-nt">&lt;/total&gt;</span>
  <span class="tok-nt">&lt;fecha&gt;</span>December 22, 2014 06:56<span class="tok-nt">&lt;/fecha&gt;</span>
  <span class="tok-nt">&lt;cliente</span> <span class="tok-na">id=</span><span class="tok-s">&quot;8&quot;</span><span class="tok-nt">&gt;</span>
     <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span>
                <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/clientes/8&quot;</span><span class="tok-nt">/&gt;</span>
     <span class="tok-nt">&lt;nombre&gt;</span>Pedro<span class="tok-nt">&lt;/nombre&gt;</span>
     <span class="tok-nt">&lt;apellidos&gt;</span>Garcia Perez<span class="tok-nt">&lt;/apellidos&gt;</span>
     <span class="tok-nt">&lt;direccion&gt;</span>Calle del Pino, 5<span class="tok-nt">&lt;direccion&gt;</span>
     <span class="tok-nt">&lt;codPostal&gt;</span>08888<span class="tok-nt">&lt;/codPostal&gt;</span>
     <span class="tok-nt">&lt;ciudad&gt;</span>Madrid<span class="tok-nt">&lt;/ciudad&gt;</span>
  <span class="tok-nt">&lt;/cliente&gt;</span>
  <span class="tok-nt">&lt;lineasPedido&gt;</span>
    <span class="tok-nt">&lt;lineaPedido</span> <span class="tok-na">id=</span><span class="tok-s">&quot;1&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;producto</span> <span class="tok-na">id=</span><span class="tok-s">&quot;34&quot;</span><span class="tok-nt">&gt;</span>
         <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span>
             <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/productos/34&quot;</span><span class="tok-nt">/&gt;</span>
         <span class="tok-nt">&lt;nombre&gt;</span>iPhone 6<span class="tok-nt">&lt;/nombre&gt;</span>
         <span class="tok-nt">&lt;precio&gt;</span>800<span class="tok-nt">&lt;/precio&gt;</span>
         <span class="tok-nt">&lt;cantidad&gt;</span>1<span class="tok-nt">&lt;/cantidad&gt;</span>
      <span class="tok-nt">&lt;/producto&gt;</span>
    <span class="tok-nt">&lt;lineaPedido/&gt;</span>
  <span class="tok-nt">&lt;lineasPedido/&gt;</span>
<span class="tok-nt">&lt;/pedido&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El formato de datos de un <code>Pedido</code> tiene en un primer nivel la información
del <code>total</code>, con el importe total del pedido, así como la <code>fecha</code> en la que
se hizo dicho pedido. <em>Pedido</em> es un buen ejemplo de composición de datos, ya que
un pedido incluye información sobre el <em>Cliente</em> y el <em>Producto/s</em>. Aquí es donde
el elemento <code>&lt;link&gt;</code> puede resultar particularmente útil. Si el usuario está
interesado en interaccionar con el <em>Cliente</em> que ha realizado el pedido, o en uno
de los <em>productos</em> del mismo, se proporciona
la URI necesaria para interactuar con cada uno de dichos recursos. De esta forma, cuando
el usuario del API consulte un pedido, podrá además, acceder a información adicional
relacionada con la consulta realizada.</p>
</div>
</div>
<div class="sect4">
<h5 id="_formato_de_datos_para_operaciones_de_creación_de_los_recursos">Formato de datos para operaciones de creación de los recursos</h5>
<div class="paragraph">
<p>Cuando estamos creando nuevos <em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em>, no tiene
mucho sentido incluir un atributo <strong><em>id</em></strong>  y un elemento <strong><em>link</em></strong> en nuestro
documento XML. El servidor será el encargado de crear los <strong><em>ids</em></strong> cuando
inserte nuestro nuevo objeto en la base de datos. Tampoco conocemos la URI
del nuevo objeto creado, ya que será el servidor el encargado de generarlo.
Por lo tanto, para crear un nuevo <em>Producto</em>, el formato de la información
podría ser el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;producto&gt;</span>
   <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span>
         <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/clientes/8&quot;</span><span class="tok-nt">/&gt;</span>
   <span class="tok-nt">&lt;nombre&gt;</span>iPhone<span class="tok-nt">&lt;/nombre&gt;</span>
   <span class="tok-nt">&lt;precio&gt;</span>800<span class="tok-nt">&lt;/precio&gt;</span>
<span class="tok-nt">&lt;/producto&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asignación_de_métodos_http">1.4.4. Asignación de métodos HTTP</h4>
<div class="paragraph">
<p>Finalmente, tendremos que decidir qué métodos HTTP expondremos en nuestro servicio
para cada uno de los recursos, así como definir qué harán dichos métodos. Es muy
importante no asignar funcionaldad a un método HTTP que "sobrepase" los límites
impuestos por la especificación de dicho método. Por ejemplo, una operación GET
sobre un recurso concreto debería ser de sólo lectura. No debería cambiar el estado
del recurso cuando invoquemos la operación GET sobre él. Si no seguimos de forma
estricta la semántica de los métodos HTTP, los clientes, así como cualquier otra
herramienta administrativa, no pueden hacer asunciones sobre nuestros servicios, de
forma que nuestro sistema se vuelve más complejo.</p>
</div>
<div class="paragraph">
<p>Veamos, para cada uno de los métodos de nuestro modelo de objetos, cuales serán
las URIs y métodos HTTP que usaremos para representarlos.</p>
</div>
<div class="sect4">
<h5 id="_visualización_de_todos_los_em_pedidos_em_em_clientes_em_o_em_productos_em">Visualización de todos los <em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em></h5>
<div class="paragraph">
<p>Los tres objetos de nuestro modelo: <em>Pedidos</em>, <em>Clientes</em> y <em>Productos</em>, son
accedidos y manipulados de forma similar. Los usuarios pueden estar interesados
en ver <strong>todos</strong> los <em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em> en el sistema. Las siguientes
URIs representan dichos objetos como un grupo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/pedidos</p>
</li>
<li>
<p>/productos</p>
</li>
<li>
<p>/clientes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para obtener una lista de <em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em>, el cliente remoto
realizara una llamada al método HTTP GET sobre la URI que representa el grupo de
objetos. Un ejemplo de petición podría ser la siguiente:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /productos HTTP/1.1</pre>
</div>
</div>
<div class="paragraph">
<p>Nuestro servicio responderá con los datos que representan todos los <em>Pedidos</em>
 de nuestro sistema. Una respuesta podría ser ésta:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">HTTP/1.1 200 OK
Content-Type: application/xml

<span class="tok-nt">&lt;productos&gt;</span>
   <span class="tok-nt">&lt;producto</span> <span class="tok-na">id=</span><span class="tok-s">&quot;111&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span> <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/productos/111&quot;</span><span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;nombre&gt;</span>iPhone<span class="tok-nt">&lt;/nombre&gt;</span>
      <span class="tok-nt">&lt;precio&gt;</span>648.99<span class="tok-nt">&lt;/precio&gt;</span>
   <span class="tok-nt">&lt;/producto&gt;</span>
   <span class="tok-nt">&lt;producto</span> <span class="tok-na">id=</span><span class="tok-s">&quot;222&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span> <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/productos/222&quot;</span><span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;nombre&gt;</span>Macbook<span class="tok-nt">&lt;/nombre&gt;</span>
      <span class="tok-nt">&lt;precio&gt;</span>1599.99<span class="tok-nt">&lt;/precio&gt;</span>
   <span class="tok-nt">&lt;/producto&gt;</span>
    ...
<span class="tok-nt">&lt;/productos&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Un problema que puede darse con esta petición es que tengamos miles de <em>Pedidos</em>,
<em>Clientes</em> o <em>Productos</em> en nuestro sistema, por lo que podemos "sobrecargar" a
nuestro cliente y afectar negativamente a los tiempos de respuesta. Para mitigar
esta problema, permitiremos que el usuario especifique unos parámetros en la URI para
limitar el tamaño del conjunto de datos que se va a devolver:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">GET /pedidos?startIndex<span class="tok-o">=</span>0<span class="tok-p">&amp;</span><span class="tok-nv">size</span><span class="tok-o">=</span><span class="tok-m">5</span> HTTP/1.1
GET /productos?startIndex<span class="tok-o">=</span>0<span class="tok-p">&amp;</span><span class="tok-nv">size</span><span class="tok-o">=</span><span class="tok-m">5</span> HTTP/1.1
GET /clientes?startIndex<span class="tok-o">=</span>0<span class="tok-p">&amp;</span><span class="tok-nv">size</span><span class="tok-o">=</span><span class="tok-m">5</span> HTTP/1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>En las órdenes anteriores, hemos definido dos parámetros de petición: <code>startIndex</code>, y
<code>size</code>. El primero de ellos es un índice numérico que representa a partir de qué posición en la lista de
<em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em>, comenzaremos a enviar la información al cliente.
El parámetro <code>size</code> especifica cuántos de estos objetos de la lista queremos
que nos sean devueltos.</p>
</div>
<div class="paragraph">
<p>Estos parámetros serán opcionales, de forma que el cliente no tiene que especificarlos en su URI.</p>
</div>
</div>
<div class="sect4">
<h5 id="_obtención_de_em_pedidos_em_em_clientes_em_o_em_productos_em_individuales">Obtención de <em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em> individuales</h5>
<div class="paragraph">
<p>Ya hemos comentado previamente que podríamos utilizar las siguientes URIs para obtener
<em>Pedidos</em>, <em>Clientes</em> o <em>Productos</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/pedidos/{id}</p>
</li>
<li>
<p>/productos/{id}</p>
</li>
<li>
<p>/clientes/{id}</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>En este caso usaremos el método HTTP GET para recuperar objetos individuales en el sistema.
Cada invocación GET devolverá la información del correspondiente objeto. Por ejemplo:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /pedidos/233 HTTP/1.1</pre>
</div>
</div>
<div class="paragraph">
<p>Para esta petición, el cliente está interesado en obtener una representación del <em>Pedido</em>
 con identificador 233. Las peticiones GET para <em>Productos</em> y <em>Clientes</em> podrían funcionar
 de forma similar. El mensaje de respuesta podría parecerse a algo como esto:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">HTTP/1.1 200 OK
Content-Type: application/xml

<span class="tok-nt">&lt;pedido</span> <span class="tok-na">id=</span><span class="tok-s">&quot;233&quot;</span><span class="tok-nt">&gt;</span>...<span class="tok-nt">&lt;/pedido&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El <strong>código de respuesta</strong> es <strong>200 OK</strong>, indicando que la petición ha tenido éxito.
La cabecera <code>Content-Type</code> especifica el formato del cuerpo de nuestro mensaje
como XML, y finalmente obtenemos la representación del <em>Pedido</em> solicitado.</p>
</div>
</div>
<div class="sect4">
<h5 id="_creación_de_un_em_pedido_em_em_cliente_em_o_em_producto_em">Creación de un <em>Pedido</em>, <em>Cliente</em> o <em>Producto</em></h5>
<div class="paragraph">
<p>Para crear un <em>Pedido</em>, <em>Cliente</em> o <em>Producto</em> utilizaremos el método POST. En este
caso, el cliente envía una representación del nuevo objeto que se prentende crear
a la URI "padre" de su representación, y por lo tanto, podremos omitir el identificador
del recurso. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="title">Petición POST para crear un pedidio</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">POST /pedidos HTTP/1.1
Content-Type: application/xml

<span class="tok-nt">&lt;pedido&gt;</span>
   <span class="tok-nt">&lt;total&gt;</span>199.02<span class="tok-nt">&lt;/total&gt;</span>
   <span class="tok-nt">&lt;fecha&gt;</span>December 22, 2008 06:56<span class="tok-nt">&lt;/fecha&gt;</span>
   ...
<span class="tok-nt">&lt;/pedido&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El servicio recibe el mensaje POST, procesa la XML, y crea un nuevo pedido en la base
de datos utilizando un identificador generado de forma única. Si bien esta aproximación
"funciona" perfectamente, se le pueden plantear varias cuestiones al usuario. ¿Qué
ocurre si el usuario quiere visualizar, modificar o eliminar el pedido que acaba
de crear? ¿Cuál es el identificador del nuevo recurso? ¿Cuál es la URI que podemos
utilizar para interactuar con el nuevo recurso? Para resolver estas cuestiones, añadiremos
alguna información al mensaje de respuesta HTTP. El cliente podría recibir un mensaje
similar a éste:</p>
</div>
<div class="listingblock">
<div class="title">Respuesta de una petición POST para crear un pedido</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">HTTP/1.1 201 Created
Content-Type: application/xml
Location: http://org.expertojava/pedidos/233

<span class="tok-nt">&lt;pedido</span> <span class="tok-na">id=</span><span class="tok-s">&quot;233&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span> <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/pedidos/233&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;total&gt;</span>199.02<span class="tok-nt">&lt;/total&gt;</span>
    <span class="tok-nt">&lt;fecha&gt;</span>December 22, 2008 06:56<span class="tok-nt">&lt;/fecha&gt;</span>
    ...
<span class="tok-nt">&lt;/pedido&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>HTTP requiere que si POST crea un nuevo recurso, se debe responder con un código
<code>201 Created</code>. También se requieer que la cabecera <code>Location</code> en el mensaje de respuesta proporcione
una URI al usuario que ha hecho la petición para que éste pueda interactuar con la
<em>Petición</em> que acaba de crear (por ejemplo, para modificar dicho <em>Pedido</em>). Es
<strong>opcional</strong> por parte del servidor devolver en la respuesta la representación del nuevo
recurso creado. En nuestro ejemplo optamos por devolver una representación XML de la <em>Peticion</em>
 creada con el identificador del atributo así como el elemento <code>link</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_actualización_de_un_em_pedido_em_em_cliente_em_o_em_producto_em">Actualización de un <em>Pedido</em>, <em>Cliente</em> o <em>Producto</em></h5>
<div class="paragraph">
<p>Para realizar modificaciones sobre los recursos que ya hemos creado utilizaremos el
método PUT. En este caso, un ejemplo de petición podría ser ésta:</p>
</div>
<div class="listingblock">
<div class="title">Petición PUT para modificar un pedidio</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">PUT /pedidos/233 HTTP/1.1
Content-Type: application/xml

<span class="tok-nt">&lt;producto</span> <span class="tok-na">id=</span><span class="tok-s">&quot;111&quot;</span><span class="tok-nt">&gt;</span>
   <span class="tok-nt">&lt;nombre&gt;</span>iPhone<span class="tok-nt">&lt;/nombre&gt;</span>
   <span class="tok-nt">&lt;precio&gt;</span>649.99<span class="tok-nt">&lt;/precio&gt;</span>
<span class="tok-nt">&lt;/producto&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Tal y como he hemos indicado anteriormente, la operación PUT es <strong>idempotente</strong>. Lo que
significa que no importa cuántas veces solicitemos la petición PUT, el producto
subyacente sigue permaneciendo con el mismo estado final.</p>
</div>
<div class="paragraph">
<p>Cuando un recurso se modifica mediante PUT, la especificación HTTP requiere que el
servidor envíe un código de respuesta <code>200 OK</code>, y un cuerpo de mensaje de respuesta,
o bien el código <code>204 No Content</code>, sin ningún cuerpo de mensaje en la respuesta.</p>
</div>
<div class="paragraph">
<p>En nuestro caso, devolveremos un código de estado <strong>204</strong> y un mensaje sin cuerpo de respuesta.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title">RECUERDA: Es importante NO confundir POST con PUT</div>
<div class="paragraph">
<p>Muchas veces se confunden los métodos PUT y POST. El significado de estos métodos es el siguiente:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>POST</strong>: Publica datos en un determinado recurso. El recurso debe existir previamente,
y los datos enviados son añadidos a él. Por ejemplo, para añadir nuevos pedidos con POST
hemos visto que debíamos hacerlo con el recurso lista de pedidos (/pedidos), ya que la URI
del nuevo pedido todavía no existe. La operación <strong>NO es idempotente</strong>, es decir,
si añadimos varias veces el mismo alumno aparecerá repetido en nuestra lista de pedidos
  con URIs distintas.</p>
</li>
<li>
<p><strong>PUT</strong>: Hace que el recurso indicado tome como contenido los datos enviados.
El recurso podría no existir previamente, y en caso de que existiese sería sobrescrito
con la nueva información. A diferencia de POST, <strong>PUT es idempotente</strong>: Múltiples
llamadas idénticas a la misma acción PUT siempre dejarán el recurso en el <strong>mismo
estado</strong>. La acción se realiza sobre la URI concreta que queremos establecer
(por ejemplo, /pedidos/215), de forma que varias llamadas consecutivas con los
mismos datos tendrán el mismo efecto que realizar sólo una de ellas.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_borrado_de_un_em_pedido_em_em_cliente_em_o_em_producto_em">Borrado de un <em>Pedido</em>, <em>Cliente</em> o <em>Producto</em></h5>
<div class="paragraph">
<p>Modelaremos el borrado de los recursos utilizando el método HTTP DELETE. El usuario
simplemente invocará el método DELETE sobre la URI que representa el objeto que
queremos eliminar. Este método hará que dicho recurso ya no exista en nuestro sistema.</p>
</div>
<div class="paragraph">
<p>Cuando eliminamos un recurso con DELETE, la especificación requiere que se envíe
un código de respuesta <code>200 OK</code>, y un cuerpo de mensaje de respuesta, o bien
un código de respuesta <code>204 No Content</code>, sin un cuerpo de mensaje de respuesta.</p>
</div>
<div class="paragraph">
<p>En nuestro caso, devolveremos un código de estado <strong>204</strong> y un mensaje sin cuerpo de respuesta.</p>
</div>
</div>
<div class="sect4">
<h5 id="_cancelación_de_un_em_pedido_em">Cancelación de un <em>Pedido</em></h5>
<div class="paragraph">
<p>Hasta ahora, las operaciones de nuestro modelo de objetos "encajan" bastante bien
en la especificación de los correspondientes métodos HTTP. Hemos utilzado GET para
leer datos, PUT para realizar modificaciones POST para crear nuevos recursos, y
DELETE para eliminarlos. En nuestro sistema, los <em>Pedidos</em> pueden eliminarse, o también
cancelarse. Ya hemos comentado que el borrado de un recurso lo "elimina completamente"
de nuestra base de datos. La operación de cancelación solamente cambia el estado del
<em>Pedido</em>, y lo sigue manteniendo en el sistema. ¿Cómo podríamos modelar esta operación?</p>
</div>
<div class="paragraph">
<p>Cuando modelamos una interfaz RESTful para las operaciones de nuestro modelo de objetos,
deberíamos plantearnos la siguiente pregunta: ¿la operación es un estado del recurso?
Si la respuesta es sí, entonces deberíamos modelar esta operación "dentro" del
formato de los datos.</p>
</div>
<div class="paragraph">
<p>La cancelación de un pedido es un ejemplo perfecto de esto que acabamos de decir.
La clave está en que esta operación, en realidad es un estado específico del <em>Pedido</em>: éste
puede estar cancelado o no. Cuando un usuario accede a un <em>Pedido</em>, puede desear
conocer si el <em>Pedido</em> ha sido o no cancelado. Por lo tanto, la información sobre
la cancelación debería formar parte del formato de datos de un <em>Pedido</em>. Así,
 añadiremos un nuevo elemento a la información del <em>Pedido</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;pedido</span> <span class="tok-na">id=</span><span class="tok-s">&quot;233&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span> <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/pedidos/233&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;total&gt;</span>199.02<span class="tok-nt">&lt;/total&gt;</span>
    <span class="tok-nt">&lt;fecha&gt;</span>December 22, 2008 06:56<span class="tok-nt">&lt;/fecha&gt;</span>
    <span class="tok-nt">&lt;cancelado&gt;</span>false<span class="tok-nt">&lt;/cancelado&gt;</span>
    ...
<span class="tok-nt">&lt;/pedido&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ya que el estado "cancelado" se modela en el propio formato de datos, modelaremos
la acción de cancelación con una operación HTTP PUT, que ya conocemos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">PUT /pedidos/233 HTTP/1.1
Content-Type: application/xml

<span class="tok-nt">&lt;pedido</span> <span class="tok-na">id=</span><span class="tok-s">&quot;233&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;link</span> <span class="tok-na">rel=</span><span class="tok-s">&quot;self&quot;</span> <span class="tok-na">href=</span><span class="tok-s">&quot;http://org.expertojava/pedidos/233&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;total&gt;</span>199.02<span class="tok-nt">&lt;/total&gt;</span>
    <span class="tok-nt">&lt;fecha&gt;</span>December 22, 2008 06:56<span class="tok-nt">&lt;/fecha&gt;</span>
    <span class="tok-nt">&lt;cancelado&gt;</span>true<span class="tok-nt">&lt;/cancelado&gt;</span>
    ...
<span class="tok-nt">&lt;/pedido&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este ejemplo, modificamos la representación del <em>Pedido</em> con el elemento <code>&lt;cancelado&gt;</code>
con valor <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Este "patrón" de modelado, no siempre "sirve" en todos los casos. Por ejemplo,
imaginemos que queremos ampliar el sistema de forma que "borremos" del sistema
todos los pedidos cancelados. No podemos modelar esta operación de la misma manera
que la de cancelación, ya que esta operación no cambia el estado de nuestra aplicación
(no es en sí misma un estado de la aplicación).</p>
</div>
<div class="paragraph">
<p>Para resolver este problema, podemos modelar esta nueva operación como un
"subrecurso" de <em>/pedidos</em>, y realizar un borrado de los pedidos cancelados, mediante el método
HTTP POST de dicho subrecurso, de la siguiente forma:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /pedidos/eliminacion HTTP/1.1</pre>
</div>
</div>
<div class="paragraph">
<p>Un efecto interesante de lo que acabamos de hacer es que, puesto que ahora <code>eliminacion</code>
es una URI, podemos hacer que la interfaz de nuestro servicios RESTful evolucionen
 con el tiempo. Por ejemplo, la orden <strong>GET /pedidos/eliminacion</strong> podría devolver la última
 fecha en la que se procedió a eliminar todos los pedidos cancelados, así como qué
 pedidos fueron cancelados. ¿Y si queremos añadir algún criterio a la hora de
 realizar el borrado de pedidos cancelados? Podríamos introducir parámetros para
 indicar que sólo queremos eliminar aquellos pedidos que estén cancelados en una
 fecha anterior a una dada. Como vemos, podemos mantener una interfaz uniforme y
 ceñirnos a las operaciones HTTP tal y como están especificadas, y a la vez, dotar
 de una gran flexiblidad a la interfaz de nuestro sistema RESTful. Hablaremos con más
 detalle de los subrecursos en la siguiente sesión.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_implementación_del_servicio_creación_del_proyecto_maven">1.4.5. Implementación del servicio: Creación del proyecto Maven</h4>
<div class="paragraph">
<p>Vamos a utilizar Maven para crear la estructura del proyecto que contendrá la implementación de nuestro
servicio Rest. Inicialmente, podemos utilizar el mismo arquetipo con el que habéis trabajado en sesiones anteriores. Y
a continuación modificaremos la configuración del fichero <em>pom.xml</em>, para implementar nuestros servicios.</p>
</div>
<div class="paragraph">
<p>Una opción es generar la estructura del proyecto directamente <strong>desde línea de comandos</strong>. El comando es el siguiente
(recuerda que debes escribirlo en una misma línea. Los
caracteres "\" que aparecen en el comando no forman parte del mismo, simplemente indican que no se debe
pulsar el retorno de carro):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">mvn --batch-mode archetype:generate <span class="tok-se">\</span>
      -DarchetypeGroupId<span class="tok-o">=</span>org.codehaus.mojo.archetypes <span class="tok-se">\</span>
      -DarchetypeArtifactId<span class="tok-o">=</span>webapp-javaee7 <span class="tok-se">\</span>
      -DgroupId<span class="tok-o">=</span>org.expertojava -DartifactId<span class="tok-o">=</span>ejemplo-rest</code></pre>
</div>
</div>
<div class="paragraph">
<p>En donde:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetypeGroupId</code> y <code>archetypeArtifactId</code> son los nombres del <em>groupId</em> y <em>artifactId</em> del
<strong>arquetipo Maven</strong> que nos va a generar la "plantilla" para nuestro proyecto</p>
</li>
<li>
<p><code>groupId</code> y <code>artifactId</code> son los nombres que asignamos como <em>groupId</em> y <em>artifactId</em> de
<strong>nuestro proyecto</strong>. En este caso hemos elegido los valores <em>org.expertojava</em> y <em>ejemplo-rest</em>,
respectivamente</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Si utilizamos IntelliJ para crear el proyecto tenemos que:</div>
<ol class="arabic">
<li>
<p>Crear un nuevo proyecto (<strong><em>New Project</em></strong>)</p>
</li>
<li>
<p>Elegir el tipo de proyecto <strong>Maven</strong></p>
</li>
<li>
<p>Crear el proyecto Maven a partir de un <strong>arquetipo</strong> con las siguientes <strong>coordenadas</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>GroupId: <em>org.codehaus.mojo.archetypes</em></p>
</li>
<li>
<p>ArtifactId: <em>webapp-javaee7</em></p>
</li>
<li>
<p>Version: <em>1.1</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Indicar las <strong>coordenadas</strong> de nuestro <strong>proyecto</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>GroupId: <em>org.expertojava</em></p>
</li>
<li>
<p>ArtifactId: <em>ejemplo-rest</em></p>
</li>
<li>
<p>Version: <em>1.0-SNAPSHOT</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Confirmamos los datos introducidos</p>
</li>
<li>
<p>Para finalizar, especificamos el nombre de nuestro <strong>proyecto en IntelliJ</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Project Name: <em>ejemplo-rest</em> (este valor también identificará el nombre del
módulo en IntelliJ)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Por comodidad, marcaremos <em>Enable autoimport</em> para importar automáticamente cualquier cambio
en el proyecto</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Una vez que hemos creado el proyecto con IntelliJ, el paso siguiente es cambiar
la configuración del <em>pom.mxl</em> que nos ha generado el arquetipo, para incluir las
<em>propiedades</em>, <em>dependencias</em>, <em>plugins</em>,&#8230;&#8203;, que necesitaremos para implementar nuestros
recursos REST.</p>
</div>
<div class="paragraph">
<p>Como ya sabemos, el fichero <em>pom.xml</em> contiene la configuración que
utiliza Maven para construir el proyecto.
A continuación indicamos las <strong>modificaciones en el fichero <em>pom.xml</em></strong> generado
inicialmente, para adecuarlo a nuestras necesidades particulares:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cambiamos las <strong>propiedades</strong> del proyecto (etiqueta <code>&lt;properties&gt;</code>) por:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Propiedades del proyecto</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;properties&gt;</span>
    <span class="tok-nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="tok-nt">&lt;/project.build.sourceEncoding&gt;</span>
<span class="tok-nt">&lt;/properties&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Indicamos las <strong>dependencias</strong> del proyecto (etiqueta <code>&lt;dependencies&gt;</code>, en donde se
incluyen las librerías necesarias para la construcción del proyecto).
 En nuestro caso, necesitamos incluir la librería <code>javax:javaee-web-api:7.0</code> que contiene el api estándar de
 javaee 7. Marcamos el ámbito de la librería (etiqueta <code>&lt;scope&gt;</code>) como <code>provided</code>.
 Con esto estamos indicando que sólo necesitaremos el jar
 correspondiente para "compilar" el proyecto, y por lo tanto <strong>no incluiremos</strong> dicho <em>jar</em>,
 en el fichero <strong><em>war</em></strong> generado para nuestra aplicación, ya que dicha librería ya estará
 disponible desde el servidor de aplicaciones en el que residirá nuestra aplicación.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Librerías utilizadas para construir el proyecto (dependencias)</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;dependencies&gt;</span>
  <span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>javax<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>javaee-web-api<span class="tok-nt">&lt;/artifactId&gt;</span>
    <span class="tok-nt">&lt;version&gt;</span>7.0<span class="tok-nt">&lt;/version&gt;</span>
    <span class="tok-nt">&lt;scope&gt;</span>provided<span class="tok-nt">&lt;/scope&gt;</span>
  <span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A continuación configuramos la <strong>construcción</strong> del proyecto (etiqueta <code>&lt;build&gt;</code>),
de la siguiente forma (cambiamos la configuración original por la que mostramos a continuación):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Configuración de la construcción del proyecto</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;build&gt;</span>
  <span class="tok-c">&lt;!-- Especificamos el nombre del war que será usado como context root</span>
<span class="tok-c">       cuando despleguemos la aplicación --&gt;</span>
  <span class="tok-nt">&lt;finalName&gt;</span>${project.artifactId}<span class="tok-nt">&lt;/finalName&gt;</span>

  <span class="tok-nt">&lt;plugins&gt;</span>
    <span class="tok-c">&lt;!-- Compilador de java. Utilizaremos la versión 1.7 --&gt;</span>
    <span class="tok-nt">&lt;plugin&gt;</span>
      <span class="tok-nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tok-nt">&lt;/groupId&gt;</span>
      <span class="tok-nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="tok-nt">&lt;/artifactId&gt;</span>
      <span class="tok-nt">&lt;version&gt;</span>3.1<span class="tok-nt">&lt;/version&gt;</span>
        <span class="tok-nt">&lt;configuration&gt;</span>
            <span class="tok-nt">&lt;source&gt;</span>1.7<span class="tok-nt">&lt;/source&gt;</span>
            <span class="tok-nt">&lt;target&gt;</span>1.7<span class="tok-nt">&lt;/target&gt;</span>
        <span class="tok-nt">&lt;/configuration&gt;</span>
    <span class="tok-nt">&lt;/plugin&gt;</span>

    <span class="tok-c">&lt;!-- Servidor de aplicaciones wildfly --&gt;</span>
    <span class="tok-nt">&lt;plugin&gt;</span>
      <span class="tok-nt">&lt;groupId&gt;</span>org.wildfly.plugins<span class="tok-nt">&lt;/groupId&gt;</span>
      <span class="tok-nt">&lt;artifactId&gt;</span>wildfly-maven-plugin<span class="tok-nt">&lt;/artifactId&gt;</span>
      <span class="tok-nt">&lt;version&gt;</span>1.0.2.Final<span class="tok-nt">&lt;/version&gt;</span>
      <span class="tok-nt">&lt;configuration&gt;</span>
          <span class="tok-nt">&lt;hostname&gt;</span>localhost<span class="tok-nt">&lt;/hostname&gt;</span>
          <span class="tok-nt">&lt;port&gt;</span>9990<span class="tok-nt">&lt;/port&gt;</span>
      <span class="tok-nt">&lt;/configuration&gt;</span>
    <span class="tok-nt">&lt;/plugin&gt;</span>

    <span class="tok-c">&lt;!-- Cuando generamos el war no es necesario</span>
<span class="tok-c">         que el fichero web.xml esté presente --&gt;</span>
    <span class="tok-nt">&lt;plugin&gt;</span>
        <span class="tok-nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tok-nt">&lt;/groupId&gt;</span>
        <span class="tok-nt">&lt;artifactId&gt;</span>maven-war-plugin<span class="tok-nt">&lt;/artifactId&gt;</span>
        <span class="tok-nt">&lt;version&gt;</span>2.3<span class="tok-nt">&lt;/version&gt;</span>
        <span class="tok-nt">&lt;configuration&gt;</span>
            <span class="tok-nt">&lt;failOnMissingWebXml&gt;</span>false<span class="tok-nt">&lt;/failOnMissingWebXml&gt;</span>
        <span class="tok-nt">&lt;/configuration&gt;</span>
    <span class="tok-nt">&lt;/plugin&gt;</span>
  <span class="tok-nt">&lt;/plugins&gt;</span>
<span class="tok-nt">&lt;/build&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_implementación_del_servicio_recursos_jax_rs">1.4.6. Implementación del servicio: Recursos JAX-RS</h4>
<div class="paragraph">
<p>Una vez que tenemos la estructura del proyecto, implementaremos los <strong>recursos</strong>
de nuestra aplicación, que serán clases Java que utilizarán anotaciones JAX-RS
para enlazar y mapear peticiones HTTP específicas a métodos java, los cuales
servirán dichas peticiones. En este caso, vamos a ilustrar con un ejemplo, una posible
implementación para el recurso <em>Cliente</em>. Tenemos que diferenciar entre las clases
java que representarán <strong>entidades de nuestro dominio</strong> (objetos java que representan
elementos de nuestro negocio, y que serán almacenados típicamente en una base de
datos), de nuestros <strong>recursos JAX-RS</strong>, que también serán clases java anotadas,
y que utilizarán objetos de nuestro dominio para llevar a cabo las operaciones
expuestas en el API RESTful que hemos diseñado.</p>
</div>
<div class="paragraph">
<p>Así, por ejemplo, implementaremos las clases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cliente.java</strong>: representa una entidad del dominio. Contiene atributos, y sus
correspondientes <em>getters</em> y <em>setters</em></p>
</li>
<li>
<p><strong>ClienteResource.java</strong>: representa las operaciones RESTful sobre nuestro recurso <em>Cliente</em> que hemos definido
en esta sesión. Es una clase java con anotaciones JAX-RS que nos permitirá
insertar, modificar, borrar, consultar un cliente, así como consultar la lista de
clientes de nuestro sistema.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_clases_de_nuestro_dominio_entidades_cliente_java">Clases de nuestro dominio (entidades): Cliente.java</h5>
<div class="paragraph">
<p>La clase que representa nuestra entidad del dominio <strong>Cliente</strong> es una clase java plana,
con sus correspondientes atributos, y <em>getters</em> y <em>setters</em>.</p>
</div>
<div class="listingblock">
<div class="title">Implementación del dominio: cliente.java</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">expertojava</span><span class="tok-o">.</span><span class="tok-na">domain</span><span class="tok-o">;</span>

<span class="tok-nd">@XmlRootElement</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;cliente&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@XmlAccessorType</span><span class="tok-o">(</span><span class="tok-n">XmlAccessType</span><span class="tok-o">.</span><span class="tok-na">FIELD</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Cliente</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">;</span>
    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">;</span>
    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">apellidos</span><span class="tok-o">;</span>
    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">direccion</span><span class="tok-o">;</span>
    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">codPostal</span><span class="tok-o">;</span>
    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">ciudad</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-kt">int</span> <span class="tok-nf">getId</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">id</span><span class="tok-o">;</span> <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setId</span><span class="tok-o">(</span><span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">id</span> <span class="tok-o">=</span> <span class="tok-n">id</span><span class="tok-o">;</span> <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getNombre</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">nombre</span><span class="tok-o">;</span> <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setNombre</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">nom</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">nombre</span> <span class="tok-o">=</span> <span class="tok-n">nom</span><span class="tok-o">;</span> <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getApellidos</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">apellidos</span><span class="tok-o">;</span> <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setApellidos</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">apellidos</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">apellidos</span> <span class="tok-o">=</span> <span class="tok-n">apellidos</span><span class="tok-o">;</span> <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getDireccion</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">direccion</span><span class="tok-o">;</span> <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setDireccion</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">dir</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">direccion</span> <span class="tok-o">=</span> <span class="tok-n">dir</span><span class="tok-o">;</span> <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getCodPostal</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">codPostal</span><span class="tok-o">;</span> <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setCodPostal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">cp</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">codPostal</span> <span class="tok-o">=</span> <span class="tok-n">cp</span><span class="tok-o">;</span> <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getCiudad</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">ciudad</span><span class="tok-o">;</span> <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setCiudad</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">ciudad</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">ciudad</span> <span class="tok-o">=</span> <span class="tok-n">ciudad</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Hemos anotado la clase <em>Cliente</em> con <code>@XmlRootElement</code> y <code>@XmlAccessorType</code>.
Hablaremos de estas anotaciones en sesiones posteriores, las cuales se encargan del serializado/deserializado
del cuerpo del mensaje (en formato xml o json) a nuestra clase java <em>Cliente</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_clases_de_nuestro_servicio_restful_clienteresource_java">Clases de nuestro servicio RESTful: ClienteResource.java</h5>
<div class="paragraph">
<p>Una vez definido el objeto de nuestro dominio que representará un objeto <em>Cliente</em>,
vamos a ver cómo implementar nuestros servicio JAX-RS para que diferentes usuarios,
de forma remota, puedan interactuar con nuestra base de datos de clientes.</p>
</div>
<div class="paragraph">
<p>La implementación del servicio es lo que se denomina una <strong>resource class</strong>, que no es
más que una clase java que utiliza anotaciones JAX-RS.</p>
</div>
<div class="paragraph">
<p>Por defecto, una nueva instancia de nuestra clase de recursos se crea para <strong>cada
petición</strong> a ese recurso. Es lo que se conoce como un objeto <strong>per-request</strong>. Esto
implica que se crea un objeto Java para procesar <strong>cada</strong> petición de entrada,
y se "destruye" automáticamente cuando la petición
se ha servido. <em>Per-request</em> también implica "sin estado", ya que no se
guarda el estado del servicio entre peticiones.</p>
</div>
<div class="paragraph">
<p>Comencemos con la implementación del servicio:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">expertojava</span><span class="tok-o">.</span><span class="tok-na">services</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">...</span><span class="tok-o">;</span>

<span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>

    <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;</span> <span class="tok-n">clienteDB</span> <span class="tok-o">=</span>
            <span class="tok-k">new</span> <span class="tok-n">ConcurrentHashMap</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;();</span>
    <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-n">AtomicInteger</span> <span class="tok-n">idContador</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nf">AtomicInteger</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Podemos observar que <em>ClientResource</em> es una clase java plana,y  que no implementa
ninguna interfaz JAX-RS particular. La anotación <code>javax.ws.rs.Path</code> indica que
la clase <em>ClienteResource</em> es un servicio JAX-RS. Todas las clases que queramos que
sean "reconocidas" como servicios JAX-RS tienen que tener esta anotación. Fíjate que
esta anotación tiene el valor <code>/clientes</code>. Este valor representa la raíz relativa
de la URI de nuestro servicio RESTful. Si la URI absoluta de nuestro servidor es, por
ejemplo: <em><a href="http://expertojava.org" class="bare">http://expertojava.org</a></em>, los métodos expuestos por nuestra clase <em>ClienteResource</em>
 estarían disponibles bajo la URI <em><a href="http://expertojava.org/clientes" class="bare">http://expertojava.org/clientes</a></em>.</p>
</div>
<div class="paragraph">
<p>En nuestra clase, definimos un Mapa para el campo <code>ClienteDB</code>, que almacenará
en memoria a los objetos <em>Cliente</em> de nuestro sistema. Utilizamos un <em>java.util.concurrent.ConcurrentHashMap</em>
como tipo de <em>clienteDB</em> ya que nuestro recurso será accedido <strong>concurrentemente</strong>
por los usuarios de nuestro servicio rest. El campo <code>idContador</code> lo utilizaremos para
generar nuevos identificadores de nuestros objetos <em>Cliente</em> creados. El tipo de este
campo es <em>java.util.concurrent.atomic.AtomicInteger</em> para garantizar que siempre
generaremos un identificador único aunque tengamos peticiones concurrentes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Justificación del caracter <strong>static</strong> de los atributos</div>
<div class="paragraph">
<p>Como nuestros objetos serán de tipo <strong>per-request</strong>, el
runtime de JAX-RS creará una instancia de <em>ClienteResource</em> <strong>para cada
peción</strong> que se realice sobre nuestro servicio. La máquina virtual de java ejecutará
cada petición a nuestro servicio en un hilo (<em>thread</em>) diferente, permitiendo así el acceso
concurrente a nuestro recurso. Puesto que hemos decidido almacenar
en memoria la información de los clientes, necesitamos que los atributos <strong>clienteDB</strong> y
<strong>idContador</strong> sean <strong>static</strong>, para que todas las instancias de <em>ClienteResource</em> tengan
acceso a la lista de clientes en memoria y no haya problemas de concurrencia. En realidad, lo que estamos haciendo con ésto
es permitir que el servicio guarde el estado entre peticiones. En un sistema real,
<em>ClienteResource</em> probablemente interactúe con una base de datos para almacenar y recuperar la información de los
clientes, y por lo tanto, no necesitaremos guardar el estado entre peticiones.</p>
</div>
<div class="paragraph">
<p>Una mejor solución sería no utilizar variables estáticas, y definir nuestro servicio
como <strong>singleton</strong>. Si hacemos ésto, solamente se crearía una instancia de <em>clienteResource</em>
y estaríamos manteniendo el estado de las peticiones. En la siguiente sesión
explicaremos cómo configurar un servicio como <strong>singleton</strong>. Por simplicidad, de momento
optaremos por la opción de que los objetos RESTful sean <strong>per-request</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_creación_de_clientes">Creación de clientes</h5>
<div class="paragraph">
<p>Para implementar la creación de un nuevo cliente utilizamos el mismo modelo que
hemos diseñado previamente. Una petición HTTP POST envía un documento XML
que representa al cliente que queremos crear.</p>
</div>
<div class="paragraph">
<p>El código para crear nuevos clientes en nuestro sistema podría ser éste:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@POST</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="tok-kd">public</span> <span class="tok-n">Response</span> <span class="tok-nf">crearCliente</span><span class="tok-o">(</span><span class="tok-n">Cliente</span> <span class="tok-n">cli</span><span class="tok-o">)</span> <span class="tok-o">{</span> <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="tok-c1">//el parámetro cli se instancia con los datos del cliente del body del mensaje HTTP</span>
  <span class="tok-n">idContador</span><span class="tok-o">++;</span>
  <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">setId</span><span class="tok-o">(</span><span class="tok-n">idContador</span><span class="tok-o">.</span><span class="tok-na">incrementAndGet</span><span class="tok-o">());</span>
  <span class="tok-n">clienteDB</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-n">cli</span><span class="tok-o">);</span>   <i class="conum" data-value="4"></i><b>(4)</b>
  <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Cliente creado &quot;</span> <span class="tok-o">+</span> <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span> <i class="conum" data-value="5"></i><b>(5)</b>
  <span class="tok-k">return</span> <span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">created</span><span class="tok-o">(</span><span class="tok-n">URI</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes/&quot;</span>
                <span class="tok-o">+</span> <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">())).</span><span class="tok-na">build</span><span class="tok-o">();</span>  <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>se recibe una petición POST</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>el cuerpo de la petición debe tener formato xml</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>contiene la información del documento xml del cuerpo de la petición de entrada</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>se añade el nuevo objeto <em>Cliente</em> a nuestro "mapa" de clientes (<strong>clienteDB</strong>)</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>este método se ejectua en el servidor, por lo que el mensaje sólo será visible, por
ejemplo, si consultamos los mensajes generados por el servidor durante la ejecución
el método devuelve un código de respuesta <code>201 Created</code>, junto con una
cabecera <strong>Location</strong> apuntando a la URI absoluta del cliente que acabamos de crear</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Vamos a explicar la implementación con más detalle.</p>
</div>
<div class="paragraph">
<p>Para enlazar peticiones HTTP POST con el método <em>crearCliente()</em>, lo anotamos
con la anotación <code>@javax.ws.rs.POST</code>. La anotación <em>@Path</em>, combinada con la
anotación <em>@POST</em>, enlaza todas las peticiones POST dirigidas a la URI relativa
<em>/clientes</em> al método Java <em>crearCliente()</em>.</p>
</div>
<div class="paragraph">
<p>La anotación <code>javax.ws.rs.Consumes</code> aplicada a <em>crearCliente()</em> especifica qué
<em>media type</em> espera el método en el cuerpo del mensaje HTTP de entrada. Si el cliente
incluye en su petición POST un <em>media type</em> diferente de XML, se envía un código de
error al cliente.</p>
</div>
<div class="paragraph">
<p>El método <em>crearCliente()</em> tiene un parámetro de tipo <em>Cliente</em>. En
JAX-RS, <strong>cualquier parámetro no anotado</strong> con anotaciones JAX-RS se considera que es
una <strong>representación del cuerpo del mensaje</strong> de la petición de entrada HTTP. Las anotaciones
que hemos introducido en la clase <em>Cliente</em> de nuestro dominio, realizan el trabajo de
"convertir" el documento xml contenido en el cuerpo de la petición htpp de entrada en
una instancia de nuestra clase Cliente.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Solamente UNO de los parámetros del método Java puede representar el cuerpo del
mensaje de la petición HTTP. Esto significa <strong>que el resto de parámetros</strong> deben
anotarse con alguna anotación JAX-RS, que veremos más adelante.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>El método <em>crearCliente()</em>
devuelve una respuesta de tipo <code>javax.ws.rs.core.Response</code>. El método estático
<code>Response.created()</code> crea un objeto <em>Response</em> que contiene un código de estado
<code>201 Created</code>. También añade una cabecera <strong>Location</strong> con un valor similar a:
<strong><a href="http://expertojava.org/clientes/123" class="bare">http://expertojava.org/clientes/123</a></strong>, dependiendo del valor del valor de base de
la raíz de la URI del servidor y el identificador generado para el objeto <em>Cliente</em>
(en este caso se habría generado el identificador 123). Más adelante explicaremos
con detalle el uso de la clase <em>Response</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_consulta_de_clientes">Consulta de clientes</h5>
<div class="paragraph">
<p>A continuación mostramos un posible código para <strong>consultar</strong> la información de <strong>un cliente</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@GET</span>
<span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id}&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-n">Cliente</span> <span class="tok-nf">recuperarClienteId</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-kd">final</span> <span class="tok-n">Cliente</span> <span class="tok-n">cli</span> <span class="tok-o">=</span> <span class="tok-n">clienteDB</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-o">);</span>
  <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">cli</span> <span class="tok-o">==</span> <span class="tok-kc">null</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-nf">WebApplicationException</span><span class="tok-o">(</span><span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">Status</span><span class="tok-o">.</span><span class="tok-na">NOT_FOUND</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
  <span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-nf">Cliente</span><span class="tok-o">(</span><span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getNombre</span><span class="tok-o">(),</span> <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getApellidos</span><span class="tok-o">(),</span>
              <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getDireccion</span><span class="tok-o">(),</span> <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getCodPostal</span><span class="tok-o">(),</span> <span class="tok-n">cli</span><span class="tok-o">.</span><span class="tok-na">getCiudad</span><span class="tok-o">());</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este caso, anotamos el método <code>recuperarClienteId()</code> con la anotación
<code>@javax.ws.rs.GET</code> para enlazar las operaciones HTTP GET con este método Java.</p>
</div>
<div class="paragraph">
<p>También anotamos <em>recuperarClienteId()</em> con la anotación <code>@javax.ws.rs.PRODUCES</code>.
Esta anotación indica a JAX-RS que valor tiene la cabecera HTTP <strong>Content-Type</strong> en
la respuesta proporcionada por la operación GET. En este caso, estamos indicando que
será de tipo <strong>application/xml</strong>.</p>
</div>
<div class="paragraph">
<p>En la implementación del método utilizamos el parámetro <code>id</code> para consultar si
existe un objeto <em>Cliente</em> en nuestro mapa <strong>clienteDB</strong>. Si dicho cliente no existe,
lanzaremos la excepción <code>javax.ws.rs.WebApplictionException</code>. Esta excepción
provocará que el código de respuesta HTTP sea <code>404 Not Found</code>, y significa que
el recurso cliente requerido no existe. Discutiremos más adelante el tema del
manejo de excepciones.</p>
</div>
</div>
<div class="sect4">
<h5 id="_modificación_de_clientes">Modificación de clientes</h5>
<div class="paragraph">
<p>Vamos a mostrar cómo sería el código para modificar un cliente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@PUT</span>
<span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id}&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">modificarCliente</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">,</span>
                            <span class="tok-n">Cliente</span> <span class="tok-n">nuevoCli</span><span class="tok-o">)</span> <span class="tok-o">{</span>

  <span class="tok-n">Cliente</span> <span class="tok-n">actual</span> <span class="tok-o">=</span> <span class="tok-n">clienteDB</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-o">);</span>
  <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">actual</span> <span class="tok-o">==</span> <span class="tok-kc">null</span><span class="tok-o">)</span>
      <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-nf">WebApplicationException</span><span class="tok-o">(</span><span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">Status</span><span class="tok-o">.</span><span class="tok-na">NOT_FOUND</span><span class="tok-o">);</span>

  <span class="tok-n">actual</span><span class="tok-o">.</span><span class="tok-na">setNombre</span><span class="tok-o">(</span><span class="tok-n">nuevoCli</span><span class="tok-o">.</span><span class="tok-na">getNombre</span><span class="tok-o">());</span> <span class="tok-n">actual</span><span class="tok-o">.</span><span class="tok-na">setApellidos</span><span class="tok-o">(</span><span class="tok-n">nuevoCli</span><span class="tok-o">.</span><span class="tok-na">getApellidos</span><span class="tok-o">());</span>
  <span class="tok-n">actual</span><span class="tok-o">.</span><span class="tok-na">setDireccion</span><span class="tok-o">(</span><span class="tok-n">nuevoCli</span><span class="tok-o">.</span><span class="tok-na">getDireccion</span><span class="tok-o">());</span>
  <span class="tok-n">actual</span><span class="tok-o">.</span><span class="tok-na">setCodPostal</span><span class="tok-o">(</span><span class="tok-n">nuevoCli</span><span class="tok-o">.</span><span class="tok-na">getCodPostal</span><span class="tok-o">());</span>
  <span class="tok-n">actual</span><span class="tok-o">.</span><span class="tok-na">setCiudad</span><span class="tok-o">(</span><span class="tok-n">nuevoCli</span><span class="tok-o">.</span><span class="tok-na">getCiudad</span><span class="tok-o">());</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Anotamos el método <strong>modificarCliente()</strong> con <code>@javax.ws.rs.PUT</code> para enlazar
las peticiones HTTP PUT a este método. Al igual que hemos hecho con
<strong>recuperarClienteId()</strong>, el método <strong>modificarCliente()</strong> está anotado adicionalmente
con <code>@Path</code>, de forma que podamos atender peticiones a través de las URIs
<strong>/clientes/{id}</strong>.</p>
</div>
<div class="paragraph">
<p>El método <strong>modificarCliente()</strong> tiene dos parámetros. El primero es un parámetro
<code>id</code> que representa el objeto <em>Cliente</em> que estamos modificando. Al igual que
ocurría con el método <strong>recuperarClienteId()</strong>, utilizamos la anotación <code>@PathParam</code>
para extraer el identificador a partir de la URI de la petición de entrada.
El segundo parámetro es un objeto <code>Cliente</code>, que representa
el cuerpo del mensaje de entrada, ya que no tiene ninguna anotación JAX-RS.</p>
</div>
<div class="paragraph">
<p>El método intenta encontrar un objeto <em>Cliente</em> en nuestro mapa <strong>clienteDB</strong>.
Si no existe,
provocamos una <strong>WebApplicationException</strong> que enviará una respuesta al usuario
con el código <code>404 Not Found</code>. Si el objeto <em>Cliente</em> existe, modificamos
nuestro objeto <em>Cliente</em> existente con los nuevos valores que obtenemos de la petición
de entrada.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_construcción_y_despliegue_del_servicio">1.4.7. Construcción y despliegue del servicio</h4>
<div class="paragraph">
<p>Una vez implementado nuestro servicio RESTful, necesitamos poner en marcha el proceso
de construcción. El proceso de construcción compilará,&#8230;&#8203;, empaquetará, &#8230;&#8203;, y finalmente
nos permitirá desplegar nuestro servicio en el servidor de aplicaciones.</p>
</div>
<div class="paragraph">
<p>Para poder, empaquetar nuestro servicio RESTful como un <em>war</em>, que se desplegará en el
servidor de aplicaciones, vamos a incluir un "proveedor" de servicios JAX-RS,
en el descriptor de despliegue de nuestra aplicación (fichero <strong><em>web.xml</em></strong>). En la siguiente sesión
justificaremos la existencia de dicho "proveedor" (que será un <em>servlet</em>)
y explicaremos el modelo de
despliegue de los servicios JAX-RS. Los pasos a seguir desde IntelliJ para <strong>configurar el
despliegue</strong> de nuestro servicio son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Añadimos el directorio WEB-INF como subdirectorio de webapp</p>
</li>
<li>
<p>Nos vamos a File&#8594;Project Structure&#8230;&#8203;&#8594;Facets&#8594;Web, y añadimos el fichero
<em>web.xml</em> (en el panel <em>Deployment descriptors</em>, pulsamos sobre <em>+</em>, y seleccionamos <em>web.xml</em>).
Editamos este fichero para añadir el servlet que servirá las peticiones de
nuestros servicios REST, indicando cuál será la ruta en la que estarán
disponibles dichos servicios (en nuestro ejemplo indicaremos la ruta "/rest/").
Dicha ruta es relativa a la ruta del contexto de nuestra aplicación,
y que por defecto, es el nombre del artefacto ".war" desplegado, que hemos indicado
en la etiqueta &lt;finalName&gt; dentro del &lt;build&gt; del fichero de configuración de Maven (pom.xml).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Contenido del fichero <em>web.xml</em>:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;web-app</span> <span class="tok-na">version=</span><span class="tok-s">&quot;3.0&quot;</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee&quot;</span>
        <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
        <span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee</span>
<span class="tok-s">        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-c">&lt;!-- One of the way of activating REST Services is adding these lines,</span>
<span class="tok-c">    the server is responsible for adding the corresponding servlet automatically,</span>
<span class="tok-c">    if the src folder has the Annotations to receive REST invocation--&gt;</span>
    <span class="tok-nt">&lt;servlet-mapping&gt;</span>
        <span class="tok-nt">&lt;servlet-name&gt;</span>javax.ws.rs.core.Application<span class="tok-nt">&lt;/servlet-name&gt;</span>
        <span class="tok-nt">&lt;url-pattern&gt;</span>/rest/*<span class="tok-nt">&lt;/url-pattern&gt;</span>
    <span class="tok-nt">&lt;/servlet-mapping&gt;</span>
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuación ya estamos en disposición de iniciar la construcción del proyecto
con Maven para compilar, empaquetar y desplegar nuestro servicio en Wildfly.</p>
</div>
<div class="paragraph">
<p><strong>Si utilizamos el terminal</strong>, la secuencia de pasos para empaquetar y desplegar nuestro
proyecto serían:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>cd ejemplo-rest  <i class="conum" data-value="1"></i><b>(1)</b>
mvn package  <i class="conum" data-value="2"></i><b>(2)</b>
./usr/local/wildfly-8.2.1.Final/bin/standalone.sh  <i class="conum" data-value="3"></i><b>(3)</b>
mvn wildfly:deploy  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nos situamos en el directorio que contiene el pom.xml de nuestro proyecto</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Empaquetamos el proyecto (obtendremos el .war)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Arrancamos el servidor wildfly</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Desplegamos el war generado en el servidor wildfly</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Secuencia correcta de acciones</div>
<div class="paragraph">
<p>En ejecuciones posteriores, después de realizar modificaciones en nuestro
código, es recomendable ejecutar "mvn clean" previamente al empaquetado del proyecto.</p>
</div>
<div class="paragraph">
<p>Por lo tanto, y suponiendo que el servidor de aplicaciones <strong>ya está en marcha</strong>,
la secuencia de acciones (comandos maven) que deberíamos realizar para asegurarnos
de que vamos a ejecutar exactamente la aplicación con los últimos cambios que hayamos
introducido son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mvn wildfly:undeploy</p>
</li>
<li>
<p>mvn clean</p>
</li>
<li>
<p>mvn package</p>
</li>
<li>
<p>mvn wildfly:deploy</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>También podríamos realizar todas estas acciones con un único comando maven:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mvn wildfly:undeploy clean package wildfly:deploy</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Si utilizamos IntelliJ</strong>, añadiremos un nuevo elemento de configuración de ejecución desde
Run&#8594;Edit Configurations. Pulsamos el icono <code>+</code> y añadimos la configuración de tipo
JBosss Server&#8594;Local. Podemos ponerle por ejemplo como nombre "Wilfdly start". A continuación configuramos la
ruta del servidor wildfly como: /usr/local/wildfly-8.2.1.Final.</p>
</div>
<div class="paragraph">
<p>Cuando lancemos este
elemento de ejecución desde IntelliJ, automáticamente se construirá el proyecto (obtendremos el war),
y arrancaremos wildfly. Para desplegar el war, utlizaremos la ventana <em>Maven Projects</em> y haremos
 doble click sobre ejemplo-rest&#8594;Plugins&#8594;wildfly&#8594;wildfly:deploy</p>
</div>
</div>
<div class="sect3">
<h4 id="_probando_nuestro_servicio">1.4.8. Probando nuestro servicio</h4>
<div class="paragraph">
<p>Podemos probar nuestro servicio de varias formas. Vamos a mostrar como hacerlo directamente
desde línea de comandos, utilizando IntelliJ, o bien utilizando la herramienta Postman (que tenéis
disponible desde el navegador Chrome).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Invocación del servicio desde línea de comandos</dt>
<dd>
<p>Utilizaremos la herramienta <em>curl</em>. Por ejemplo, para realizar una inserción de un cliente,
el comando sería:</p>
<div class="literalblock">
<div class="content">
<pre>curl -i -H "Accept: application/xml" -H "Content-Type: application/xml" -X POST -d @cliente.xml http://localhost:8080/ejemplo-rest/rest/clientes/</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>En donde:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">-i</dt>
<dd>
<p>También se puede utilizar la opción equivalente <strong>--include</strong>. Indica que se debe incluir
las cabeceras HTTP en la respuesta recibida. Recuerda que la petición POST devuelve en
la cabecera <strong>Location</strong> el enlace del nuevo recurso creado (puede hacerlo en una cabedera <strong>Location</strong>,
 o como un campo <em>&lt;link&gt;</em> del elemento creado en el cuerpo del mensaje, lo veremos más adelante).
 Esta información será necesaria
para poder consultar la información del nuevo cliente creado.</p>
</dd>
<dt class="hdlist1">-H</dt>
<dd>
<p>Indica un par <em>cabecera</em>:_valor_. En nuestro caso lo utilizamos para especificar los
valores de las cabeceras HTTP <strong>Accept</strong> y <strong>Content-Type</strong></p>
</dd>
<dt class="hdlist1">-X</dt>
<dd>
<p>Indica el método a invocar (GET, POST, PUT,&#8230;&#8203;)</p>
</dd>
<dt class="hdlist1">-d</dt>
<dd>
<p>También se puede utilizar <strong>--data</strong>. Indica cuáles son los datos enviados en el mensaje de
entrada en una petición POST. Si los datos especificados van precedidos por <code>@</code>, estamos
indicando que dichos datos están en un fichero. Por ejemplo, en la orden anterior, escribimos
en el fichero <strong>cliente.xml</strong> los datos del cliente que queremos añadir en nuestro sistema.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>El contenido del fichero cliente.xml podría ser éste:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;clientes&gt;</span>
  <span class="tok-nt">&lt;cliente&gt;</span>
    <span class="tok-nt">&lt;nombre&gt;</span>Pepe <span class="tok-nt">&lt;/nombre&gt;</span>
    <span class="tok-nt">&lt;apellidos&gt;</span>Garcia Lopez<span class="tok-nt">&lt;/apellido1&gt;</span>
    <span class="tok-nt">&lt;direccion&gt;</span>Calle del pino, 3<span class="tok-nt">&lt;/apellido2&gt;</span>
    <span class="tok-nt">&lt;codPostal&gt;</span>0001<span class="tok-nt">&lt;/codPostal&gt;</span>
    <span class="tok-nt">&lt;ciudad&gt;</span>Alicante<span class="tok-nt">&lt;/ciudad&gt;</span>
  <span class="tok-nt">&lt;/cliente&gt;</span>
<span class="tok-nt">&lt;/clientes&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finalmente, en la orden indicamos la URI a la que queremos acceder, en este caso:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://localhost:8080/ejemplo-rest/rest/clientes/</pre>
</div>
</div>
<div class="paragraph">
<p>Una vez insertado el cliente, podemos recuperar el cliente, utilizando el enlace
que se incluye en la cabecera de respuesta <strong>Location</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -i -H "Accept: application/xml" -H "Content-Type: application/xml" -X GET http://localhost:8080/ejemplo-rest/rest/clientes/1</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Invocación del servicio desde IntelliJ</dt>
<dd>
<p>IntelliJ nos proporciona una herramienta para probar servicios REST, desde Tools&#8594;Test RESTful Web Service
Desde esta nueva ventana podremos invocar al servicio REST indicando el tipo de
petición HTTP, así como las cabeceras y cuerpo de la petición.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>La siguiente figura muestra la elaboración de una petición POST a nuestro servicio REST:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/rest01/test-intelliJ-POST.png" alt="Petición POST realizada desde Intellij" width="100%">
</div>
</div>
<div class="paragraph">
<p>A continuación mostramos la ejecución de una petición GET:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/rest01/test-intelliJ-GET.png" alt="Resultado de ejecución de una petición GET ejecutada desde Intellij" width="100%">
</div>
</div>
<div class="paragraph">
<p>Cuando realizamos una petición POST debemos indicar el contenido del cuerpo del mensaje.
En la siguiente figura observamos que tenemos varias opciones disponibles, como
por ejemplo "teclear" directamente dicho contenido (opción <em>Text</em>), o bien "subir"
dicha información desde un fichero en nuestro disco duro (opción <em>File Contents</em>).
Podemos ver que hemos elegido esta última opción para probar nuestro servicio.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/rest01/test-intelliJ-POST.png" alt="Resultado de ejecución de una petición GET ejecutada desde Intellij" width="100%">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Invocación del servicio desde Postman</dt>
<dd>
<p>Otra alternativa sencilla para probar nuestro servicio REST es la herramienta postman, que podemos
lanzar desde el navegador, en nuestro caso: Chrome.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Accederemos a la aplicación desde la barra de marcadores, seleccionando "Aplicaciones", y
y a continuación, pulsaremos sobre el icono "Postman".</p>
</div>
<div class="paragraph">
<p>El aspecto de la herramienta es el que mostramos a continuación:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/rest01/test-postman.png" alt="Resultado de ejecución de una petición GET ejecutada desde Postman" width="100%">
</div>
</div>
<div class="paragraph">
<p>Postman, a diferencia de las alternativas anteriores, nos permitirá guardar un "historial"
de peticiones, de forma que podamos repetir la ejecución de nuestros tests, exactamente de la misma
forma, aunque no de forma automática, sino que tenemos que lanzar "manualmente" cada test
que queramos volver a ejecutar.</p>
</div>
<div class="paragraph">
<p>También podemos crear "colecciones", que no son más que carpetas que contienen un conjunto
de peticiones de nuestro "historial". Por ejemplo, podemos crear la <strong>colección</strong> <em>s1-rest-ejercicio1</em>
en donde guardaremos todas las peticiones que hayamos hecho sobre el ejercicio 1 de la primera sesión
de rest.</p>
</div>
<div class="paragraph">
<p>Podéis crearos una cuenta gratuita para almacener y gestionar vuestras peticiones rest. Una vez que
tengáis creadas varias colecciones, Postman nos permite "guardarlas" en nuestro disco duro en formato json.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/rest01/test-collections-postman.png" alt="Podemos guardar nuestras colecciones en formato JSON" width="100%">
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="_ejercicios">1.5. Ejercicios</h3>
<div class="paragraph">
<p>Antes de empezar a crear los proyectos, debes descargarte el repositorio <em>git</em>
<code>java_ua/ejercicios-rest-expertojava</code> en el que vas a implementar los ejercicios relativos a
 la asignatura de <em>Servicios REST</em>. El proceso es el mismo que el seguido en sesiones
 anteriores:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Accedemos al repositorio y realizamos un <em>Fork</em> en nuestra cuenta personal (así podremos
tener una copia con permisos de escritura)</p>
</li>
<li>
<p>Realizamos un <em>Clone</em> en nuestra máquina:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>git clone https://bitbucket.org/&lt;alumno&gt;/ejercicios-rest-expertojava</code></pre>
</div>
</div>
<div class="paragraph">
<p>De esta forma se crea en nuestro ordenador el directorio <code>ejercicios-rest-expertojava</code> y se
descarga en él un proyecto IntelliJ en el que iremos añadiendo <strong>MÓDULOS</strong> para cada uno
 de los ejercicios. Contiene también el fichero <code>gitignore</code>, así como diferentes
 módulos con las plantillas que vayamos a necesitar para realizar los ejercicios.</p>
</div>
<div class="paragraph">
<p>A partir de este momento se puede trabajar con dicho proyecto y realizar
 <em>Commit</em> y <em>Push</em> cuando sea oportuno:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span><span class="tok-nb">cd </span>ejercicios-rest-expertojava
<span class="tok-nv">$ </span>git add .
<span class="tok-nv">$ </span>git commit -a -m <span class="tok-s2">&quot;Mensaje de commit&quot;</span>
<span class="tok-nv">$ </span>git push origin master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Los <strong>MÓDULOS</strong> IntelliJ que iremos añadiendo, tendrán todos el prefijo <code>sx-</code>, siendo <em>x</em>
el número de la sesión correspondiente (por ejemplo <em>s1-ejercicio</em>, <em>s2-otroEjercicio</em>,&#8230;&#8203;).</p>
</div>
<div class="sect3">
<h4 id="_servicio_rest_ejemplo_0_puntos">1.5.1. Servicio REST ejemplo (0 puntos)</h4>
<div class="paragraph">
<p>Para familiarizarnos con las peticiones http POST, PUT, GET, DELETE se proporciona
el <strong>MÓDULO</strong> <strong>s1-ejemplo-rest</strong>, con la implementación de un servicio rest que podéis
probar, bien desde línea de comandos con la utilidad <strong>curl</strong>, desde el navegador con
la herramienta <strong>postman</strong>
, o bien desde IntelliJ con el <strong>cliente REST</strong> incluido en el IDE.</p>
</div>
<div class="paragraph">
<p>En el directorio <code>src/main/resources</code> de dicho módulo tenéis un fichero de
texto (<em>instrucciones.txt</em>) con las instrucciones para construir, desplegar y probar la aplicación de ejemplo.</p>
</div>
</div>
<div class="sect3">
<h4 id="_servicio_rest_saludo_1_punto">1.5.2. Servicio REST saludo (1 punto)</h4>
<div class="paragraph">
<p>Vamos a implementar un primer servicio RESTful muy sencillo. Para ello
seguiremos las siguientes indicaciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creamos un <strong>MÓDULO</strong> Maven con IntelliJ (desde el directorio <code>ejercicios-rest-expertojava</code>)
con el arquetipo <code>webapp-javaee7</code>, tal y como hemos visto en los apuntes de la sesión. Las coordenadas
del <strong>artefacto Maven</strong> serán:</p>
<div class="ulist">
<ul>
<li>
<p><em>GroupId</em>: org.expertojava</p>
</li>
<li>
<p><em>ArtifactId</em>: s1-saludo-rest</p>
</li>
<li>
<p><em>version</em>: 1.0-SNAPSHOT</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configuramos el pom.mxl del proyecto para poder compilar, empaquetar y desplegar nuestro servicio.
Consulta los apuntes para ver cuál debe ser el contenido de las etiquetas <em>&lt;properties&gt;</em>, <em>&lt;dependencies&gt;</em> y <em>&lt;build&gt;</em>.</p>
</li>
<li>
<p>Creamos la carpeta WEB-INF y añadimos el fichero de configuración <em>web.xml</em> tal y como hemos
visto en los apuntes (esto será necesario para configurar el despliegue). En este caso
queremos <em>mapear</em> los servicios REST, contenidos en el paquete
 <em>org.expertojava</em>, al directorio <em>/recursos</em> dentro de nuestro contexto (recuerda que el contexto
 de nuestra aplicación web vendrá dado por el valor de la etiqueta &lt;finalName&gt;, anidada dentro de &lt;build&gt;).</p>
</li>
<li>
<p>Creamos un recurso de nombre <code>HolaMundoResource</code>, que se mapee a la dirección <strong>/holamundo</strong>.
Implementar un método, de forma que al acceder a él por <strong>GET</strong> nos devuelva
en texto plano (text/plain) el mensaje "Hola mundo!".
Una vez desplegada la aplicación en el servidor WildFly, prueba el servicio mediante la
utilidad Postman desde Chrome.
Comprobar que la invocación:</p>
<div class="literalblock">
<div class="content">
<pre>GET http://localhost:8080/saludo-rest/holamundo</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Devuelve como cuerpo del mensaje: "Hola mundo!"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Vamos a añadir un segmento variable a la ruta. Implementa un método GET nuevo, de forma que si
accedemos a /holamundo/nombre, añade el nombre indicado al saludo (separado por un
espacio en blanco y seguido por "!!").</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Una vez desplegada la aplicación en el servidor WildFly, prueba el servicio mediante
la utilidad "Test RESTFul Web Service" de IntelliJ, o con Postman.
Comprobar que la invocación:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET http://localhost:8080/saludo-rest/holamundo/pepe</pre>
</div>
</div>
<div class="paragraph">
<p>Devuelve como cuerpo del mensaje: "Hola mundo! pepe!!"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hacer que se pueda cambiar el saludo mediante un método PUT. El nuevo saludo llegará
también como texto plano en el cuerpo de la petición, y posteriores invocaciones a los métodos GET utilizarán el
nuevo saludo. Almacenaremos el nuevo saludo en una variable estática de nuestro recurso. ¿Qué pasa si
no lo es? (lo hemos explicado en los apuntes, puedes hacer la prueba para ver qué ocurre
si la variable no es estática).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Una vez desplegada la aplicación en el servidor WildFly, prueba el servicio
con Postman, o bien mediante la utilidad "Test RESTFul Web Service" de IntelliJ.
Realizar las siguientes invocaciones (en este orden):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PUT http://localhost:8080/saludo-rest/holamundo/
y en el cuerpo del mensaje: "Buenos días"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>GET http://localhost:8080/saludo-rest/holamundo
GET http://localhost:8080/saludo-rest/holamundo/pepe</pre>
</div>
</div>
<div class="paragraph">
<p>La segunda invocación debe devolver como cuerpo del mensaje: <code>"Buenos dias"</code>
Al ejecutar la tercera invocación el cuerpo del mensaje de respuesta debería ser:
<code>"Buenos dias Pepe!!"</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_servicio_rest_foro_1_punto">1.5.3. Servicio REST foro (1 punto)</h4>
<div class="paragraph">
<p>Vamos a implementar un servicio RESTful que contemple las
 cuatro operaciones básicas (GET, PUT, POST y DELETE). Se trata de un foro con en el que los usuarios
 pueden intervenir, de forma anónima, en diferentes conversaciones.</p>
</div>
<div class="paragraph">
<p>Primero debes crear un nuevo módulo Maven, configurar el pom.xml, así como el fichero <code>web.xml</code>,
de la misma forma que hemos hecho en el ejercicio anterior, pero para este
 ejercicio:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Las coordenadas del módulo Maven serán:</p>
<div class="ulist">
<ul>
<li>
<p><em>GroupId</em>: org.expertojava</p>
</li>
<li>
<p><em>ArtifactId</em>: s1-foro-rest</p>
</li>
<li>
<p><em>version</em>: 1.0-SNAPSHOT</p>
</li>
</ul>
</div>
</li>
<li>
<p>Nuestros servicios REST estarán disponibles en la URI <code><a href="http://localhost:8080/s1-foro-rest/" class="bare">http://localhost:8080/s1-foro-rest/</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El foro estará formado por diferentes mensajes. Por lo tanto el modelo del dominio de nuestra
aplicación estará formado por la clase <code>Mensaje</code>, que contendrá un identificador, y una
cadena de caracteres que representará el contenido del mensaje (recuerda que debes implementar
los correspondientes <em>getters</em> y <em>setters</em>).</p>
</div>
<div class="paragraph">
<p>Por simplicidad, vamos a almacenar los mensajes de nuestro foro en memoria. Estos estarán
disponibles desde la clase <code>DatosEnMemoria</code>, que contendrá la variable estática:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>static Map&lt;Integer, Mensaje&gt; datos = new HashMap&lt;Integer, Mensaje&gt;();</pre>
</div>
</div>
<div class="paragraph">
<p>Los servicios que proporcionará el foro estarán implementados en la clase <code>MensajeResource</code>. Se
accederá a ellos través de la ruta relativa a la raíz de nuestros servicios: "/mensajes".
Concretamente podremos realizar las siguientes operaciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Añadir un nuevo mensaje al foro con la URI relativa a la raíz de nuestros servicios:
<code>"/mensajes"</code>. El texto del mensaje estará en el cuerpo de la petición y el tipo MIME asociado
será <code>text/plain</code> (contenido de la cabecera <code>Content-type</code> de la petición HTTP).  Nuestra respuesta
debe incluir en la cabecera <code>Location</code> de la respuesta HTTP, la URI del nuevo recurso creado.
Utiliza para ello la clase <code>Response</code> tal y como hemos mostrado en el código de ejemplo proporcionado
para el ejercicio anterior.
Hablaremos con detalle sobre esta clase en sesiones posteriores.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Recuerda que para acceder al cuerpo de la petición basta con definir un parámetro de tipo <em>String</em>.
JAX-RS automáticamente lo instanciará a partir del cuerpo de la petición y lo convertirá en
un objeto de tipo <em>String</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Modificar un mensaje determinado con un identificador con valor <code>id</code>, a través de la URI relativa a la raíz de
nuestros servicios: <code>/mensajes/id</code> (<code>id</code> debe ser, por tanto, un segmento de ruta variable). Si no
existe ningún mensaje con el identificador <code>id</code>, se lanzará la excepción: <code>WebApplicationException(Response.Status.NOT_FOUND)</code></p>
</li>
<li>
<p>Borrar un mensaje determinado con un identificador con valor <code>id</code>, a través de la URI relativa a la raíz de
nuestros servicios: <code>/mensajes/id</code>. Igual que en el caso anterior, si el identificador proporcionado no
se corresponde con el de ningún mensaje del foro, se lanzará la excepción: <code>WebApplicationException(Response.Status.NOT_FOUND)</code></p>
</li>
<li>
<p>Consultar todos los mensajes del foro (la URI relativa será: <code>/mensajes</code>). El resultado se mostrará en tantas líneas
como mensajes. Cada mensaje irá precedido de su identificador. También se informará del número total de
mensajes en el foro. (La respuesta será una cadena de caracteres. Al final del ejercicio mostramos un ejemplo
de mensaje de respuesta para esta operación)</p>
</li>
<li>
<p>Consultar un mensaje determinado con un identificador con valor <code>id</code>, a través de la URI relativa a la raíz de
nuestros servicios: <code>/mensajes/id</code>. Si el identificador proporcionado no
se corresponde con el de ningún mensaje del foro, se lanzará la excepción: <code>WebApplicationException(Response.Status.NOT_FOUND)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Prueba el servicio utilizando Postman, o el cliente de IntelliJ para servicios REST, con las siguientes entradas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Crea los mensajes "Mensaje numero 1", "Mensaje numero 2", Mensaje numero 3", en este orden</p>
</li>
<li>
<p>Consulta los mensajes del foro. El resultado debe ser:</p>
<div class="paragraph">
<p>"1: Mensaje numero 1</p>
</div>
<div class="paragraph">
<p>2: Mensaje numero 2</p>
</div>
<div class="paragraph">
<p>3: Mensaje numero 3</p>
</div>
<div class="paragraph">
<p>Numero total de mensajes = 3"</p>
</div>
</li>
<li>
<p>Cambia el mensaje con identificador 2 por: "Nuevo mensaje numero 2"</p>
</li>
<li>
<p>Consulta los mensajes del foro. El resultado debe ser:</p>
<div class="paragraph">
<p>"1: Mensaje numero 1</p>
</div>
<div class="paragraph">
<p>2: Nuevo Mensaje numero 2</p>
</div>
<div class="paragraph">
<p>3: Mensaje numero 3</p>
</div>
<div class="paragraph">
<p>Numero total de mensajes = 3"</p>
</div>
</li>
<li>
<p>Borra el mensaje con identificador 3</p>
</li>
<li>
<p>Consulta el mensaje con el identificador 3. Se debe obtener una respuesta <code>404 Not Found</code></p>
</li>
<li>
<p>Consulta los mensajes del foro. El resultado debe ser:</p>
<div class="paragraph">
<p>"1: Mensaje numero 1</p>
</div>
<div class="paragraph">
<p>2: Nuevo Mensaje numero 2</p>
</div>
<div class="paragraph">
<p>Numero total de mensajes = 2"</p>
</div>
</li>
<li>
<p>Añade el mensaje "Mensaje final". Vuelve a consultar los mensajes, el resultado debe ser:</p>
<div class="paragraph">
<p>"1: Mensaje numero 1</p>
</div>
<div class="paragraph">
<p>2: Nuevo Mensaje numero 2</p>
</div>
<div class="paragraph">
<p>4: Mensaje final</p>
</div>
<div class="paragraph">
<p>Numero total de mensajes = 3"</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Para evitar problemas con el <em>id</em> generado si hemos borrado mensajes, lo más sencillo es que el identificador vaya
incrementándose siempre con cada nuevo mensaje. Esto puede hacer que "queden huecos"
en la numeración, como en el ejemplo anterior.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-15 10:06:27 CEST
</div>
</div>
</body>
</html>