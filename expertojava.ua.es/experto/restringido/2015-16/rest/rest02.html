<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="María Isabel Alfonso Galipienso">
<title>Servicios Rest</title>
<style>/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 97%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #1164be; text-decoration: none; line-height: inherit; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #1c355e; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 2.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

/*@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }*/
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; border-bottom: 1px solid #dddddd }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; font-weight: normal; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

.keyseq { color: #555555; }

kbd { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#floating {
  position: fixed;
  z-index: 1000;
  padding: 0.5em;
  right: 0;
  top: 0;
  background: white;
  box-shadow: 0 0 1em #777777;
  -webkit-box-shadow: 0 0 1em #777777;
  -moz-box-shadow: 0 0 1em #777777;
  -webkit-border-bottom-left-radius: 5px;
  -moz-border-radius-bottomleft: 5px;
  max-height: 80%;
  overflow: auto;
}

#floating #full { display: none; } /* Hide the full TOC by default */

#floating:hover #full{
  display: block; /* Show it on hover */
}


#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 2.5em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Servicios Rest</h1>
<div class="details">
<span id="author" class="author">María Isabel Alfonso Galipienso</span><br>
<span id="email" class="email">&lt;<a href="mailto:eli@ua.es">eli@ua.es</a>&gt;</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice de contenidos</div>
<ul class="sectlevel1">
<li><a href="#sesion02">2. Anotaciones básicas JAX-RS. El modelo de despliegue.</a>
<ul class="sectlevel2">
<li><a href="#__c%C3%B3mo_funciona_el_enlazado_de_m%C3%A9todos_http">2.1. ¿Cómo funciona el enlazado de métodos HTTP?</a></li>
<li><a href="#_la_anotaci%C3%B3n_path">2.2. La anotación @Path</a>
<ul class="sectlevel3">
<li><a href="#_expresiones_path">2.2.1. Expresiones @Path</a></li>
<li><a href="#_par%C3%A1metros_em_matrix_em_em_matrix_parameters_em">2.2.2. Parámetros <em>matrix</em> (<em>Matrix parameters</em>)</a></li>
<li><a href="#_subrecursos_em_subresource_locators_em">2.2.3. Subrecursos (<em>Subresource Locators</em>)</a></li>
</ul>
</li>
<li><a href="#_usos_de_las_anotaciones_produces_y_consumes">2.3. Usos de las anotaciones @Produces y @Consumes</a>
<ul class="sectlevel3">
<li><a href="#_anotaci%C3%B3n_consumes">2.3.1. Anotación @Consumes</a></li>
<li><a href="#_anotaci%C3%B3n_produces">2.3.2. Anotación @Produces</a></li>
</ul>
</li>
<li><a href="#_inyecci%C3%B3n_de_par%C3%A1metros_jax_rs">2.4. Inyección de parámetros JAX-RS</a>
<ul class="sectlevel3">
<li><a href="#__javax_ws_rs_pathparam">2.4.1. @javax.ws.rs.PathParam</a></li>
<li><a href="#_interfaz_uriinfo">2.4.2. Interfaz UriInfo</a></li>
<li><a href="#__javax_ws_rs_matrixparam">2.4.3. @javax.ws.rs.MatrixParam</a></li>
<li><a href="#__javax_ws_rs_queryparam">2.4.4. @javax.ws.rs.QueryParam</a></li>
<li><a href="#__javax_ws_rs_formparam">2.4.5. @javax.ws.rs.FormParam</a></li>
<li><a href="#__javax_ws_rs_headerparam">2.4.6. @javax.ws.rs.HeaderParam</a></li>
<li><a href="#__javax_ws_rs_core_context">2.4.7. @javax.ws.rs.core.Context</a></li>
<li><a href="#__javax_ws_rs_beanparam">2.4.8. @javax.ws.rs.BeanParam</a></li>
<li><a href="#_conversi%C3%B3n_autom%C3%A1tica_de_tipos">2.4.9. Conversión automática de tipos</a></li>
<li><a href="#_valores_por_defecto_defaultvalue">2.4.10. Valores por defecto (@DefaultValue)</a></li>
</ul>
</li>
<li><a href="#_configuraci%C3%B3n_y_despliegue_de_aplicaciones_jax_rs">2.5. Configuración y despliegue de aplicaciones JAX-RS</a>
<ul class="sectlevel3">
<li><a href="#_configuraci%C3%B3n_mediante_la_clase_em_application_em">2.5.1. Configuración mediante la clase <em>Application</em></a></li>
<li><a href="#_configuraci%C3%B3n_mediante_un_fichero_em_web_xml_em">2.5.2. Configuración mediante un fichero <em>web.xml</em></a></li>
<li><a href="#_configuraci%C3%B3n_en_un_contenedor_que_no_disponga_de_una_implementaci%C3%B3n_jax_rs">2.5.3. Configuración en un contenedor que no disponga de una implementación JAX-RS</a></li>
</ul>
</li>
<li><a href="#_ejercicios">2.6. Ejercicios</a>
<ul class="sectlevel3">
<li><a href="#_creaci%C3%B3n_de_un_recurso_creaci%C3%B3n_y_consulta_de_temas_en_el_foro_0_5_puntos">2.6.1. Creación de un recurso: creación y consulta de temas en el foro (0,5 puntos)</a></li>
<li><a href="#_despliegue_y_pruebas_del_recurso_0_5_puntos">2.6.2. Despliegue y pruebas del recurso (0,5 puntos)</a></li>
<li><a href="#_m%C3%BAltiples_consultas_de_los_temas_del_foro_0_5_puntos">2.6.3. Múltiples consultas de los temas del foro (0,5 puntos)</a></li>
<li><a href="#_creaci%C3%B3n_de_subrecursos_0_5_puntos">2.6.4. Creación de subrecursos (0,5 puntos)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sesion02">2. Anotaciones básicas JAX-RS. El modelo de despliegue.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ya hemos visto como crear un servicio REST básico. Ahora se trata de analizar con
más detalle aspectos fundamentales sobre la implementación de los servicios.
Comenzaremos por detallar los usos de la anotación @Path, que es la que nos
permite "etiquetar" una clase Java como un recurso REST sobre el que podremos realizar
las operaciones que hemos identificado en la sesión anterior. También hablaremos
algo más sobre las anotaciones @Produces y @Consumes que ya hemos utilizado para
implementar nuestro primer servicio.</p>
</div>
<div class="paragraph">
<p>En segundo lugar hablaremos sobre la extracción de información de las peticiones HTTP,
 y cómo podemos inyectar esa información en nuestro código java. Esto nos permitirá
 servir las peticiones sin tener que escribir demasiado código adicional.</p>
</div>
<div class="paragraph">
<p>Finalmente, explicaremos más detenidamente cómo configurar el despliegue de
nuestra aplicación REST, de forma que sea portable.</p>
</div>
<div class="sect2">
<h3 id="__cómo_funciona_el_enlazado_de_métodos_http">2.1. ¿Cómo funciona el enlazado de métodos HTTP?</h3>
<div class="paragraph">
<p>JAX-RS define cinco anotaciones que se corresponden con operaciones HTTP específicas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>@javax.ws.rs.GET</p>
</li>
<li>
<p>@javax.ws.rs.PUT</p>
</li>
<li>
<p>@javax.ws.rs.POST</p>
</li>
<li>
<p>@javax.ws.rs.DELETE</p>
</li>
<li>
<p>@javax.ws.rs.HEAD</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>En la sesión anterior ya hemos utilizado estas anotaciones para hacer corresponder
(enlazar) peticiones HTTP GET con un método Java concreto:</p>
</div>
<div class="paragraph">
<p>Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ServicioCliente</span> <span class="tok-o">{</span>

  <span class="tok-nd">@GET</span> <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getTodosLosClientes</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este código, la anotación @GET indica al <em>runtime</em> JAX-RS que el método java
<em>getTodosLosClientes()</em> atiende peticiones HTTP GET dirigidas a la URI <em>/clientes</em></p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Sólamente se puede utilizar una de las anotaciones anteriores para un mismo método.
Si se aplica más de uno, se produce un error durante el despliegue de la aplicación</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Es interesante conocer que cada una de estas anotaciones, a su vez, está anotada con
otras anotaciones (podríamos llamarlas <em>meta anotaciones</em>). Por ejemplo, la implementación de
la anotación @GET tiene este aspecto:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">javax</span><span class="tok-o">.</span><span class="tok-na">ws</span><span class="tok-o">.</span><span class="tok-na">rs</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">...</span><span class="tok-o">;</span>

<span class="tok-nd">@Target</span><span class="tok-o">({</span><span class="tok-n">ElementType</span><span class="tok-o">.</span><span class="tok-na">METHOD</span><span class="tok-o">})</span>
<span class="tok-nd">@Retention</span><span class="tok-o">(</span><span class="tok-n">RetentionPolicy</span><span class="tok-o">.</span><span class="tok-na">RUNTIME</span><span class="tok-o">)</span>
<span class="tok-nd">@HttpMethod</span><span class="tok-o">(</span><span class="tok-n">HttpMethod</span><span class="tok-o">.</span><span class="tok-na">GET</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-nd">@interface</span> <span class="tok-n">GET</span> <span class="tok-o">{</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>@GET, en sí mismo, no tiene ningún significado especial para el proveedor JAX-RS (<em>runtime</em>
de JAX-RS). Lo que hace que la anotación @GET sea significativo para el <em>runtime</em> de JAX-RS
es el valor de la <em>meta anotación</em> @javax.ws.rs.HttpMethod (en este caso <code>HttpMethod.GET</code>).
Este valor es el que realmente "decide" que un determinado método Java se "enlace" con
un determinado método HTTP.</p>
</div>
<div class="paragraph">
<p>¿Cuáles son las implicaciones de ésto? Pues que podemos crear nuevas anotaciones que
podemos enlazar a otros métodos HTTP que no sean GET, POST, PUT, DELETE, o HEAD. De esta
 forma podríamos permitir que diferentes tipos de clientes que hacen uso de la
 operación HTTP LOCK, puedan ser "atendidos" por nuestro
 servicio REST (como por ejemplo un cliente WebDAV ).</p>
</div>
</div>
<div class="sect2">
<h3 id="_la_anotación_path">2.2. La anotación @Path</h3>
<div class="paragraph">
<p>La anotación @Path identifica la "plantilla" de <em>path</em> para la URI del recurso al
que se accede y se puede especificar a nivel de clase o a nivel de método de dicho recurso.</p>
</div>
<div class="paragraph">
<p>El <strong>valor</strong> de una anotación @Path es una <strong>expresión</strong> que denota una URI relativa a la URI base del servidor en el que se despliega el recurso,
a la raiz del contexto de la aplicación, y al patrón URL al que responde el runtime de JAX-RS.</p>
</div>
<div class="paragraph">
<p>Un <strong>segmento</strong> de la URI es cada una de las subcadenas delimitadas por <code>/</code> que aparecen
 en dicha URI. Por ejemplo, la URI <em><a href="http://ejemplo.clientes.com/clientes/vip/recientes" class="bare">http://ejemplo.clientes.com/clientes/vip/recientes</a></em> contiene 4
 segmentos de ruta: <em>ejemplo.clientes.com</em>, <em>clientes</em>, <em>vip</em> y <em>recientes</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>La anotación @Path no es necesario que contenga una ruta que empiece o termine con el carácter <code>/</code>. El
<em>runtime</em> de JAX-RS analiza igualmente la expresión indicada como valor de @Path</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para que una <strong>clase Java</strong> sea identificada como una clase que puede atender peticiones HTTP,
ésta tiene que estar anotada con al menos la expresión: <code>@Path("/")</code>. Este tipo
de clases se denominan <strong>recursos JAX-RS raíz</strong>.</p>
</div>
<div class="paragraph">
<p>Para recibir una petición, un  <strong>método Java</strong> debe tener al menos una anotación de método HTTP,
como por ejemplo @javax.ws.rs.GET. Este método no requiere tener ninguna anotación @Path
adicional. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getTodosLosPedidos</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Una petición HTTP <strong>GET /pedidos</strong> se delegará en el método <strong>getTodosLosPedidos()</strong>.</p>
</div>
<div class="paragraph">
<p>Podemos aplicar también @Path a un método Java. Si hacemos esto, la expresión de la
anotación @Path de la clase, se concatenará con la expresión de la anotación @Path del
método. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;noPagados&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPedidosNoPagados</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>De esta forma, una petición <strong>GET /pedidos/noPagados</strong> se delegará en el método
<strong>getPedidosNoPagados()</strong>.</p>
</div>
<div class="paragraph">
<p>Podemos tener anotaciones @Path para cada método, que serán relativos a la ruta
indicada en la anotación  @Path de
la definición de la clase. Por ejemplo, la siguiente clase de recurso sirve peticiones
a la URI <strong>/pedidos</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPedidos</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si quisiéramos proporcionar el servicio en la URI <strong>pedidos/incidencias</strong>, por ejemplo,
no necesitamos una nueva definición de clase, y podríamos anotar un nuevo método
<em>getIncidenciasPedidos()</em> de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPedidos</span><span class="tok-o">()</span> <span class="tok-o">{...}</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/incidencias&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getIncidenciasPedidos</span><span class="tok-o">()</span> <span class="tok-o">{...}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ahora tenemos una clase de recurso que gestiona peticiones para <strong>/pedidos</strong>,
y para <strong>/pedidos/incidencias/</strong>.</p>
</div>
<div class="sect3">
<h4 id="_expresiones_path">2.2.1. Expresiones @Path</h4>
<div class="paragraph">
<p>El valor de una anotación @Path puede ser una cadena de caracteres, o también puede
contener expresiones más complejas si es necesario, nos referiremos a ellas como
 <strong>expresiones @Path</strong></p>
</div>
<div class="paragraph">
<p>Una expresión @Path puede incluir variables, que se indican entre llaves, que serán sustituidas en tiempo
de ejecución dependiendo del valor que se indique en la llamada al recurso.
Así, por ejemplo, si tenemos la siguiente anotación:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@GET</span>
<span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes/{id}&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>y el usuario realiza la llamada:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET http://org.expertojava/contexto/rest/clientes/Pedro</pre>
</div>
</div>
<div class="paragraph">
<p>la petición se delegará en el método que esté anotado con las anotaciones anteriores
y el valor de {id} será instanciado en tiempo de ejecución a "Pedro".</p>
</div>
<div class="paragraph">
<p>Para obtener el valor del nombre del cliente, utilizaremos la anotación <code>@PathParam</code>
  en los parámetros del método, de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@GET</span>
<span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes/{nombre}&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getClientePorNombre</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Una expresión @Path puede tener más de una variable, cada una figurará entre llaves.
Por ejemplo, si utilizamos la siguiente expresión @Path:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/{nombre1}/{nombre2}/&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiResource</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>podremos atender peticiones dirigidas a URIs que respondan a la plantilla:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://org.expertojava/contexto/recursos/{nombre1}/{nombre2}</pre>
</div>
</div>
<div class="paragraph">
<p>como por ejemplo:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://org.expertojava/contexto/recursos/Pedro/Lopez</pre>
</div>
</div>
<div class="paragraph">
<p>Las expresiones @Path pueden incluir más de una variable para referenciar un
segmento de ruta. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;clientes/{apellido1}-{apellido2}&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getCliente</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellido1&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">ape1</span><span class="tok-o">,</span>
                           <span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellido2&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">ape2</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Una petición del tipo:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET http://org.expertojava/contexto/clientes/Pedro-Lopez</pre>
</div>
</div>
<div class="paragraph">
<p>será procesada por el método <strong>getCliente()</strong></p>
</div>
<div class="sect4">
<h5 id="_expresiones_regulares">Expresiones regulares</h5>
<div class="paragraph">
<p>Las anotaciones @Path pueden contener expresiones regulares (asociadas a las variables).
Por ejemplo, si
nuestro método <strong>getClienteId()</strong> tiene un parámetro de tipo entero, podemos restringir
las peticiones para tratar solamente aquellas URIs que contengan dígitos en el
segmento de ruta que nos interese:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id : \\d+}&quot;</span><span class="tok-o">)</span>  <span class="tok-c1">//solo soporta dígitos</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getClienteId</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si la URI de la petición de entrada no satisface ninguna expresión regular de
ninguno de los metodos del recurso, entonces se devolverá el código de error: <strong>404 Not Found</strong></p>
</div>
<div class="paragraph">
<p>El formato para especificar expresiones regulares para las variables del <em>path</em> es:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{" nombre-variable [ ":" expresion-regular ] "}</pre>
</div>
</div>
<div class="paragraph">
<p>El uso de expresiones regulares es opcional. Si no se proporciona una expresión regular,
por defecto se admite cualquier carácter. En términos de una expresión regular, la
expresión regular por defecto sería:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"[^/]+?"</pre>
</div>
</div>
<div class="paragraph">
<p>Por ejemplo, si queremos aceptar solamente nombres que comiencen por una letra, y
 a continuación puedan contener una letra o un dígito, lo expresaríamos como:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
   <span class="tok-nd">@GET</span>
   <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{nombre : [a-zA-Z][a-zA-Z_0-9]}&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getClienteNombre</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span> <span class="tok-n">string</span> <span class="tok-n">nom</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>De esta forma, la URI <code>/clientes/aaa</code> no sería válida, la URI <code>/clientes/a9</code>
 activaría el método <em>getClienteNombre()</em>, y la URI <code>/clientes/89</code> activaría
 el método <em>getClienteId()</em>.</p>
</div>
<div class="paragraph">
<p>Las expresiones regulares no se limitan a un sólo segmento de la URI. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id : .+}&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getCliente</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id : .+}/direccion&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getDireccion</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La expresión regular <code>.+</code> indica que están permitidos cualquier número de caracteres.
Así, por ejemplo, la petición <code>GET /clientes/pedro/lopez</code> podría delegarse en el método
<em>getClientes()</em></p>
</div>
<div class="paragraph">
<p>El método <em>getDireccion()</em> tiene asociada una expresión más específica, la cual puede
mapearse con cualquier cadena de caracteres que termine con <em>/direccion</em>. Según ésto,
la petición <code>GET /clientes/pedro/lopez/direccion</code> podría delegarse en el método
<em>getDireccion()</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_reglas_de_precedencia">Reglas de precedencia</h5>
<div class="paragraph">
<p>En el ejemplo anterior, acabamos de ver que las expresiones @Path para <em>getCliente()</em> y
<em>getDireccion()</em> son ambiguas. Una petición <code>GET /clientes/pedro/lopez/direccion</code> podría
mapearse con cualquiera de los dos métodos. La especificación JAX-RS define las siguientes
 reglas para priorizar el mapeado de expresiones regulares:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>El primer criterio para ordenar las acciones de mapeado es el número de caracteres
literales que contiene la expresión @Path, teniendo prioridad aquellas con un mayor
número de caracteres literales. El patrón de la URI para el método
<em>getCliente()</em> tiene 10 carácteres literales: <code>/clientes</code>. El patrón para el método
<em>getDireccion()</em> tiene 19: <code>clientes/direccion</code>. Por lo tanto se elegiría primero
el método <em>getDireccion()</em></p>
</li>
<li>
<p>El segundo criterio es el número de variables
en expresiones @Path (por ejemplo {id}, o {id: .+}). Teniendo precedencia
las patrones con un mayor número de variables</p>
</li>
<li>
<p>El tercer criterio es el número de variables que tienen asociadas expresiones
regulares (también en orden descendente)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A continuación mostramos una lista de expresiones @Path,
 ordenadas en orden descendente de prioridad:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>/clientes/{id}/{nombre}/direccion</p>
</li>
<li>
<p>/clientes/{id : .+}/direccion</p>
</li>
<li>
<p>/clientes/{id}/direccion</p>
</li>
<li>
<p>/clientes/{id : .+}</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Las expresiones 1..3 se analizarían primero ya que tienen más caracteres literales que la
expresión número 4. Si bien las expresiones 1..3 tienen el mismo número de caracteres
literales. La expresión 1 se analizaría antes que las otras dos debido a la segunda regla (tiene
más variables). Las expresiones 2 y 3 tienen el mismo número de caracteres literales
y el mismo número de variables, pero la expresión 2 tiene una variable con una expresión
regular asociada.</p>
</div>
<div class="paragraph">
<p>Estas reglas de ordenación no son perfectas. Es posible que siga habiendo ambigüedades,
pero cubren el 90% de los casos. Si el diseño de nuestra aplicación presenta ambigüedades
 aplicando estas reglas, es bastante probable que hayamos complicado dicho diseño y
sería conveniente revisarlo y refactorizar nuestro esquema de URIs.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parámetros_em_matrix_em_em_matrix_parameters_em">2.2.2. Parámetros <em>matrix</em> (<em>Matrix parameters</em>)</h4>
<div class="paragraph">
<p>Los parámetros <em>matrix</em> con pares nombre-valor incluidos como parte de la URI.
Aparecen al final de un <strong>segmento</strong> de la URI (segmento de ruta) y están delimitados por el
carácter <code>;</code>. Por ejemplo:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://ejemplo.coches.com/seat/ibiza;color=black/2006</pre>
</div>
</div>
<div class="paragraph">
<p>En la ruta anterior el parámetro <em>matrix</em> aparece después del segmento de ruta <em>ibiza</em>.
Su nombre es <code>color</code> y el <code>valor</code> asociado es <code>black</code>.</p>
</div>
<div class="paragraph">
<p>Un parámetro <em>matrix</em> es diferente de lo que denominamos <strong>parámetro de consulta</strong> (<em>query parameter</em>),
ya que los parámetros <em>matrix</em> representan atributos de ciertos <strong>segmentos</strong> de la URI y se utilizan
para propósitos de <strong>identificación</strong>. Pensemos en ellos como adjetivos. Los <strong>parámetros de consulta</strong>,
por otro lado, <strong>siempre</strong> aparecen al <strong>final</strong> de la URI, y <strong>siempre</strong>
pertenecen al recurso "completo" que estemos referenciando.</p>
</div>
<div class="paragraph">
<p>Los parámetros <em>matrix</em> son ignorados cuando el runtime de JAX-RS realiza el <em>matching</em>
 de las peticiones de entrada a métodos de recursos REST. De hecho, es "ilegal" incluir
 parámetros <em>matrix</em> en las expresiones @Path. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/seat&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SeatService</span> <span class="tok-o">{</span>

   <span class="tok-nd">@GET</span>
   <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/ibiza/{anyo}&quot;</span><span class="tok-o">)</span>
   <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;image/jpeg&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">Response</span> <span class="tok-nf">getIbizaImagen</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;anyo&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">anyo</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si la petición de entrada es: <strong>GET /seat/ibiza;color=black/2009</strong>, el método <em>getIbizaImagen()</em>
sería elegido por el proveedor de JAX-RS para servir la petición de entrada, y sería invocado.
Los parámetros <em>matrix</em> <strong>NO</strong> se consideran parte del proceso de <em>matching</em> debido a que normalmente
  son atributos variables de la petición.</p>
</div>
</div>
<div class="sect3">
<h4 id="_subrecursos_em_subresource_locators_em">2.2.3. Subrecursos (<em>Subresource Locators</em>)</h4>
<div class="paragraph">
<p>Acabamos de ver la capacidad de JAX-RS para hacer corresponder, de forma <strong>estática</strong> a
través de la anotación @Path, URIs
especificadas en la entrada de la petición con métodos Java específicos. JAX-RS
también nos permitirá, de forma <strong>dinámica</strong> servir nosotros mismos las peticiones a través
de los denominados <strong><em>subresource locators</em></strong> (localizadores de subrecursos).</p>
</div>
<div class="paragraph">
<p>Los <strong><em>subresource locators</em></strong> son métodos Java anotados con @Path, pero sin anotaciones
 @GET, @PUT, &#8230;&#8203; Este tipo de métodos devuelven un objeto, que es, en sí mismo, un servicio
 JAX-RS que "sabe" cómo servir el resto de la petición. Vamos a describir mejor este
 concepto con un ejemplo.</p>
</div>
<div class="paragraph">
<p>Supongamos que queremos extender nuestro servicio que proporciona información sobre los
clientes. Disponemos de diferentes bases de datos de clientes según regiones geográficas.
Queremos añadir esta información en nuestro esquema de URIs pero desacoplando
la búsqueda
del servidor de base de datos, de la consulta particular de un cliente en concreto.
Añadiremos la información de la zona geográfica en la siguiente expresión @Path:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/clientes/{zona}-db/{clienteId}</pre>
</div>
</div>
<div class="paragraph">
<p>A continuación definimos la clase <strong>ZonasClienteResource</strong>, que delegará en la clase
 ClienteResource, que ya teníamos definida.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ZonasClienteResource</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{zona}-db&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">ClienteResource</span> <span class="tok-nf">getBaseDeDatos</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;zona&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">db</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-c1">// devuelve una instancia dependiendo del parámetro db</span>
      <span class="tok-n">ClienteResource</span> <span class="tok-n">resource</span> <span class="tok-o">=</span> <span class="tok-n">localizaClienteResource</span><span class="tok-o">(</span><span class="tok-n">db</span><span class="tok-o">);</span>
      <span class="tok-k">return</span> <span class="tok-n">resource</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">protected</span> <span class="tok-n">ClienteResource</span> <span class="tok-nf">localizaClienteResource</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">db</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La clase <strong>ZonasClienteResource</strong> es nuestro recurso raíz. Dicha clase no atiende
ninguna petición HTTP directamente. Nuestro recurso raíz procesa el segmento de URI
que hace referencia a la base de datos en donde buscar a nuestro cliente y devuelve
una instancia de dicha base de datos (o más propiamente dicho, del objeto con en que
accederemos a dicha base de datos). El "proveedor" de JAX-RS utiliza dicha instancia
para "servir" el resto de la petición:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-kd">private</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;</span> <span class="tok-n">clienteDB</span> <span class="tok-o">=</span>
                 <span class="tok-k">new</span> <span class="tok-n">ConcurrentHashMap</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;();</span>
  <span class="tok-kd">private</span> <span class="tok-n">AtomicInteger</span> <span class="tok-n">idContador</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nf">AtomicInteger</span><span class="tok-o">();</span>

  <span class="tok-kd">public</span> <span class="tok-nf">ClienteResource</span><span class="tok-o">(</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;</span> <span class="tok-n">clienteDB</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">clienteDB</span> <span class="tok-o">=</span> <span class="tok-n">clienteDB</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@POST</span>
  <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">Response</span> <span class="tok-nf">crearCliente</span><span class="tok-o">(</span><span class="tok-n">InputStream</span> <span class="tok-n">is</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">Cliente</span> <span class="tok-nf">recuperarClienteId</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span>

  <span class="tok-nd">@PUT</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">modificarCliente</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span> <span class="tok-n">cli</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si un usuario envía la petición <em>GET /clientes/norteamerica-db/333</em>, el proveedor
JAX-RS primero realizará un <em>matching</em> de la expresión sobre el método <em>ZonasClienteResource.getBaseDeDatos()</em>.
A continuación procesará el resto de la petición ("/333") a través del método
ClienteResource.recuperarClienteId().</p>
</div>
<div class="paragraph">
<p>Podemos observar que la nueva clase <strong>ClienteResource</strong>, además de tener un nuevo constructor,
ya no está anotada con @Path. Esto implica que <strong>ya no es un recurso</strong> de nuestro sistema;
es un <strong>subrecurso</strong> y no debe ser registrada en el <em>runtime</em> de JAX-RS a través de la
clase <em>Application</em> (como veremos más adelante).</p>
</div>
<div class="paragraph">
<p>Veamos otro ejemplo. Supongamos que tenemos un conjunto de alumnos, del que podemos
obtener el listado completo de alumnos y añadir nuevos alumnos, pero además
queremos que cada alumno individual pueda consultarse, modificarse o borrarse.
Una forma sencilla de tratar esto es dividir el código en un <strong>recurso</strong> (lista de
alumnos) y un <strong>subrecurso</strong> (alumno individual) de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/alumnos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AlumnosResource</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Context</span>
    <span class="tok-n">UriInfo</span> <span class="tok-n">uriInfo</span><span class="tok-o">;</span>

    <span class="tok-nd">@GET</span>
    <span class="tok-nd">@Produces</span><span class="tok-o">({</span><span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_XML</span><span class="tok-o">,</span>
               <span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_JSON</span><span class="tok-o">})</span>
    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">AlumnoBean</span><span class="tok-o">&gt;</span> <span class="tok-nf">getAlumnos</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">getAlumnos</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@POST</span>
    <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_JSON</span><span class="tok-o">)</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">addAlumno</span><span class="tok-o">(</span><span class="tok-n">AlumnoBean</span> <span class="tok-n">alumno</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">IOException</span> <span class="tok-o">{</span>
        <span class="tok-n">String</span> <span class="tok-n">dni</span> <span class="tok-o">=</span> <span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">addAlumno</span><span class="tok-o">(</span><span class="tok-n">alumno</span><span class="tok-o">);</span>
        <span class="tok-n">URI</span> <span class="tok-n">uri</span> <span class="tok-o">=</span>
          <span class="tok-n">uriInfo</span><span class="tok-o">.</span><span class="tok-na">getAbsolutePathBuilder</span><span class="tok-o">().</span><span class="tok-na">path</span><span class="tok-o">(</span><span class="tok-s">&quot;{dni}&quot;</span><span class="tok-o">).</span><span class="tok-na">build</span><span class="tok-o">(</span><span class="tok-n">dni</span><span class="tok-o">);</span>
        <span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">created</span><span class="tok-o">(</span><span class="tok-n">uri</span><span class="tok-o">).</span><span class="tok-na">build</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{alumno}&quot;</span><span class="tok-o">)</span>
    <span class="tok-kd">public</span> <span class="tok-n">AlumnoResource</span> <span class="tok-nf">getAlumno</span><span class="tok-o">(</span>
                           <span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;alumno&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">dni</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-nf">AlumnoResource</span><span class="tok-o">(</span><span class="tok-n">uriInfo</span><span class="tok-o">,</span> <span class="tok-n">dni</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Vemos que en este recurso inyectamos información sobre la URI solicitada como
variable de instancia (utilizando la anotación <code>@Context</code>, de la que hablaremos
más adelante). Para el conjunto de alumnos ofrecemos dos operaciones:
obtener la lista de alumnos, y añadir un nuevo alumno a la lista, la cual devuelve
como respuesta la URI que nos da acceso al recurso que acabamos de añadir.</p>
</div>
<div class="paragraph">
<p>Sin embargo, lo más destacable es el último método. Éste se ejecutará cuando
añadamos a la ruta el identificador de un alumno (por ejemplo <code>/alumnos/15</code>).
En este caso lo que hace es devolver un subrecurso (<strong>AlumnoResource</strong>),
para así tratar un alumno individual (destacamos que el nombre está en singular,
para distinguirlo del recurso anterior que representa el conjunto).</p>
</div>
<div class="paragraph">
<p>Cuando hacemos esto estamos delegando en el nuevo <em>Recurso</em> para tratar la petición.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AlumnoResource</span> <span class="tok-o">{</span>

    <span class="tok-n">UriInfo</span> <span class="tok-n">uriInfo</span><span class="tok-o">;</span>

    <span class="tok-n">String</span> <span class="tok-n">dni</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-nf">AlumnoResource</span><span class="tok-o">(</span><span class="tok-n">UriInfo</span> <span class="tok-n">uriInfo</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">dni</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">uriInfo</span> <span class="tok-o">=</span> <span class="tok-n">uriInfo</span><span class="tok-o">;</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">dni</span> <span class="tok-o">=</span> <span class="tok-n">dni</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@GET</span>
    <span class="tok-nd">@Produces</span><span class="tok-o">({</span><span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_XML</span><span class="tok-o">,</span><span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_JSON</span><span class="tok-o">})</span>
    <span class="tok-kd">public</span> <span class="tok-n">AlumnoBean</span> <span class="tok-nf">getAlumno</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-n">AlumnoBean</span> <span class="tok-n">alumno</span> <span class="tok-o">=</span>
            <span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">getAlumno</span><span class="tok-o">(</span><span class="tok-n">dni</span><span class="tok-o">);</span>
        <span class="tok-k">if</span><span class="tok-o">(</span><span class="tok-n">alumno</span><span class="tok-o">==</span><span class="tok-kc">null</span><span class="tok-o">)</span>
            <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-nf">WebApplicationException</span><span class="tok-o">(</span><span class="tok-n">Status</span><span class="tok-o">.</span><span class="tok-na">NOT_FOUND</span><span class="tok-o">);</span>
        <span class="tok-k">return</span> <span class="tok-n">alumno</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@PUT</span>
    <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_XML</span><span class="tok-o">)</span>
    <span class="tok-kd">public</span> <span class="tok-n">Response</span> <span class="tok-nf">setAlumno</span><span class="tok-o">(</span><span class="tok-n">AlumnoBean</span> <span class="tok-n">alumno</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-c1">// El DNI del alumno debe coincidir con el de la URI</span>
        <span class="tok-n">alumno</span><span class="tok-o">.</span><span class="tok-na">setDni</span><span class="tok-o">(</span><span class="tok-n">dni</span><span class="tok-o">);</span>

        <span class="tok-k">if</span><span class="tok-o">(</span><span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">getAlumno</span><span class="tok-o">(</span><span class="tok-n">dni</span><span class="tok-o">)</span> <span class="tok-o">!=</span> <span class="tok-kc">null</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">updateAlumno</span><span class="tok-o">(</span><span class="tok-n">alumno</span><span class="tok-o">);</span>
            <span class="tok-k">return</span> <span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">noContent</span><span class="tok-o">().</span><span class="tok-na">build</span><span class="tok-o">();</span>
        <span class="tok-o">}</span> <span class="tok-k">else</span> <span class="tok-o">{</span>
            <span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">addAlumno</span><span class="tok-o">(</span><span class="tok-n">alumno</span><span class="tok-o">);</span>
            <span class="tok-k">return</span>
                <span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">created</span><span class="tok-o">(</span><span class="tok-n">uriInfo</span><span class="tok-o">.</span><span class="tok-na">getAbsolutePath</span><span class="tok-o">()).</span><span class="tok-na">build</span><span class="tok-o">();</span>
        <span class="tok-o">}</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@DELETE</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">deleteAlumno</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-n">FactoriaDaos</span><span class="tok-o">.</span><span class="tok-na">getAlumnoDao</span><span class="tok-o">().</span><span class="tok-na">deleteAlumno</span><span class="tok-o">(</span><span class="tok-n">dni</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Este recurso ya no es un recurso raíz mapeado a una ruta determinada (podemos ver
que la clase no lleva la anotación @Path), sino que es creado desde otro recurso.
Es, por lo tanto, un subrecurso.</p>
</div>
<div class="paragraph">
<p>Como ya hemos visto, los subrecursos nos permiten simplificar la forma
de trabajar con conjuntos de recursos, definiendo en un único método la ruta de
acceso a un recurso individual, en lugar de tenerlo que hacer de forma independiente
para cada operación.</p>
</div>
<div class="paragraph">
<p>Además, este diseño modular de los recursos nos va a permitir reutilizar determinados
recursos dentro de otros. Por ejemplo, dentro del recurso de un alumno podríamos
ver la lista de asignaturas en las que se ha matriculado, y reutilizar el subrecurso
encargado de acceder a las asignaturas para poder acceder a sus datos a partir del
recurso del alumno. No deberemos abusar de esta característica, ya que si creamos
relaciones cíclicas perdemos la característica deseable de los servicios REST de
que cada recurso está asignado a una única URI.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>En un subrecurso <strong>NO</strong> podemos inyectar objetos de contexto mediante la anotación
<code>@Context</code>, ya que no estamos en un recurso raíz. Por ese motivo en el ejemplo
hemos proporcionado el objeto <strong>UriInfo</strong> en el constructor del subrecurso. De forma
alternativa, también podríamos haber inyectado este objeto como parámetro de sus
métodos, en ese caso si que habría sido posible la inyección.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_carácter_dinámico_del_dispatching_de_peticiones">Carácter dinámico del "dispatching" de peticiones</h5>
<div class="paragraph">
<p>En los ejemplos anteriores hemos ilustrado el concepto de <em>subresource locator</em>, aunque no
hemos mostrado completamente su carácter dinámico. Así, si volvemos al primero de ellos,
el método <em>ZonasClienteResource.getBaseDeDatos()</em>
puede devolver <strong>cualquier</strong> instancia de <strong>cualquier clase</strong>. En tiempo de ejecución, el proveedor
JAX-RS "buscará el interior" de esta instancia métodos de recurso que puedan gestionar la
petición.</p>
</div>
<div class="paragraph">
<p>Supongamos que tenemos dos bases de datos de clientes con diferentes tipos de identificadores.
Una de ellas utiliza una clave numérica. La otra utiliza una clave formada por el nombre y
apellidos. Necesitamos tener dos clases diferentes para extraer la información adecuada de la
 URI de la petición. Cambiaremos la implementación de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ZonasClienteResourceResource</span> <span class="tok-o">{</span>
   <span class="tok-kd">protected</span> <span class="tok-n">ClienteResource</span> <span class="tok-n">europa</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nf">ClienteResource</span><span class="tok-o">();</span>
   <span class="tok-kd">protected</span> <span class="tok-n">OtraClaveClienteResource</span> <span class="tok-n">norteamerica</span> <span class="tok-o">=</span>
                          <span class="tok-k">new</span> <span class="tok-nf">OtraClaveClienteResource</span><span class="tok-o">();</span>

   <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{zona}-db&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">Object</span> <span class="tok-nf">getBaseDeDatos</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;zona&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">db</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">db</span><span class="tok-o">.</span><span class="tok-na">equals</span><span class="tok-o">(</span><span class="tok-s">&quot;europa&quot;</span><span class="tok-o">))</span> <span class="tok-o">{</span>
         <span class="tok-k">return</span> <span class="tok-n">europa</span><span class="tok-o">;</span>
      <span class="tok-o">}</span>
      <span class="tok-k">else</span> <span class="tok-nf">if</span> <span class="tok-o">(</span><span class="tok-n">db</span><span class="tok-o">.</span><span class="tok-na">equals</span><span class="tok-o">(</span><span class="tok-s">&quot;norteamerica&quot;</span><span class="tok-o">))</span> <span class="tok-o">{</span>
               <span class="tok-k">return</span> <span class="tok-n">northamerica</span><span class="tok-o">;</span> <span class="tok-o">}</span>
      <span class="tok-k">else</span> <span class="tok-k">return</span> <span class="tok-kc">null</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En lugar de devolver una instancia de ClienteResource, el método getBaseDeDatos()
devuelve una instancia de <code>java.lang.Object</code>. JAX-RS analizará la instancia
devuelta para ver cómo procesar el resto de la petición.</p>
</div>
<div class="paragraph">
<p>Ahora, si un usuario envía la petición <em>GET /clientes/europa-db/333</em>, se utilizará
la clase ClienteResource para servir el resto de la petición. Si la petición es
<em>GET /clientes/norteamerica-db/john-smith</em> utilizaremos el nuevo subrecurso OtraClaveClienteResource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">OtraClaveClienteResource</span> <span class="tok-o">{</span>
   <span class="tok-kd">private</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;</span> <span class="tok-n">clienteDB</span> <span class="tok-o">=</span>
               <span class="tok-k">new</span> <span class="tok-n">ConcurrentHashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Cliente</span><span class="tok-o">&gt;();</span>
   <span class="tok-nd">@GET</span>
   <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{nombre}-{apellidos}&quot;</span><span class="tok-o">)</span>
   <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">Cliente</span> <span class="tok-nf">getCliente</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">,</span>
                              <span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellidos&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">apelllidos</span><span class="tok-o">)</span> <span class="tok-o">{</span>
     <span class="tok-o">...</span>
   <span class="tok-o">}</span>

   <span class="tok-nd">@PUT</span>
   <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{nombre}-{apellidos}&quot;</span><span class="tok-o">)</span>
   <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">actualizaCliente</span><span class="tok-o">()</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">,</span>
                            <span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellidos&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">apelllidos</span><span class="tok-o">,</span>
                             <span class="tok-n">Cliente</span> <span class="tok-n">cli</span><span class="tok-o">)</span> <span class="tok-o">{</span>
     <span class="tok-o">...</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usos_de_las_anotaciones_produces_y_consumes">2.3. Usos de las anotaciones @Produces y @Consumes</h3>
<div class="paragraph">
<p>La información enviada a un recurso y posteriormente devuelta al cliente que realizó
la petición se especifica con la cabecera HTTP <code>Media-Type</code>, tanto en la petición
como en la respuesta. Como ya hemos visto, podemos especificar que representaciones de
los recursos (valor de <strong>Media_Type</strong>) son capaces de aceptar y/o producir nuestros
servicios mediante las siguientes anotaciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>javax.ws.rs.Consumes</p>
</li>
<li>
<p>javax.ws.rs.Produces</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La ausencia de dichas anotaciones es equivalente a incluirlas con el valor de <em>media type</em>
<code><strong>/</strong></code>, es decir, su ausencia implica que se soporta (acepta) cualquier tipo de representación.</p>
</div>
<div class="sect3">
<h4 id="_anotación_consumes">2.3.1. Anotación @Consumes</h4>
<div class="paragraph">
<p>Esta anotación funciona conjuntamente con @POST y @PUT. Le indica al framework (librerías JAX-RS)
a qué método se debe delegar la petición de entrada. Específicamente, el cliente
fija la cabecera HTTP <code>Content-Type</code> y el framework delega la petición al correspondiente
método capaz de manejar dicho contenido. Un ejemplo de anotación con @PUT es la
siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>
   <span class="tok-nd">@PUT</span>
   <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">modificarPedido</span><span class="tok-o">(</span><span class="tok-n">Pedido</span> <span class="tok-n">representation</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si @Consumes se aplica a la clase, por defecto los métodos correspondientes aceptan
los tipos especificados de tipo MIME. Si se aplica a nivel de método, se ignora
cualquier anotación @Consumes a nivel de clase para dicho método.</p>
</div>
<div class="paragraph">
<p>En este ejemplo, le estamos indicando al framework que el método <em>modificarPedido()</em>
  acepta un recurso cuya representación (tipo MIME) es "application/xml"
  (y que se almacenará
  en la variable <em>representation</em>, hablaremos de ello en la siguiente sesión). Por lo tanto, un cliente que se conecte al
  servicio web a través de la URI <em>/pedidos</em> debe enviar una petición HTTP PUT
  conteniendo el valor de <code>application/xml</code> como tipo MIME de la cabecera <code>HTTP Content-Type</code>,
  y el cuerpo (<em>body</em>) del mensaje HTTP debe ser, por tanto, un documento xml válido.</p>
</div>
<div class="paragraph">
<p>Si no hay métodos de recurso que puedan responder al tipo MIME solicitado (tipo MIME
especificado en la anotación @Consumes del servicio), se le
devolverá al cliente un código <strong><em>HTTP 415 ("Unsupported Media Type")</em></strong>. Si el método
que consume la representación indicada como tipo MIME no devuelve ninguna representación,
se enviará un el código <strong>HTTP 204 ("No content")</strong>. A continuación mostramos un
ejemplo en el que sucede ésto:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@POST</span>
<span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">creaPedido</span><span class="tok-o">(</span><span class="tok-n">Pedido</span> <span class="tok-n">pedido</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-c1">// Crea y almacena un nuevo _Pedido_</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Podemos ver que el método "consume" una representación en texto plano, pero devuelve <strong>void</strong>,
es decir, no devuelve ninguna representación. En este caso, se envía el código de
estado  <strong>HTTP 204 No content</strong> en la respuesta.</p>
</div>
<div class="paragraph">
<p>Un recurso puede aceptar diferentes tipos de "entradas". Así, podemos utilizar la
anotación @PUT con más de un método para gestionar las repuestas con tipos MIME
diferentes. Por ejemplo, podríamos tener un método para aceptar estructuras XML,
y otro para aceptar estructuras JSON.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>
 
   <span class="tok-nd">@PUT</span>
   <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">modificarPedidoXML</span><span class="tok-o">(</span><span class="tok-n">InputStream</span> <span class="tok-n">pedido</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">}</span>
    
   <span class="tok-nd">@PUT</span>
   <span class="tok-nd">@Consumes</span><span class="tok-o">(</span><span class="tok-s">&quot;application/json&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">modificarPedidoJson</span><span class="tok-o">(</span><span class="tok-n">InputStream</span> <span class="tok-n">pedido</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-o">}</span>
 
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_anotación_produces">2.3.2. Anotación @Produces</h4>
<div class="paragraph">
<p>Esta anotación funciona conjuntamente con @GET, @POST y @PUT. Indica al <em>framework</em>
qué tipo de representación se envía de vuelta al cliente.</p>
</div>
<div class="paragraph">
<p>De forma más específica, el cliente envía una petición HTTP junto con una cabecera
HTTP <strong>Accept</strong> que se mapea directamente con el <strong>Content-Type</strong> que el método produce.
Por lo tanto, si el valor de la cabecera Accept HTTP es <strong>application/xml</strong>, el método
que gestiona la petición devuelve un stream de tipo MIME <strong>application/xml</strong>. Esta anotación
también puede utilizarse en más de un método en la misma clase de recurso. Un ejemplo que
devuelve representaciones XML y JSON sería el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/pedidos&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>

   <span class="tok-nd">@GET</span>
   <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPedidoXml</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-o">}</span>

   <span class="tok-nd">@GET</span>
   <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/json&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPedidoJson</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Si un cliente solicita una petición a una URI con un tipo MIME no soportado por el
recurso, el <em>framework</em> JAX-RS lanza la excepción adecuada, concretamente el runtime
de JAX-RS envía de vuelta un error <strong>HTTP 406 Not acceptable</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Se puede declarar más de un tipo en la misma declaración @Produces, como por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Produces</span><span class="tok-o">({</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;application/json&quot;</span><span class="tok-o">})</span>
<span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPedidosXmlOJson</span><span class="tok-o">()</span> <span class="tok-o">{</span>
   <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El método <em>getPedidosXmlOJson()</em> será invocado si cualquiera de los dos tipos MIME
especificados en la anotación @Produces son aceptables (la cabecera <strong>Accept</strong> de la
petición HTTP indica qué representación es aceptable). Si ambas representaciones
son igualmente aceptables, se elegirá la primera.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>En lugar de especificar los tipos MIME como cadenas de texto en @Consumes y @Produces,
podemos utilizar las constantes definidas en la clase <strong>javax.ws.rs.core.MediaType</strong>,
como por ejemplo <code>MediaType.APPLICATION_XML</code> o <code>MediaType.APPLICATION_JSON</code>, en lugar
de <code>application/xml</code> y <code>application/json</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inyección_de_parámetros_jax_rs">2.4. Inyección de parámetros JAX-RS</h3>
<div class="paragraph">
<p>Buena parte del "trabajo" de JAX-RS es el "extraer" información de una petición HTTP e
inyectarla en un método Java. Podemos estar interesados en un fragmento de la URI de
entrada, en los parámetros de petición,&#8230;&#8203; El cliente también podría enviar información
en las cabeceras de la petición. A continuación indicamos una lista con algunas de las
anotaciones que podemos
utilizar para inyectar información de las peticiones HTTP.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>@javax.ws.rs.PathParam</p>
</li>
<li>
<p>@javax.ws.rs.MatrixParam</p>
</li>
<li>
<p>@javax.ws.rs.QueryParam</p>
</li>
<li>
<p>@javax.ws.rs.FormParam</p>
</li>
<li>
<p>@javax.ws.rs.HeaderParam</p>
</li>
<li>
<p>@javax.ws.rs.Context</p>
</li>
<li>
<p>@javax.ws.rs.BeanParam</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Habitualmente, estas anotaciones se utilizan en los parámetros de un método de recurso JAX-RX.
Cuando el proveedor de JAX-RS recibe una petición HTTP, busca un método Java que pueda servir
dicha petición. Si el método Java tiene parámetros anotados con alguna de estas anotaciones,
extraerá la información de la petición HTTP y la "pasará" como un <strong>parámetro</strong> cuando se invoque
el método.</p>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_pathparam">2.4.1. @javax.ws.rs.PathParam</h4>
<div class="paragraph">
<p>Ya la hemos utilizado en la sesión anterior. @PathParam nos permite inyectar el valor de
los parámetros de la URI definidos en expresiones @Path. Recordemos el ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{id}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">Cliente</span> <span class="tok-nf">recuperarClienteId</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Podemos referenciar más de un parámetro en el path de la URI en nuestros método java. Por ejemplo,
supongamos que estamos utilizando el nombre y apellidos para identificar a un cliente en
nuestra clase de recurso:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;{nombre}-{apellidos}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">Cliente</span> <span class="tok-nf">recuperarClienteId</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">nom</span><span class="tok-o">,</span>
                                    <span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellidos&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">ape</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En ocasiones, un paramétro de path de la URI puede repetirse en diferentes expresiones @Path
que conforman el patrón de <em>matching</em> completo para un método de un recurso (por ejemplo
puede repetirse en la expresión @Path de la clase y de un método). En estos casos, la anotación
@PathParam siempre referencia el parámetro path final. Así, en el siguiente código:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes/{id}&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/direccion/{id}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;text/plain&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getDireccion</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">direccionId</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Si nuestra petición HTTP es: <strong>GET /clientes/123/direccion/456</strong>, el parámetro <code>direccionId</code> del
método <em>getDireccion()</em> tendría el valor inyectado de <strong>"456"</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_interfaz_uriinfo">2.4.2. Interfaz UriInfo</h4>
<div class="paragraph">
<p>Podemos disponer, además, de un API más general para consultar y extraer información sobre las
peticiones URI de entrada. Se trata de la interfaz <code>javax.ws.rs.core.UriInfo</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">UriInfo</span> <span class="tok-o">{</span>
  <span class="tok-kd">public</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">net</span><span class="tok-o">.</span><span class="tok-na">URI</span> <span class="tok-nf">getAbsolutePath</span><span class="tok-o">();</span>
  <span class="tok-kd">public</span> <span class="tok-n">UriBuilder</span> <span class="tok-nf">getAbsolutePathBuilder</span><span class="tok-o">();</span>

  <span class="tok-kd">public</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-na">net</span><span class="tok-o">.</span><span class="tok-na">URI</span> <span class="tok-nf">getBaseUri</span><span class="tok-o">();</span>
  <span class="tok-kd">public</span> <span class="tok-n">UriBuilder</span> <span class="tok-nf">getBaseUriBuilder</span><span class="tok-o">();</span>

  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getPath</span><span class="tok-o">();</span>
  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">PathSegment</span><span class="tok-o">&gt;</span> <span class="tok-nf">getPathSegments</span><span class="tok-o">();</span>
  <span class="tok-kd">public</span> <span class="tok-n">MultivaluedMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">getPathParameters</span><span class="tok-o">();</span>
  <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Los métodos <strong>getAbsolutePathBuilder()</strong> y <strong>getAbsolutePath()</strong> devuelven la ruta
absoluta de la <strong>petición</strong> HTTP en forma de <em>UriBuilder</em> y <em>URI</em> respectivamente.</p>
</div>
<div class="paragraph">
<p>Los métodos <strong>getBaseUri()</strong> y <strong>getBaseUriBuilder()</strong> devuelven la ruta "base" de la
aplicación (ruta raiz de nuestros servicios rest) en forma de <em>UriBuilder</em> y <em>URI</em> respectivamente.</p>
</div>
<div class="paragraph">
<p>El método <strong>UriInfo.getPath()</strong> permite obtener la ruta relativa de nuestros servicios REST utilizada para
realizar el <em>matching</em> con nuestra petición de entrada (es la ruta de la petición
actual relativa a la ruta base de la petición rest)</p>
</div>
<div class="paragraph">
<p>El método <strong>UriInfo.getPathSegments()</strong> "divide" la
ruta relativa de nuestro servicio REST en una serie de objetos <em>PathSegment</em> (segmentos de ruta,
delimitados por <code>/</code>).</p>
</div>
<div class="paragraph">
<p>El método <strong>UriInfo.getPathParameters()</strong> devuelve un objeto de tipo <em>MultivaluedMap</em>
con todos los parámetros del path definidos en todas las expresiones @Path de nuestra
petición rest.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, si la ruta de nuestra petción http es: <em><a href="http://localhost:8080/contexto/rest/clientes/2" class="bare">http://localhost:8080/contexto/rest/clientes/2</a></em>
(siendo "contexto" la ruta raíz del <em>war</em> desplegado, y "rest" la ruta de servicio de jax-rs):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>la ruta absoluta (método <em>getAbsolutePath()</em>) sería <em><a href="http://localhost:8080/contexto/rest/clientes/2" class="bare">http://localhost:8080/contexto/rest/clientes/2</a></em></p>
</li>
<li>
<p>la ruta base (método <em>getBaseUri</em>) sería <em><a href="http://localhost:8080/contexto/rest/" class="bare">http://localhost:8080/contexto/rest/</a></em></p>
</li>
<li>
<p>la ruta relativa a la ruta base (método <em>getPath()</em>) sería <em>/clientes/2</em></p>
</li>
<li>
<p>el número de segmentos de la petición rest (método <em>getPathSegments()</em>) serían 2: "clientes" y "2"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Podemos inyectar una instancia de la interfaz <code>UriInfo</code> utilizando la anotación <code>@javax.ws.rs.core.Context</code>.
A continuación mostramos un ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/coches/{marca}&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CarResource</span> <span class="tok-o">{</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/{modelo}/{anyo}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;image/jpeg&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">Response</span> <span class="tok-nf">getImagen</span><span class="tok-o">(</span><span class="tok-nd">@Context</span> <span class="tok-n">UriInfo</span> <span class="tok-n">info</span><span class="tok-o">)</span> <span class="tok-o">{</span>
          <span class="tok-n">String</span> <span class="tok-n">fabricado</span> <span class="tok-o">=</span> <span class="tok-n">info</span><span class="tok-o">.</span><span class="tok-na">getPathParameters</span><span class="tok-o">().</span><span class="tok-na">getFirst</span><span class="tok-o">(</span><span class="tok-s">&quot;marca&quot;</span><span class="tok-o">);</span>
          <span class="tok-n">PathSegment</span> <span class="tok-n">modelo</span> <span class="tok-o">=</span> <span class="tok-n">info</span><span class="tok-o">.</span><span class="tok-na">getPathSegments</span><span class="tok-o">().</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-mi">2</span><span class="tok-o">);</span>
          <span class="tok-n">String</span> <span class="tok-n">color</span> <span class="tok-o">=</span> <span class="tok-n">modelo</span><span class="tok-o">.</span><span class="tok-na">getMatrixParameteres</span><span class="tok-o">().</span><span class="tok-na">getFirst</span><span class="tok-o">(</span><span class="tok-s">&quot;color&quot;</span><span class="tok-o">);</span>
          <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este ejemplo, inyectamos una instancia de <em>UriInfo</em> como parámetro del método <em>getImagen()</em>.
A continuación hacemos uso de dicha instancia para extraer información de la URI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Recuerda que también podríamos inyectar una instancia de <em>UriInfo</em> en una variable de instancia
de la clase raíz de nuestro recurso.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>El método <strong>CarResource.getImagen()</strong> utiliza la interfaz <code>javax.ws.rs.core.PathSegment</code> que,
como ya hemos indicado, representa un segmento de ruta.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">javax</span><span class="tok-o">.</span><span class="tok-na">ws</span><span class="tok-o">.</span><span class="tok-na">rs</span><span class="tok-o">.</span><span class="tok-na">core</span><span class="tok-o">;</span>
<span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">PathSegment</span> <span class="tok-o">{</span>
       <span class="tok-n">String</span> <span class="tok-nf">getPath</span><span class="tok-o">();</span>
       <span class="tok-n">MultivaluedMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">getMatrixParameters</span><span class="tok-o">();</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El método <strong>PathSegment.getPath()</strong> devuelve el valor de la cadena de caracteres del segmento de ruta
actual, sin considerar nigún parámetro matrix que pudiese contener.</p>
</div>
<div class="paragraph">
<p>El método <strong>PathSegment.getMatrixParameters()</strong> devuelve un "mapa" con todos los parámetros matrix
aplicados a un segmento de ruta.</p>
</div>
<div class="paragraph">
<p>Supongamos que realizamos la siguiente petición http para el código anterior (clase CarResource):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /coches/seat/leon;color=rojo/2015</pre>
</div>
</div>
<div class="paragraph">
<p>Esta petición es delegada en el método <em>ClarResource.getImagen()</em>. La ruta contiene 4
segmentos: <em>coches</em>, <em>seat</em>, <em>leon</em> y <em>2015. La variable _modelo</em> tomará el valor <em>leon</em>
y la variable <em>color</em> se instanciará con el valor <em>rojo</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_matrixparam">2.4.3. @javax.ws.rs.MatrixParam</h4>
<div class="paragraph">
<p>La especificación JAX-RS nos permite inyectar una matriz de valores de parámetros
a través de la anotación <code>javax.ws.rs.MatrixParam</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/coches/{marca}&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CarResource</span> <span class="tok-o">{</span>

  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/{modelo}/{anyo}&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;image/jpeg&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">Response</span> <span class="tok-nf">getImagen</span><span class="tok-o">(</span><span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;marca&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">marca</span>
                        <span class="tok-nd">@PathParam</span><span class="tok-o">(</span><span class="tok-s">&quot;modelo&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">modelo</span>
                        <span class="tok-nd">@MatrixParam</span><span class="tok-o">(</span><span class="tok-s">&quot;color&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">color</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El uso de la anotación <code>@MatrixParam</code> simplifica nuestro código y lo hace algo más
legible. Si, por ejemplo, la petición de entrada es:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">GET /coches/seat/ibiza<span class="tok-p">;</span><span class="tok-nv">color</span><span class="tok-o">=</span>black/2009</code></pre>
</div>
</div>
<div class="paragraph">
<p>entonces el parámetro <em>color</em> del método <em>CarResource.getImagen()</em> tomaría el valor <em>black</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_queryparam">2.4.4. @javax.ws.rs.QueryParam</h4>
<div class="paragraph">
<p>La anotación <code>@javax.ws.rs.QueryParam</code> nos permite inyectar parámetros de consulta
(<strong><em>query parameters</em></strong>) de la
URI en los valores de los parámetros de los métodos java de nuestros recursos. Por ejemplo,
supongamos que queremos consultar información de nuestros clientes y queremos recuperar
un subconjunto de clientes de nuestra base de datos. Nuestra URI de petición podría ser
algo así:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /clientes?inicio=0&amp;total=10</pre>
</div>
</div>
<div class="paragraph">
<p>El parámetro de consulta <code>inicio</code> representa el índice (o posición) del primer cliente que
queremos consultar, y el parámetro <code>total</code> representa cuántos clientes en total queremos
obtener como respuesta. Una implementación del servicio RESTful podría contener el
siguiente código:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getClientes</span><span class="tok-o">(</span><span class="tok-nd">@QueryParam</span><span class="tok-o">(</span><span class="tok-s">&quot;inicio&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">inicio</span><span class="tok-o">,</span>
                            <span class="tok-nd">@QueryParam</span><span class="tok-o">(</span><span class="tok-s">&quot;total&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">total</span><span class="tok-o">)</span>
  <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este ejemplo, el parámetro <code>inicio</code> tomaría el valor <code>0</code>, y el parámetro <code>total</code>
tomaría el valor <code>10</code> (JAX-RS convierte automáticamente las cadenas de caracteres
  de los parámetros de consulta en enteros).</p>
</div>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_formparam">2.4.5. @javax.ws.rs.FormParam</h4>
<div class="paragraph">
<p>La anotación <code>@javax.ws.rs.FormParam</code> se utiliza para acceder al cuerpo del mensaje
de la petición HTTP de entrada, cuyo valor de <em>Content-Type</em> es <strong><em>application/x-www-form-urlencoded</em></strong>.
Es decir, se utiliza para acceder a entradas individuales de un formulario HTML. Por ejemplo,
supongamos que para registrar a nuevos clientes en el sistema tenemos que rellenar el
siguiente formulario:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;FORM</span> <span class="tok-na">action=</span><span class="tok-s">&quot;http://ejemplo.com/clientes&quot;</span> <span class="tok-na">method=</span><span class="tok-s">&quot;post&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;P&gt;</span>
    Nombre: <span class="tok-nt">&lt;INPUT</span> <span class="tok-na">type=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-nt">&gt;&lt;BR&gt;</span>
    Apellido: <span class="tok-nt">&lt;INPUT</span> <span class="tok-na">type=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;apellido&quot;</span><span class="tok-nt">&gt;&lt;BR&gt;</span>
    <span class="tok-nt">&lt;INPUT</span> <span class="tok-na">type=</span><span class="tok-s">&quot;submit&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;Send&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;/P&gt;</span>
<span class="tok-nt">&lt;/FORM&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La ejecución de este código, inyectará los valores del formulario como
parámetros de nuestro método Java que representa el servicio, de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
   <span class="tok-nd">@POST</span>
   <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">crearCliente</span><span class="tok-o">(</span><span class="tok-nd">@FormParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">nom</span><span class="tok-o">,</span>
                            <span class="tok-nd">@FormParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellido&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">ape</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Aquí estamos inyectando los valores de <code>nombre</code> y <code>apellidos</code> del formulario HTML en
los parámetors <code>nom</code> y <code>ape</code> del método java <em>crearCliente()</em>. Los datos del formulario
"viajan" a través de la red codificados como <em>URL-encoded</em>. Cuando se utiliza
la anotación @FormParam, JAX-RS decodifica de forma automática las entradas del fomulario
antes de inyectar sus valores.</p>
</div>
<div class="paragraph">
<p>Así, por ejemplo, si tecleamos los valores <em>Maria Luisa</em> y_Perlado_, como valores en los
campos de texto <em>nombre</em> y <em>apellido</em> del formulario, el cuerpo de nuestro mensaje HTTP
será <strong>nombre=Maria%20Luisa;apellido=Perlado</strong>. Este mensaje será recibido por nuestro método, que
extraerá los valores correspondientes y los instanciará en los parámetros <em>nom</em>,
y <em>ape</em> del método _ClienteResource.crearCliente().</p>
</div>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_headerparam">2.4.6. @javax.ws.rs.HeaderParam</h4>
<div class="paragraph">
<p>La anotación <code>@javax.ws.rs.HeaderParam</code> se utiliza para inyectar valores de las cabeceras de
las peticiones HTTP. Por ejemplo, si estamos interesados en la página web que nos ha
referenciado o enlazado con nuestro servicio web, podríamos acceder a la cabecera HTTP
<strong>Referer</strong> utilizando la anotación @HeaderParam, de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/miservicio&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiServicio</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;text/html&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">get</span><span class="tok-o">(</span><span class="tok-nd">@HeaderParam</span><span class="tok-o">(</span><span class="tok-s">&quot;Referer&quot;</span><span class="tok-o">)</span> <span class="tok-n">String</span> <span class="tok-n">referer</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>De forma alternativa, podemos acceder de forma programativa a todas las cabeceras de
la petición de entrada, utilizando la interfaz <code>javax.ws.rs.core.HttpHeaders</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">HttpHeaders</span> <span class="tok-o">{</span>
  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">getRequestHeader</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">);</span>
  <span class="tok-kd">public</span> <span class="tok-n">MultivaluedMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">getRequestHeaders</span><span class="tok-o">();</span>
  <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El método <code>getRequestHeader()</code> permite acceder a una cabecera en concreto, y el método
<code>getRequestHeaders()</code> nos proporciona un objeto de tipo <em>Map</em> que representa
<strong>todas</strong> las cabeceras. A continuación mostramos un ejemplo que accede a todas
las cabeceras de la petición HTTP de entrada.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/miservicio&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MiServicio</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;text/html&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">get</span><span class="tok-o">(</span><span class="tok-nd">@Context</span> <span class="tok-n">HttpHeaders</span> <span class="tok-n">cabeceras</span><span class="tok-o">)</span> <span class="tok-o">{</span>
     <span class="tok-n">String</span> <span class="tok-n">referer</span> <span class="tok-o">=</span> <span class="tok-n">headers</span><span class="tok-o">.</span><span class="tok-na">getRequestHeader</span><span class="tok-o">(</span><span class="tok-s">&quot;Referer&quot;</span><span class="tok-o">).</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">);</span>
     <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">header</span> <span class="tok-o">:</span> <span class="tok-n">headers</span><span class="tok-o">.</span><span class="tok-na">getRequestHeaders</span><span class="tok-o">().</span><span class="tok-na">keySet</span><span class="tok-o">())</span> <span class="tok-o">{</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Se ha utilizado esta cabecera : &quot;</span> <span class="tok-o">+</span> <span class="tok-n">header</span><span class="tok-o">);</span>
     <span class="tok-o">}</span>
     <span class="tok-o">...</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_core_context">2.4.7. @javax.ws.rs.core.Context</h4>
<div class="paragraph">
<p>Dentro de nuestros recursos JAX-RS podemos inyectar determinados objetos con información sobre
el contexto de JAX-RS, sobre el contexto de servlets, o sobre elementos de la petición recibida
desde el cliente. Para ello utilizaremos la anotación <code>@javax.ws.rs.core.Context</code>.</p>
</div>
<div class="paragraph">
<p>En los ejemplos de esta sesión, ya hemos visto como utilizarla
para inyectar objetos de tipo <em>UriInfo</em> y <em>HttpHeaders</em>.</p>
</div>
<div class="paragraph">
<p>A continuación mostramos un ejemplo en el que podos obtener detalles sobre el contexto
del despliegue de la aplicacion, asi como del contexto de peticiones individuales
utilizando la anotacion @Context:</p>
</div>
<div class="listingblock">
<div class="title">Implementación de un servicio que muestra información sobre el contexto de la petición</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;orders&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PedidoResource</span> <span class="tok-o">{</span>
   <span class="tok-nd">@Context</span> <span class="tok-n">Application</span> <span class="tok-n">app</span><span class="tok-o">;</span> <i class="conum" data-value="1"></i><b>(1)</b>
   <span class="tok-nd">@Context</span> <span class="tok-n">UriInfo</span> <span class="tok-n">uri</span><span class="tok-o">;</span> <i class="conum" data-value="2"></i><b>(2)</b>
   <span class="tok-nd">@Context</span> <span class="tok-n">HttpHeaders</span> <span class="tok-n">headers</span><span class="tok-o">;</span> <i class="conum" data-value="3"></i><b>(3)</b>
   <span class="tok-nd">@Context</span> <span class="tok-n">Request</span> <span class="tok-n">request</span><span class="tok-o">;</span> <i class="conum" data-value="4"></i><b>(4)</b>
   <span class="tok-nd">@Context</span> <span class="tok-n">SecurityContext</span> <span class="tok-n">security</span><span class="tok-o">;</span> <i class="conum" data-value="5"></i><b>(5)</b>
   <span class="tok-nd">@Context</span> <span class="tok-n">Providers</span> <span class="tok-n">providers</span><span class="tok-o">;</span> <i class="conum" data-value="6"></i><b>(6)</b>

   <span class="tok-nd">@GET</span>
   <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
   <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Order</span><span class="tok-o">&gt;</span> <span class="tok-nf">getAll</span><span class="tok-o">(</span><span class="tok-nd">@QueryParam</span><span class="tok-o">(</span><span class="tok-s">&quot;start&quot;</span><span class="tok-o">)</span><span class="tok-kt">int</span> <span class="tok-n">from</span><span class="tok-o">,</span>
   <span class="tok-nd">@QueryParam</span><span class="tok-o">(</span><span class="tok-s">&quot;end&quot;</span><span class="tok-o">)</span><span class="tok-kt">int</span> <span class="tok-n">to</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-c1">//. . .(app.getClasses());</span>
        <span class="tok-c1">//. . .(uri.getPath());</span>
        <span class="tok-c1">//. . .(headers.getRequestHeader(HttpHeaders.ACCEPT));</span>
        <span class="tok-c1">//. . .(headers.getCookies());</span>
        <span class="tok-c1">//. . .(request.getMethod());</span>
        <span class="tok-c1">//. . .(security.isSecure());</span>
        <span class="tok-c1">//. . .</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong>Application</strong> proporciona acceso a la información de la configuración de la aplicación (clase Application)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><strong>UriInfo</strong> proporciona acceso a la URI de la petición</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><strong>HttpHeaders</strong> proporciona acceso a las cabeceras de la petición HTTP
La anotación @HeaderParam puede también utilizarse para enlazar una cabecera HTTP a un parámetro de un método
de nuestro recurso, a un campo del mismo, o a una propiedad de un <em>bean</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><strong>Request</strong> se utiliza para procesar la respuestas, típicamente se usa juntamente
con la clase Response para construir la respuesta de forma dinámica</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><strong>SecurityContext</strong> proporciona acceso a la información de la petición actual
relacionada con la seguridad</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><strong>Providers</strong> proporciona información sobre la búsqueda del runtime de las
instancias de proveedores utilizando un conjunto de criterios de búsqueda</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Con respecto a contexto de servlets, podremos inyectar información de <em>ServletContext</em>,
<em>ServletConfig</em>, <em>HttpServletRequest</em>, y <em>HttpServletResponse</em>. Debemos recordar que los recursos
 JAX-RS son invocados por un servlet dentro de una aplicación web, por lo que podemos necesitar
 tener acceso a la información del contexto de servlets. Por ejemplo, si necesitamos acceder a
 la ruta en disco donde tenemos los datos de nuestra aplicación web tendremos que inyectar
 el objeto @ServletContext:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@GET</span>
<span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;image/jpeg&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-n">InputStream</span> <span class="tok-nf">getImagen</span><span class="tok-o">(</span><span class="tok-nd">@Context</span> <span class="tok-n">ServletContext</span> <span class="tok-n">sc</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">sc</span><span class="tok-o">.</span><span class="tok-na">getResourceAsStream</span><span class="tok-o">(</span><span class="tok-s">&quot;/fotos/&quot;</span> <span class="tok-o">+</span> <span class="tok-n">nif</span> <span class="tok-o">+</span> <span class="tok-s">&quot;.jpg&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__javax_ws_rs_beanparam">2.4.8. @javax.ws.rs.BeanParam</h4>
<div class="paragraph">
<p>La anotación <code>@javax.ws.rs.BeanParam</code> nos permite inyectar una clase específica cuyos
métodos o atributos estén anotados con alguna de las anotaciones de inyección de parámetros
<em>@xxxParam</em> que hemos visto en esta sesión. Por ejemplo, supongamos esta clase:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteInput</span> <span class="tok-o">{</span>
   <span class="tok-nd">@FormParam</span><span class="tok-o">(</span><span class="tok-s">&quot;nombre&quot;</span><span class="tok-o">)</span>
   <span class="tok-n">String</span> <span class="tok-n">nombre</span><span class="tok-o">;</span>

   <span class="tok-nd">@FormParam</span><span class="tok-o">(</span><span class="tok-s">&quot;apellido&quot;</span><span class="tok-o">)</span>
   <span class="tok-n">String</span> <span class="tok-n">apellido</span><span class="tok-o">;</span>

   <span class="tok-nd">@HeaderParam</span><span class="tok-o">(</span><span class="tok-s">&quot;Content-Type&quot;</span><span class="tok-o">)</span>
   <span class="tok-n">String</span> <span class="tok-n">contentType</span><span class="tok-o">;</span>

   <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getFirstName</span><span class="tok-o">()</span> <span class="tok-o">{...}</span>
   <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La clase <code>ClienteInput</code> es un simple POJO (Plain Old Java Object) que contiene el nombre y
apellidos de un cliente, así como el tipo de contenido del mismo. Podemos dejar que JAX-RS
cree, inicialice, e inyecte esta clase usando la anotación @BeanParam de la siguiente forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@POST</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">crearCliente</span><span class="tok-o">(</span><span class="tok-nd">@BeanParam</span> <span class="tok-n">ClienteInput</span> <span class="tok-n">newCust</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-o">...}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>El runtime de JAX-RS "analizará" los parámetros anotados con @BeanParam para inyectar las
anotaciones correspondientes y asignar el valor que corresponda. En este ejemplo, la clase
<em>ClienteInput</em> contendrá dos valores de un formulario de entrada, y uno de los valores de
la cabecera de la petición. De esta forma, nos podemos evitar una larga lista de parámetros
en el método <em>crearCliente()</em> (en este caso son sólo tres pero podrían ser muchos más).</p>
</div>
</div>
<div class="sect3">
<h4 id="_conversión_automática_de_tipos">2.4.9. Conversión automática de tipos</h4>
<div class="paragraph">
<p>Todas las anotaciones que hemos visto referencian varias partes de la petición HTTP. Todas
ellas se representan como una cadena de caracteres en dicha petición HTTP. JAX-RS puede
convertir esta cadena de caracteres en cualquier tipo Java, siempre y cuando se cumpla <strong>al menos
uno</strong> de estos casos:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Se trata de un tipo primitivo. Los tipos <em>int</em>, <em>short</em>, <em>float</em>, <em>double</em>, <em>byte</em>, <em>char</em>, y
<em>boolean</em>, pertenecen a esta categoría.</p>
</li>
<li>
<p>Se trata de una clase Java que tiene un constructor con un único parámetro de tipo <em>String</em></p>
</li>
<li>
<p>Se trata de una clase Java que tiene un método estático denominado <em>valueOf()</em>, que toma un
único <em>String</em> como argumento, y devuelve una instancia de la clase.</p>
</li>
<li>
<p>Es una clase de tipo java.util.List&lt;T&gt;, java.util.Set&lt;T&gt;, o java.util.SortedSet&lt;T&gt;, en donde
T es un tipo que satisface los criterios 2 ó 3, o es un <em>String</em>. Por ejemplo, List&lt;Double&gt;,
Set&lt;String&gt;, o SortedSet&lt;Integer&gt;.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Si el runtime JAX-RS falla al convertir una cadena de caracteres en
el tipo Java especificado, se considera un error del cliente.
Si se produce este fallo durante el procesamiento de una inyección de tipo
@MatrixParam, @QueryParam, o @PathParam, se devuelve al cliente un error
"404 Not found". Si el fallo tiene lugar con el procesamiento de las
inyecciones @HeaderParam o @CookieParam (esta última no la hemos visto), entonces se envía al cliente
el eror "400 Bad Request".</p>
</div>
</div>
<div class="sect3">
<h4 id="_valores_por_defecto_defaultvalue">2.4.10. Valores por defecto (@DefaultValue)</h4>
<div class="paragraph">
<p>Suele ser habitual que algunos de los parámetros proporcionados en
las peticiones a servicios RESTful sean opcionales. Cuando un cliente no
proporciona esta información opcional en la petición, JAX-RS inyectará por defecto
un valor null si se trata de un objeto, o un valor cero en el caso de tipos primitivos.</p>
</div>
<div class="paragraph">
<p>Estos valores por defecto no siempre son los que necesitamos para nuestro servicio.
Para solucionar este problema, podemos definir nuestro propio valor por defecto para
los parámetros que sean opcionales, utilizando la anotación <code>@javax.ws.rs.DefaultValue</code>.</p>
</div>
<div class="paragraph">
<p>Consideremos el ejemplo anterior relativo a la recuperación de la información de un
  subconjunto de clientes de nuestra base de datos. Para ello utilizábamos dos
parámetros de consulta para indicar el índice del primer elemento, así como el número
total de elementos que estamos interesados en recuperar. En este caso, no queremos
que el cliente tenga que especificar siempre estos parámetros al realizar la peticion.
Usaremos la anotación @DefaultValue para indicar los valores por defecto que nos
interese.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-nd">@Path</span><span class="tok-o">(</span><span class="tok-s">&quot;/clientes&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ClienteResource</span> <span class="tok-o">{</span>
  <span class="tok-nd">@GET</span>
  <span class="tok-nd">@Produces</span><span class="tok-o">(</span><span class="tok-s">&quot;application/xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getClientes</span><span class="tok-o">(</span>
         <span class="tok-nd">@DefaultValue</span><span class="tok-o">(</span><span class="tok-s">&quot;0&quot;</span><span class="tok-o">)</span> <span class="tok-nd">@QueryParam</span><span class="tok-o">(</span><span class="tok-s">&quot;inicio&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">inicio</span><span class="tok-o">,</span>
        <span class="tok-nd">@DefaultValue</span><span class="tok-o">(</span><span class="tok-s">&quot;10&quot;</span><span class="tok-o">)</span> <span class="tok-nd">@QueryParam</span><span class="tok-o">(</span><span class="tok-s">&quot;total&quot;</span><span class="tok-o">)</span> <span class="tok-kt">int</span> <span class="tok-n">total</span><span class="tok-o">)</span>
  <span class="tok-o">...</span> <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Hemos usado @DefaultValue para especificar un índice de comienzo con valor cero, y
un tamaño del subconjunto de los datos de la respuesta. JAX-RS utilizará las reglas
de conversión de cadenas de caracteres que acabamos de indicar para convertir el
valor del parámetro en el tipo Java que especifiquemos.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuración_y_despliegue_de_aplicaciones_jax_rs">2.5. Configuración y despliegue de aplicaciones JAX-RS</h3>
<div class="paragraph">
<p>Como ya hemos visto en la sesión anterior, implementamos nuestros servicios
 REST utilizando el API de Java JAX-RS (especificación JSR-339). Una aplicación JAX-RS
 consiste en uno o más <strong>recursos</strong> y cero o más <strong>proveedores</strong>. En este apartado vamos
 a describir ciertos aspectos aplicados a las aplicaciones JAX-RS como un todo,
  concretamente a la configuración y también a la publicación de las mismas cuando utilizamos
  un servidor de aplicaciones JavaEE 7 o bien un contenedor de servlets 3.0, que incluyan
  una implementación del API JAX-RS. También indicaremos cómo configurar el despliegue
  en el caso de no disponer como mínimo de un contenedor de <em>servlets 3.0</em>.</p>
</div>
<div class="sect3">
<h4 id="_configuración_mediante_la_clase_em_application_em">2.5.1. Configuración mediante la clase <em>Application</em></h4>
<div class="paragraph">
<p>Tanto los recursos (clases anotadas con @Path) como los proveedores que conforman nuestra aplicación JAX-RS
pueden configurarse utilizando una subclase de <strong>Application</strong>. Cuando hablamos de
configuración nos estamos refiriendo, en este caso, a definir los mecanismos para
localizar las clases que representan los recursos, así como a los proveedores.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Un <strong>proveedor</strong> es una clase que implementa una o alguna de las siguientes
 interfaces JAX-RS: MesssageBodyReader, MessageBodyWriter, ContextResolver&lt;T&gt;, y
 ExceptionMapper&lt;T&gt;. Las dos primeras permiten crear <em>proveedores de entidades</em> (<em>entity providers</em>),
la tercera es un <em>proveedor de contexto</em> (<em>context provider</em>), y la última un
 proveedor de mapeado de excepciones (<em>exception mapping provider</em>). Las clases que
 actúan como "proveedores" están anotadas con @Provider, para que puedan ser
 identificadas automáticamente por el <em>runtime</em> JAX-RS.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>El uso de una subclase de <strong>Application</strong> para configurar nuestros servicios REST
constituye la forma más sencilla de desplegar los servicios JAX-RS en un servidor
de aplicaciones certificado como Java EE (en este caso, Wildfly cumple con este
requisito), o un contenedor <em>standalone</em> de <em>Servlet 3</em> (como por ejemplo Tomcat).</p>
</div>
<div class="paragraph">
<p>Pasemos a conocer la clase <code>javax.ws.rs.core.Application</code>. El uso de la clase
<em>Application</em> es la única forma <strong>portable</strong> de "decirle" a
 JAX-RS qué servicios web (clases anotadas con @Path), así como qué otros
 elementos, como filtros, interceptores,&#8230;&#8203;, queremos publicar (desplegar).</p>
</div>
<div class="paragraph">
<p>La clase <strong><em>Application</em></strong> se define como:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">javax</span><span class="tok-o">.</span><span class="tok-na">ws</span><span class="tok-o">.</span><span class="tok-na">rs</span><span class="tok-o">.</span><span class="tok-na">core</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">java.util.Collections</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">java.util.Set</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kd">class</span> <span class="tok-nc">Application</span> <span class="tok-o">{</span>
   <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">emptySet</span> <span class="tok-o">=</span>
                          <span class="tok-n">Collections</span><span class="tok-o">.</span><span class="tok-na">emptySet</span><span class="tok-o">();</span>

   <span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Class</span><span class="tok-o">&lt;?&gt;&gt;</span> <span class="tok-n">getClasses</span><span class="tok-o">();</span>

   <span class="tok-kd">public</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getSingletons</span><span class="tok-o">()</span> <span class="tok-o">{</span>
      <span class="tok-k">return</span> <span class="tok-n">emptySet</span><span class="tok-o">;</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La clase <em>Application</em> es muy simple. Como ya hemos indicado, su propósito es
proporcionar una lista de clases y objetos que "queremos" desplegar.</p>
</div>
<div class="paragraph">
<p>El método <code>getClasses()</code> devuelve una lista de <strong>clases</strong> de servicios web y
proveedores JAX-RS. Cualquier <strong>servicio</strong> JAX-RS devuelto por este método sigue
el modelo <em>per-request</em>, que ya hemos introducido en la sesión anterior.
Cuando la implementación de JAX-RS determina que una petición HTTP necesita ser
procesada por un método de una de estas clases, se creará una instancia de dicha
clase durante la petición, y se "destruirá" al finalizar la misma. En este caso
estamos <strong>delegando</strong> en el <em>runtime</em> JAX-RS la <strong>creación de los objetos</strong>.
Las clases "proveedoras" son instanciadas por el contenedor JAX-RS y registradas
una única vez por aplicación.</p>
</div>
<div class="paragraph">
<p>El método <code>getSingletons()</code> devuelve una lista de servicios y proveedores web JAX-RS
"ya instanciados". Nosotros, como programadores de las aplicaciones, somos responsables
de crear estos objetos. El <em>runtime</em> JAX-RS iterará a través de la lista de <strong>objetos</strong>
y los registrará internamente.</p>
</div>
<div class="paragraph">
<p>Un ejemplo de uso de una subclase de <em>Application</em> podría ser éste:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">expertojava</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">javax.ws.rs.core.Application</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.ws.rs.ApplicationPath</span><span class="tok-o">;</span>

<span class="tok-nd">@ApplicationPath</span><span class="tok-o">(</span><span class="tok-s">&quot;/rest&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ComercioApplication</span> <span class="tok-kd">extends</span> <span class="tok-n">Application</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Class</span><span class="tok-o">&lt;?&gt;&gt;</span> <span class="tok-n">getClasses</span><span class="tok-o">()</span> <span class="tok-o">{</span>
      <span class="tok-n">HashSet</span><span class="tok-o">&lt;</span><span class="tok-n">Class</span><span class="tok-o">&lt;?&gt;&gt;</span> <span class="tok-n">set</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashSet</span><span class="tok-o">&lt;</span><span class="tok-n">Class</span><span class="tok-o">&lt;?&gt;&gt;();</span>
      <span class="tok-n">set</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">ClienteResource</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>
      <span class="tok-n">set</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">PedidoResource</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>
      <span class="tok-k">return</span> <span class="tok-n">set</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getSingletons</span><span class="tok-o">()</span> <span class="tok-o">{</span>
     <span class="tok-n">JsonWriter</span> <span class="tok-n">json</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nf">JsonWriter</span><span class="tok-o">();</span>
     <span class="tok-n">TarjetaCreditoResource</span> <span class="tok-n">servicio</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nf">TarjetaCreditoResource</span><span class="tok-o">();</span>

     <span class="tok-n">HashSet</span><span class="tok-o">&lt;</span><span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">set</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nf">HashSet</span><span class="tok-o">();</span>
     <span class="tok-n">set</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">json</span><span class="tok-o">);</span>
     <span class="tok-n">set</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">servicio</span><span class="tok-o">);</span>
     <span class="tok-k">return</span> <span class="tok-n">set</span><span class="tok-o">;</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>La anotación <code>@ApplicationPath</code> define la base URL de la ruta para todos nuestros
servicios JAX-RS desplegados. Así, por ejemplo, accederemos a todos nuestros servicios JAX-RS
serán desde la ruta "/rest" cuando los ejecutemos. En el ejemplo anterior
estamos indicando que <em>ClienteResource</em> y <em>PedidoResource</em> son servicios <em>per-request</em>.
El método <em>getSingletons()</em> devuelve el servicio de tipo <em>TarjetaCreditoResource</em>, así como
el proveedor <em>JsonWriter</em> (que implementa la interfaz <em>MessageBodyWriter</em>).</p>
</div>
<div class="paragraph">
<p>Si tenemos al menos una implementación de la clase <em>Application</em> anotada con
<em>@ApplicationPath</em>, esta será "detectada" y desplegada automáticamente por el servidor
de aplicaciones.</p>
</div>
<div class="paragraph">
<p>Podemos aprovechar completamente esta capacidad para "escanear" y detectar automáticamente
nuestros servicios si tenemos implementada una subclase de Application, pero dejamos que
<em>getSingletons()</em> devuelva el conjunto vacío, y no indicamos nada en el método <em>getClasses()</em>,
de esta forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-kn">package</span> <span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">expertojava</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">javax.ws.rs.ApplicationPath</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">javax.ws.rs.core.Application</span><span class="tok-o">;</span>

<span class="tok-nd">@ApplicationPath</span><span class="tok-o">(</span><span class="tok-s">&quot;/rest&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ComercioApplication</span> <span class="tok-kd">extends</span> <span class="tok-n">Application</span> <span class="tok-o">{</span>

<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En este caso, el servidor de aplicaciones se encargará de buscar en el directorio
<em>WEB-INF/classes</em> y en cualquier fichero <em>jar</em> dentro del directorio <em>WEB-INF/lib</em>.
A continuación añadirá cualquier clase anotada con <em>@Path</em> o <em>@Provider</em> a la lista
de "cosas" que necesitan ser desplegadas y registradas en el <em>runtime</em> JAX-RS.</p>
</div>
<div class="paragraph">
<p>Los servicios REST son "atendidos" por un <em>servlet</em>, que es específico de la implementación
JAX-RS utilizada por el servidor de aplicaciones. El servidor wildfly utiliza la implementación
de JAX-RS 2.0 denomindada <em>resteasy</em> (otra implementación muy utilizada es <em>jersey</em>, por ejemplo
con el servidor de aplicaciones <em>Glassfish</em>). El <em>runtime</em> de JAX-RS contiene un <em>servlet</em> inicializado
con un parámetro de inicialización de tipo <em>javax.ws.rs.Application</em>, cuyo valor será
instanciado "automáticamente" por el servidor de aplicaciones con el nombre de la subclase
de <em>Application</em> que sea detectada en el <em>war</em> de nuestra aplicación.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuración_mediante_un_fichero_em_web_xml_em">2.5.2. Configuración mediante un fichero <em>web.xml</em></h4>
<div class="paragraph">
<p>En la sesión anterior, no hemos utilizado de forma explícita la clase <em>Application</em> para configurar el despliegue.
En su lugar, hemos indicado esta información en el fichero "web.xml":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;web-app</span> <span class="tok-na">version=</span><span class="tok-s">&quot;3.0&quot;</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee&quot;</span>
        <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
        <span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://java.sun.com/xml/ns/javaee</span>
<span class="tok-s">        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-c">&lt;!-- Con estas líneas, el servidor es el responsable de</span>
<span class="tok-c">      añadir el servlet correspondiente de forma automática.</span>
<span class="tok-c">      Si en nuestro war, tenemos clases anotadas con anotaciones JAX-RS</span>
<span class="tok-c">      para recibir invocaciones REST, éstas serán detectadas y registradas--&gt;</span>
    <span class="tok-nt">&lt;servlet-mapping&gt;</span>
        <span class="tok-nt">&lt;servlet-name&gt;</span>javax.ws.rs.core.Application<span class="tok-nt">&lt;/servlet-name&gt;</span>
        <span class="tok-nt">&lt;url-pattern&gt;</span>/rest/*<span class="tok-nt">&lt;/url-pattern&gt;</span>
    <span class="tok-nt">&lt;/servlet-mapping&gt;</span>
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta configuración es equivalente a incluir una subclase de <em>Application</em> sin
sobreescribir los métodos correspondientes. En este caso, se añade de forma dinámica
 el servlet que sirve las peticiones REST, con el nombre <em>javax.ws.rs.core.Application</em>,
 de forma que se detecten automáticamente todas las clases de recursos, y clases
 proveedoras empaquetadas en el <em>war</em> de la aplicación.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuración_en_un_contenedor_que_no_disponga_de_una_implementación_jax_rs">2.5.3. Configuración en un contenedor que no disponga de una implementación JAX-RS</h4>
<div class="paragraph">
<p>Si queremos hacer el despliegue sobre servidores de aplicaciones o servidores web
que den soporte a una especificación de <em>servlets</em> con una versión inferior a la <em>3.0</em>,
tendremos que configurar MANUALMENTE el fichero <em>web.xml</em> para que "cargue" el servlet
de nuestra implementación propietaria de JAX-RS (cuyos ficheros <em>jar</em> deberemos incluir
en el directorio <em>WEB-INF/lib</em> de nuestro war). Un ejemplo de configuración podría
ser éste:</p>
</div>
<div class="listingblock">
<div class="title">Configuración del fichero web.xml (directorio de fuentes: webapp/WEB-INF/web.xml)</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tok-nt">&lt;web-app&gt;</span>
   <span class="tok-nt">&lt;servlet&gt;</span>
      <span class="tok-nt">&lt;servlet-name&gt;</span>JAXRS<span class="tok-nt">&lt;/servlet-name&gt;</span>
      <span class="tok-nt">&lt;servlet-class&gt;</span>
          org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
      <span class="tok-nt">&lt;/servlet-class&gt;</span>
      <span class="tok-nt">&lt;init-param&gt;</span>
         <span class="tok-nt">&lt;param-name&gt;</span>
            javax.ws.rs.Application
         <span class="tok-nt">&lt;/param-name&gt;</span>
         <span class="tok-nt">&lt;param-value&gt;</span>
            org.expertoJava.ComercioApplication
         <span class="tok-nt">&lt;/param-value&gt;</span>
       <span class="tok-nt">&lt;/init-param&gt;</span>
   <span class="tok-nt">&lt;/servlet&gt;</span>

   <span class="tok-nt">&lt;servlet-mapping&gt;</span>
      <span class="tok-nt">&lt;servlet-name&gt;</span>JAXRS<span class="tok-nt">&lt;/servlet-name&gt;</span>
      <span class="tok-nt">&lt;url-pattern&gt;</span>/rest/*<span class="tok-nt">&lt;/url-pattern&gt;</span>
   <span class="tok-nt">&lt;/servlet-mapping&gt;</span>
<span class="tok-nt">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En la configuración anterior estamos indicando de forma explícita el <em>servlet</em>
JAX-RS que recibe las peticiones REST, que a su vez, utilizará la clase Application
para detectar qué servicios y proveedores REST serán desplegados en el servidor.</p>
</div>
<div class="paragraph">
<p>También será necesario incluir la librería con la implementación JAX-RS 2.0 de forma explícita en
el <em>war</em> generado (recordemos que para ello, tendremos que utilizar la etiqueta
&lt;scope&gt;compile&lt;scope&gt;, para que se añadan los <em>jar</em> correspondientes).</p>
</div>
<div class="listingblock">
<div class="title">Librería con la implementación de JAX-RS 2.0</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>javax<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>javaee-web-api<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>7.0<span class="tok-nt">&lt;/version&gt;</span>
  <span class="tok-nt">&lt;scope&gt;</span>compile<span class="tok-nt">&lt;/scope&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="_ejercicios">2.6. Ejercicios</h3>
<div class="paragraph">
<p>Para esta sesión añadiremos un nuevo módulo en el que implementaremos un servicio rest
incorporando los conceptos que hemos explicado durante la sesión. En concreto:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creamos un módulo Maven con IntelliJ (desde el directorio <code>ejercicios-rest-expertojava</code>)
con el arquetipo <code>webapp-javaee7</code>, tal y como hemos visto en los apuntes de la sesión. Las coordenadas
del <strong>artefacto Maven</strong> serán:</p>
<div class="ulist">
<ul>
<li>
<p><em>GroupId</em>: org.expertojava</p>
</li>
<li>
<p><em>ArtifactId</em>: s2-foro-nuevo</p>
</li>
<li>
<p><em>version</em>: 1.0-SNAPSHOT</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configuramos el pom.mxl del proyecto para poder compilar, empaquetar y desplegar nuestro servicio
en el servidor de aplicaciones Wildfly. Consulta los apuntes para ver cuál debe ser el contenido de las etiquetas
<em>&lt;properties&gt;</em>, <em>&lt;dependencies&gt;</em> y <em>&lt;build&gt;</em></p>
</li>
<li>
<p>Vamos a estructurar los fuentes (directorio <strong>src/main/java</strong>) de nuestro proyecto en los
siguientes paquetes:</p>
<div class="ulist">
<ul>
<li>
<p><em>org.expertojava.datos</em>: contendrá clases relacionadas con los datos a los que accede
nuestra aplicación rest. Por simplicidad, almacenaremos en memoria los datos de nuestra
 aplicación.</p>
</li>
<li>
<p><em>org.expertojava.modelo</em>: contiene las clases de nuestro modelo de objetos, que serán
clases java con atributos y sus correspondientes <em>getters</em> y <em>setters</em></p>
</li>
<li>
<p><em>org.expertojava.rest</em>: contiene los recursos JAX-RS, que implementan nuestros
servicios rest, así como las clases necesarias para automatizar el despliegue de dichos
recursos</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_creación_de_un_recurso_creación_y_consulta_de_temas_en_el_foro_0_5_puntos">2.6.1. Creación de un recurso: creación y consulta de temas en el foro (0,5 puntos)</h4>
<div class="paragraph">
<p>Vamos a crear un recurso JAX-RS al que denominaremos <code>TemasResource</code>
(en el paquete <em>org.expertojava.rest</em> ). En el siguiente ejercicio
, al configurar la aplicación, haremos que este recurso sea un <strong>singleton</strong>.
Nuestro recurso gestionará sus propios datos en memoria. Por ejemplo
 podemos utilizar un atributo <em>private</em> de tipo <em>HashMap</em> en el que almacenaremos los temas, cada uno
 con un identificador numérico como clave. También necesitaremos un atributo para
 generar las claves para cada uno de los temas. Por ejemplo:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>private Map&lt;Integer, Tema&gt; temasDB = new HashMap&lt;Integer, Tema&gt;();
private int contadorTemas = 0;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Fíjate que si utilizamos los tipos <em>HashMap</em> e <em>int</em> podemos tener problemas de
concurrencia si múltiples usuarios están realizando peticiones para crear y/o consultar
los temas del foro. En una situación real deberíamos utilizar en su lugar los tipos
<em>ConcurrentHasMap</em> y <em>AtomicInteger</em>, para evitar el que dos usuarios intentaran crear
un nuevo tema con la misma clave, perdiéndose así uno de los dos temas creados. Al
tratarse de un ejercicio en el que solamente tendremos un cliente, no nos planteará
ningún problema el trabajar con <em>HashMap</em> e <em>int</em>, por lo que podéis elegir cualquiera
de las dos opciones para realizar el ejercicio</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Nuestro recurso estará accesible en el servidor en la ruta <code>/temas</code> (relativa
a la raíz del contexto de nuestra aplicación, y a la ruta de nuestro servlet JAX-RS,
que determinaremos con la anotación @ApplicationPath de nuestra clase <em>Application</em>).</p>
</li>
<li>
<p>En el paquete <em>org.expertojava.modelo</em> crearemos la clase <code>Tema</code>, con los atributos
privados:</p>
<div class="literalblock">
<div class="content">
<pre>int id;
String nombre;</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>y sus correspondientes <em>getters</em> y <em>setters</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>setId(), getId()
setNombre(), getNombre()</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Implementamos un primer método en el recurso <code>TemasResource</code>, denominado <code>creaTema()</code>,
para poder crear un
nuevo tema en el foro. Dicho método atenderá peticiones POST a nuestro servicio.
Los datos de entrada (cadena de caracteres que respresenta el nombre del tema) se pasan
a través de un formulario html, en el que tenemos una única entrada denominada "nombre".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Puedes incluir el siguiente contenido en el fichero <code>index.html</code> para introducir los
datos desde el navegador:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="html"><span class="tok-cp">&lt;!DOCTYPE html&gt;</span>
<span class="tok-nt">&lt;html&gt;</span>
<span class="tok-nt">&lt;head&gt;</span>
    <span class="tok-nt">&lt;title&gt;</span>Start Page<span class="tok-nt">&lt;/title&gt;</span>
    <span class="tok-nt">&lt;meta</span> <span class="tok-na">http-equiv=</span><span class="tok-s">&quot;Content-Type&quot;</span> <span class="tok-na">content=</span><span class="tok-s">&quot;text/html; charset=UTF-8&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-nt">&lt;/head&gt;</span>
<span class="tok-nt">&lt;body&gt;</span>
<span class="tok-nt">&lt;h1&gt;</span>Alta de temas en el foro: <span class="tok-nt">&lt;/h1&gt;</span>
<span class="tok-nt">&lt;form</span> <span class="tok-na">action=</span><span class="tok-s">&quot;/s2-foro-nuevo/rest/temas&quot;</span> <span class="tok-na">method=</span><span class="tok-s">&quot;post&quot;</span><span class="tok-nt">&gt;</span>
    Nombre del tema: <span class="tok-nt">&lt;input</span> <span class="tok-na">type=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;nombre&quot;</span> <span class="tok-nt">/&gt;&lt;br</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;input</span> <span class="tok-na">type=</span><span class="tok-s">&quot;submit&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;Enviar&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/form&gt;</span>
<span class="tok-nt">&lt;/body&gt;</span>
<span class="tok-nt">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Cada nuevo <code>Tema</code> creado se añadirá a nuestra base de datos en memoria <code>temasDB</code>
junto con un identificador numérico (que se irá incrementando para cada nueva
instancia creada).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implementamos un segundo método para consultar los temas creados en el foro.
El método se denominará <code>verTemasTodos()</code>, y devuelve (en formato texto) todos los
temas actualmente creados. Dado que puede haber un gran número de ellos, vamos
a permitir que el usuario decida cuántos elementos como máximo quiere consultar a partir de
una posición determinada. Por defecto, si no se indica esta información, se
mostrarán como máximo los primeros 8 temas registrados en el foro. Si el identificador a
partir del cual queremos iniciar la consulta es mayor que el número de temas almacenados,
entonces devolveremos la cadena: "No es posible atender la consulta". Ejemplos de
URIs que acepta dicho método son:</p>
<div class="ulist">
<ul>
<li>
<p>/temas</p>
<div class="paragraph">
<p>en este caso, y suponiendo que hayamos creado solamente los tres temas del
apartado anterior, el resultado sería:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"Listado de temas del 1 al 8:
1. animales
2. plantas
3. ab"</pre>
</div>
</div>
</li>
<li>
<p>/temas?inicio=2&amp;total=2</p>
<div class="paragraph">
<p>el resultado sería:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"Listado de temas del 2 al 3:
2. plantas
3. ab"</pre>
</div>
</div>
</li>
<li>
<p>/temas?inicio=7&amp;total=1</p>
<div class="paragraph">
<p>el resultado sería:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"No es posible atender la consulta"</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Como ya hemos comentado, las URIs indicadas en este ejercicio son relativas a la
raíz del contexto de nuestra aplicación y a la ruta especificada para nuestros servicios rest.
Recuerda que si has configurado el pom.xml como en la sesión anterior, la raíz
del contexto de la aplicación vendrá dada por el valor de la etiqueta &lt;finalName&gt;,
anidada en &lt;build&gt;. En nuestro caso debería ser "/s2-foro-nuevo". Más adelante,
fijaremos la ruta de nuestros servicios rest como <code>/rest</code>. Por ejemplo la URI
completa para el último apartado sería:
 <a href="http://localhost:8080/s2-foro-nuevo/rest/temas?inicio=7&amp;total=1" class="bare">http://localhost:8080/s2-foro-nuevo/rest/temas?inicio=7&amp;total=1</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_despliegue_y_pruebas_del_recurso_0_5_puntos">2.6.2. Despliegue y pruebas del recurso (0,5 puntos)</h4>
<div class="paragraph">
<p>Vamos a construir y desplegar nuestro servicio en el servidor de aplicaciones.
Para ello vamos a utilizar una subclase de <em>Application</em> que añadiremos en el
paquete <em>org.expertojava.rest</em>. La ruta en la que se van a servir nuestras peticiones rest
será <code>rest</code>. Fíjate que el recurso que hemos creado es el
encargado de gestionar (crear, modificar,&#8230;&#8203;) sus propios datos. Por lo tanto
necesitamos que nuestro recurso REST sea un <em>singleton</em>. Implementa la clase
<code>ForoApplication</code> y realiza la construcción y despliegue del proyecto. A continuación
prueba el servicio utilizando postman. Puedes probar la inserción de temas utilizando
también el formulario a través de la URI: <em><a href="http://localhost:8080/s2-foro-nuevo" class="bare">http://localhost:8080/s2-foro-nuevo</a></em>.
Podemos utilizar las entradas del apartado anterior, de forma que comprobemos que se
crean correctamente los temas "animales", "plantas", y "ab", y que
obtenemos los listados correctos tanto si no indicamos el inicio y total de elementos,
como si decidimos mostrar los temas desde el 2 hasta el 3.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cuando utilices el cliente IntelliJ para probar métodos POST, debes proporcionar
un <strong>Request Body</strong> <strong>no vacío</strong>. En este caso, como en la propia URI incluimos
el contenido del mensaje, que es el nombre del tema que queremos añadir al foro
tendrás que seleccionar <strong>Text</strong> aunque no rellenemos el campo correspondiente.
De no hacerlo así, obtendremos como respuesta un cuerpo de mensaje vacío, y
la cabecera de respuesta <strong>HTTP/1.1 415 Unsupported Media Type</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_múltiples_consultas_de_los_temas_del_foro_0_5_puntos">2.6.3. Múltiples consultas de los temas del foro (0,5 puntos)</h4>
<div class="paragraph">
<p>Implementa tres nuevas consultas de los temas del foro, de forma que:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se pueda realizar una consulta de un tema concreto a partir de su identificador
numérico (el método solamente debe admitir identificadores formados por uno o
más dígitos). Si el tema consultado no existe se debe devolver una excepción
con la cabecera de respuesta <strong>HTTP/1.1 404 Not Found</strong>. Por ejemplo:</p>
<div class="ulist">
<ul>
<li>
<p>/temas/2</p>
<div class="paragraph">
<p>Debe devolver lo siguiente:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"Ver el tema 2:
plantas"</pre>
</div>
</div>
</li>
<li>
<p>/temas/4</p>
<div class="paragraph">
<p>Obtenemos como respuesta un cuerpo de mensaje vacío, y
la cabecera de respuesta: <strong>HTTP/1.1 404 Not Found</strong></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Se pueda realizar una consulta de los temas que comiencen por uno de los
siguientes caracteres: a, b, c, ó d. Por ejemplo, teniendo en cuenta que hemos
introducido los temas anteriores:</p>
<div class="ulist">
<ul>
<li>
<p>/temas/a</p>
<div class="paragraph">
<p>Debe devolver lo siguiente:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"Listado de temas que comienzan por a:
animales"</pre>
</div>
</div>
</li>
<li>
<p>/temas/d</p>
<div class="paragraph">
<p>Debe devolver:
 "Listado de temas que comienzan por d:"</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Se pueda realizar una consulta de los temas que contengan una subcadena de caracteres.
Por ejemplo, teniendo en cuenta que hemos
 introducido los temas anteriores:</p>
<div class="ulist">
<ul>
<li>
<p>/temas/ma
+
Debe devolver lo siguiente:</p>
<div class="literalblock">
<div class="content">
<pre>"Listado de temas que contienen la subcadena : ma
animales"</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_creación_de_subrecursos_0_5_puntos">2.6.4. Creación de subrecursos (0,5 puntos)</h4>
<div class="paragraph">
<p>Vamos a crear el subrecurso <code>MensajesResource</code> (en el paquete <em>org.expertojava.rest</em>),
de forma que este recurso gestione la creación y consulta de mensajes para cada uno
 de los temas del foro. Este subrecurso debe atender peticiones desde rutas del tipo:
 <code>/temas/<em>identificadorTema</em>/mensajes</code>, siendo <em>identificadorTema</em> la clave
 numérica asociada a uno de los temas almacenados.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En este caso, nuestro subrecurso no será un <em>singleton</em>, por lo que necesitaremos
almacenar los mensajes en otra clase diferente (ya que crearemos una nueva instancia
del recurso para cada petición). La clase <code>DatosEnMemoria</code> (en el paquete <em>org.expertojava.datos</em>)
será la encargada de almacenar en memoria la información de los mensajes publicados
para cada tema. Por ejemplo puedes utilizar los siguientes campos <strong>estáticos</strong> para
gestionar los mensajes:</p>
<div class="literalblock">
<div class="content">
<pre>public static Map&lt;Mensaje, String&gt; mensajesDB =
                    new HashMap&lt;Mensaje, String&gt;();</pre>
</div>
</div>
<div class="paragraph">
<p>La clave será el propio mensaje (objeto <em>Mensaje</em>, que se
 asociará al tema correspondiente)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>public static int contadorMen = 0;</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Como ya hemos comentado puedes usar <em>ConcurrentHashMap</em> y <em>AtomicInteger</em> en lugar de
los tipos anteriores, para evitar problemas de concurrencia.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>En el paquete <em>org.expertojava.datos</em> crearemos la clase <code>Mensaje</code>, con los atributos
privados:</p>
<div class="literalblock">
<div class="content">
<pre>int id;
String texto;
String autor="anonimo";</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>y sus correspondientes <em>getters</em> y <em>setters</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>setId(), getId()
setTexto(), getTexto()
setAutor(), getAutor()</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Vamos a crear un método para poder realizar la publicación de un mensaje de texto
en el foro, en uno de los temas ya creados. Independientemente del tipo de
petición realizada sobre los mensajes, si el tema indicado en la URI no existe,
lanzaremos la excepción <em>WebApplicationException(Response.Status.NOT_FOUND)</em>.
Veamos algún ejemplo:</p>
<div class="ulist">
<ul>
<li>
<p>Deberemos poder realizar una petición <strong>POST</strong>  a <strong>/temas/1/mensajes</strong>, con el cuerpo de mensaje =
"Mensaje numero 1". El mensaje creado, por defecto tendrá asociado el autor "anonimo"</p>
</li>
<li>
<p>Si realizamos una petición para añadir un mensaje a la URI: <strong>/temas/9/mensajes</strong>,
deberíamos obtener como cabecera de respuesta: <strong>HTTP/1.1 404 Not Found</strong>, independientemente
del cuerpo del mensaje</p>
</li>
</ul>
</div>
</li>
<li>
<p>Vamos a crear un método para realizar una consulta de todos los mensajes
publicados en un tema concreto. Por ejemplo:</p>
<div class="ulist">
<ul>
<li>
<p>Una petición <strong>GET</strong> a <strong>/temas/1/mensajes</strong> debería dar como resultado:</p>
<div class="literalblock">
<div class="content">
<pre>"Lista de mensajes para el tema: animales
1. Mensaje anonimo"</pre>
</div>
</div>
</li>
<li>
<p>Si realizamos una petición <strong>GET</strong> a la URI: <strong>/temas/9/mensajes</strong>,
deberíamos obtener como cabecera de respuesta: <strong>HTTP/1.1 404 Not Found</strong>,
independientemente del cuerpo del mensaje</p>
</li>
</ul>
</div>
</li>
<li>
<p>Finalmente vamos a añadir dos nuevos métodos para: (a) añadir un nuevo mensaje
en un tema concreto, indicando el autor del mensaje. Como restricción, el nombre del
autor deberá estar formado solamente por caracteres alfabéticos, utilizando mayúsculas
o minúsculas, y como mínimo tiene que tener un caracter; y (b) consultar todos los mensajes
que un determinado autor ha publicado en el foro en un tema determinado</p>
<div class="ulist">
<ul>
<li>
<p>Una petición <strong>POST</strong> a la URI: /temas/1/mensajes/pepe, con el cuerpo de mensaje
con valor "mensaje de pepe" debería crear un nuevo mensaje para el tema con identificador 2,
y devolver como resultado el nuevo id (y/o la URI del nuevo recurso en la cabecera de
respuesta <em>Location</em>, si seguimos la ortodoxia REST). En caso de que devolvamos la URI del
nuevo recurso podemos utilizar la orden:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-k">return</span> <span class="tok-n">Response</span><span class="tok-o">.</span><span class="tok-na">created</span><span class="tok-o">(</span><span class="tok-n">uriInfo</span><span class="tok-o">.</span><span class="tok-na">getAbsolutePathBuilder</span><span class="tok-o">()</span>  <i class="conum" data-value="1"></i><b>(1)</b>
                                <span class="tok-o">.</span><span class="tok-na">segment</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-o">))</span>  <i class="conum" data-value="2"></i><b>(2)</b>
                                <span class="tok-o">.</span><span class="tok-na">build</span><span class="tok-o">())</span>  <i class="conum" data-value="3"></i><b>(3)</b>
                        <span class="tok-o">.</span><span class="tok-na">build</span><span class="tok-o">();</span> <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Obtenemos el path absoluto de la uri que nos ha invocado</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Añadimos el identificador <em>id</em> del nuevo recurso creado</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Construimos la nueva URI</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Construimos el objeto Response.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Veremos cómo manipular objetos de tipo <em>Response</em> en sesiones posteriores.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Recuerda que para acceder al cuerpo de la petición basta con definir un parámetro de tipo <em>String</em>.
JAX-RS automáticamente lo instanciará con el cuerpo de la petición como una cadena.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Una petición <strong>GET</strong> a la URI: /temas/1/mensajes/anonimo, daría como resultado:</p>
<div class="paragraph">
<p>"Lista de mensajes tema= animales ,y autor= anonimo</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Mensaje anonimo"</p>
</li>
</ol>
</div>
</li>
<li>
<p>Una petición <strong>GET</strong> a la URI: /temas/1/mensajes/, daría como resultado:</p>
<div class="literalblock">
<div class="content">
<pre>"Lista de mensajes para el tema: animales
1. Mensaje anonimo
2. mensaje de pepe"</pre>
</div>
</div>
</li>
<li>
<p>Una petición <strong>GET</strong> a la URI: /temas/1/mensajes/roberto, daría como resultado:</p>
<div class="literalblock">
<div class="content">
<pre>"Lista de mensajes tema= animales ,y autor= roberto"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-10-15 10:06:27 CEST
</div>
</div>
</body>
</html>