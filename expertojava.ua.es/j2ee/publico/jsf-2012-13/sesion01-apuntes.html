<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Introducci&oacute;n a JavaServer Faces</title>
<link type="text/css" href="skin/highlight/shCore.css" rel="stylesheet">
<link type="text/css" href="skin/highlight/shThemeEclipse.css" rel="stylesheet">
<script src="skin/highlight/shCore.js" type="text/javascript"></script><script src="skin/highlight/shAutoloader.js" type="text/javascript"></script>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://web.ua.es/especialistajava"><img class="logoImage" alt="jtech" src="images/baner_j2ee_izq.gif" title="Experto Universitario Java Enterprise"></a>
</div>
<div class="projectlogoA1">
<a href="../../../../www.jtech.ua.es/index.html"><img class="logoImage" alt="Componentes de presentaci&oacute;n" src="images/baner_j2ee_der.gif" title="Componentes de presentaci&oacute;n"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="javascript:location.href='../index.html'">Home</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-web.html'">Aplicaciones Web</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-ent.html'">Aplicaciones Enterprise</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../proy-int/index.html'">Proyecto</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">JSF</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Componentes de presentacion</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Componentes de presentaci&oacute;n">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.2', 'skin/')" id="menu_selected_1.1.2Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Teor&iacute;a</div>
<div id="menu_selected_1.1.2" class="selectedmenuitemgroup" style="display: block;">
<div class="menupage">
<div class="menupagetitle">Sesion 1</div>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.3', 'skin/')" id="menu_1.1.3Title" class="menutitle">Ejercicios</div>
<div id="menu_1.1.3" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion01-apuntes.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Introducci&oacute;n a JavaServer Faces</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Frameworks+RIA+basados+en+el+servidor">Frameworks RIA basados en el servidor</a>
</li>
<li>
<a href="#Caracter%C3%ADsticas+de+JSF">Caracter&iacute;sticas de JSF</a>
</li>
<li>
<a href="#Evoluci%C3%B3n+de+JSF">Evoluci&oacute;n de JSF</a>
<ul class="minitoc">
<li>
<a href="#Especificaciones+de+JSF">Especificaciones de JSF</a>
</li>
<li>
<a href="#JSF+y+otros+frameworks+de+presentaci%C3%B3n">JSF y otros frameworks de presentaci&oacute;n</a>
</li>
<li>
<a href="#Implementaciones+y+componentes+JSF">Implementaciones y componentes JSF</a>
</li>
</ul>
</li>
<li>
<a href="#El+lenguaje+de+definici%C3%B3n+de+vistas+JSF">El lenguaje de definici&oacute;n de vistas JSF</a>
<ul class="minitoc">
<li>
<a href="#Facelets">Facelets</a>
</li>
<li>
<a href="#Definiendo+plantillas+con+Facelets">Definiendo plantillas con Facelets</a>
</li>
</ul>
</li>
<li>
<a href="#Creando+un+primer+proyecto+JSF">Creando un primer proyecto JSF</a>
</li>
<li>
<a href="#Una+aplicaci%C3%B3n+de+ejemplo+en+detalle">Una aplicaci&oacute;n de ejemplo en detalle</a>
<ul class="minitoc">
<li>
<a href="#Librer%C3%ADas+de+implementaci%C3%B3n+de+JSF">Librer&iacute;as de implementaci&oacute;n de JSF</a>
</li>
<li>
<a href="#P%C3%A1ginas+JSF">P&aacute;ginas JSF</a>
</li>
<li>
<a href="#Directivas+en+el+fichero+web.xml">Directivas en el fichero web.xml</a>
</li>
<li>
<a href="#Fichero+faces-config.xml">Fichero faces-config.xml</a>
</li>
<li>
<a href="#Clase+Java+con+el+bean+gestionado">Clase Java con el bean gestionado</a>
</li>
<li>
<a href="#Probando+la+aplicaci%C3%B3n">Probando la aplicaci&oacute;n</a>
</li>
</ul>
</li>
</ul>
</div>


<a name="N1000C"></a><a name="Frameworks+RIA+basados+en+el+servidor"></a>
<h2 class="underlined_10">Frameworks RIA basados en el servidor</h2>
<div class="section">
<p>Frente a las aplicaciones web tradicionales basadas en la
navegaci&oacute;n entre distintas p&aacute;ginas, en los &uacute;ltimos a&ntilde;os se han
popularizado las aplicaciones web de una &uacute;nica p&aacute;gina que intentan
simular las aplicaciones de escritorio. Son las denominadas RIA
(<em>Rich Internet Applications</em>).</p>
<p>Google fue uno de los primeros promotores de este tipo de
aplicaciones, con ejemplos como Google Maps. Esta aplicaci&oacute;n web
utiliza JavaScript de forma intensiva para interactuar con el mapa o
para seleccionar opciones (<em>imprimir</em>, <em>enviar</em>,
etc.). Todas estas acciones se realizan en una &uacute;nica p&aacute;gina del
navegador.</p>
<p>
<img alt="Un ejemplo de aplicaci&oacute;n RIA: Google Maps" content-width="12cm" src="imagenes/tema01/google-maps.png" width="600"></p>
<p>En las aplicaciones tradicionales cada petici&oacute;n al servidor hace
que &eacute;ste genere una nueva p&aacute;gina HTML. En la parte izquierda de la
siguiente figura se muestra este modelo.</p>
<p>
<img alt="" content-width="12cm" src="imagenes/tema01/ajax.png" width="591"></p>
<p></p>
<p>En la parte derecha de la figura vemos el funcionamiento de las
aplicaciones RIA. Se siguen realizando peticiones HTTP al servidor,
pero no es el navegador qui&eacute;n lo hace directamente, sino funciones
JavaScript residentes en la p&aacute;gina. Estas funciones env&iacute;an la petici&oacute;n
y los datos al servidor y &eacute;ste devuelve los datos de respuesta en
alg&uacute;n tipo de formato (texto, XML o JSON). Las funciones JavaScript en
la p&aacute;gina del navegador formatean estos datos y los muestran en
pantalla actualizando el &aacute;rbol de componentes DOM. El servidor no
genera una nueva p&aacute;gina sino s&oacute;lo los datos. Este enfoque se ha
denominado <a href="http://www.adaptivepath.com/ideas/essays/archives/000385.php">Ajax
(Asynchronous JavaScript and XML).</a>
</p>
<p>Existen frameworks JavaScript muy populares, como
<a href="http://jquery.com/">jQuery</a>, que facilitan la tarea de
definir la interfaz de usuario de la aplicaci&oacute;n. Aun as&iacute;, el
mantenimiento y testeo de este c&oacute;digo se hace complicado. Hay muchos
elementos implicados: la comunicaci&oacute;n con el servidor, las p&aacute;ginas
HTML en las que est&aacute; embebido y el propio c&oacute;digo JavaScript. Tambi&eacute;n
se hace complicado reutilizar y compartir el c&oacute;digo JavaScript entre
distintas p&aacute;ginas y desarrolladores.</p>
<p>Como alternativa a la codificaci&oacute;n en JavaScript aparecen los
denominados <em>frameworks RIA basados en el servidor</em>, en los que
los desarrolladores no escriben directamente JavaScript, sino que
utilizan componentes de alto nivel (paneles, men&uacute;s desplegables,
combos, etc.) que el servidor inserta en las p&aacute;ginas resultantes. Este
enfoque es el que utilizan frameworks populares
como <a href="http://www.oracle.com/technetwork/java/javaee/javaserverfaces-139869.html">JSF</a>
(<em>JavaServer
Faces</em>), <a href="http://code.google.com/intl/es-ES/webtoolkit/">GWT</a>
(<em>Google Web Toolkit</em>) o
<a href="http://www.zkoss.org/">ZK</a>.</p>
<p>En este enfoque el desarrollador compone la interfaz de usuario
utilizando un lenguaje de componentes espec&iacute;fico. Esta definici&oacute;n
reside en el servidor en forma de p&aacute;gina de texto. Cuando el servidor
recibe una petici&oacute;n realiza un procesamiento de esta p&aacute;gina de texto y
genera otra que contiene todos los componentes de la interfaz en
formato HTML y JavaScript y que se env&iacute;a de vuelta al navegador.</p>
<p>En el caso de JSF 2 la definici&oacute;n de la interfaz se realiza en
forma de p&aacute;ginas XHTML con distintos tipos de etiquetas que veremos
m&aacute;s adelante. Estas p&aacute;ginas se denominan <em>p&aacute;ginas JSF</em>. La
siguiente figura muestra el funcionamiento de JSF para generar una
p&aacute;gina por primera vez.</p>
<p>
<img alt="Generaci&oacute;n de una p&aacute;gina JSF" content-width="15cm" src="imagenes/tema01/jsf-generando-html.png" width="600"></p>
<p>El navegador realiza una petici&oacute;n a una determinada URL en la que
reside la p&aacute;gina JSF que se quiere mostrar. En el servidor un servlet
que llamamos <em>motor de JSF</em> recibe la petici&oacute;n y construye un
&aacute;rbol de componentes a partir de la p&aacute;gina JSF que se solicita. Este
&aacute;rbol de componentes replica en forma de objetos Java la estructura de
la p&aacute;gina JSF original y representa la estructura de la p&aacute;gina que se
va a devolver al navegador. Por ejemplo, si en la p&aacute;gina JSF se define
un componente de tipo men&uacute; con la etiqueta</p>
<pre class="code">&lt;h:selectOneMenu&gt;</pre>
<p>en el &aacute;rbol de componentes se construir&aacute; un objeto Java de la
  clase</p>
<pre class="code">javax.faces.component.html.HtmlSelectOneMenu</pre>
<p>Una vez construido el &aacute;rbol de componentes, se ejecuta c&oacute;digo Java
en el servidor para rellenar los elementos del &aacute;rbol con los datos
de la aplicaci&oacute;n. Por &uacute;ltimo, a partir del &aacute;rbol de componentes se
genera la p&aacute;gina HTML que se env&iacute;a al navegador.</p>
<p>Los componentes deben mostrar y recoger datos que se obtienen y se
pasan a la aplicaci&oacute;n. Este proceso se denomina ligado de datos
o <em>data binding</em>. En los frameworks basados en el servidor el
ligado de datos es sencillo porque la definici&oacute;n de la interfaz de
usuario y los datos residen en un mismo sitio. En el caso de JSF 2
la forma de ligar datos con la interfaz es utilizando la
anotaci&oacute;n <span class="codefrag">@ManagedBean</span> en una clase Java para definir lo
que se denomina como <em>bean gestionado</em>.</p>
<p>Una vez que la p&aacute;gina se muestra en el navegador, el usuario
interact&uacute;a con ella (por ejemplo, pulsando en un bot&oacute;n, escribiendo
texto en un campo o pinchando en una opci&oacute;n de un men&uacute;
desplegable). En este momento es cuando se utiliza el enfoque de
Ajax. Los componentes contienen c&oacute;digo JavaScript que se encarga de
gestionar la interacci&oacute;n y pasar al servidor las peticiones
espec&iacute;ficas. Estas peticiones no tienen por qu&eacute; generar una nueva
p&aacute;gina. Muchas veces es suficiente con actualizar alg&uacute;n elemento del
DOM de la p&aacute;gina actual, siguiendo un enfoque similar a Ajax. La
siguiente figura describe el proceso de actualizaci&oacute;n de una p&aacute;gina
JSF.</p>
<p>
<img alt="Actualizaci&oacute;n de una p&aacute;gina JSF" content-width="15cm" src="imagenes/tema01/jsf-actualizando-html.png" width="600"></p>
<p>El servidor recoge la petici&oacute;n, la procesa, recupera el &aacute;rbol de
componentes de la p&aacute;gina y genera unos datos en formato XML que
devuelve al cliente. All&iacute; el c&oacute;digo JavaScript los procesa y actualiza
el DOM de la p&aacute;gina.</p>
<p>Como resumen, entre las ventajas del desarrollo basado en el servidor
frente a la codificaci&oacute;n directa en JavaScript destacamos:</p>
<ul>
   
<li> M&aacute;s f&aacute;cil de portar a distintos navegadores y plataformas
   (m&oacute;viles, por ejemplo).</li>
   
<li> M&aacute;s sencillo de utilizar: es muy f&aacute;cil acceder a los objetos
   de negocio y de datos desde la presentaci&oacute;n.</li>
   
<li> Mayor robustez y seguridad.</li>
   
<li> Mayor facilidad de mantener, probar y modificar.</li>

</ul>
</div>


<a name="N100A9"></a><a name="Caracter%C3%ADsticas+de+JSF"></a>
<h2 class="underlined_10">Caracter&iacute;sticas de JSF</h2>
<div class="section">
<p>JSF es un framework MVC (Modelo-Vista-Controlador) basado en el API
de Servlets que proporciona un conjunto de componentes en forma de
etiquetas definidas en p&aacute;ginas XHTML mediante el framework
Facelets. Facelets se define en la especificaci&oacute;n 2 de JSF como un
elemento fundamental de JSF que proporciona caracter&iacute;sticas de
plantillas y de creaci&oacute;n de componentes compuestos. Antes de la
especificaci&oacute;n actual se utilizaba JSP para componer las p&aacute;ginas
JSF.</p>
<p>En la siguiente sesi&oacute;n explicaremos con m&aacute;s profundidad las
caracter&iacute;sticas MVC de JSF. Por ahora basta con adelantar que JSF
utiliza las p&aacute;ginas Facelets como vista, objetos Javabean como modelos
y m&eacute;todos de esos objetos como controladores. El servlet FacesServlet
realiza toda la tediosa tarea de procesar las peticiones HTTP, obtener
los datos de entrada, validarlos y convertirlos, colocarlos en los
objetos del modelo, invocar las acciones del controlador y renderizar
la respuesta utilizando el &aacute;rbol de componentes.</p>
<p>Entrando un poco m&aacute;s en detalle, JSF proporciona las siguientes caracter&iacute;sticas destacables: </p>
<ul>
   
<li>Definici&oacute;n de las interfaces de usuario
   mediante <strong>vistas</strong> que
   agrupan <strong>componentes</strong> gr&aacute;ficos.</li>
   
<li>Conexi&oacute;n de los componentes gr&aacute;ficos con los datos de la
   aplicaci&oacute;n mediante los denominados <strong>beans gestionados</strong>.</li>
   
<li>Conversi&oacute;n de datos y validaci&oacute;n autom&aacute;tica de la entrada del
   usuario.</li>
   
<li>Navegaci&oacute;n entre vistas.</li>
   
<li>Internacionalizaci&oacute;n</li>
   
<li>A partir de la especificaci&oacute;n 2.0 un modelo est&aacute;ndar de
   comunicaci&oacute;n Ajax entre la vista y el servidor.</li>

</ul>
<p>Tal y como hemos comentado, JSF se ejecuta sobre la tecnolog&iacute;a de
Servlets y no requiere ning&uacute;n servicio adicional, por lo que para
ejecutar aplicaciones JSF s&oacute;lo necesitamos un contenedor de servlets
tipo Tomcat o Jetty.</p>
<p>Para entender el funcionamiento de JSF es interesante compararlo
con JSP. Recordemos que una p&aacute;gina JSP contiene c&oacute;digo HTML con
etiquetas especiales y c&oacute;digo Java. La p&aacute;gina se procesa en una pasada
de arriba a abajo y se convierte en un servlet. Los elementos JSP se
procesan en el orden en que aparecen y se transforman en c&oacute;digo Java
que se incluye en el servlet. Una vez realizada la conversi&oacute;n, las
peticiones de los usuarios a la p&aacute;gina provocan la ejecuci&oacute;n del
servlet.</p>
<p>En JSF el funcionamiento es distinto. Una p&aacute;gina JSF tambi&eacute;n
contiene etiquetas especiales y c&oacute;digo HTML, pero su procesamiento es
mucho m&aacute;s complicado. La diferencia fundamental con JSP es el
resultado del procesamiento interno, en el servidor, de la p&aacute;gina
cuando se realiza la petici&oacute;n. En JSP la p&aacute;gina se procesa y se
transforma en un servlet. En JSF, sin embargo, el resultado del
procesamiento es un &aacute;rbol de componentes, objetos Java instanciados el
servidor, que son los que posteriormente se encargan de generar el
HTML.</p>
<p>
<img alt="" content-width="5.5cm" src="imagenes/tema01/peticion-jsf.png" width="428"></p>
<p> Con un poco m&aacute;s de detalle, cuando el usuario realiza una petici&oacute;n
a la p&aacute;gina JSF se realizan las siguientes acciones en orden:</p>
<ul>
   
<li>(1) Se procesa la p&aacute;gina de arriba abajo y se crea
   un <strong>&aacute;rbol de componentes</strong> JSF en forma de objetos
   instanciados de clases del framework JSF.</li>

   
<li>(2) Se obtienen los valores introducidos por el usuario y se
   actualizan los beans gestionados con ellos. </li>

   
<li>(3) Se actualizan los componentes con los valores procedentes
   de las propiedades de los beans gestionados.</li>

   
<li>(4) Se pide a los componentes que se rendericen, gener&aacute;ndose el
   c&oacute;digo HTML que se env&iacute;a de vuelta al navegador como resultado de
   la petici&oacute;n.</li>

   
<li>(5) El &aacute;rbol de componentes JSF se guarda en memoria para que
   posteriores peticiones a la misma p&aacute;gina JSF no tengan que crearlo,
   sino que utilicen el existente.</li>

</ul>
<p>&iquest;C&oacute;mo se genera el HTML final de la respuesta a la petici&oacute;n? En JSP
el servlet genera el HTML mediante sentencias embebidas en su c&oacute;digo
que escriben en el <em>stream</em> de salida. En JSF, la p&aacute;gina HTML
se genera como resultado de llamadas a m&eacute;todos del &aacute;rbol de
componentes (en JSF se habla de realizar un <em>render</em> del
componente). Una ventaja del enfoque de JSF es que el renderizado de
la interfaz de usuario resultante es m&aacute;s flexible. De hecho, es
posible generar con el mismo JSF distinto c&oacute;digo para distintos
dispositivos. Por ejemplo, es posible utilizar la misma aplicaci&oacute;n JSF
para servir p&aacute;ginas a navegadores web y dispositivos m&oacute;viles.</p>
</div>


<a name="N10108"></a><a name="Evoluci%C3%B3n+de+JSF"></a>
<h2 class="underlined_10">Evoluci&oacute;n de JSF</h2>
<div class="section">
<a name="N1010E"></a><a name="Especificaciones+de+JSF"></a>
<h3 class="underlined_5">Especificaciones de JSF</h3>
<p>JavaServer Faces es el framework oficial de Java
Enterprise para el desarrollo de interfaces de usuario avanzadas en
aplicaciones web. La especificaci&oacute;n de JSF ha ido evolucionando desde
su lanzamiento en 2004 y se ha ido consolidando, introduciendo nuevas
caracter&iacute;sticas y funcionalidades.</p>
<p>La especificaci&oacute;n original de JavaServer Faces (1.0) se aprob&oacute; en
marzo del 2004, con la <em>Java Specification
Request</em> <a href="http://www.jcp.org/en/jsr/detail?id=127">JSR
127</a>. En esta especificaci&oacute;n se define el funcionamiento b&aacute;sico de
JSF, introduci&eacute;ndose sus caracter&iacute;sticas principales: uso de beans
gestionados el lenguaje JSF EL, componentes b&aacute;sicos y navegaci&oacute;n entre
vistas.</p>
<p>La especificaci&oacute;n JavaServer Faces 1.2 se aprob&oacute; en mayo del
2006. La JSR donde se define es
la <a href="http://www.jcp.org/en/jsr/detail?id=252">JSR 252</a>. En
esta especificaci&oacute;n se introducen algunas mejoras y correcciones en la
especificaci&oacute;n 1.1. Una de las principales es la introducci&oacute;n del
lenguaje unificado de expresiones (<em>Unified Expression
Language</em> o <em>Unified EL&nbsp;</em>), que integra el lenguaje JSTL de
expresiones de JSP y el lenguaje de expresiones de JSF en una &uacute;nica
especificaci&oacute;n.</p>
<p>La especificaci&oacute;n actual de JSF (JavServer Faces 2.1) se aprob&oacute; en
octubre de 2010 (<a href="http://www.jcp.org/en/jsr/detail?id=314">JSR
314</a>) junto con el resto de especificaciones que definen Java EE
6.0. En esta especificaci&oacute;n se rompe definitivamente con JSP como
forma de definir las vistas JSF y se introduce un formato
independiente de JSP. De hecho, la implementaci&oacute;n de referencia de Oracle/Sun
se integra con <a href="https://facelets.dev.java.net/">Facelets</a>,
un sistema de definici&oacute;n de plantillas para las p&aacute;ginas web que
sustituye a JSP y que se ha popularizado con JSF 1.2.</p>
<p>Otras caracter&iacute;sticas importantes de esta especificaci&oacute;n son :</p>
<ul>
   
<li>Soporte para Ajax</li>
   
<li>Componentes m&uacute;ltiples</li>
   
<li>Integraci&oacute;n con Facelets</li>
   
<li>Gesti&oacute;n de recursos (hojas de estilo, im&aacute;genes, etc.)</li>
   
<li>Facilidad de desarrollo y despliegue</li>

</ul>
<p>Por la cantidad de comentarios que est&aacute; generando, parece ser que
esta nueva versi&oacute;n va a representar un salto cualitativo importante y
va a conseguir popularizar definitivamente JSF. Esta es la
especificaci&oacute;n con la que vamos a trabajar en este m&oacute;dulo.</p>
<p>Las siguientes URLs son muy &uacute;tiles cuando se est&aacute; programando en JSF.</p>
<ul>

<li>JavaDoc del API de JSF
2: <a href="http://javaserverfaces.java.net/nonav/docs/2.1/javadocs/">http://javaserverfaces.java.net/nonav/docs/2.1/javadocs/</a>
</li>

<li>Anotaci&oacute;n <span class="codefrag">@ManagedBean</span>: <a href="http://javaserverfaces.java.net/nonav/docs/2.1/managed-bean-javadocs/index.html">http://javaserverfaces.java.net/nonav/docs/2.0/managed-bean-javadocs/index.html</a>
</li>

<li>Etiquetas de JSF y Facelets:
<a href="http://javaserverfaces.java.net/nonav/docs/2.1/vdldocs/facelets/index.html">http://javaserverfaces.java.net/nonav/docs/2.1/vdldocs/facelets/index.html</a>
</li> 

</ul>
<a name="N1016D"></a><a name="JSF+y+otros+frameworks+de+presentaci%C3%B3n"></a>
<h3 class="underlined_5">JSF y otros frameworks de presentaci&oacute;n</h3>
<p>En la actualidad JSF se ha convertido una alternativa ya madura
digna de ser tenida en cuenta si necesitamos que nuestra aplicaci&oacute;n
web tenga un interfaz rico. </p>
<p>Algunas de las caracter&iacute;sticas m&aacute;s importantes de JSF en la
actualidad:</p>
<ul>
   
<li>Framework est&aacute;ndar definido en la especificaci&oacute;n Java EE.</li>
   
<li>Soporte en todos los servidores de aplicaciones y en las
   herramientas de desarrollo: Eclipse, GlassFish, etc.</li>
   
<li>Entornos gr&aacute;ficos para desarrollar r&aacute;pidamente aplicaciones JSF.</li>
   
<li>Gran variedad de implementaciones de componentes.</li>
   
<li>F&aacute;cil integraci&oacute;n con frameworks en la capa de negocio y de
   persistencia: Spring, JPA, etc.</li>
   
<li>Comunidad muy activa en la actualidad; podemos encontrar
   f&aacute;cilmente soporte en foros, art&iacute;culos, tutoriales, etc.</li>

</ul>
<p>Todo esto, sumado a la madurez demostrada con la especificaci&oacute;n 2.0
hace que JSF sea una tecnolog&iacute;a que tenemos que conocer
obligatoriamente y que plateemos seriamente su utilizaci&oacute;n en
proyectos Java EE.</p>
<p>Ahora bien, como con cualquier otra tecnolog&iacute;a y framework
novedoso, antes de lanzarse a ello hay que tomar ciertas
precauciones. JSF es una tecnolog&iacute;a complicada, con una curva de
aprendizaje bastante pronunciada, y debemos meditar bien si es apropiado
utilizarla o no.</p>
<p>Lo primero que debemos plantearnos es si nuestro proyecto necesita
una interfaz de usuario rica. Si estamos desarrollando una aplicaci&oacute;n
web de gesti&oacute;n de contenidos y p&aacute;ginas HTML, lo m&aacute;s probable es que
JSF nos venga grande. Ser&iacute;a suficiente alguna herramienta para
gestionar plantillas como Velocity, Tiles o el mismo Facelets junto
con JSP.</p>
<p>Si nuestro proyecto va a necesitar formularios, rejillas de datos,
gr&aacute;ficas estad&iacute;sticas generadas din&aacute;micamente, &aacute;rboles de navegaci&oacute;n,
pesta&ntilde;as, validaci&oacute;n de los datos introducidos por el usuario,
internacionalizaci&oacute;n y dem&aacute;s caracter&iacute;sticas avanzadas, entonces s&iacute;
que debemos considerar JSF.</p>
<p>Uno de los problemas que nos podemos encontrar en JSF es que
necesitemos alg&uacute;n componente espec&iacute;fico que no exista en el conjunto
de componentes que estemos utilizando. Puede ser que queramos definir
alguna funcionalidad espec&iacute;fica en nuestra web (un canvas, por
ejemplo, en el que el usuario dibuja algunos sencillos trazos) que no
est&eacute; soportada por ning&uacute;n conjunto de componentes, o que queramos
integrar en ella alg&uacute;n servicio Ajax de terceros, como Google
Maps. Dado que JSF se basa en componentes definidos previamente que
insertamos en las p&aacute;ginas web de forma declarativa (utilizando
etiquetas XML), tendr&iacute;amos que construir ese componente nosotros
mismos. Hay bastante informaci&oacute;n sobre c&oacute;mo hacerlo, pero es un tema
avanzado que no vamos a ver en este curso.</p>
<p>Entre las alternativas m&aacute;s s&oacute;lidas a JSF en la actualidad se
encuentran GWT (Google Web Toolkit), Java FX y Flex. Todas ellas se
pueden comunicar perfectamente con la aplicaci&oacute;n Java en el servidor,
si hemos utilizado una correcta arquitectura y hemos separado nuestra
aplicaci&oacute;n en capas. Algunas de las caracter&iacute;sticas de estas
tecnolog&iacute;as son las siguientes:</p>
<ul>
   
<li>
<a href="http://code.google.com/webtoolkit/">GWT</a> (Google
   Web Toolkit) es un proyecto open source de Google para desarrollar
   aplicaciones de internet ricas en Java basadas en Ajax. El enfoque
   de GWT es radicalmente distinto al de JSF. La interfaz de usuario
   se desarrolla en Java (en lugar de definirse est&aacute;ticamente en un
   fichero XML) como si estuvi&eacute;ramos programando en Swing. La conexi&oacute;n
   con el servidor se realiza utilizando un API de GWT de llamadas
   as&iacute;ncronas a procedimientos remotos. El c&oacute;digo que define la
   interfaz de usuario cliente se compila a c&oacute;digo JavaScript
   compatible con todos los navegadores con las herramientas
   suministradas por Google. Es una alternativa a JSF muy
   interesante.</li>
  
   
<li>
<a href="http://javafx.com/">Java FX</a> es la &uacute;ltima propuesta
   de Oracle/Sun para desarrollar aplicaciones RIA (<em>Rich Internet
   Applications</em>) que podemos ejecutar en el navegador o en el
   escritorio. Sun inverti&oacute; mucho esfuerzo en el desarrollo del
   framework y ahora en su divulgaci&oacute;n y promoci&oacute;n. Los resultados y
   las aplicaciones ejemplo que muestran en el sitio web son bastante
   espectaculares. Es una tecnolog&iacute;a que merece la pena conocer si se
   quiere desarrollar una aplicaci&oacute;n totalmente interactiva, que se
   salga del navegador y que necesite conexi&oacute;n a servicios web
   externos proporcionados por un servidor. Con la actualizaci&oacute;n 10 de
   Java 6 se intenta dar un nuevo empuj&oacute;n a los applets, introduciendo
   la posibilidad de arrastrar y soltar applets del navegador al
   escritorio.</li>
  
   
<li>
<a href="http://www.adobe.com/devnet/flex/flex_java.html">Flex</a>
   es la propuesta de Adobe basada en Flash para realizar aplicaciones
   RIA. Es posible integrarlo con c&oacute;digo Java en el servidor. Es
   posible usarlo tanto para desarrollar aplicaciones completas, como
   para definir peque&ntilde;os componentes con efectos interactivos en
   nuestras p&aacute;ginas web. Una de las ventajas de Flex frente a Java FX
   es que Flash est&aacute; instalado casi en la totalidad de navegadores, lo
   que hace la aplicaci&oacute;n muy portable.</li>

</ul>
<a name="N101B9"></a><a name="Implementaciones+y+componentes+JSF"></a>
<h3 class="underlined_5">Implementaciones y componentes JSF</h3>
<p>Una vez que hemos decidido utilizar JSF para nuestro proyecto
tenemos que tomar una decisi&oacute;n complicada. &iquest;Qu&eacute; conjunto de
componentes utilizar? Existen multitud de implementaciones de
componentes. </p>
<p>JSF es una especificaci&oacute;n y, como tal, existen distintas
implementaciones. Sun siempre proporciona una implementaci&oacute;n de
referencia de las tecnolog&iacute;as Java, que incluye en el servidor de
aplicaciones GlassFish. En el caso de JSF, la implementaci&oacute;n de
referencia es las dos implementaciones m&aacute;s usadas son: </p>
<ul>
   
<li>
<a href="https://javaserverfaces.dev.java.net/">Mojarra</a> es
   la especificaci&oacute;n de referencia realizada por Sun. Es una de las
   implementaciones m&aacute;s populares y se incluye en distintos servidores
   de aplicaciones Java Enterprise, entre los que se encuentran
   GlassFish y JBoss. Sun la mantiene activamente y se puede descargar
   desde <a href="https://javaserverfaces.dev.java.net/download.html">esta
   p&aacute;gina</a>.</li>

   
<li>
<a href="http://myfaces.apache.org/">MyFaces</a> es la
   implementaci&oacute;n abierta de la Fundaci&oacute;n Apache. Est&aacute; desarrollada
   por la comunidad Apache y est&aacute; incluida en el servidor de
   aplicaciones Geronimo. Se puede descargar
   desde <a href="http://myfaces.apache.org/download.html">esta
   p&aacute;gina</a>.</li>

</ul>
<p>Las implementaciones de la especificaci&oacute;n JSF proporcionan el
framework y los componentes b&aacute;sicos (etiquetas <span class="codefrag">h:</span>
y <span class="codefrag">f:</span>). Para utilizar JSF en una aplicaci&oacute;n avanzada
necesitaremos componentes m&aacute;s elaborados. </p>
<p>En la p&aacute;gina
web <a href="http://www.jsfmatrix.net/">www.jsfmatrix.net</a> se
encuentra una tabla resumen muy &uacute;til en la que se comparan las
caracter&iacute;sticas de distintos conjuntos de componentes para JSF (m&aacute;s de
20). Los autores de la p&aacute;gina escribieron un
interesante <a href="http://www.theserverside.com/tt/articles/article.tss?l=JSFComparison">art&iacute;culo</a>
en The Server Side comparando tres conjuntos de componentes
espec&iacute;ficos. Este art&iacute;culo dio origen a la tabla comparativa.</p>
<p>Podemos destacar los siguientes:</p>
<ul>
   
<li>
<a href="http://www.jboss.org/jbossrichfaces/">RichFaces</a>. Desarrollado
   por Exadel y comprado por JBoss para su servidor de aplicaciones
   JBoss. Componentes Ajax muy elaborados y con una detallada
   documentaci&oacute;n. Muy recomendable. Licencia open source LGPL.</li>

   
<li>
<a href="http://www.icefaces.org/main/home/index.jsp">Icefaces</a>. Conjunto
   de componentes muy maduro, usado por gran cantidad de aplicaciones
   web de importantes empresas. Ha sido escogido por Sun como conjunto
   de componentes adicional a los b&aacute;sicos, sustituyendo un proyecto
   interno de Sun reci&eacute;n cancelado (Proyecto Woodstock). Licencia open
   source Mozilla Public License, version 1.1.</li>

   
<li>
<a href="http://myfaces.apache.org/tomahawk/index.html">MyFaces
   Tomahawk</a>. Desarrollado por el proyecto MyFaces de
   Apache. Tambi&eacute;n maduro y estable. Licencia open source Apache
   Software License, version 2.0.</li>

</ul>
<p>En las siguientes im&aacute;genes, se puede observar un ejemplo de la
apariencia de algunos componentes de RichFaces y de Icefaces. Hay que
tener en cuenta que la apariencia final del componente en una misma
implementaci&oacute;n depende tambi&eacute;n del <em>skin</em> escogido, que, a su
vez, se implementa con hojas de estilo CSS.</p>
<p>Richfaces:</p>
<p>
<img alt="" content-width="16cm" src="imagenes/tema01/richfaces.png" width="550"></p>
<p>Icefaces:</p>
<p>
<img alt="" content-width="10cm" src="imagenes/tema01/icefaces.png" width="300"></p>
</div>





<a name="N10224"></a><a name="El+lenguaje+de+definici%C3%B3n+de+vistas+JSF"></a>
<h2 class="underlined_10">El lenguaje de definici&oacute;n de vistas JSF</h2>
<div class="section">
<p>Al igual que JSP, las vistas JSF se construyen mediante etiquetas
espec&iacute;ficas que declaran elementos y componentes. Un ejemplo de p&aacute;gina
JSF es el siguiente:</p>
<pre class="brush:xml;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"&gt;
   &lt;h:head&gt;
      &lt;title&gt;Welcome&lt;/title&gt;
   &lt;/h:head&gt;
   &lt;h:body&gt;
      &lt;h:form&gt;
         &lt;h3&gt;Please enter your name and password.&lt;/h3&gt;
         &lt;table&gt;
            &lt;tr&gt;
               &lt;td&gt;Name:&lt;/td&gt;
               &lt;td&gt;&lt;h:inputText value="#{user.name}"/&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
               &lt;td&gt;Password:&lt;/td&gt;
               &lt;td&gt;&lt;h:inputSecret value="#{user.password}"/&gt;&lt;/td&gt;
            &lt;/tr&gt;
         &lt;/table&gt;
         &lt;p&gt;&lt;h:commandButton value="Login" action="welcome"/&gt;&lt;/p&gt;
      &lt;/h:form&gt;
   &lt;/h:body&gt;
&lt;/html&gt;</pre>
<p>El ejemplo muestra una pantalla de login en la se pide al usuario
el nombre y la contrase&ntilde;a. El aspecto de la p&aacute;gina en el navegador es
el siguiente:</p>
<p>
<img alt="" content-width="10cm" src="imagenes/tema01/getfile.jpg" width="500"></p>
<p>En las especificaciones anteriores a JSF 2.0 (la actual es la versi&oacute;n 2.1), las
p&aacute;ginas de JSF se constru&iacute;an utilizando p&aacute;ginas JSP con etiquetas
espec&iacute;ficas de JSF. Pronto se comprob&oacute; que el enfoque no era el
correcto. La tecnolog&iacute;a JSP no ten&iacute;a la potencia sufiente para las
funcionalidades que se intentaban implementar en JSF. Adem&aacute;s, ambos
conjuntos de etiquetas ten&iacute;an incompatibilidades y era complicado
combinarlas de forma sencilla.</p>
<p>La especificaci&oacute;n 2 soluciona el problema utilizando XHTML como
el lenguaje en el que se definen las p&aacute;ginas. Repasemos r&aacute;pidamente
qu&eacute; es el XHTML y cu&aacute;les son sus ventajas frente al HTML
tradicional. </p>
<p>El lenguaje XHTML es una normalizaci&oacute;n del HTML orientada
a hacerlo compatible con el formato XML. Expres&aacute;ndolo en pocas
palabras, un documento XHTML es un documento HTML formateado en forma
de documento XML. Por ejemplo, en los documentos XML toda etiqueta
debe empezar y terminar. En HTML, no sucede siempre as&iacute;. El ejemplo
m&aacute;s com&uacute;n es la etiqueta de fin de
l&iacute;nea <span class="codefrag">&lt;br&gt;</span>. En HTML es una etiqueta
correcta. Sin embargo en XHTML se transforma a&ntilde;adi&eacute;ndole la
terminaci&oacute;n (<span class="codefrag">&lt;br/&gt;</span>) para cumplir el est&aacute;ndar
XML.</p>
<p>Debido a que est&aacute;n escritos en XML, los documentos XHTML son m&aacute;s
f&aacute;ciles de validar y de procesar. Se pueden editar con herramientas
gen&eacute;ricas orientadas a XML. Y se pueden transformar utilizando hojas
de estilo y otras caracter&iacute;sticas de XML.</p>
<p>Una de las caracter&iacute;sticas del XHTML es la posibilidad de utilizar
en un mismo documento distintos lenguajes de etiquetas utilizando
espacios de nombres. Por ejemplo, un documento XHTML puede contener
dibujos definidos en SVG o ecuaciones definidas en MathML. Cada
lenguaje tiene su propio espacio de nombres definido con un prefijo
distinto. Es la forma de evitar conflictos entre etiquetas iguales de
distintos lenguajes. Esta caracter&iacute;stica es la que usa la
especificaci&oacute;n JSF para permitir que en las p&aacute;ginas XHTML coexistan
distintos tipos de etiquetas.</p>
<p>Los espacios de nombres se especifican al comienzo del documento
XHTML definiendo el prefijo que utilizan las etiquetas de cada uno de
los lenguajes. Utilizando distintos prefijos para distintos lenguajes
se elimina el problema de la posible ambiguedad a la hora de procesar
el documento.</p>
<p>La siguiente tabla muestra las distintas librer&iacute;as de etiquetas que
se utilizan en las p&aacute;ginas JSF, incluyendo las etiquetas de la
implementaci&oacute;n RichFaces que es la que utilizaremos en el m&oacute;dulo.</p>
<p></p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">

<tr>
   
<th colspan="1" rowspan="1">Librer&iacute;a de etiquetas</th>
   <th colspan="1" rowspan="1">Descripci&oacute;n</th>
   <th colspan="1" rowspan="1"></th>
   <th colspan="1" rowspan="1">Ejemplo</th>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSTL Core</td>
   <td colspan="2" rowspan="1">Etiquetas est&aacute;ndar JSP</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;c:forEach&gt;</span>
<br>
       
<span class="codefrag">&lt;c:catch&gt;</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSTL Functions</td>
   <td colspan="2" rowspan="1">Funciones est&aacute;ndar JSTL</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;fn:toUpperCase&gt;</span>
<br>
       
<span class="codefrag">&lt;fn:toLowerCase&gt;</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">Facelets</td>
   <td colspan="2" rowspan="1">Lenguaje de plantillas</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:component&gt;</span>
<br>
       
<span class="codefrag">&lt;ui:insert&gt;</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSF HTML</td>
   <td colspan="2" rowspan="1">Componentes est&aacute;ndar JSF basados en HTML</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;h:body&gt;</span>
<br>
       
<span class="codefrag">&lt;h:inputText&gt;</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSF Core</td>
   <td colspan="2" rowspan="1">Componentes espec&iacute;ficos de JSF</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;f:actionListener&gt;</span>
<br>
       
<span class="codefrag">&lt;f:attribute&gt;</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">RichFaces</td>
   <td colspan="2" rowspan="1">Componentes espec&iacute;ficos de RichFaces</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;rich:dataTable&gt;</span>
<br>
       
<span class="codefrag">&lt;rich:panel&gt;</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">Ajax RichFaces</td>
   <td colspan="2" rowspan="1">Funciones Ajax de RichFaces</td>
   <td colspan="1" rowspan="1"><span class="codefrag">&lt;a4j:poll&gt;</span>
<br>
       
<span class="codefrag">&lt;a4j:commandButton&gt;</span></td>

</tr>

</table>
<p></p>
<p>Cada librer&iacute;a se declara con un prefijo distinto. La siguiente
tabla muestra los distintos prefijos y URIs.</p>
<p></p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">

<tr>
   
<th colspan="1" rowspan="1">Librer&iacute;a de etiquetas</th>
   <th colspan="1" rowspan="1">Prefijo</th>
   <th colspan="1" rowspan="1">URI</th>
   <th colspan="1" rowspan="1"></th>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSTL Core</td>
   <td colspan="1" rowspan="1"><span class="codefrag">c:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/jstl/core</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSTL Functions</td>
   <td colspan="1" rowspan="1"><span class="codefrag">fn:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/jstl/functions</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSF Facelets</td>
   <td colspan="1" rowspan="1"><span class="codefrag">ui:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://java.sun.com/jsf/facelets</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSF HTML</td>
   <td colspan="1" rowspan="1"><span class="codefrag">h:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://java.sun.com/jsf/htm</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">JSF Core</td>
   <td colspan="1" rowspan="1"><span class="codefrag">f:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://java.sun.com/jsf/core</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">RichFaces</td>
   <td colspan="1" rowspan="1"><span class="codefrag">rich:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://richfaces.org/rich</span></td>

</tr>

<tr>
   
<td colspan="1" rowspan="1">Ajax RichFaces</td>
   <td colspan="1" rowspan="1"><span class="codefrag">a4j:</span></td>
   <td colspan="2" rowspan="1"><span class="codefrag">http://richfaces.org/a4j</span></td>

</tr>

</table>
<p></p>
<p>Estos lenguajes de etiquetas se definen al comienzo del documento
XHTML. S&oacute;lo es necesario declarar los que se utilizan en el
documento. El siguiente ejemplo muestra una cabecera de un documento
en el que se declaran todos los lenguajes de etiquetas que se pueden
utilizar en las p&aacute;ginas RichFaces.</p>
<pre class="code">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:rich="http://richfaces.org/rich"&gt;
</pre>
<a name="N103C8"></a><a name="Facelets"></a>
<h3 class="underlined_5">Facelets</h3>
<p>Facelets es un framework basado en el servidor que permite definir
la estructura general de las p&aacute;ginas (su <em>layout</em>) mediante
plantillas. Se trata de un framework similar a Tiles, Velocity,
Tapestry o Sitemesh.</p>
<p>Facelets se adapta perfectamente al enfoque de JSF y se incorpora a la
especificaci&oacute;n en la &uacute;ltima revisi&oacute;n 2.1. Anteriormente, las p&aacute;ginas
JSF se defin&iacute;an utilizando etiquetas espec&iacute;ficas de JSP, lo que
generaba cierta confusi&oacute;n porque se trata de enfoques alternativos
para un mismo problema. La sustituci&oacute;n de JSP por Facelets como
lenguaje b&aacute;sico para definir la disposici&oacute;n de las p&aacute;ginas permite
separar perfectamente las responsabilidades de cada parte del
framework. La estructura de la p&aacute;gina se define utilizando las
etiquetas Facelets y los componentes espec&iacute;ficos que deben presentar
los datos de la aplicaci&oacute;n utilizando etiquetas JSF.</p>
<p>Entre las caracter&iacute;sticas de Facelets destacan:</p>
<ul>

<li>Definici&oacute;n de plantillas (como en Tiles)</li>

<li>Composici&oacute;n de componentes</li>

<li>Etiquietas para definir funciones y l&oacute;gica</li>

<li>Desarrollo de p&aacute;ginas amistoso para el dise&ntilde;ador</li>

<li>Posibilidad de crear librer&iacute;as de componentes</li>

</ul>
<p>Para usar los tags de facelets, habr&aacute; que a&ntilde;adir la siguiente declaraci&oacute;n de namespace en nuestra p&aacute;gina JSF:</p>
<pre class="code">xmlns:ui="http://java.sun.com/jsf/facelets"</pre>
<p>La siguiente tabla explica brevemente las etiquetas definidas por
Facelets. Por falta de tiempo en el m&oacute;dulo nos centraremos &uacute;nicamente
en las etiquetas que se utilizan para definir
plantillas: <span class="codefrag">&lt;ui:include&gt;</span>,
<span class="codefrag">&lt;ui:composition&gt;</span>, <span class="codefrag">&lt;ui:define&gt;</span>
y <span class="codefrag">&lt;ui:insert&gt;</span>.</p>
<p></p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">

<tr>
<th colspan="1" rowspan="1">Etiqueta</th><th colspan="1" rowspan="1">Descripci&oacute;n</th><th colspan="1" rowspan="1"></th>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:include&gt;</span></td><td colspan="2" rowspan="1">Incluye
    contenido de otro fichero XHTML. Permite la reutilizaci&oacute;n de contenido para m&uacute;ltiples vistas</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:composition&gt;</span></td><td colspan="2" rowspan="1">Cuando se
    usa sin el atributo <span class="codefrag">template</span> una composici&oacute;n es una
    secuencia de elementos que se pueden insertar en alg&uacute;n otro lugar
    (mediante la etiqueta <span class="codefrag">&lt;ui:include&gt;</span> por ejemplo). La
    composici&oacute;n puede tener partes variables especificadas con el
    elemento hijo <span class="codefrag">&lt;ui:insert&gt;</span>. Cuando se usa con el
    atributo <span class="codefrag">template</span>, se carga la plantilla
    especificada. Los elementos hijos
    (etiquetas <span class="codefrag">&lt;ui:define&gt;</span>) determinan las partes variables
    de la plantilla. El contenido de la plantilla reemplaza esta
    etiqueta.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:decorate&gt;</span></td><td colspan="2" rowspan="1">Cuando se usa
    sin el atributo <span class="codefrag">template</span> especifica una p&aacute;gina en la
    que se pueden insertar otras partes. Las partes variables se
    especifican con el elemento hijo <span class="codefrag">&lt;ui:insert&gt;</span>.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:define&gt;</span></td><td colspan="2" rowspan="1">Define el
    contenido que se inserta en una plantilla con
    un <span class="codefrag">&lt;ui:insert&gt;</span> que empareja.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:insert&gt;</span></td><td colspan="2" rowspan="1">Define un lugar
    en el que se va a insertar contenido en una plantilla. El
    contenido se define en la etiqueta que carga la
    plantilla utilizando la etiqueta <span class="codefrag">&lt;ui:define&gt;</span>.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:param&gt;</span></td><td colspan="2" rowspan="1">Especifica un
    par&aacute;metro que se pasa a un fichero incluido o a una plantilla.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:component&gt;</span></td><td colspan="2" rowspan="1">Esta etiqueta
    es id&eacute;ntica a <span class="codefrag">&lt;ui:composition&gt;</span>, excepto en que crea un
    componente que se a&ntilde;ade al &aacute;rbol de componentes.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:fragment&gt;</span></td><td colspan="2" rowspan="1">Es id&eacute;ntica
    a <span class="codefrag">&lt;ui:decorate&gt;</span> excepto que crea un componente que se
    a&ntilde;ade al &aacute;rbol de coponentes.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:debug&gt;</span></td><td colspan="2" rowspan="1">Permite mostrar al
    usuario una ventana de depuraci&oacute;n que muestra la jerarqu&iacute;a de
    componentes de la p&aacute;gina actual y las variables en el &aacute;mbito de la
    aplicaci&oacute;n.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:remove&gt;</span></td><td colspan="2" rowspan="1">JSF elimina
    todo lo que hay dentro de una etiqueta <span class="codefrag">&lt;ui:remove&gt;</span>.</td>
</tr>

<tr>
<td colspan="1" rowspan="1"><span class="codefrag">&lt;ui:repeat&gt;</span></td><td colspan="2" rowspan="1">Itera sobre una
    lista, array, result set o un objeto individual.</td>
</tr>

</table>
<p></p>
<a name="N104B4"></a><a name="Definiendo+plantillas+con+Facelets"></a>
<h3 class="underlined_5">Definiendo plantillas con Facelets</h3>
<p>Facelets nos permite usar un mecanismo de plantillas para encapsular los comoponentes comunes en una aplicaci&oacute;n. 
As&iacute; tambi&eacute;n podremos modificar el aspecto de nuestra p&aacute;gina aplicando cambios sobre la plantilla, y no individualmente 
sobre las p&aacute;ginas.</p>
<p>Veamos ahora c&oacute;mo definir 
la plantilla de una aplicaci&oacute;n. Supongamos que queremos definir una
plantilla con la siguiente estructura: un men&uacute; a la izquierda, una
cabecera, un pie de p&aacute;gina y un contenido variable, en funci&oacute;n de la
opci&oacute;n del men&uacute; que se ha pulsado. Para el usuario siempre se va a
estar en la misma p&aacute;gina y s&oacute;lo va a cambiar el contenido del
centro de la pantalla. El aspecto de la p&aacute;gina que queremos construir
es el que aparece en la siguiente figura:</p>
<p>
<img alt="" content-width="15cm" src="imagenes/tema01/plantilla.png" width="600"></p>
<p>La plantilla la definimos en el
fichero <span class="codefrag">resources/templates/principal.xhtml</span>. Es una p&aacute;gina XHTML
que utiliza una tabla para componer la disposici&oacute;n y que contiene la
etiqueta <span class="codefrag">&lt;ui:insert&gt;</span> para definir el
contenido variable. La cabecera y el pie de p&aacute;gina se definen en la
propia p&aacute;gina. Por modularidad el men&uacute; se define en una p&aacute;gina
separada que se incluye con la
instrucci&oacute;n <span class="codefrag">&lt;ui:include&gt;</span>.</p>
<p>La p&aacute;gina se define en el fichero <span class="codefrag">templates/principal.xhtml</span>:</p>
<pre class="brush:xml;">&lt;?xml version='1.0' encoding='UTF-8' ?&gt; 
&lt;!DOCTYPE html PUBLIC 
  "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"&gt;

    &lt;h:head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
        &lt;link href="./resources/css/default.css" rel="stylesheet" type="text/css" /&gt;
        &lt;link href="./resources/css/cssLayout.css" rel="stylesheet" type="text/css" /&gt;
        &lt;title&gt;
          &lt;ui:insert name="pageTitle"&gt;JSF Twitter&lt;/ui:insert&gt;
        &lt;/title&gt;
    &lt;/h:head&gt;

    &lt;h:body&gt;

        &lt;div id="top"&gt;
            &lt;ui:insert name="top"&gt;
                &lt;h1&gt;JSF Twitter&lt;/h1&gt;
            &lt;/ui:insert&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;div id="left"&gt;
                &lt;ui:insert name="left"&gt;
                    &lt;ui:include src="/resources/components/leftMenu.xhtml"&gt;&lt;/ui:include&gt;
                &lt;/ui:insert&gt;
            &lt;/div&gt;
            &lt;div id="content" class="left_content"&gt;
                &lt;ui:insert name="content"&gt;
                    Aqu&iacute; va el contenido. Si no hay contenido, se mostrar&aacute; este texto por defecto
                &lt;/ui:insert&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="clearboth"&gt;&lt;/div&gt;
        &lt;div id="bottom"&gt;
            &amp;copy; Experto en Desarrollo de Aplicaciones y Servicios con Java Enterprise
        &lt;/div&gt;

    &lt;/h:body&gt;

&lt;/html&gt;</pre>
<p>Ya tenemos definida nuestra plantilla con sus cuatro elementos: cabecera, men&uacute;, contenido y pie</p>
<p>Dentro de cada fragmento, podemos especificar un contenido por defecto, cosa que hemos hecho tanto 
en el men&uacute; como en el contenido. Sin embargo, la manera de a&ntilde;adir contenido por defecto se ha hecho de dos 
formas distintas:</p>
<ul>
  
<li>En el caso del men&uacute;, hemos hecho uso de la etiqueta <span class="codefrag">ui:include</span> para incluir contenido
   de otra p&aacute;gina</li>
  
<li>En el caso del bloque de contenido, hemos incluido directamente el c&oacute;digo HTML del mismo</li>

</ul>
<p>Ambas maneras son permitidas por Facelets. Sin embargo, el uso de la etiqueta <span class="codefrag">ui:include</span> nos permite una mayor 
independencia de la plantilla a la hora de modificar fragmentos.</p>
<p>El siguiente fichero <span class="codefrag">resources/components/leftMenu.xhtml</span>
contiene el men&uacute; de la aplicaci&oacute;n. Utiliza la
directiva <span class="codefrag">&lt;ui:composition&gt;</span> para definir un
bloque de c&oacute;digo que es insertado desde otra p&aacute;gina con la
directiva <span class="codefrag">&lt;ui:include&gt;</span>. Dentro utilizamos el
componente RichFaces <span class="codefrag">&lt;rich:panel&gt;</span> para
definir un panel con el t&iacute;tulo <em>Men&uacute;</em>
</p>
<pre class="brush:xml;">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;
&lt;!DOCTYPE html PUBLIC 
  "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:rich="http://richfaces.org/rich"&gt;
    
    &lt;ui:composition&gt;
      &lt;div class="left_menu"&gt;
        &lt;div&gt;
          &lt;div class="foto_usuario"&gt;
            &lt;img src="#{user.profile_image_url}" /&gt;&lt;br/&gt;
            user.name}&lt;br/&gt;(#{user.screenName})
          &lt;/div&gt;
          &lt;div class="clearboth"&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div&gt;
          &lt;ul&gt;
            &lt;li&gt;Tweets: #{user.tweets}&lt;/li&gt;
            &lt;li&gt;Siguiendo a: #{user.following}&lt;/li&gt;
            &lt;li&gt;Seguidores: #{user.followers}&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/ui:composition&gt;

&lt;/html&gt;</pre>
<p>Por &uacute;ltimo, definimos el fichero principal <span class="codefrag">timeline.xhtml</span>:
que incluye la plantilla con la
instrucci&oacute;n <span class="codefrag">&lt;ui:composition&gt;</span> y el
atributo <span class="codefrag">template</span> en el que se indica la ruta de la
plantilla. Con la directiva <span class="codefrag">&lt;ui:define&gt;</span>
definimos el contenido del panel principal, utilizando el
atributo <span class="codefrag">name</span> con un valor que debe emparejar con el
mismo atributo de la directiva <span class="codefrag">&lt;ui:insert&gt;</span> en
el que se coloca.</p>
<pre class="brush:xml;">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;
&lt;!DOCTYPE html PUBLIC 
  "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:c="http://java.sun.com/jsp/jstl/core"&gt;

  &lt;body&gt;
    &lt;ui:composition template="./resources/templates/twitterTemplate.xhtml"&gt;
      &lt;ui:define name="content"&gt;
        &lt;h:form&gt;
          &lt;div&gt;
            &lt;h:commandButton 
                action="#{timelineBean.getPrevPage()}" 
                value="M&aacute;s recientes" /&gt;
            &lt;ui:repeat 
                var="tweet" 
                value="#{timelineBean.getTweets()}" 
                offset="#{timelineBean.currentPage}" 
                size="#{timelineBean.perPage}"&gt;
              &lt;div class="tweet"&gt;
                &lt;div class="tweet-wrapper"&gt;
                  &lt;div class="userpic"&gt;
                    &lt;img src="#{tweet.user.profile_image_url}" /&gt;
                  &lt;/div&gt;
                  &lt;div&gt;#{tweet.user.name} (@#{tweet.user.screenName})&lt;/div&gt;
                  &lt;div&gt;#{tweet.text}&lt;/div&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/ui:repeat&gt;
          &lt;/div&gt;
          &lt;h:commandButton 
              action="#{timelineBean.getNextPage()}" 
              value="Siguiente p&aacute;gina" /&gt;
        &lt;/h:form&gt;
      &lt;/ui:define&gt;
    &lt;/ui:composition&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<p>Se utiliza una hoja de estilo CSS en la que se define el tama&ntilde;o de
fuente del t&iacute;tulo y del pie de p&aacute;gina y las dimensiones y separaci&oacute;n
del men&uacute; y la zona principal. Lo hacemos en el
fichero <span class="codefrag">resources/css/detault.css</span>:</p>
<pre class="brush:css;">body {
    background-color: #ffffff;
    font-size: 12px;
    font-family: Verdana, Arial, sans-serif;
    color: #000000;  
    margin: 10px;
}

h1 {
    font-family: Verdana, Arial, sans-serif;
    border-bottom: 1px solid #AFAFAF; 
    font-size:  16px;
    font-weight: bold;
    margin: 0px;
    padding: 0px;
    color: #D20005;
}

/* RESTO DEL CSS*/</pre>
<p>Para acceder a la p&aacute;gina debemos utilizar el
prefijo <span class="codefrag">faces</span> accediendo
a <em>http://localhost:8080/jsf-ejemplos/faces/timeline.xhtml</em>.</p>
<p>
Tambi&eacute;n podemos definir un fichero <span class="codefrag">index.jsp</span> en la ra&iacute;z
de la aplicaci&oacute;n web que haga una redirecci&oacute;n a la p&aacute;gina anterior
utilizando la directiva <span class="codefrag">jsp:forward</span>:</p>
<pre class="brush:xml;">&lt;!doctype html public "-//w3c//dtd html 4.0 transitional//en"&gt;
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
   &lt;jsp:forward page="/faces/timeline.xhtml" /&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>Debemos incluir el fichero <span class="codefrag">index.jsp</span> en el primer
lugar de la lista de ficheros de bienvenida
en <span class="codefrag">WEB-INF/web.xml</span>:</p>
<pre class="brush:xml;">
...
&lt;welcome-file-list&gt;
   &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
   &lt;welcome-file&gt;faces/timeline.xhtml&lt;/welcome-file&gt;
&lt;/welcome-file-list&gt;
...</pre>
</div>




<a name="N10558"></a><a name="Creando+un+primer+proyecto+JSF"></a>
<h2 class="underlined_10">Creando un primer proyecto JSF</h2>
<div class="section">
<p>En esta secci&oacute;n vamos a detallar c&oacute;mo crear un proyecto JSF
utilizando Maven y la implementaci&oacute;n de
JSF <a href="http://www.jboss.org/richfaces">RichFaces</a>. En el
momento de escribir estos apuntes, JBoss est&aacute; terminando el desarrollo
de la versi&oacute;n 4.2, la versi&oacute;n que soporta completamente la
especificaci&oacute;n 2.1 de JSF.</p>
<p>Para crear nuestro primer proyecto JSF, lo primero que haremos ser&aacute; crear un proyecto web en Netbeans con Maven, 
del tipo <em>Web Application</em>. Las caracter&iacute;sticas de nuestro proyecto ser&aacute;n las que se muestran en el 
siguiente pantallazo:</p>
<p>
<img alt="Proyecto Netbeans" content-width="12cm" src="imagenes/tema01/np_20121222.jpg" width="600"></p>
<p>Posteriormente, tendremos que editar el fichero pom.xml para a&ntilde;adir las rutas del repositorio de RichFaces, 
as&iacute; como las dependencias con sus librer&iacute;as y las de JSR 303</p>
<pre class="brush:xml;">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
    http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;es.ua.jtech.jsf&lt;/groupId&gt;
  &lt;artifactId&gt;ModJSF&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;

  &lt;name&gt;ModJSF&lt;/name&gt;
    
  &lt;!-- A&Ntilde;ADIR REPOSITORIOS DE JSF&nbsp;--&gt;
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;richfaces&lt;/id&gt;
      &lt;name&gt;Richfaces repository&lt;/name&gt;
      &lt;layout&gt;default&lt;/layout&gt;
      &lt;url&gt;https://repository.jboss.org/nexus/content/groups/public-jboss/&lt;/url&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;

  &lt;properties&gt;
    &lt;endorsed.dir&gt;${project.build.directory}/endorsed&lt;/endorsed.dir&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
  &lt;/properties&gt;

  &lt;dependencies&gt;
    &lt;!-- DEPENDENCIAS RICHFACES&nbsp;--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.richfaces.core&lt;/groupId&gt;
      &lt;artifactId&gt;richfaces-core-impl&lt;/artifactId&gt;
      &lt;version&gt;4.2.0.Final&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.richfaces.ui&lt;/groupId&gt;
      &lt;artifactId&gt;richfaces-components-ui&lt;/artifactId&gt;
      &lt;version&gt;4.2.0.Final&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.richfaces.core&lt;/groupId&gt;
      &lt;artifactId&gt;richfaces-core-api&lt;/artifactId&gt;
      &lt;version&gt;4.2.0.Final&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.richfaces.ui&lt;/groupId&gt;
      &lt;artifactId&gt;richfaces-components-api&lt;/artifactId&gt;
      &lt;version&gt;4.2.0.Final&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.sun.faces&lt;/groupId&gt;
      &lt;artifactId&gt;jsf-api&lt;/artifactId&gt;
      &lt;version&gt;2.1.1-b04&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.sun.faces&lt;/groupId&gt;
      &lt;artifactId&gt;jsf-impl&lt;/artifactId&gt;
      &lt;version&gt;2.1.1-b04&lt;/version&gt;
    &lt;/dependency&gt;
        
    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
      &lt;artifactId&gt;jstl&lt;/artifactId&gt;
      &lt;version&gt;1.1.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;taglibs&lt;/groupId&gt;
      &lt;artifactId&gt;standard&lt;/artifactId&gt;
      &lt;version&gt;1.1.2&lt;/version&gt;
    &lt;/dependency&gt;
        &lt;!-- DEPENDENCIAS SCRIBE&nbsp;--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.scribe&lt;/groupId&gt;
      &lt;artifactId&gt;scribe&lt;/artifactId&gt;
      &lt;version&gt;1.3.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
      &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
      &lt;version&gt;3.1-b02&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
        
    &lt;!-- DEPENDENCIAS JSR 303&nbsp;--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
      &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
      &lt;version&gt;4.3.0.Final&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;
      &lt;artifactId&gt;gson&lt;/artifactId&gt;
      &lt;version&gt;2.2.2&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.3.2&lt;/version&gt;
          &lt;configuration&gt;
            &lt;source&gt;1.6&lt;/source&gt;
            &lt;target&gt;1.6&lt;/target&gt;
            &lt;compilerArguments&gt;
              &lt;endorseddirs&gt;${endorsed.dir}&lt;/endorseddirs&gt;
            &lt;/compilerArguments&gt;
          &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.1.1&lt;/version&gt;
        &lt;configuration&gt;
          &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.1&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
              &lt;goals&gt;
                &lt;goal&gt;copy&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;outputDirectory&gt;${endorsed.dir}&lt;/outputDirectory&gt;
              &lt;silent&gt;true&lt;/silent&gt;
              &lt;artifactItems&gt;
                &lt;artifactItem&gt;
                  &lt;groupId&gt;javax&lt;/groupId&gt;
                  &lt;artifactId&gt;javaee-endorsed-api&lt;/artifactId&gt;
                  &lt;version&gt;6.0&lt;/version&gt;
                  &lt;type&gt;jar&lt;/type&gt;
                &lt;/artifactItem&gt;
              &lt;/artifactItems&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</pre>
<p>Una vez hecho esto, editaremos las propiedades del proyecto, y nos iremos al apartado Frameworks. A&ntilde;adiremos JavaServer Faces 2.1 y aceptaremos</p>
<p>
<img alt="Proyecto Netbeans" content-width="12cm" src="imagenes/tema01/fw_20121222.jpg" width="600"></p>
<p>Volviendo a editar, verificamos que, adem&aacute;s, se nos han a&ntilde;adido las librer&iacute;as de RichFaces.
 En caso contrario, a&ntilde;adiremos las
 dependencias faltantes y actualizaremos nuestro proyecto.</p>
</div>


<a name="N10588"></a><a name="Una+aplicaci%C3%B3n+de+ejemplo+en+detalle"></a>
<h2 class="underlined_10">Una aplicaci&oacute;n de ejemplo en detalle</h2>
<div class="section">
<p>Las aplicaciones JSF utilizan la tecnolog&iacute;a de servlets y pueden
ser ejecutadas en cualquier contenedor de aplicaciones web, como
Tomcat 6.x. No es necesario un servidor de aplicaciones compatible
con toda la especificaci&oacute;n Java EE 5 o 6.</p>
<p>Una aplicaci&oacute;n web JSF contiene los siguientes elementos
espec&iacute;ficos:</p>
<ul>

<li>Librer&iacute;as de implementaci&oacute;n de JSF</li>

<li>P&aacute;ginas JSF</li>

<li>Directivas en el fichero <span class="codefrag">web.xml</span>
</li>

<li>Fichero <span class="codefrag">faces-config.xml</span>
</li>

<li>Clases Java con los beans gestionados</li>

</ul>
<p>Vamos a detallar todos estos elementos, creando una sencilla
aplicaci&oacute;n de ejemplo que hace uso de RichFaces.</p>
<a name="N105AD"></a><a name="Librer%C3%ADas+de+implementaci%C3%B3n+de+JSF"></a>
<h3 class="underlined_5">Librer&iacute;as de implementaci&oacute;n de JSF</h3>
<p>Contienen el conjunto de clases que realizan la implementaci&oacute;n del
framework y las librer&iacute;as de apoyo. Como en cualquier aplicaci&oacute;n web,
se guardan en el directorio <span class="codefrag">WEB-INF/lib</span> del WAR.</p>
<p>Las librer&iacute;as dependen de la implementaci&oacute;n espec&iacute;fica de JSF. Por
ejemplo, en el caso de la implementaci&oacute;n de RichFaces (<em>RichFaces
4.2</em>) la lista de librer&iacute;as es la siguiente:</p>
<pre class="brush:text plain;">cssparser-0.9.5.jar
ehcache-1.6.0.jar
guava-r05.jar
jsf-api-2.0.3-b03.jar
jsf-impl-2.0.3-b03.jar
jstl-1.2.jar
richfaces-components-api-4.0.0.20101110-M4.jar
richfaces-components-ui-4.0.0.20101110-M4.jar
richfaces-core-api-4.0.0.20101110-M4.jar
richfaces-core-impl-4.0.0.20101110-M4.jar
sac-1.3.jar</pre>
<p>Vemos que existen librer&iacute;as de apoyo
(<em>cssparser</em>, <em>ehcache</em>, <em>guava</em>
y <em>sac</em>) y librer&iacute;as propias de JSF.</p>
<p>Entre las librer&iacute;as de JSF podemos diferenciar dos tipos, las que
realizan la implementaci&oacute;n b&aacute;sica del est&aacute;ndar y las que definen
componentes adicionales que se a&ntilde;aden a los componentes est&aacute;ndar de
JSF. Las implementaciones m&aacute;s usadas de las librer&iacute;as b&aacute;sicas son las
del proyecto <a href="http://javaserverfaces.java.net/">Mojarra de
GlassFish</a> de Oracle/Sun y las del
subproyecto <a href="http://myfaces.apache.org/core20/index.html">MyFaces
Core</a> de Apache. Ambas implementan la &uacute;ltima especificaci&oacute;n JSF
2.1. En ambos casos se definen dos m&oacute;dulos:
<span class="codefrag">jsf-api-xxx.jar</span> y <span class="codefrag">jsf-impl-xxx.jar</span>.</p>
<p>Los componentes adicionales los proporcionan las distintas
librer&iacute;as de componentes desarrolladas por una gran cantidad de
empresas. Las m&aacute;s populares
son <a href="http://www.jboss.org/richfaces">RichFaces</a>, <a href="http://www.primefaces.org/">PrimeFaces</a>
y <a href="http://www.icefaces.org/main/home/">IceFaces</a>, aunque
cada d&iacute;a aparecen nuevas librer&iacute;as muy interesantes
como <a href="http://www.openfaces.org/">OpenFaces</a>. Algunas de
estas librer&iacute;as de componentes son compatibles, y es posible
utilizarlas conjuntamente. Por ejemplo, podemos desarrollar una
aplicaci&oacute;n en RichFaces y a&ntilde;adir alg&uacute;n componente adicional
desarrollado por OpenFaces.</p>
<a name="N105F8"></a><a name="P%C3%A1ginas+JSF"></a>
<h3 class="underlined_5">P&aacute;ginas JSF</h3>
<p>La aplicaci&oacute;n ejemplo contendr&aacute; una &uacute;nica p&aacute;gina JSF, que permite al
usuario escribir en un campo y que muestra lo que va escribiendo a su
derecha. La p&aacute;gina (la llamaremos <span class="codefrag">sample.xhtml</span>) es la siguiente:</p>
<pre class="brush:xml;">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:a4j="http://richfaces.org/a4j"&gt;

&lt;h:head&gt;
   &lt;title&gt;RichFaces Sample&lt;/title&gt;
   &lt;meta http-equiv="content-type" content="text/xhtml; charset=UTF-8" /&gt;
&lt;/h:head&gt;

&lt;h:body&gt;
   &lt;h:form prependId="false"&gt;
      &lt;h:outputLabel value="Name:" for="nameInput" /&gt;
      &lt;h:inputText id="nameInput" value="#{richBean.name}"&gt;
         &lt;a4j:ajax event="keyup" render="output" /&gt;
      &lt;/h:inputText&gt;
      &lt;h:panelGroup id="output"&gt;
         &lt;h:outputText value="Hello #{richBean.name}!"
            rendered="#{not empty richBean.name}" /&gt;
      &lt;/h:panelGroup&gt;
   &lt;/h:form&gt;
&lt;/h:body&gt;
&lt;/html&gt;</pre>
<p>Destacamos lo siguiente:</p>
<ul>

<li>El texto introducido por el usuario se guarda en el bean
  gestionado <span class="codefrag">richBean</span>, en concreto en su
  campo <span class="codefrag">name</span>.</li>

<li>El componente <span class="codefrag">&lt;h:form&gt;</span> genera una
  etiqueta <span class="codefrag">&lt;form&gt;</span> de HTML en la que se
  incluye el campo de entrada <span class="codefrag">nameInput</span>. El
  atributo <span class="codefrag">prependId=false</span> hace que el motor de JSF no
  a&ntilde;ada ning&uacute;n prefijo a los identificadores de los componentes dentro
  del formulario. Esto reduce el tama&ntilde;o de la p&aacute;gina HTML
  generada.</li>

<li>El texto de salida se encuentra dentro de un <em>PanelGroup</em>
  con el identificador <span class="codefrag">output</span>. El
  componente <span class="codefrag">&lt;a4j:ajax&gt;</span> hace que cada vez que
  se produzca el evento <span class="codefrag">keyup</span> en el campo de entrada se
  redibuje el panel y todos los componentes incluidos.</li>

<li>El atributo <span class="codefrag">rendered</span> de un componente permite
  definir si se muestra o no. En este caso depende del valor devuelto
  por la expresi&oacute;n EL <span class="codefrag">#{not empty richBean.name}</span>.</li>

</ul>
<a name="N10640"></a><a name="Directivas+en+el+fichero+web.xml"></a>
<h3 class="underlined_5">Directivas en el fichero web.xml</h3>
<p>El motor de JSF es el servlet que procesa las peticiones de los
navegadores y realiza el procesamiento de las p&aacute;ginas JSF para generar
el HTML resultante. Es necesario declarar este servlet en el
fichero <span class="codefrag">web.xml</span> y definir ciertas propiedades de la
aplicaci&oacute;n web, como el mapeado de nombres o las p&aacute;ginas de
bienvenida.</p>
<p>En concreto, el fichero <span class="codefrag">WEB-INF/web.xml</span> de la
aplicaci&oacute;n ejemplo es el siguiente:</p>
<pre class="brush:xml;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="3.0" 
  xmlns="http://java.sun.com/xml/ns/javaee" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
  http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;
    &lt;context-param&gt;
        &lt;param-name&gt;javax.faces.PROJECT_STAGE&lt;/param-name&gt;
        &lt;param-value&gt;Development&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/faces/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
    &lt;session-config&gt;
        &lt;session-timeout&gt;
            30
        &lt;/session-timeout&gt;
    &lt;/session-config&gt;
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;faces/index.xhtml&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;
&lt;/web-app&gt;</pre>
<p>Podemos destacar los siguientes elementos:</p>
<ul>

<li>El servlet que procesa todas las peticiones
  es <span class="codefrag">javax.faces.webapp.FacesServlet</span>
</li>

<li>Se definen dos patrones de nombres de petici&oacute;n que se redirigen a
  ese servlet: <span class="codefrag">*.jsf</span> y <span class="codefrag">/faces/*</span>. Cuando se
  realiza una petici&oacute;n (por ejemplo, <em>/faces/login/registro.xhtml</em>
  o <em>/login/registro.jsf</em>) el servlet elimina el prefijo o la
  extensi&oacute;n <em>.jsf</em> y procesa la p&aacute;gina XHTML definida
  en la ruta de la petici&oacute;n (<em>/login/registro.xhtml</em>).</li>

<li>La p&aacute;gina de bienvenida es la <span class="codefrag">faces/index.xhtml</span>. El
  navegador realiza la petici&oacute;n a esa ruta y se carga la p&aacute;gina
  JSF <span class="codefrag">index.xhtml</span>
</li>

</ul>
<a name="N10680"></a><a name="Fichero+faces-config.xml"></a>
<h3 class="underlined_5">Fichero faces-config.xml</h3>
<p>El fichero <span class="codefrag">faces-config.xml</span> define la configuraci&oacute;n
de la aplicaci&oacute;n JSF:</p>
<ul>

<li>
<em>Beans</em> de la aplicaci&oacute;n, sus nombres y propiedades
  iniciales.</li>

<li>Reglas de validaci&oacute;n de los componentes de entrada.</li>

<li>Reglas de navegaci&oacute;n entre distintas p&aacute;ginas de la
  aplicaci&oacute;n.</li>

<li>Ficheros de recursos para la internacionalizaci&oacute;n de la aplicaci&oacute;n.</li>

</ul>
<p>Sin embargo, nos aprovecharemos de las anotaciones que JSF2 provee para no tener la necesidad de declarar 
nuestros Beans en este fichero, con lo que en este momento no es ni siquiera necesaria su existencia.</p>
<a name="N106A1"></a><a name="Clase+Java+con+el+bean+gestionado"></a>
<h3 class="underlined_5">Clase Java con el bean gestionado</h3>
<p>La clase Java que define el bean gestionado <em>richBean</em> es un sencillo
JavaBean con la propiedad <span class="codefrag">name</span>:</p>
<p>A partir JSF 2.0 se hace todav&iacute;a m&aacute;s sencillo la definici&oacute;n de un bean
gestionado. Como hemos dicho, no es necesario hacerlo en el
fichero <span class="codefrag">faces-config.xml</span>. Basta utilizar las
anotaciones <span class="codefrag">@ManagedBean</span> y <span class="codefrag">@ViewScoped</span> en la
propia clase. La primera define el car&aacute;cter del bean como gestionado y
la segunda su &aacute;mbito (otros posibles valores
son: <span class="codefrag">@RequestScoped</span>, <span class="codefrag">@SessionScoped</span>
o <span class="codefrag">@ApplicationScoped</span>).</p>
<p>El nombre por defecto que se utilizar&aacute; en las p&aacute;ginas
JSF ser&aacute; el de la clase del bean gestionado, cambiando la primera
letra may&uacute;scula por una min&uacute;scula. Es posible definir un nombre
distinto utilizando el atributo <span class="codefrag">name</span> de la
anotaci&oacute;n <span class="codefrag">@ManagedBean</span>.</p>
<pre class="brush:java;">package es.ua.jtech.jsf.ejemplo;

import java.io.Serializable;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;

@ManagedBean
@ViewScoped
public class RichBean implements Serializable {
   private static final long serialVersionUID = -2403138958014741653L;
   private String name;

   public RichBean() {
      name = "John";
   }

   public String getName() {
       return name;
   }

   public void setName(String name) {
       this.name = name;
   }
}</pre>
<a name="N106D4"></a><a name="Probando+la+aplicaci%C3%B3n"></a>
<h3 class="underlined_5">Probando la aplicaci&oacute;n</h3>
<p>Ejecutaremos la aplicaci&oacute;n para probar el c&oacute;digo escrito (se encuentra en <a href="http://localhost:8080/jsf-expertojava/faces/sample.xhtml">http://localhost:8080/jsf-expertojava/faces/sample.xhtml</a>)</p>
</div>




<p class="pageBreakAfter"></p>

</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2012-2013 Dept. Ciencia de la Computaci&oacute;n e IA</div>
</div>
<script type="text/javascript">
     
         SyntaxHighlighter.defaults['toolbar'] = false;
         SyntaxHighlighter.autoloader(
  		     'java                   skin/highlight/shBrushJava.js',
  		     'xml xhtml xslt html    skin/highlight/shBrushXml.js',
  		     'js jscript javascript  skin/highlight/shBrushJScript.js',
  		     'groovy                 skin/highlight/shBrushGroovy.js',
  		     'bash shell             skin/highlight/shBrushBash.js',
  		     'php                    skin/highlight/shBrushPhp.js',
  		     'css                    skin/highlight/shBrushCss.js',
  		     'sql                    skin/highlight/shBrushSql.js',
  		     'objc                   skin/highlight/shBrushObjC.js',
  		     'cpp c                  skin/highlight/shBrushCpp.js',
  		     'text plain             skin/highlight/shBrushPlain.js'
         );
         SyntaxHighlighter.all();
     </script><a href="skin/highlight/shBrushJava.js"></a><a href="skin/highlight/shBrushXml.js"></a><a href="skin/highlight/shBrushJScript.js"></a><a href="skin/highlight/shBrushGroovy.js"></a><a href="skin/highlight/shBrushBash.js"></a><a href="skin/highlight/shBrushPhp.js"></a><a href="skin/highlight/shBrushCss.js"></a><a href="skin/highlight/shBrushSql.js"></a><a href="skin/highlight/shBrushObjC.js"></a><a href="skin/highlight/shBrushCpp.js"></a><a href="skin/highlight/shBrushPlain.js"></a>
</body>
</html>
