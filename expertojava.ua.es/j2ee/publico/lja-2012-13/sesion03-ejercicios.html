<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de tratamiento de errores</title>
<link type="text/css" href="skin/highlight/shCore.css" rel="stylesheet">
<link type="text/css" href="skin/highlight/shThemeEclipse.css" rel="stylesheet">
<script src="skin/highlight/shCore.js" type="text/javascript"></script><script src="skin/highlight/shAutoloader.js" type="text/javascript"></script>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://web.ua.es/especialistajava"><img class="logoImage" alt="jtech" src="images/baner_j2ee_izq.gif" title="Experto en Desarrollo de Aplicaciones y Servicios con Java Enterprise"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Lenguaje Java Avanzado" src="images/baner_j2ee_der.gif" title="Lenguaje Java Avanzado"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="javascript:location.href='../index.html'">Home</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-web.html'">Aplicaciones Web</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-ent.html'">Aplicaciones Enterprise</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../charlas.html'">Charlas</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../proy-int/index.html'">Proyecto</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Java y Herramientas de Desarrollo</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Materiales</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Java y Herramientas de Desarrollo">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-apuntes.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-apuntes.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-apuntes.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-apuntes.html">Sesion 8</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 3</div>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-ejercicios.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-ejercicios.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-ejercicios.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-ejercicios.html">Sesion 8</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion03-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de tratamiento de errores</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Captura+de+excepciones+%280.5+puntos%29">Captura de excepciones (0.5 puntos)</a>
</li>
<li>
<a href="#Lanzamiento+de+excepciones+%280.5+puntos%29">Lanzamiento de excepciones (0.5 puntos)</a>
</li>
<li>
<a href="#Excepciones+como+tipos+gen%C3%A9ricos+en+la+aplicaci%C3%B3n+filmotecas%280.5+puntos%29">Excepciones como tipos gen&eacute;ricos en la aplicaci&oacute;n filmotecas(0.5 puntos)</a>
</li>
<li>
<a href="#Excepciones+anidadas+en+la+aplicaci%C3%B3n+filmotecas+%281.5+puntos%29">Excepciones anidadas en la aplicaci&oacute;n filmotecas (1.5 puntos)</a>
</li>
</ul>
</div>


<a name="N1000C"></a><a name="Captura+de+excepciones+%280.5+puntos%29"></a>
<h2 class="underlined_10">Captura de excepciones (0.5 puntos)</h2>
<div class="section">
<p>En el proyecto <span class="codefrag">lja-excepciones</span> de las plantillas de la sesi&oacute;n tenemos una aplicaci&oacute;n <span class="codefrag">Ej1.java</span> que toma un n&uacute;mero 
  como par&aacute;metro, y como salida muestra el logaritmo de dicho n&uacute;mero. 
  Sin embargo, en ning&uacute;n momento comprueba si se ha proporcionado alg&uacute;n 
  par&aacute;metro, ni si ese par&aacute;metro es un n&uacute;mero. Se pide:</p>
<p>
<em>a)</em> Compilar el programa y ejecutadlo de tres formas distintas:</p>
<ul>
    
<li>Sin par&aacute;metros</li>
  
</ul>
<pre class="code">java Ej1 </pre>
<ul>
    
<li>Poniendo un par&aacute;metro no num&eacute;rico</li>
  
</ul>
<pre class="code">java Ej1 pepe</pre>
<ul>
    
<li>Poniendo un par&aacute;metro
num&eacute;rico&nbsp;</li>
  
</ul>
<pre class="code">java Ej1 30</pre>
<p>Anotad las excepciones que se lanzan en cada caso (si se lanzan)</p>
<p>
<em>b)</em> Modificar el c&oacute;digo de <span class="codefrag">main </span>para 
    que capture las excepciones producidas y muestre los errores correspondientes 
    en cada caso:</p>
<ul>
    
<li>Para comprobar si no hay par&aacute;metros se capturar&aacute; una excepci&oacute;n de tipo 
      <span class="codefrag">ArrayIndexOutOfBoundsException</span> (para ver si el <em>array</em> 
      de <span class="codefrag">String</span> que se pasa en el <span class="codefrag">main</span> tiene alg&uacute;n elemento).</li>
    
<li>Para comprobar si el par&aacute;metro es num&eacute;rico, se capturar&aacute; una excepci&oacute;n 
      de tipo <span class="codefrag">NumberFormatException</span>.</li>
  
</ul>
<p>As&iacute;, tendremos en el <span class="codefrag">main </span>algo como:</p>
<pre class="brush:java;">try
{
	// Tomar par&aacute;metro y asignarlo a un double
} catch (ArrayIndexOutOfBoundsException e1) {
	// Codigo a realizar si no hay parametros
} catch (NumberFormatException e2) {
	// Codigo a realizar con parametro no numerico
}</pre>
<p>Probad de nuevo el programa 
    igual que en el caso anterior comprobando que las excepciones son capturadas 
    y tratadas.</p>
</div>

<a name="N10070"></a><a name="Lanzamiento+de+excepciones+%280.5+puntos%29"></a>
<h2 class="underlined_10">Lanzamiento de excepciones (0.5 puntos)</h2>
<div class="section">
<p>El fichero <span class="codefrag">Ej2.java</span> es similar al anterior, 
  aunque ahora no vamos a tratar las excepciones del <span class="codefrag">main</span>, sino las 
  del m&eacute;todo<span class="codefrag"> logaritmo</span>:<em> </em> en la funci&oacute;n que calcula 
  el logaritmo se comprueba si el valor introducido es menor o igual que 0, ya 
  que para estos valores la funci&oacute;n logaritmo no est&aacute; definida. 
  Se pide:</p>
<p>
<em>a)</em> Buscar entre las excepciones de Java la m&aacute;s adecuada para 
    lanzar en este caso, que indique que a un m&eacute;todo se le ha pasado un 
    argumento ilegal. (Pista: Buscar entre las clases derivadas de <span class="codefrag">Exception</span>. 
    En este caso la m&aacute;s adecuada se encuentra entre las derivadas de <span class="codefrag">RuntimeException</span>).</p>
<p>
<em>b)</em> Una vez elegida la excepci&oacute;n adecuada, a&ntilde;adir 
    c&oacute;digo (en el m&eacute;todo <span class="codefrag">logaritmo</span>)<em> </em>para que en el 
    caso de haber introducido un par&aacute;metro incorrecto se lance dicha excepci&oacute;n.&nbsp;</p>
<pre class="brush:java;">throw new ... // excepcion elegida</pre>
<p> Probar el programa para comprobar el efecto que tiene el lanzamiento de 
    la excepci&oacute;n.</p>
<p>
<em>c)</em> Al no ser una excepci&oacute;n del tipo <em>checked</em> no har&aacute; 
    falta que la capturemos ni que declaremos que puede ser lanzada. Vamos a crear 
    nuestro propio tipo de excepci&oacute;n derivada de <span class="codefrag">Exception</span> 
    (de tipo <em>checked</em>) para ser lanzada en caso de introducir un valor no 
    v&aacute;lido como par&aacute;metro. La excepci&oacute;n se llamar&aacute; 
    <span class="codefrag">WrongParameterException</span> y tendr&aacute; la siguiente forma:</p>
<pre class="brush:java;">public class WrongParameterException extends Exception 
{
	public WrongParameterException(String msg) {
		super(msg);
	}
}</pre>
<p>Deberemos lanzarla en lugar de la escogida en el punto anterior.&nbsp;</p>
<pre class="brush:java;">throw new WrongParameterException(...);</pre>
<p> Intentar compilar el programa y observar los errores que aparecen. &iquest;Por 
    qu&eacute; ocurre esto? A&ntilde;adir los elementos necesarios al c&oacute;digo 
    para que compile y probarlo.&nbsp;</p>
<p>
<em>d)</em> Por el momento controlamos que no se pase un n&uacute;mero negativo como entrada.
  &iquest;Pero qu&eacute; ocurre si la entrada no es un n&uacute;mero v&aacute;lido? En ese caso se producir&aacute; una excepci&oacute;n
  al convertir el valor de entrada y esa excepci&oacute;n se propagar&aacute; autom&aacute;ticamente al nivel 
  superior. Ya que tenemos una excepci&oacute;n que indica cuando el par&aacute;metro de entrada de nuestra
  funci&oacute;n es incorrecto, ser&iacute;a conveniente que siempre que esto ocurra se lance dicha excepci&oacute;n,
  independientemente de si ha sido causada por un n&uacute;mero negativo o por algo que no es un 
  n&uacute;mero, pero siempre conservando la informaci&oacute;n sobre la causa que produjo el error. Utilizar
  <em>nested exceptions</em> para realizar esto.</p>
<div class="frame note">
<div class="label">Ayuda</div>
<div class="content">Deberemos a&ntilde;adir un nuevo constructor a <span class="codefrag">WrongParameterException</span>
  en el que se proporcione la excepci&oacute;n que caus&oacute; el error. En la funci&oacute;n <span class="codefrag">logaritmo</span>
  capturaremos cualquier excepci&oacute;n que se produzca al convertir la cadena a n&uacute;mero, y lanzaremos
  una excepci&oacute;n <span class="codefrag">WrongParameterException</span> que incluya la excepci&oacute;n causante.</div>
</div>
</div>


<a name="N100DA"></a><a name="Excepciones+como+tipos+gen%C3%A9ricos+en+la+aplicaci%C3%B3n+filmotecas%280.5+puntos%29"></a>
<h2 class="underlined_10">Excepciones como tipos gen&eacute;ricos en la aplicaci&oacute;n filmotecas(0.5 puntos)</h2>
<div class="section">
<p>Realiza una copia del proyecto <span class="codefrag">lja-filmoteca</span> con otro nombre: <span class="codefrag">lja-filmoteca-exc</span>.
  En este nuevo branch realizaremos cambios que <strong>no</strong> mantendremos para el siguiente ejercicio. </p>
<p>Los m&eacute;todos de nuestros DAO pueden devolver excepciones. Seg&uacute;n si el DAO se dedica a escribir en disco,
      en memoria o en una base de datos, podr&aacute; devolver unas excepciones u otras. Busca la clase de excepci&oacute;n
      que te parezca adecuada para cada uno de los DAO que tiene la aplicaci&oacute;n. Por ejemplo, la <span class="codefrag">IOException</span>
      para <span class="codefrag">FilePeliculaDAO</span>.  </p>
<p>A&ntilde;ade un tipo gen&eacute;rico <span class="codefrag">E</span> a <span class="codefrag">IPeliculaDAO</span>, que s&oacute;lo pueda ser una <span class="codefrag">Exception</span> o 
      clases derivadas. De esta manera si tenemos que
      crear un nuevo <span class="codefrag">FilePeliculaDAO</span> y asignarlo a una variable que cumple con la interfaz, tendremos que
      introducir el tipo de excepci&oacute;n:</p>
<pre class="brush:java;">
      IPeliculaDAO&lt;IOException&gt; dao = new FilePeliculaDAO();
  </pre>
<p>Reliza los cambios necesarios a <span class="codefrag">FilePeliculaDAO</span> para que, efectivamente, sus m&eacute;todos lancen esa
      excepci&oacute;n (s&oacute;lo con <span class="codefrag">throws</span>, sin implementar c&oacute;digo dentro de los m&eacute;todos).</p>
<p>Supongamos que <span class="codefrag">MemoryPeliculaDAO</span> no tuviera que devolver ninguna excepci&oacute;n. Declara adecuadamente
      la clase</p>
<pre class="brush:java;">
      public class MemoryPeliculaDAO implements IPeliculaDAO&lt;...&gt; {
  </pre>
<p>Comprueba que todos los DAO se pueden devolver correctamente desde GestorDAO, tanto los que devuelven excepciones
      como los que no.</p>
<p>&iquest;Qu&eacute; limitaci&oacute;n tiene esta aproximaci&oacute;n? En el siguiente ejercicio a&ntilde;adiremos tratamiento de excepciones
      siguiendo otra aproximaci&oacute;n diferente, sin usar tipos gen&eacute;ricos.</p>
</div>


<a name="N10124"></a><a name="Excepciones+anidadas+en+la+aplicaci%C3%B3n+filmotecas+%281.5+puntos%29"></a>
<h2 class="underlined_10">Excepciones anidadas en la aplicaci&oacute;n filmotecas (1.5 puntos)</h2>
<div class="section">
<p>En este ejercicio plantearemos el tratamiento de errores de los distintos DAO anidando excepciones en una
      excepci&oacute;n general para todos los DAO. As&iacute; las partes de c&oacute;digo que utilicen un DAO de cualquier tipo,
      sabr&aacute;n qu&eacute; excepciones se deben al DAO y adem&aacute;s se incluir&aacute; excepci&oacute;n concreta que caus&oacute; el error,
      por si es necesario saberlo.</p>
<p>Para empezar, en el proyecto <span class="codefrag">lja-filmoteca</span>, a&ntilde;adiremos excepciones para tratar los errores en la clase <span class="codefrag">MemoryPeliculaDAO</span>.
  Cuando se produzca un error en esta clase lanzaremos una excepci&oacute;n <span class="codefrag">DAOException</span>, de
  tipo <em>checked</em>, que deberemos implementar. Se pide:</p>
<p>
<em>a) </em>La excepci&oacute;n <span class="codefrag">DAOExcepcion</span> se crear&aacute; en el mismo paquete que el resto de las clases
  del DAO. Utilizaremos las facilidades que nos ofrece Eclipse para generar autom&aacute;ticamente los constructores de 
  dicha clase (tendremos suficiente con tener acceso a los constructores de la super-clase).</p>
<p>
<em>b) </em>&iquest;Qu&eacute; ocurre si declaramos que los m&eacute;todos de <span class="codefrag">MemoryPeliculaDAO</span> pueden lanzar la excepci&oacute;n
  creada, pero no lo hacemos en la interfaz <span class="codefrag">IPeliculaDAO</span>? &iquest;Y si en <span class="codefrag">IPeliculaDAO</span> si que se
  declara, pero en alguna de las clases que implementan esta interfaz no se hace (<span class="codefrag">FilePeliculaDAO</span>, 
  <span class="codefrag">JDBCPeliculaDAO</span>)? &iquest;Por qu&eacute; crees que esto es as&iacute;? Todos los m&eacute;todos de <span class="codefrag">IPeliculaDAO</span> 
  podr&aacute;n lanzar este tipo de excepci&oacute;n.</p>
<p>
<em>c) </em>El m&eacute;todo <span class="codefrag">addPelicula</span> lanzar&aacute; la excepci&oacute;n si le pasamos como par&aacute;metro <span class="codefrag">null</span>,
  si intentamos a&ntilde;adir una pel&iacute;cula cuyo t&iacute;tulo
  sea <span class="codefrag">null</span> o cadena vac&iacute;a, o si ya existe una pel&iacute;cula en la lista con el mismo t&iacute;tulo.</p>
<p>
<em>d) </em>El m&eacute;todo <span class="codefrag">delPelicula</span> lanzar&aacute; la excepci&oacute;n cuando no exista ninguna pel&iacute;cula con el identificador
  proporcionado.</p>
<p>
<em>e) </em>En algunos casos es posible que fallen las propias operaciones de a&ntilde;adir, eliminar o listar los elementos de las
  colecciones. Vamos a utilizar <em>nested exceptions</em> para tratar estos posibles errores. Para hacer esto a&ntilde;adiremos
  bloques <span class="codefrag">try-catch</span> alrededor de las operaciones con colecciones, y en caso de que se produjese un error
  lanzaremos una excepci&oacute;n de tipo <span class="codefrag">DAOException</span>. Podemos conseguir que se produzca una excepci&oacute;n de este
  tipo si utilizamos como colecci&oacute;n un tipo <span class="codefrag">TreeSet</span>. &iquest;Por qu&eacute; se producen errores al utilizar este tipo? &iquest;Qu&eacute;
  habr&iacute;a que hacer para solucionarlo?</p>
<p>
<em>f) </em>Comprobar que los errores se tratan correctamente utilizando el programa de pruebas que tenemos (clase <span class="codefrag">Main</span>). 
  Habr&aacute; que hacer una serie de modificaciones en dicho programa principal para tratar las excepciones. Debemos destacar que el haber
  tratado las posibles excepciones internas de las colecciones mediante <em>nested exceptions</em> ahora nos facilitar&aacute; el trabajo, 
  ya que s&oacute;lo deberemos preocuparnos de capturar la excepci&oacute;n de tipo <span class="codefrag">DAOException</span>, sin importarnos c&oacute;mo se haya
  implementado internamente el DAO.</p>
</div>


<p class="pageBreakAfter"></p>
  

</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2012-2013 Dept. Ciencia de la Computaci&oacute;n e IA</div>
</div>
<script type="text/javascript">
     
         SyntaxHighlighter.defaults['toolbar'] = false;
         SyntaxHighlighter.autoloader(
  		     'java                   skin/highlight/shBrushJava.js',
  		     'xml xhtml xslt html    skin/highlight/shBrushXml.js',
  		     'js jscript javascript  skin/highlight/shBrushJScript.js',
  		     'groovy                 skin/highlight/shBrushGroovy.js',
  		     'bash shell             skin/highlight/shBrushBash.js',
  		     'php                    skin/highlight/shBrushPhp.js',
  		     'css                    skin/highlight/shBrushCss.js',
  		     'sql                    skin/highlight/shBrushSql.js',
  		     'objc                   skin/highlight/shBrushObjC.js',
  		     'cpp c                  skin/highlight/shBrushCpp.js',
  		     'text plain             skin/highlight/shBrushPlain.js'
         );
         SyntaxHighlighter.all();
     </script><a href="skin/highlight/shBrushJava.js"></a><a href="skin/highlight/shBrushXml.js"></a><a href="skin/highlight/shBrushJScript.js"></a><a href="skin/highlight/shBrushGroovy.js"></a><a href="skin/highlight/shBrushBash.js"></a><a href="skin/highlight/shBrushPhp.js"></a><a href="skin/highlight/shBrushCss.js"></a><a href="skin/highlight/shBrushSql.js"></a><a href="skin/highlight/shBrushObjC.js"></a><a href="skin/highlight/shBrushCpp.js"></a><a href="skin/highlight/shBrushPlain.js"></a>
</body>
</html>
