<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios sesi&oacute;n 1 - Introducci&oacute;n a Struts</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://web.ua.es/especialistajava"><img class="logoImage" alt="jtech" src="images/baner_j2ee_izq.gif" title="Especialista Universitario Java Enterprise"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Struts" src="images/baner_j2ee_der.gif" title="Struts"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="javascript:location.href='../index.html'">Home</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-web.html'">Aplicaciones Web</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-ent.html'">Aplicaciones Enterprise</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../charlas.html'">Charlas</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../proy-int/index.html'">Proyecto</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Struts</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Struts</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Struts">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-struts-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-struts-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-struts-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-struts-apuntes.html">Sesion 4</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menupage">
<div class="menupagetitle">Sesion 1</div>
</div>
<div class="menuitem">
<a href="sesion02-struts-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-struts-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-struts-ejercicios.html">Sesion 4</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion01-struts-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios sesi&oacute;n 1 - Introducci&oacute;n a Struts</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Instalaci%C3%B3n+de+la+aplicaci%C3%B3n+de+ejemplo">Instalaci&oacute;n de la aplicaci&oacute;n de ejemplo</a>
</li>
<li>
<a href="#Implementar+un+caso+de+uso+completo+%281+punto%29">Implementar un caso de uso completo (1 punto)</a>
</li>
<li>
<a href="#Gestionar+errores+en+las+acciones+%281+punto%29">Gestionar errores en las acciones (1 punto)</a>
</li>
<li>
<a href="#Seguridad+declarativa+%281+punto%29">Seguridad declarativa (1 punto)</a>
</li>
</ul>
</div>


<a name="N1000E"></a><a name="Instalaci%C3%B3n+de+la+aplicaci%C3%B3n+de+ejemplo"></a>
<h2 class="underlined_10">Instalaci&oacute;n de la aplicaci&oacute;n de ejemplo</h2>
<div class="section">
<p>Durante las cuatro sesiones de Struts realizaremos los ejercicios sobre la misma aplicaci&oacute;n
de ejemplo. Se trata de una sencilla aplicaci&oacute;n para almacenar las tareas pendientes (ToDo) de
un usuario. Hay que tener en cuenta que es simplemente una aplicaci&oacute;n de ejemplo. 
El objetivo es tener una aplicaci&oacute;n para poder "trastear" con Struts m&aacute;s compleja que un "hola mundo" pero no tanto como una aplicaci&oacute;n real.
Tanto la arquitectura de la aplicaci&oacute;n  como el interfaz de usuario se deber&iacute;an mejorar en una implementaci&oacute;n
m&aacute;s realista. </p>
<p>Los casos de uso de la aplicaci&oacute;n son:</p>
<ul>

<li>Hacer login</li>

<li>Ver la lista de tareas pendientes</li>

<li>Crear una nueva tarea</li>

<li>Eliminar una tarea existente</li>

</ul>
<p>Para instalar la aplicaci&oacute;n, seguid estos pasos:</p>
<ol>

<li>Baj&aacute;os el proyecto de Eclipse e importadlo a vuestro espacio de trabajo</li>

<li>
<strong>Crear la base de datos:</strong> en la carpeta <span class="codefrag">database</span> hay  un script SQL para crear la base
de datos de MySQL. Pod&eacute;is crearla con las herramientas gr&aacute;ficas de MySQL o bien tecleando desde una terminal
<pre class="code">
mysql -u root -p &lt; todo.sql <em>(os pedir&aacute; el password: especialista)</em>

</pre>

</li>

<li>Para aseguraros de que la conexi&oacute;n con la base de datos funciona, haced login
con el usuario "struts" y el password "mola". Debe aparecer una lista de tareas pendientes.</li>

</ol>
</div>


<a name="N10047"></a><a name="Implementar+un+caso+de+uso+completo+%281+punto%29"></a>
<h2 class="underlined_10">Implementar un caso de uso completo (1 punto)</h2>
<div class="section">
<p>Como mejor se ve el funcionamiento de Struts es siguiendo el flujo de ejecuci&oacute;n de un caso
de uso completo. Para ello vais a implementarlo vosotros y luego probarlo. El caso de uso
en cuesti&oacute;n es el de mostrar todos los datos de una tarea. En la p&aacute;gina que lista
todas las tareas hay un enlace "Ver detalles" al lado de cada una, que apunta a "verTarea.do" . Falta por
 implementar: 
</p>
<ul>

<li>La clase Java con la acci&oacute;n</li>

<li>El JSP que muestre el resultado (verTarea.jsp)</li>

<li>El mapeo en el struts-config.xml entre la acci&oacute;n y los posibles resultados. En este caso habr&aacute; un &uacute;nico resultado
posible, "OK".</li>

</ul>
<p>En la plantilla, la clase <span class="codefrag">es.ua.jtech.struts.acciones.VerTareaAccion</span> devuelve simplemente el
forward "OK". El JSP "verTarea.jsp" muestra simplemente un mensaje de saludo. Se recomienda que prob&eacute;is primero
a hacer el mapeo en el struts-config.xml, comprob&eacute;is que funciona y luego hag&aacute;is la implementaci&oacute;n real de la
acci&oacute;n y del JSP.</p>
<p>Ve&aacute;moslo con un poco m&aacute;s de detalle:</p>
<ol>

<li>En cuanto a <strong>La clase Java VerTareaAccion</strong>. 
	<ul>
	 
<li>El &uacute;nico posible resultado (<em>forward</em>) por el momento ser&aacute; "OK".</li>
  	
<li>El acceso a la base de datos nos lo da la clase <span class="codefrag">TareaDAO</span>. Para obtener
  	una instancia, llamar a <span class="codefrag">TareaDAO.getInstance()</span>. Para obtener los datos de 
  	una tarea, llamar a <span class="codefrag">getTarea(id_de_la_tarea)</span>. El id de la tarea lo podemos
  	sacar del par&aacute;metro HTTP "id"</li>
  	
<li>Una vez se obtenga un objeto <span class="codefrag">Tarea</span> con todos los datos, colocarlo
  	en el <span class="codefrag">request</span> para que se pueda mostrar desde el JSP</li>
	
</ul>  

</li>

<li>En cuanto a <strong>La vista <span class="codefrag">verTarea.jsp</span></strong>: Usad el lenguaje de expresiones de JSP para
simplificar la sintaxis, pod&eacute;is tomar como ejemplo <span class="codefrag">tareas.jsp</span>.</li>

</ol>
</div>

<a name="N10098"></a><a name="Gestionar+errores+en+las+acciones+%281+punto%29"></a>
<h2 class="underlined_10">Gestionar errores en las acciones (1 punto)</h2>
<div class="section">
<p>A&ntilde;adir gesti&oacute;n de errores a la acci&oacute;n <span class="codefrag">VerTarea</span>, de modo que si se solicita el id de una tarea
no existente, se detecte la situaci&oacute;n y aparezca un mensaje de error.</p>
<p>Pasos a seguir:</p>
<ol>

<li>En el fichero <span class="codefrag">mensajes.properties</span> (carpeta <span class="codefrag">resources</span>) a&ntilde;adir un mensaje de error para este caso.</li>

<li>En el c&oacute;digo de la acci&oacute;n: 
<ul>

<li>Si el m&eacute;todo <span class="codefrag">getTarea(id)</span> de <span class="codefrag">TareaDAO</span> devuelve <span class="codefrag">null</span>, la tarea
no existe. Por tanto en este caso habr&aacute; que devolver otro resultado distinto de "OK". Llamadlo "error".</li>

<li>En caso de error, crear un <span class="codefrag">ActionMessage</span> asociado al mensaje del fichero <span class="codefrag">mensajes.properties</span> y guardarlo con <span class="codefrag">saveErrors</span> como
se explica en los apuntes.</li>

</ul>

</li>

<li>En el struts-config.xml, asociar el resultado "error" con la p&aacute;gina error.jsp, que deber&aacute;s crear.</li>

<li>En dicha p&aacute;gina usar la etiqueta <span class="codefrag">&lt;html:messages&gt;</span> para mostrar el error.</li>

</ol>
</div>

<a name="N100DB"></a><a name="Seguridad+declarativa+%281+punto%29"></a>
<h2 class="underlined_10">Seguridad declarativa (1 punto)</h2>
<div class="section">
<p>La aplicaci&oacute;n de tareas pendientes usa seguridad declarativa. Hay dos clases de usuarios (dos roles): "registrado" y "pro". Modifica la aplicaci&oacute;n para
que solo los usuarios "pro" puedan ver los detalles de la tarea.</p>
<ul>

<li>Modifica el struts-config.xml para que la acci&oacute;n de VerTarea solo se pueda ejecutar con rol "pro"</li>

<li>Haz que si intenta acceder un usuario que no tenga este rol se salte a la p&aacute;gina "sinPermiso.jsp", que deber&aacute;s crear, mostrando
en ella un mensaje de error apropiado.</li>

</ul>
</div>
   

<p class="pageBreakAfter"></p>

</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2010-2011 Dept. Ciencia de la Computaci&oacute;n e IA</div>
</div>
</body>
</html>
