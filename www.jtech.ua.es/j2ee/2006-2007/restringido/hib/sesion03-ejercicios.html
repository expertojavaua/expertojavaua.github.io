<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de Relaciones entre objetos</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Hibernate" src="images/baner_j2ee_der.gif" title="Hibernate"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Hibernate</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Hibernate</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Hibernate">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html" title="Sesi&oacute;n 1: Introducci&oacute;n a Hibernate:Configuraci&oacute;n e Inicio">Sesi&oacute;n 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html" title="Sesi&oacute;n 2: Mapeado de clases persistentes">Sesi&oacute;n 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html" title="Sesi&oacute;n 3: Relaciones entre objetos">Sesi&oacute;n 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html" title="Sesi&oacute;n 4: Consultas HQL">Sesi&oacute;n 4</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html" title="Roadmap">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html" title="Sesi&oacute;n 1: Introducci&oacute;n a Hibernate:Configuraci&oacute;n e Inicio">Sesi&oacute;n 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html" title="Sesi&oacute;n 2: Mapeado de clases persistentes">Sesi&oacute;n 2</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesi&oacute;n 3</div>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html" title="Sesi&oacute;n 4: Consultas HQL">Sesi&oacute;n 4</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion03-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de Relaciones entre objetos</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Ejercicio+1%3A+Asociaci%C3%B3n+unidireccional">Ejercicio 1: Asociaci&oacute;n unidireccional</a>
</li>
<li>
<a href="#Ejercicio+2%3A+Asociaci%C3%B3n+Bidireccional">Ejercicio 2: Asociaci&oacute;n Bidireccional</a>
</li>
</ul>
</div>

<p>Se proporciona el fichero <strong>hib-sesion3.doc</strong> como plantilla para que contest&eacute;is a las preguntas 
   formuladas en los ejercicios.
  </p>
   
<p>Vamos a utilizar el proyecto <span class="codefrag">hib-sesion3</span>, que se encuentra en el fichero <strong>sesion03-ejercicios.zip</strong>.
      En dicho proyecto realizaremos las modificaciones que se piden en los ejercicios propuestos.</p>


<a name="N1001B"></a><a name="Ejercicio+1%3A+Asociaci%C3%B3n+unidireccional"></a>
<h2 class="underlined_10">Ejercicio 1: Asociaci&oacute;n unidireccional</h2>
<div class="section">
<p>Utilizando la clase <em>Person</em> de la sesi&oacute;n anterior, y la nueva clase <em>Bill</em>, que representa las facturas
      asociadas de una persona, ten&eacute;is que realizar los cambios necesarios para mapear una relaci&oacute;n de 
      asociaci&oacute;n de uno a muchos unidireccional entre dichas clases desde <em>Person</em> a <em>Bill</em> (es decir, no ser&aacute;
	  posible navegar desde <em>Bill</em> hacia <em>Person</em>). A&ntilde;adiremos la restricci&oacute;n de que una factura no puede existir
	  si no est&aacute; asociada a una persona. Una vez implementada la asociaci&oacute;n, tienes que:</p>
<ul>
	    
<li>Implementar el m&eacute;todo <em>public void createInitialPersons()</em> (fichero <em>PersonManager.java</em>) 
		    que inicializa los valores de la tabla <em>PERSON</em> 
		    con los mismos datos de la sesi&oacute;n anterior:(10,"Pepa","Flores", "1111","2222"),(20,"Maria","Flores", "1111","2222"), 
			(45,"Juan","Flores","1111","2222"), (30,"Pepe","Flores", "1111","2222"), (56,"Marta","Flores", "1111","2222") 
			</li>
	    
<li>Implementar el m&eacute;todo <em>public void createAndStoreBill(Long theNumber, Date theDate, Long cantidad)</em>
		    (fichero <em>BillManager.java</em>) que crea una nueva fila en la tabla <em>BILLS</em>. </li>
	    
<li>Implementar el m&eacute;todo <em>public void addBillToPerson(Long idPerson, Long numberBill,
           Date dateBill, Long amountBill)</em> en <em>PersonManager.java</em>. Dicho m&eacute;todo a&ntilde;ade una factura a una
		   persona cuyo identificador es <em>idPerson</em>. Prueba a habilitar la popagaci&oacute;n en cascada de las operaciones
		   <em>"save"</em> y <em>"update"</em> con <em>cascada="save-update"</em> y justifica las diferencias en la implementaci&oacute;n de
		   <em>addBillToPerson</em> con y sin habilitar la propagaci&oacute;n en cascada. Para probar el m&eacute;todo puedes hacerlo con:
		   <em>addBillToPerson(2,1000,10/10/05,500))</em>
</li>
		
<li>Implementar el m&eacute;todo <em>public void printBillsFromPerson(Long personID)</em> en <em>PersonManager.java</em> que, 
		    dado el identificador de
		    una persona, imprima por pantalla los datos de las facturas de dicha persona. Si, por ejemplo, hemos a&ntilde;adido a la
			persona con identificador 2 una factura con n&uacute;mero 1000, fecha 10/10/2005 y cantidad 500, nos aparecer&aacute; por pantalla:
			<p>Facturas de la persona 2</p>
			
<p>ID: 1 N&uacute;mero Factura: 1000 Fecha: 10/oct/2005 Cantidad: 500</p>			
		
</li>
		
<li>
<strong>OPCIONAL: </strong>Implementar el m&eacute;todo <em>public void changeAmountFromPerson(Long personID, Long billNumber, Long newAmount)</em> 
		    en <em>PersonManager.java</em> que, dado el identificador
		    de una persona (<em>personID</em>) y el n&uacute;mero de factura (<em>billNumber</em>), cambia el importe a <em>newAmount</em>.
			Nota: Para comparar dos elementos utiliza el m&eacute;todo <span class="codefrag">equals</span> en vez de <span class="codefrag">==</span>. Explica por qu&eacute; tenemos
			que cargar en memoria de forma expl&iacute;cita las instacias de factura para modificar su importe. Indica qu&eacute; modificaciones 
			tendr&iacute;amos que hacer en el c&oacute;digo para que las instancias de
			la colecci&oacute;n de facturas se cargaran autom&aacute;ticamente por Hibernate al acceder a una persona. 
	    </li>
	  
</ul>
</div>


<a name="N10095"></a><a name="Ejercicio+2%3A+Asociaci%C3%B3n+Bidireccional"></a>
<h2 class="underlined_10">Ejercicio 2: Asociaci&oacute;n Bidireccional</h2>
<div class="section">
<p>En este ejercicio vamos a seguir a&ntilde;adiendo c&oacute;digo a la aplicaci&oacute;n anterior. En este caso se trata de:</p>
<ul>
  
<li>A&ntilde;adir una clase <em>Event</em>, con los campos: <em>String name</em>, <em>Date date</em>, y <em>String site</em> (pod&eacute;is utilizar
      la clase <em>Event</em> de los ejercicios de la sesi&oacute;n anterior).</li>
  
<li>La nueva clase <em>Event</em> tiene una relaci&oacute;n <strong>muchos a muchos bidireccional</strong> con la clase <em>Person</em>.
      Implementa los cambios necesarios en los POJOS y ficheros de mapeado de ambas clases para dicha asociaci&oacute;n bidireccional.</li>
  
<li>Puedes reutilizar el fichero <em>EventManager.java</em> de la sesi&oacute;n anterior, concretamente los m&eacute;todos 
      <em>createAndStoreEvent</em>, <em>createInitialEvents</em>, <em>listEvents</em>, <em>printEvents</em> y <em>obtenerFecha</em>.
	  Utiliza los m&eacute;todos  <em>createInitialEvents()</em> y <em>createInitialPersons()</em> para crear eventos y personas
	  inicialmente, <strong>cada vez</strong> que ejecutemos el programa. Utiliza los mismos datos que ya hemos introducido en
	  ejercicios anteriores.
      </li>
  
<li>Implementa el m&eacute;todo <em>public void addPersonToEvent (Long personId, Long eventId)</em> que, a&ntilde;ade una persona a un determinado
      evento (en el fichero <em>EventManager.java</em>. Modifica convenientemente las clases <em>Person.java</em> y <em>Event.java</em> con los m&eacute;todos 
	  <em>addEvent()</em> y <em>addPerson()</em>, respectivamente. Prueba a a&ntilde;adir los siguientes datos: (persona 1, evento 3), (persona 2, evento 3), (persona 4, evento 3). 
  </li>
  
<li>Implementa el m&eacute;todo <em>public void removePersonFromEvent (Long personId, Long eventId)</em> que, "borra" a una persona de un 
      determinado
      evento. Tambi&eacute;n en el fichero <em>EventManager</em>. Prueba a deshacer los cambios del punto anterior. 
  </li>

</ul>
</div>


<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006-2007 Depto. CCIA</div>
</div>
</body>
</html>
