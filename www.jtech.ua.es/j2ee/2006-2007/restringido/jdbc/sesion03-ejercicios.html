<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de actualizaci&oacute;n y sentencias preparadas</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Bases de datos con JDBC" src="images/baner_j2ee_der.gif" title="Bases de datos con JDBC"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Bases de datos con JDBC</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Materiales</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Bases de datos con JDBC">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 3</div>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion03-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de actualizaci&oacute;n y sentencias preparadas</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Sentencias+preparadas">Sentencias preparadas</a>
</li>
<li>
<a href="#Funciones+almacenadas">Funciones almacenadas</a>
</li>
</ul>
</div>

<a name="N1000C"></a><a name="Sentencias+preparadas"></a>
<h2 class="underlined_10">Sentencias preparadas</h2>
<div class="section">
<p>En este ejercicio vamos a trabajar con las sentencias preparadas. Vamos a usar
un par de m&eacute;todos para consultar usuarios por su DNI. Hay que crear la sentencia
preparada y guardarla en el DAO. Luego usaremos un m&eacute;todo para consultar.
Cread en el DAO de usuario los siguientes m&eacute;todos:</p>
<ul>
    
<li>
<em>public void preparaUsuarioDNI ()</em>: crear&aacute; la sentencia preparada,
    dejando como argumento el DNI.</li>
    
<li>
<em>public Usuario getUsuarioDNI (int dni)</em>: se le pasa el DNI del usuario
    a buscar y devuelve el objeto Usuario correspondiente. Se usar&aacute; la sentencia
    preparada anteriormente creada.</li>

</ul>
<p>En la clase <em>Consultas</em> se crear&aacute; un m&eacute;todo que llamar&aacute; a 
<em>preparaUsuarioDNI</em> y luego ir&aacute; llamando a <em>getUsuarioDNI</em>, tal como 
se hace en la plantilla.</p>
<p>Como ejercicio optativo se propone hacer un m&eacute;todo para consultar los hoteles (y/o
vuelos) dentro de un rango de precios</p>
</div>

<a name="N10032"></a><a name="Funciones+almacenadas"></a>
<h2 class="underlined_10">Funciones almacenadas</h2>
<div class="section">
<p>Vamos a llamar a una funci&oacute;n creada disponible en MySQL. Primero es crear la funci&oacute;n 
en MySQL. Ejecutamos la aplicaci&oacute;n MySQL Administrator. Seleccionamos <em>Catalogs</em>
y seleccionamos nuestra base de datos, <em>viajes</em>. Seleccionamos la solapa 
<em>Stored Procedures</em> y pinchamos en el bot&oacute;n para crear un nuevo procedimiento. 
Le damos el nombre y le decimos que queremos crear una funci&oacute;n. Nos aparecer&aacute; un editor 
para introducir la definici&oacute;n de la funci&oacute;n. El c&oacute;digo a introducir es el siguiente:</p>
<pre class="code">
CREATE FUNCTION `miFunc`(pr int) RETURNS int(11)
BEGIN
    declare a int;
    select count(*) into a from hotel count where precio&lt;pr;
    return a;
END
</pre>
<p>Esta funci&oacute;n devuelve el n&uacute;mero de hoteles cuyo precio es inferior al pasado por 
par&aacute;metro. Este ejercicio consiste en llamar a esta funci&oacute;n desde Java. Cread un 
m&eacute;todo en la clase <em>Consultas</em> que se llamar&aacute; <em>llamaFuncion()</em> que 
pedir&aacute; el precio a buscar y mostrar&aacute; el n&uacute;mero de hoteles cuyo precio sea inferior
al indicado. La llamada al procedimiento se tiene que realizar desde el DAO 
correspondiente.
</p>
</div>

<p class="pageBreakAfter"></p>

</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006-2007 Depto. CCIA</div>
</div>
</body>
</html>
