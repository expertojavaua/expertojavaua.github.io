<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Excepciones e hilos</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Java y Herramientas de Desarrollo" src="images/baner_j2ee_der.gif" title="Java y Herramientas de Desarrollo"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Java y Herramientas de Desarrollo</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Materiales</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Java y Herramientas de Desarrollo">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.2', 'skin/')" id="menu_selected_1.1.2Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Teor&iacute;a</div>
<div id="menu_selected_1.1.2" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 3</div>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-apuntes.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-apuntes.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-apuntes.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-apuntes.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.3', 'skin/')" id="menu_1.1.3Title" class="menutitle">Ejercicios</div>
<div id="menu_1.1.3" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-ejercicios.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-ejercicios.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-ejercicios.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-ejercicios.html">Sesion 8</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion03-apuntes.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Excepciones e hilos</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Excepciones">Excepciones</a>
<ul class="minitoc">
<li>
<a href="#Tipos+de+excepciones">Tipos de excepciones</a>
</li>
<li>
<a href="#Captura+de+excepciones">Captura de excepciones</a>
</li>
<li>
<a href="#Lanzamiento+de+excepciones">Lanzamiento de excepciones</a>
</li>
<li>
<a href="#Creaci%C3%B3n+de+nuevas+excepciones">Creaci&oacute;n de nuevas excepciones</a>
</li>
</ul>
</li>
<li>
<a href="#Hilos">Hilos</a>
<ul class="minitoc">
<li>
<a href="#Creaci%C3%B3n+de+hilos">Creaci&oacute;n de hilos</a>
</li>
<li>
<a href="#Estado+y+propiedades+de+los+hilos">Estado y propiedades de los hilos</a>
</li>
<li>
<a href="#Sincronizaci%C3%B3n+de+hilos">Sincronizaci&oacute;n de hilos</a>
</li>
<li>
<a href="#Grupos+de+hilos">Grupos de hilos</a>
</li>
</ul>
</li>
</ul>
</div>

	
<a name="N1000C"></a><a name="Excepciones"></a>
<h2 class="underlined_10">Excepciones</h2>
<div class="section">
<p>Las excepciones son eventos que ocurren durante la ejecuci&oacute;n de un programa 
		y hacen que &eacute;ste salga de su flujo normal de instrucciones. Este mecanismo 
		permite tratar los errores de una forma elegante, ya que separa el c&oacute;digo 
		para el tratamiento de errores del c&oacute;digo normal del programa. Se 
		dice que una excepci&oacute;n es <em>lanzada</em> cuando se produce un error, 
		y esta excepci&oacute;n puede ser <em>capturada</em> para tratar dicho error.</p>
<a name="N1001B"></a><a name="Tipos+de+excepciones"></a>
<h3 class="underlined_5">Tipos de excepciones</h3>
<p>Tenemos diferentes tipos de excepciones dependiendo del tipo de error que representen. 
		Todas ellas descienden de la clase <span class="codefrag">Throwable</span>, la cual tiene dos 
		descendientes directos:</p>
<ul>
		
<li> 
<strong><span class="codefrag">Error</span></strong>: Se refiere a errores graves en la m&aacute;quina 
			virtual de Java, como por ejemplo fallos al enlazar con alguna librer&iacute;a. 
			Normalmente en los programas Java no se tratar&aacute;n este tipo de errores.</li>
		
<li>
<strong><span class="codefrag">Exception</span></strong>: Representa errores que no son cr&iacute;ticos y 
			por lo tanto pueden ser tratados y continuar la ejecuci&oacute;n de la aplicaci&oacute;n. 
			La mayor&iacute;a de los programas Java utilizan estas excepciones para el 
			tratamiento de los errores que puedan ocurrir durante la ejecuci&oacute;n 
			del c&oacute;digo.</li>
		
	
</ul>
<p>Dentro de <span class="codefrag">Exception</span>, cabe destacar una subclase especial de excepciones 
		denominada <span class="codefrag">RuntimeException</span>, de la cual derivar&aacute;n todas 
		aquellas excepciones referidas a los errores que com&uacute;nmente se pueden 
		producir dentro de cualquier fragmento de c&oacute;digo, como por ejemplo hacer 
		una referencia a un puntero <span class="codefrag">null</span>, o acceder fuera de los l&iacute;mites 
		de un <em>array</em>. </p>
<p>Estas <span class="codefrag">RuntimeException</span> se diferencian del resto de excepciones 
		en que no son de tipo <em>checked</em>. Una excepci&oacute;n de tipo <em>checked</em> 
		debe ser capturada o bien especificar que puede ser lanzada de forma obligatoria, 
		y si no lo hacemos obtendremos un error de compilaci&oacute;n. Dado que las 
		<span class="codefrag">RuntimeException</span> pueden producirse en cualquier fragmento de c&oacute;digo, 
		ser&iacute;a impensable tener que a&ntilde;adir manejadores de excepciones y 
		declarar que &eacute;stas pueden ser lanzadas en todo nuestro c&oacute;digo. 
		Deberemos:</p>
<ul>
		
<li>Utilizar excepciones <em> no-checked </em> (no predecibles) para indicar errores 
			graves en la l&oacute;gica del programa, que normalmente no deber&iacute;an ocurrir.</li>
		
<li>Utilizar excepciones <em> checked</em> para mostrar errores que pueden ocurrir 
			durante la ejecuci&oacute;n de la aplicaci&oacute;n, normalmente debidos a 
			factores externos como por ejemplo la lectura de un fichero con formato incorrecto 
			o un fallo en la conexi&oacute;n.</li>
		
	
</ul>
<p>   
	
<img alt="Tipos de excepciones" content-width="10cm" height="254" src="imagenes/desarrollo/excepcion.gif" width="491">
 </p>
<p>Dentro de estos grupos principales de excepciones podremos encontrar tipos 
			concretos de excepciones o bien otros grupos que a su vez pueden contener m&aacute;s 
			subgrupos de excepciones, hasta llegar a tipos concretos de ellas. Cada tipo 
			de excepci&oacute;n guardar&aacute; informaci&oacute;n relativa al tipo de error 
			al que se refiera, adem&aacute;s de la informaci&oacute;n com&uacute;n a todas 
			las excepciones. Por ejemplo, una <span class="codefrag">ParseException</span> se suele utilizar 
			al procesar un fichero. Adem&aacute;s de almacenar un mensaje de error, guardar&aacute; 
			la l&iacute;nea en la que el <em>parser</em> encontr&oacute; el error.</p>
<a name="N10078"></a><a name="Captura+de+excepciones"></a>
<h3 class="underlined_5">Captura de excepciones</h3>
<p>Cuando un fragmento de c&oacute;digo sea susceptible de lanzar una excepci&oacute;n 
			y queramos tratar el error producido o bien por ser una excepci&oacute;n de 
			tipo <em>checked</em> debamos capturarla, podremos hacerlo mediante la estructura 
			<span class="codefrag">try-catch-finally</span>, que consta de tres bloques de c&oacute;digo:</p>
<ul>
			
<li> Bloque <span class="codefrag">try</span>: Contiene el c&oacute;digo regular de nuestro programa 
				que puede producir una excepci&oacute;n en caso de error.</li>
			
			
<li>Bloque <span class="codefrag">catch</span>: Contiene el c&oacute;digo con el que trataremos 
				el error en caso de producirse.</li>
			
<li>Bloque <span class="codefrag">finally</span>: Este bloque contiene el c&oacute;digo que se 
				ejecutar&aacute; al final tanto si se ha producido una excepci&oacute;n como 
				si no lo ha hecho. Este bloque se utiliza para, por ejemplo, cerrar alg&uacute;n 
				fichero que haya podido ser abierto dentro del c&oacute;digo regular del programa, 
				de manera que nos aseguremos que tanto si se ha producido un error como si 
				no este fichero se cierre. El bloque <span class="codefrag">finally</span> no es obligatorio 
				ponerlo.</li>
			
		
</ul>
<p>Para el bloque <span class="codefrag">catch</span> adem&aacute;s deberemos especificar el tipo 
			o grupo de excepciones que tratamos en dicho bloque, pudiendo incluir varios 
			bloques <span class="codefrag">catch</span>, cada uno de ellos para un tipo/grupo de excepciones 
			distinto. La forma de hacer esto ser&aacute; la siguiente:</p>
<pre class="code">
<strong>try</strong> {
	// C&oacute;digo regular del programa
	// Puede producir excepciones
} <strong>catch(TipoDeExcepcion1 e1)</strong> {
	// C&oacute;digo que trata las excepciones de tipo 
	// TipoDeExcepcion1 o subclases de ella.
	// Los datos sobre la excepci&oacute;n los encontraremos 
	// en el objeto e1.
} <strong>catch(TipoDeExcepcion2 e2)</strong> {	
	// C&oacute;digo que trata las excepciones de tipo 
	// TipoDeExcepcion2 o subclases de ella.
	// Los datos sobre la excepci&oacute;n los encontraremos 
	// en el objeto e2.
...
} <strong>catch(TipoDeExcepcionN eN)</strong> {
	// C&oacute;digo que trata las excepciones de tipo 
	// TipoDeExcepcionN o subclases de ella.
	// Los datos sobre la excepci&oacute;n los encontraremos 
	// en el objeto eN.
} <strong>finally</strong> {
	// C&oacute;digo de finalizaci&oacute;n (opcional)
}</pre>
<p> Si como tipo de excepci&oacute;n especificamos un grupo de excepciones este 
			bloque se encargar&aacute; de la captura de todos los subtipos de excepciones 
			de este grupo. Por lo tanto, si especificamos <span class="codefrag">Exception</span> capturaremos 
			cualquier excepci&oacute;n, ya que est&aacute; es la superclase com&uacute;n 
			de todas las excepciones. </p>
<p> En el bloque <span class="codefrag">catch</span> pueden ser &uacute;tiles algunos m&eacute;todos de la excepci&oacute;n 
			(que podemos ver en la API de la clase padre <span class="codefrag">Exception</span>): </p>
<pre class="code">String getMessage()
void printStackTrace()</pre>
<p>con <span class="codefrag">getMessage</span> obtenemos una cadena descriptiva del error (si 
			la hay). Con <span class="codefrag">printStackTrace</span> se muestra por la salida est&aacute;ndar 
			la traza de errores que se han producido (en ocasiones la traza es muy larga 
			y no puede seguirse toda en pantalla con algunos sistemas operativos). </p>
<p>Un ejemplo de uso:
			
		</p>
<pre class="code">try {
	... // Aqui va el codigo que puede lanzar una excepcion
} catch (Exception e) {
	System.out.println ("El error es: " + e.getMessage());
	e.printStackTrace();
}</pre>
<p>Nunca deberemos dejar vac&iacute;o el cuerpo del <span class="codefrag">catch</span>, porque si se 
			produce el error, nadie se va a dar cuenta de que se ha producido. En especial, 
			cuando estemos con excepciones <em>no-checked</em>.</p>
<a name="N100E7"></a><a name="Lanzamiento+de+excepciones"></a>
<h3 class="underlined_5">Lanzamiento de excepciones</h3>
<p>Hemos visto c&oacute;mo capturar excepciones que se produzcan en el c&oacute;digo, 
			pero en lugar de capturarlas tambi&eacute;n podemos hacer que se propaguen al 
			m&eacute;todo de nivel superior (desde el cual se ha llamado al m&eacute;todo actual). Para esto,
			en el m&eacute;todo donde se vaya a lanzar la excepci&oacute;n, se siguen 2 pasos:</p>
<ul>
			
<li>Indicar en el m&eacute;todo que determinados tipos 
				de excepciones o grupos de ellas pueden ser lanzados, cosa que haremos de la siguiente
				forma, por ejemplo:</li>
		
</ul>
<pre class="code">public void lee_fichero() 
	<strong>throws </strong>IOException, FileNotFoundException
{
	// Cuerpo de la funci&oacute;n
}</pre>
<p>Podremos indicar tantos tipos de excepciones como queramos en la cla&uacute;sula 
				<span class="codefrag">throws</span>. Si alguna de estas clases de excepciones tiene subclases, 
				tambi&eacute;n se considerar&aacute; que puede lanzar todas estas subclases.</p>
<ul>
			
<li> Para lanzar la excepci&oacute;n utilizamos la instrucci&oacute;n <span class="codefrag">throw</span>, 
				proporcion&aacute;ndole un objeto correspondiente al tipo de excepci&oacute;n 
				que deseamos lanzar. Por ejemplo:</li>
		
</ul>
<pre class="code">
<strong>throw</strong> new IOException(mensaje_error);</pre>
<ul>
			
<li>Juntando estos dos pasos:</li>
		
</ul>
<pre class="code">public void lee_fichero() 
	<strong>throws </strong>IOException, FileNotFoundException
{
	...
	throw new IOException(mensaje_error);
	...
}</pre>
<p>Podremos lanzar as&iacute; excepciones en nuestras funciones para indicar que algo 
			no es como debiera ser a las funciones llamadoras. Por ejemplo, si estamos procesando 
			un fichero que debe tener un determinado formato, ser&iacute;a buena idea lanzar 
			excepciones de tipo <span class="codefrag">ParseException</span> en caso de que la sintaxis del 
			fichero de entrada no sea correcta.&nbsp;</p>
<p>NOTA: para las excepciones que no son de tipo <em> checked</em> no har&aacute; falta
			la cl&aacute;usula <em>throws</em> en la declaraci&oacute;n del m&eacute;todo, pero seguir&aacute;n el mismo comportamiento que el resto, si 
			no son capturadas pasar&aacute;n al m&eacute;todo de nivel superior, y seguir&aacute;n 
			as&iacute; hasta llegar a la funci&oacute;n principal, momento en el que si 
			no se captura provocar&aacute; la salida de nuestro programa mostrando el error 
			correspondiente.</p>
<a name="N1012E"></a><a name="Creaci%C3%B3n+de+nuevas+excepciones"></a>
<h3 class="underlined_5">Creaci&oacute;n de nuevas excepciones</h3>
<p>Adem&aacute;s de utilizar los tipos de excepciones contenidos en la distribuci&oacute;n 
			de Java, podremos crear nuevos tipos que se adapten a nuestros problemas.</p>
<p>Para crear un nuevo tipo de excepciones simplemente deberemos crear una clase 
			que herede de <span class="codefrag">Exception</span> o cualquier otro subgrupo de excepciones 
			existente. En esta clase podremos a&ntilde;adir m&eacute;todos y propiedades 
			para almacenar informaci&oacute;n relativa a nuestro tipo de error. Por ejemplo:</p>
<pre class="code">public class MiExcepcion extends Exception
{
	public MiExcepcion (String mensaje)
	{
		super(mensaje);
	}
}</pre>
<p>Adem&aacute;s podremos crear subclases de nuestro nuevo tipo de excepci&oacute;n, 
			creando de esta forma grupos de excepciones. Para utilizar estas excepciones 
			(capturarlas y/o lanzarlas) hacemos lo mismo que lo explicado antes para las 
			excepciones que se tienen definidas en Java.</p>
</div>

<a name="N10146"></a><a name="Hilos"></a>
<h2 class="underlined_10">Hilos</h2>
<div class="section">
<p>Un hilo es un flujo de control dentro de un programa. Creando varios hilos 
			podremos realizar varias tareas simult&aacute;neamente. Cada hilo tendr&aacute; 
			s&oacute;lo un contexto de ejecuci&oacute;n (contador de programa, pila de ejecuci&oacute;n). 
			Es decir, a diferencia de los procesos UNIX, no tienen su propio espacio de 
			memoria sino que acceden todos al mismo espacio de memoria com&uacute;n, por 
			lo que ser&aacute; importante su sincronizaci&oacute;n cuando tengamos varios 
			hilos accediendo a los mismos objetos.</p>
<a name="N1014F"></a><a name="Creaci%C3%B3n+de+hilos"></a>
<h3 class="underlined_5">Creaci&oacute;n de hilos</h3>
<p>En Java los hilos est&aacute;n encapsulados en la clase <span class="codefrag">Thread</span>. 
			Para crear un hilo tenemos dos posibilidades:</p>
<ul>
			
<li>Heredar de <span class="codefrag">Thread</span> redefiniendo el m&eacute;todo <span class="codefrag">run</span>.</li>
			
			
<li>Crear una clase que implemente la interfaz <span class="codefrag">Runnable</span> que nos 
				obliga a definir el m&eacute;todo <span class="codefrag">run</span>.</li>
		
</ul>
<p>En ambos casos debemos definir un m&eacute;todo <span class="codefrag">run</span> que ser&aacute; 
			el que contenga el c&oacute;digo del hilo. Desde dentro de este m&eacute;todo 
			podremos llamar a cualquier otro m&eacute;todo de cualquier objeto, pero este 
			m&eacute;todo <span class="codefrag">run</span> ser&aacute; el m&eacute;todo que se invoque cuando 
			iniciemos la ejecuci&oacute;n de un hilo. El hilo terminar&aacute; su ejecuci&oacute;n 
			cuando termine de ejecutarse este m&eacute;todo <span class="codefrag">run</span>.</p>
<p>Para crear nuestro hilo mediante herencia haremos lo siguiente:</p>
<pre class="code">public class EjemploHilo extends <strong>Thread</strong>
{
	public void <strong>run</strong>() {
		// C&oacute;digo del hilo
	}
}</pre>
<p>Una vez definida la clase de nuestro hilo deberemos instanciarlo y ejecutarlo 
			de la siguiente forma:</p>
<pre class="code">
<strong>Thread</strong> t = new EjemploHilo();
t.<strong>start</strong>();</pre>
<p>Crear un hilo heredando de <span class="codefrag">Thread</span> tiene el problema de que al 
			no haber herencia m&uacute;ltiple en Java, si heredamos de <span class="codefrag">Thread</span> 
			no podremos heredar de ninguna otra clase, y por lo tanto un hilo no podr&iacute;a 
			heredar de ninguna otra clase.</p>
<p>Este problema desaparece si utilizamos la interfaz <span class="codefrag">Runnable</span> para 
			crear el hilo, ya que una clase puede implementar varios interfaces. Definiremos 
			la clase que contenga el hilo como se muestra a continuaci&oacute;n:</p>
<pre class="code">public class EjemploHilo implements <strong>Runnable</strong>
{
	public void <strong>run</strong>() {
		// C&oacute;digo del hilo
	}
}</pre>
<p>Para instanciar y ejecutar un hilo de este tipo deberemos hacer lo siguiente:</p>
<pre class="code">
<strong>Thread</strong> t = new <strong>Thread</strong>(new EjemploHilo());
t.<strong>start</strong>();</pre>
<p>Esto es as&iacute; debido a que en este caso <span class="codefrag">EjemploHilo</span> no deriva 
			de una clase <span class="codefrag">Thread</span>, por lo que no se puede considerar un hilo, 
			lo &uacute;nico que estamos haciendo implementando la interfaz es asegurar que 
			vamos a tener definido el m&eacute;todo <span class="codefrag">run</span>. Con esto lo que haremos 
			ser&aacute; proporcionar esta clase al constructor de la clase <span class="codefrag">Thread</span>, 
			para que el objeto <span class="codefrag">Thread</span> que creemos llame al m&eacute;todo <span class="codefrag">run</span> 
			de la clase que hemos definido al iniciarse la ejecuci&oacute;n del hilo, ya 
			que implementando la interfaz le aseguramos que esta funci&oacute;n existe.</p>
<p>Deberemos utilizar s&oacute;lo los hilos necesarios. Se utilizar&aacute;n: </p>
<ul>
			
<li> Cuando la aplicaci&oacute;n debe responder a varios eventos simult&aacute;neamente.</li>
			
<li>Para aumentar la capacidad de respuesta (que se pueda responder al usuario 
				incluso cuando la aplicaci&oacute;n est&eacute; realizando otras tareas).</li>
			
<li>Para aprovechar las m&aacute;quinas con m&uacute;ltiples procesadores.</li>
		
</ul>
<a name="N101E2"></a><a name="Estado+y+propiedades+de+los+hilos"></a>
<h3 class="underlined_5">Estado y propiedades de los hilos</h3>
<p>Un hilo pasar&aacute; por varios estados durante su ciclo de vida. </p>
<pre class="code">
<strong>Thread</strong> t = new Thread(this);</pre>
<p>Una vez se ha instanciado el objeto del hilo, diremos que est&aacute; en estado 
			de <em> Nuevo hilo</em>.</p>
<pre class="code">t.<strong>start</strong>();</pre>
<p>Cuando invoquemos su m&eacute;todo <span class="codefrag">start</span> el hilo pasar&aacute; 
			a ser un hilo <em>vivo</em>, comenz&aacute;ndose a ejecutar su m&eacute;todo <span class="codefrag">run</span>. 
			Una vez haya salido de este m&eacute;todo pasar&aacute; a ser un hilo <em>muerto</em>.</p>
<p>La &uacute;nica forma de parar un hilo es hacer que salga del m&eacute;todo 
			<span class="codefrag">run</span> de forma natural. Podremos conseguir esto haciendo que se cumpla 
			la condici&oacute;n de salida del bucle principal definido dentro del <span class="codefrag">run</span>. 
			Las funciones para parar, pausar y reanudar hilos est&aacute;s desaprobadas 
			en las versiones actuales de Java.</p>
<p>Mientras el hilo est&eacute; <em>vivo</em>, podr&aacute; encontrarse en dos estados: 
			<em> Ejecutable</em> y <em> No ejecutable</em>. El hilo pasar&aacute; de <em> Ejecutable</em> 
			a <em> No ejecutable</em> en los siguientes casos:</p>
<ul>
			
<li>Cuando se encuentre dormido por haberse llamado al m&eacute;todo <span class="codefrag">sleep</span>, 
				permanecer&aacute; <em> No ejecutable</em> hasta haber transcurrido el n&uacute;mero 
				de milisegundos especificados.</li>
			
<li>Cuando se encuentre bloqueado en una llamada al m&eacute;todo <span class="codefrag">wait</span> 
				esperando que otro hilo lo desbloquee llamando a <span class="codefrag">notify</span> o <span class="codefrag">notifyAll</span>.</li>
			
			
<li>Cuando se encuentre bloqueado en una petici&oacute;n de E/S, hasta que se 
				complete la operaci&oacute;n de E/S.</li>
		
</ul>
<p>   
		
<img alt="Ciclo de vida de los hilos" content-width="8cm" height="154" src="imagenes/desarrollo/3-2.gif" width="405">
 </p>
<p>Lo &uacute;nico que podremos saber es si un hilo se encuentra vivo o no, llamando 
				a su m&eacute;todo <span class="codefrag">isAlive</span>.</p>
<p>Adem&aacute;s, una propiedad importante de los hilos ser&aacute; su prioridad. 
				Mientras el hilo se encuentre vivo, el <em> scheduler</em> de la m&aacute;quina 
				virtual Java le asignar&aacute; o lo sacar&aacute; de la CPU, coordinando as&iacute; 
				el uso de la CPU por parte de todos los hilos activos bas&aacute;ndose en su 
				prioridad. Se puede forzar la salida de un hilo de la CPU llamando a su m&eacute;todo 
				<span class="codefrag">yield</span>. Tambi&eacute;n se sacar&aacute; un hilo de la CPU cuando 
				un hilo de mayor prioridad se haga <em>Ejecutable</em>, o cuando el tiempo que 
				se le haya asignado expire.</p>
<p>Para cambiar la prioridad de un hilo se utiliza el m&eacute;todo <span class="codefrag">setPriority</span>, 
				al que deberemos proporcionar un valor de prioridad entre <span class="codefrag">MIN_PRIORITY</span> 
				y <span class="codefrag">MAX_PRIORITY</span>.</p>
<a name="N1026C"></a><a name="Sincronizaci%C3%B3n+de+hilos"></a>
<h3 class="underlined_5">Sincronizaci&oacute;n de hilos</h3>
<p>Muchas veces los hilos deber&aacute;n trabajar de forma coordinada, por lo 
				que es necesario un mecanismo de sincronizaci&oacute;n entre ellos.</p>
<p>
<strong>Secci&oacute;n cr&iacute;tica</strong>
</p>
<p>Hablamos de secci&oacute;n cr&iacute;tica para referirnos al fragmento de c&oacute;digo 
				que no debe ser ejecutado por m&aacute;s de un hilo de forma concurrente. Un 
				primer mecanismo de sincronizaci&oacute;n es la variable cerrojo incluida en 
				todo objeto <span class="codefrag">Object</span>, que permitir&aacute; evitar que m&aacute;s 
				de un hilo entre en la secci&oacute;n cr&iacute;tica. Los m&eacute;todos declarados 
				como <span class="codefrag">synchronized</span> utilizan el cerrojo del objeto al que pertenecen 
				evitando que m&aacute;s de un hilo entre en ellos al mismo tiempo.</p>
<pre class="code">public <strong>synchronized</strong> void seccion_critica()
{
	// C&oacute;digo secci&oacute;n cr&iacute;tica
}</pre>
<p>Tambi&eacute;n podemos utilizar cualquier otro objeto para la sincronizaci&oacute;n 
				dentro de nuestro m&eacute;todo de la siguiente forma:</p>
<pre class="code">
<strong>synchronized</strong> (objeto_con_cerrojo) 
{
	// C&oacute;digo secci&oacute;n cr&iacute;tica
}</pre>
<p>De esta forma estaremos utilizando el cerrojo del objeto especificado. Si dos 
				hilos intentan entrar de forma concurrente en un bloque de c&oacute;digo sincronizado 
				con un mismo objeto, el segundo de ellos quedar&aacute; bloqueado hasta que 
				el primero libere el cerrojo (salga de dicho bloque de c&oacute;digo).</p>
<p>Deberemos:</p>
<ul>
				
<li>Utilizar sincronizaci&oacute;n s&oacute;lo cuando sea realmente necesario.</li>
				
<li>No sincronizar clases que proporcionen datos fundamentales, dejar que el 
					usuario decida cu&aacute;ndo sincronizarlas en sus propias clases</li>
				
<li>No sincronizar un m&eacute;todo si contiene un n&uacute;mero elevado de operaciones que 
					no necesitan sincronizaci&oacute;n (reorganizar el m&eacute;todo en varios, en ese caso). 
					Se trata de minimizar el tiempo de bloqueo de hilos a lo estrictamente necesario</li>
				
				
<li>Las asignaciones simples de tipos de datos se garantiza que ser&aacute;n at&oacute;micas 
					(o se completan o se quedan como al principio). No es necesario sincronizarlas, 
					s&oacute;lo se sincronizar&aacute;n cuando haya varias asignaciones seguidas que sean interdependientes</li>
			
</ul>
<p>
<strong>Espera y notificaci&oacute;n</strong>
</p>
<p>Adem&aacute;s podemos hacer que un hilo quede bloqueado a la espera de que 
				otro hilo lo desbloquee cuando suceda un determinado evento. Para bloquear un 
				hilo usaremos la funci&oacute;n <span class="codefrag">wait</span>, para lo cual el hilo que 
				llama a esta funci&oacute;n debe estar en posesi&oacute;n del monitor, cosa 
				que ocurre dentro de un m&eacute;todo <span class="codefrag">synchronized</span>, por lo que 
				s&oacute;lo podremos bloquear a un proceso dentro de estos m&eacute;todos. </p>
<p>Para desbloquear a los hilos que haya bloqueados se utilizar&aacute; <span class="codefrag">notifyAll</span>, 
				o bien <span class="codefrag">notify</span> para desbloquear s&oacute;lo uno de ellos aleatoriamente. 
				Para invocar estos m&eacute;todos ocurrir&aacute; lo mismo, el hilo deber&aacute; 
				estar en posesi&oacute;n del monitor.</p>
<p>Cuando un hilo queda bloqueado liberar&aacute; el cerrojo para que otro hilo 
				pueda entrar en la secci&oacute;n cr&iacute;tica y desbloquearlo.</p>
<p>Deberemos utilizar <span class="codefrag">notifyAll</span> s&oacute;lo cuando los hilos est&eacute;n esperando 
				por varias condiciones, o cuando varios hilos puedan seguir ejecutando a partir 
				de dicho <span class="codefrag">notifyAll</span>. Para lo dem&aacute;s, utilizar <span class="codefrag">notify</span>, 
				porque es m&aacute;s eficiente.</p>
<p>
<strong>Esperar la finalizaci&oacute;n de un hilo</strong>
</p>
<p>Por &uacute;ltimo, puede ser necesario esperar a que un determinado hilo haya 
				finalizado su tarea para continuar. Esto lo podremos hacer llamando al m&eacute;todo 
				<span class="codefrag">join</span> de dicho hilo, que nos bloquear&aacute; hasta que el hilo 
				haya finalizado.</p>
<a name="N102D7"></a><a name="Grupos+de+hilos"></a>
<h3 class="underlined_5">Grupos de hilos</h3>
<p>Los grupos de hilos nos permitir&aacute;n crear una serie de hilos y manejarlos 
				todos a la vez como un &uacute;nico objeto. Si al crear un hilo no se especifica 
				ning&uacute;n grupo de hilos, el hilo creado pertenecer&aacute; al grupo de 
				hilos por defecto.</p>
<p>Podemos crearnos nuestro propio grupo de hilos instanciando un objeto de la 
				clase <span class="codefrag">ThreadGroup</span>. Para crear hilos dentro de este grupo deberemos 
				pasar este grupo al constructor de los hilos que creemos.</p>
<pre class="code">
<strong>ThreadGroup</strong> grupo = new <strong>ThreadGroup</strong>("Grupo de hilos");
<strong>Thread</strong> t = new <strong>Thread</strong>(grupo,new EjemploHilo());</pre>
<p>&nbsp;</p>
</div>


<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006 Depto. CCIA</div>
</div>
</body>
</html>
