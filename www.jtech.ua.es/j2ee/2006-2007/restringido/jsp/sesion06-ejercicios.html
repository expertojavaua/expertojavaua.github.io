<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de JSP B&aacute;sico</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Servlets y JSP" src="images/baner_j2ee_der.gif" title="Servlets y JSP"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Servlets y JSP</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Servlets y JSP</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Servlets y JSP">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-apuntes.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-apuntes.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-apuntes.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-apuntes.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="sesion09-apuntes.html">Sesion 9</a>
</div>
<div class="menuitem">
<a href="sesion10-apuntes.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-apuntes.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-apuntes.html">Sesion 12</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-ejercicios.html">Sesion 5</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 6</div>
</div>
<div class="menuitem">
<a href="sesion07-ejercicios.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-ejercicios.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="sesion09-ejercicios.html">Sesion 9</a>
</div>
<div class="menuitem">
<a href="sesion10-ejercicios.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-ejercicios.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-ejercicios.html">Sesion 12</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion06-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de JSP B&aacute;sico</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Conversor+JSP">Conversor JSP</a>
</li>
<li>
<a href="#Contador+de+visitas">Contador de visitas</a>
</li>
<li>
<a href="#Chat+con+JSPs">Chat con JSPs</a>
</li>
<li>
<a href="#Identificador+del+usuario+%28*%29">Identificador del usuario (*)</a>
</li>
</ul>
</div>


<a name="N1000C"></a><a name="Conversor+JSP"></a>
<h2 class="underlined_10">Conversor JSP</h2>
<div class="section">
<p>Crear una versi&oacute;n JSP de la aplicaci&oacute;n conversor que ten&iacute;ais
en el tema de servidores web. La aplicaci&oacute;n ser&aacute; una &uacute;nica p&aacute;gina JSP a la que:</p>
<ul>

<li>Si se le llama sin que exista un parametro HTTP <span class="codefrag">numero</span>, mostrar&aacute;
el formulario para introducir la cantidad de euros</li>

<li>Si se la llama con un par&aacute;metro  HTTP <span class="codefrag">numero</span> tomar&aacute; el valor del
par&aacute;metro, realizar&aacute; la conversi&oacute;n euros/pesetas y la mostrar&aacute; en pantalla.</li>

</ul>
<p>
Una vez realizada la parte b&aacute;sica, a&ntilde;adirle tratamiento de errores, de manera
que si se produce una excepci&oacute;n en la p&aacute;gina <span class="codefrag">conversor.jsp</span> se salte a la
p&aacute;gina de error, <span class="codefrag">error.jsp</span> (que tambi&eacute;n deb&eacute;is crear). En caso de que la cantidad que
representa el par&aacute;metro <span class="codefrag">numero</span> sea negativa lanzar una excepcion
con el mensaje de error deseado (<span class="codefrag">throw new Exception("La cantidad no es correcta")</span>). Imprimir dicho mensaje desde la p&aacute;gina de error.
</p>
</div>

<a name="N10034"></a><a name="Contador+de+visitas"></a>
<h2 class="underlined_10">Contador de visitas</h2>
<div class="section">
<p>Crear un fragmento de c&oacute;digo JSP que sirva 
como contador de visitas. El objetivo es poder incluir este c&oacute;digo 
en otras p&aacute;ginas JSP, por lo que no es necesario (ni conveniente) 
que sea una p&aacute;gina web completa, sino solo el texto del contador. Este
debe aparecer con texto HTML en negrita similar al siguiente</p>
<p>

<strong> Esta p&aacute;gina ha sido visitada X veces </strong>

</p>
<p>
Valorar si ser&iacute;a m&aacute;s conveniente emplear la directiva <span class="codefrag">include</span> 
o la acci&oacute;n del mismo nombre. El c&oacute;digo debe poder incluirse en distintas p&aacute;ginas de
forma que cada una tenga un contador propio.
</p>
<p>
<strong>(*)</strong> Una vez se tenga funcionando el contador b&aacute;sico, mejorarlo haciendo que 
    el n&uacute;mero de visitas se conserve, aunque el servidor se apague o se descargue 
    el JSP de la memoria. Para ello, tener en cuenta que:</p>
<ul>
    
<li>El n&uacute;mero de visitas se puede guardar en un fichero con el nombre 
      de la p&aacute;gina. Para simplificar, se puede suponer que en la p&aacute;gina principal
	  se define una variable "nombrePag" de tipo String con el nombre del fichero.
	  No obstante, este se podr&iacute;a obtener a partir del m&eacute;todo <span class="codefrag">getRequestURI()</span> 
      del objeto impl&iacute;cito <span class="codefrag">request</span> (este m&eacute;todo devuelve 
      la URI completa de la p&aacute;gina actual, de la que habr&aacute; que extraer 
      el nombre del fichero).
      <div class="frame note">
<div class="label">Nota</div>
<div class="content">S&oacute;lo tenemos acceso al objeto <span class="codefrag">request</span> una vez realizada
      una petici&oacute;n, por lo que no podremos utilizarlo desde el m&eacute;todo <span class="codefrag">jspInit</span>. En su 
      lugar podr&iacute;amos utilizar, por ejemplo, el nombre de la clase actual.</div>
</div>
      
</li>
    
<li>Habr&aacute; que sobreescribir los m&eacute;todos <span class="codefrag">public void jspInit()</span> 
      y <span class="codefrag">public void jspDestroy()</span>, que se ejecutan, respectivamente, 
      cuando la p&aacute;gina se carga por primera vez y cuando se destruye por falta 
      de memoria o porque se apaga el servidor. Al llamar a <span class="codefrag">jspDestroy</span> 
      se debe guardar el n&uacute;mero de visitas en el fichero, y cargarlo cuando 
      se realice el <span class="codefrag">jspInit</span>.</li>
  
</ul>
</div>

<a name="N10074"></a><a name="Chat+con+JSPs"></a>
<h2 class="underlined_10">Chat con JSPs</h2>
<div class="section">
<p>En la sesi&oacute;n anterior implementamos un chat con <em>servlets</em>. Hemos visto que los JSP
son m&aacute;s adecuados para la presentaci&oacute;n. Por lo tanto, vamos a modificar el chat para que la lista
de mensajes sea generada por un JSP, en lugar de un <em>servlet</em>. Se pide:</p>
<p>
<em>a)</em> Crearemos un directorio <span class="codefrag">jsp</span> en la ra&iacute;z de la web al que no se deber&aacute; poder acceder directamente
desde el cliente. Para ello deberemos protegerlo utilizando seguridad declarativa y no daremos
acceso a usuarios de ning&uacute;n rol. Este directorio contendr&aacute; aquellos JSP que utilizan los servlets de la aplicaci&oacute;n
para presentar la informaci&oacute;n producida. Estos JSP ser&aacute;n: </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
  
<tr>
<th colspan="1" rowspan="1"></th><th colspan="1" rowspan="1"></th><th colspan="1" rowspan="1"></th><th colspan="1" rowspan="1"></th><th colspan="1" rowspan="1"></th>
</tr>
    
<tr>
     
<td colspan="1" rowspan="1">
      <span class="codefrag">listaMensajes.jsp</span>
     </td>
     <td colspan="4" rowspan="1">Mostrar&aacute; los mensajes publicados en el chat en forma de documento HTML. 
     Debe esperar recibir 
     un atributo <span class="codefrag">es.ua.jtech.jsp.sesion6.chat.mensajes</span> en el &aacute;mbito de la petici&oacute;n 
     (<span class="codefrag">request</span>), con la lista de mensajes publicados en el chat. </td>
   
</tr>
   
<tr>
     
<td colspan="1" rowspan="1">
      <span class="codefrag">error.jsp</span>
      </td>
     <td colspan="4" rowspan="1">Mostrar&aacute; un mensaje de error y permitir&aacute; volver a la p&aacute;gina de <em>login</em>. 
     Espera recibir un atributo <span class="codefrag">es.ua.jtech.jsp.sesion6.chat.error</span>
     en el &aacute;mbito de la petici&oacute;n (<span class="codefrag">request</span>), con el mensaje de error que
     deber&aacute; mostrar.</td>
   
</tr>

</table>
<p>
<em>b)</em> Implementar el JSP <span class="codefrag">listaMensajes.jsp</span>. Modificar el <em>servlet</em> <span class="codefrag">ListaMensajesServlet</span>
para que en lugar de generar el mismo el HTML, redirija mediante <span class="codefrag">forward</span> la petici&oacute;n al
JSP que acabamos de crear. En el <em>servlet</em> se deber&aacute; obtener la lista de mensajes y le deber&aacute;
pasar este objeto al JSP como atributo de la petici&oacute;n, como se ha descrito anteriormente. </p>
<p>
<em>c)</em> Implementar el JSP <span class="codefrag">error.jsp</span>. Modificar el <em>servlet</em> <span class="codefrag">EnviaMensajeServlet</span>
para que en lugar redirigir a <span class="codefrag">error.html</span> en caso de error, lo haga a <span class="codefrag">error.jsp</span>, pasando 
como atributo de la petici&oacute;n una cadena con el mensaje de error que deber&aacute; mostrar esta p&aacute;gina.</p>
</div>

<a name="N100F7"></a><a name="Identificador+del+usuario+%28*%29"></a>
<h2 class="underlined_10">Identificador del usuario (*)</h2>
<div class="section">
<p>Desarrollar c&oacute;digo 
  JSP (debe poderse incluir en cualquier p&aacute;gina) que muestre datos b&aacute;sicos 
  del usuario: <strong>IP</strong> desde donde se conecta y <strong>nombre</strong> de usuario (si 
  se ha autentificado en la aplicaci&oacute;n). El nombre de usuario se puede 
  obtener del m&eacute;todo <span class="codefrag">getRemoteUser()</span> en el objeto impl&iacute;cito 
  <span class="codefrag">request</span>. Se debe poder controlar de manera sencilla desde la p&aacute;gina 
  principal el color en que aparece la informaci&oacute;n. Incluir este c&oacute;digo 
  dentro de la p&aacute;gina <span class="codefrag">restringida.html</span> que ten&eacute;is en la 
  aplicaci&oacute;n seguridad incluida en las plantillas de la sesi&oacute;n.</p>
</div>

<p class="pageBreakAfter"></p>

</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006 Depto. CCIA</div>
</div>
</body>
</html>
