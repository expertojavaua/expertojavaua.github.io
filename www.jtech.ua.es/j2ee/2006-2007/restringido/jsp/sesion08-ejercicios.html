<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de introducci&oacute;n a las librer&iacute;as de tags</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Servlets y JSP" src="images/baner_j2ee_der.gif" title="Servlets y JSP"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Servlets y JSP</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Servlets y JSP</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Servlets y JSP">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-apuntes.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-apuntes.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-apuntes.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-apuntes.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="sesion09-apuntes.html">Sesion 9</a>
</div>
<div class="menuitem">
<a href="sesion10-apuntes.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-apuntes.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-apuntes.html">Sesion 12</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-ejercicios.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-ejercicios.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-ejercicios.html">Sesion 7</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 8</div>
</div>
<div class="menuitem">
<a href="sesion09-ejercicios.html">Sesion 9</a>
</div>
<div class="menuitem">
<a href="sesion10-ejercicios.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-ejercicios.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-ejercicios.html">Sesion 12</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion08-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de introducci&oacute;n a las librer&iacute;as de tags</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Configuraci%C3%B3n+de+librer%C3%ADas+de+tags">Configuraci&oacute;n de librer&iacute;as de tags</a>
</li>
<li>
<a href="#Registro+de+usuarios">Registro de usuarios</a>
</li>
<li>
<a href="#Listado+de+usuarios+y+otras+mejoras">Listado de usuarios y otras mejoras</a>
</li>
</ul>
</div>


<p>En la plantilla tenemos una aplicaci&oacute;n <strong>jsp-sesion8</strong> que va a almacenar en una base de datos <em>datosusuarios</em>, en su tabla <em>usuarios</em>, los datos de los usuarios que se registren. Para ello utilizaremos las librer&iacute;as de tags <em>request</em> y <em>dbtags</em> vistas en la parte te&oacute;rica.</p>
 

<a name="N1001E"></a><a name="Configuraci%C3%B3n+de+librer%C3%ADas+de+tags"></a>
<h2 class="underlined_10">Configuraci&oacute;n de librer&iacute;as de tags</h2>
<div class="section">
<p>Como primer ejercicio, vamos a configurar la aplicaci&oacute;n <strong>jsp-sesion8</strong> para poder trabajar con las librer&iacute;as:</p>
<ul>
		
<li>Tenemos los ficheros TLD de las librer&iacute;as (<em>dbtags.tld</em> y <em>request.tld</em>) en el directorio <em>WEB-INF</em> de la aplicaci&oacute;n (carpeta <em>web</em>)</li>
		
<li>Tenemos los ficheros JAR de las librer&iacute;as (<em>dbtags.jar</em> y <em>request.jar</em>) en el directorio <em>WEB-INF/lib</em> de la aplicaci&oacute;n (carpeta <em>web</em>)</li>
		
<li>Modificamos el fichero descriptor de la aplicaci&oacute;n (<em>web.xml</em>), a&ntilde;adi&eacute;ndole las etiquetas para que acepte las dos librer&iacute;as:</li>
	
</ul>
<pre class="code">&lt;taglib&gt;
	&lt;taglib-uri&gt;
	http://jakarta.apache.org/taglibs/request-1.0
	&lt;/taglib-uri&gt;
	&lt;taglib-location&gt;
	/WEB-INF/request.tld
	&lt;/taglib-location&gt;
&lt;/taglib&gt;

&lt;taglib&gt;
	&lt;taglib-uri&gt;
	http://jakarta.apache.org/taglibs/dbtags
	&lt;/taglib-uri&gt;
	&lt;taglib-location&gt;
	/WEB-INF/dbtags.tld
	&lt;/taglib-location&gt;
&lt;/taglib&gt;</pre>
</div>
           

<a name="N10056"></a><a name="Registro+de+usuarios"></a>
<h2 class="underlined_10">Registro de usuarios</h2>
<div class="section">
<p>Una vez tengamos la aplicaci&oacute;n configurada, construiremos dos p&aacute;ginas:</p>
<ul>
		
<li>
			
<p>Una p&aacute;gina <strong>form_registro.html<em> </em></strong>que contendr&aacute; un formulario con los siguientes campos de texto:</p>
			
<ul>
				
<li>
<em>nombre</em>: con el nombre del usuario</li>
				
<li>
<em>email</em>: con su correo electr&oacute;nico</li>
				
<li>
<em>login</em>: nick que utilizar&aacute; para entrar a la aplicaci&oacute;n</li>
				
<li>
<em>password</em>: con la contrase&ntilde;a para validarlo</li>
				
<li>
<em>telefono</em>: con el n&uacute;mero de tel&eacute;fono</li>
			
</ul>
		
</li>
		
<li>El formulario anterior tendr&aacute; un bot&oacute;n de <em>submit</em> que nos enviar&aacute; a una p&aacute;gina <strong>registro.jsp</strong>, que se encargar&aacute; de introducir los datos del usuario en la base de datos, tom&aacute;ndolos de los par&aacute;metros de la petici&oacute;n (utilizando la librer&iacute;a <em>request</em>), e introduci&eacute;ndolos en la base de datos (utilizando <em>dbtags</em>)</li>
	
</ul>
<p>La aplicaci&oacute;n mostrar&aacute; un mensaje indicando si los datos se han introducido correctamente, o ha habido alg&uacute;n error. Para comprobar si ha habido alg&uacute;n error al insertar, podemos buscar tras la inserci&oacute;n un registro con los datos insertados, y mostrar el mensaje de error si no existe:</p>
<pre class="code">&lt;%@ taglib uri="http://jakarta.apache.org/taglibs/request-1.0" prefix="req" %&gt;
&lt;%@ taglib uri="http://jakarta.apache.org/taglibs/dbtags" prefix="sql" %&gt;
...
&lt;sql:connection id="con1"&gt;
	...
&lt;/sql:connection&gt;

&lt;sql:statement id="s1" conn="con1"&gt;
	&lt;sql:query&gt;
		INSERT INTO usuarios(nombre, email...)
		VALUES 
		('&lt;req:parameter name="nombre"/&gt;',
		 '&lt;req:parameter name="email"/&gt;'...)
	&lt;/sql:query&gt;
	&lt;sql:execute/&gt;
&lt;/sql:statement&gt;

&lt;sql:statement id="s1" conn="con1"&gt;
	&lt;sql:query&gt;
		SELECT * FROM usuarios 
		WHERE nombre='&lt;req:parameter name="nombre"/&gt;' 
		AND email='&lt;req:parameter name="email"/&gt;' 
		AND ...
	&lt;/sql:query&gt;
	&lt;sql:resultSet id="rs1"&gt;&lt;/sql:resultSet&gt;
	&lt;sql:wasEmpty&gt;Error al insertar&lt;/sql:wasEmpty&gt;
	&lt;sql:wasNotEmpty&gt;...&lt;/sql:wasNotEmpty&gt;
&lt;/sql:statement&gt;

&lt;sql:closeConnection conn="con1"/&gt;
</pre>
<p>Si se produce un error al insertar, es probable que el servidor lance una excepci&oacute;n. Por ejemplo, en el caso de que intentemos introducir un nombre que ya existe. No es necesario que capturemos ese error. Se deja como optativo  comprobar, antes de insertar, si existe el nombre en la BD.</p>
<p>
<strong>Nota</strong>: En el directorio <span class="codefrag">db</span> se encuentra el <em>script</em> para la creaci&oacute;n de la BD.</p>
</div>


<a name="N100AE"></a><a name="Listado+de+usuarios+y+otras+mejoras"></a>
<h2 class="underlined_10">Listado de usuarios y otras mejoras</h2>
<div class="section">
<p>Sobre lo anterior, podemos realizar una p&aacute;gina <strong>listado.jsp</strong> que muestre un listado con los usuarios actualmente registrados</p>
<p>(*) Para cada uno, hacer que permita eliminarlo de la lista (se borrar&iacute;an sus datos de la base de datos), o modificar sus datos (mostrando en otra p&aacute;gina un formulario con sus datos para editarlos).</p>
</div>

<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006 Depto. CCIA</div>
</div>
</body>
</html>
