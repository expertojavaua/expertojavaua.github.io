<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>JSTL</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Servlets y JSP" src="images/baner_j2ee_der.gif" title="Servlets y JSP"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Servlets y JSP</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Servlets y JSP</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Servlets y JSP">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.2', 'skin/')" id="menu_selected_1.1.2Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Teor&iacute;a</div>
<div id="menu_selected_1.1.2" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-apuntes.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-apuntes.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-apuntes.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-apuntes.html">Sesion 8</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 9</div>
</div>
<div class="menuitem">
<a href="sesion10-apuntes.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-apuntes.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-apuntes.html">Sesion 12</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.3', 'skin/')" id="menu_1.1.3Title" class="menutitle">Ejercicios</div>
<div id="menu_1.1.3" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-ejercicios.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-ejercicios.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-ejercicios.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-ejercicios.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="sesion09-ejercicios.html">Sesion 9</a>
</div>
<div class="menuitem">
<a href="sesion10-ejercicios.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-ejercicios.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-ejercicios.html">Sesion 12</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion09-apuntes.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>JSTL</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Uso+de+JSTL">Uso de JSTL</a>
</li>
<li>
<a href="#La+librer%C3%ADa+Core">La librer&iacute;a Core</a>
<ul class="minitoc">
<li>
<a href="#Tags+de+prop%C3%B3sito+general">Tags de prop&oacute;sito general</a>
</li>
<li>
<a href="#Tags+de+control+de+flujo">Tags de control de flujo</a>
</li>
<li>
<a href="#Tags+de+manejo+de+URLs">Tags de manejo de URLs</a>
</li>
<li>
<a href="#Ejemplo">Ejemplo</a>
</li>
</ul>
</li>
<li>
<a href="#La+librer%C3%ADa+SQL">La librer&iacute;a SQL</a>
<ul class="minitoc">
<li>
<a href="#Etiquetas+de+la+librer%C3%ADa">Etiquetas de la librer&iacute;a</a>
</li>
<li>
<a href="#Ejemplo-N106FE">Ejemplo</a>
</li>
</ul>
</li>
<li>
<a href="#La+librer%C3%ADa+de+internacionalizaci%C3%B3n">La librer&iacute;a de internacionalizaci&oacute;n</a>
<ul class="minitoc">
<li>
<a href="#Etiquetas+de+la+librer%C3%ADa-N1073C">Etiquetas de la librer&iacute;a</a>
</li>
<li>
<a href="#Ejemplo-N107EE">Ejemplo</a>
</li>
</ul>
</li>
<li>
<a href="#La+librer%C3%ADa+XML+y+la+librer%C3%ADa+de+funciones">La librer&iacute;a XML y la librer&iacute;a de funciones</a>
</li>
</ul>
</div>


<p>
<strong>JSTL</strong> (<span class="codefrag">JavaServer Pages Standard Tag Library</span>) es una librer&iacute;a de tags est&aacute;ndar que encapsula, en forma de tags, muchas funcionalidades comunes en aplicaciones JSP, de forma que, en lugar que tener que recurrir a varias librer&iacute;as de tags de distintos distribuidores, s&oacute;lo necesitaremos tener presente esta librer&iacute;a que, adem&aacute;s, por el hecho de ser est&aacute;ndar, funciona de la misma forma en cualquier parte, y los contenedores pueden reconocerla y optimizar sus implementaciones. </p>

<p>JSTL permite realizar tareas como iteraciones, estructuras condicionales, tags de manipulaci&oacute;n de documentos XML, tags SQL, etc. Tambi&eacute;n introduce un lenguaje de expresiones que simplifica el desarrollo de las p&aacute;ginas, y proporciona un API para simplificar la configuraci&oacute;n de los tags JSTL y el desarrollo de tags personalizados que sean conformes a las convenciones de JSTL. </p>

<p>Se puede emplear JSTL a partir de la versi&oacute;n 2.3 de servlets, y 1.2 de JSP. Pod&eacute;is encontrar m&aacute;s informaci&oacute;n sobre JSTL en: </p>

<p>
<a href="http://java.sun.com/products/jsp/jstl">http://java.sun.com/products/jsp/jstl</a>
</p>
 

<a name="N1001F"></a><a name="Uso+de+JSTL"></a>
<h2 class="underlined_10">Uso de JSTL</h2>
<div class="section">
<p>JSTL contiene una gran variedad de tags que permiten hacer distintos tipos de tareas, subdivididas en &aacute;reas. As&iacute;, JSTL proporciona varios ficheros TLD, para describir cada una de las &aacute;reas que abarca, y dar as&iacute; a cada &aacute;rea su propio espacio de nombres.  </p>
<p>En la siguientes tablas se muestran las &aacute;reas cubiertas por JSTL (cada una con una librer&iacute;a): </p>
<p>
<strong>Librer&iacute;a EL:</strong> 
</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
		
<tr>
			
<th colspan="1" rowspan="1">AREA</th>
			<th colspan="1" rowspan="1">URI</th>
			<th colspan="1" rowspan="1">PREFIJO</th>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>Core</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/core</span></td>
			<td colspan="1" rowspan="1">c</td>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>XML</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/xml</span></td>
			<td colspan="1" rowspan="1">x</td>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>Internacionalizaci&oacute;n (I18N)</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/fmt</span></td>
			<td colspan="1" rowspan="1">fmt</td>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>SQL</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/sql</span></td>
			<td colspan="1" rowspan="1">sql</td>
		
</tr>
	
</table>
<p>
<strong>Librer&iacute;a RT:</strong>
</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
		
<tr>
			
<th colspan="1" rowspan="1">AREA</th>
			<th colspan="1" rowspan="1">URI</th>
			<th colspan="1" rowspan="1">PREFIJO</th>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>Core</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/core_rt</span></td>
			<td colspan="1" rowspan="1">c_rt</td>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>XML</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/xml_rt</span></td>
			<td colspan="1" rowspan="1">x_rt</td>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>Internacionalizaci&oacute;n (I18N)</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/fmt_rt</span></td>
			<td colspan="1" rowspan="1">fmt_rt</td>
		
</tr>
		
<tr>
			
<td colspan="1" rowspan="1"><strong>SQL</strong></td>
			<td colspan="1" rowspan="1"><span class="codefrag">http://java.sun.com/jsp/ jstl/sql_rt</span></td>
			<td colspan="1" rowspan="1">sql_rt</td>
		
</tr>
	
</table>
<p>Se tienen dos versiones de JSTL, aunque la utilidad de las librer&iacute;as es la misma para las dos:</p>
<ul>
		
<li>
<strong>Core</strong> se utiliza para funciones de prop&oacute;sito general (manejo de expresiones, sentencias de control de flujo, etc). </li>
		
<li>
<strong>XML</strong> se emplea para procesamiento de ficheros XML.</li>
		
<li>La librer&iacute;a de <strong>i</strong><strong>nternationalizaci&oacute;n</strong> se usa para dar soporte a p&aacute;ginas multilenguaje, y a multiformatos de n&uacute;meros, monedas, etc, en funci&oacute;n de la regi&oacute;n en que se tenga la aplicaci&oacute;n. </li>
		
<li>
<strong>SQL</strong> sirve para acceder y manipular bases de datos relacionales. </li>
	
</ul>
<p>El motivo de esta duplicaci&oacute;n de librer&iacute;as es que las librer&iacute;as EL son compatibles con el lenguaje de expresiones de JSP (inclu&iacute;do desde JSTL 1.0 en JSTL, y desde JSP 2.0 en todas las p&aacute;ginas JSP), y las librer&iacute;as RT son compatibles con los cl&aacute;sicos scriptlets <span class="codefrag">&lt;%=...%&gt;</span>. Esto quiere decir que las librer&iacute;as EL admitir&aacute;n lenguaje de expresiones en sus atributos, y las RT admitir&aacute;n scriptlets. Se mantiene este segundo grupo de librer&iacute;as por compatibilidad con versiones antiguas.</p>
<p>Las URIs y prefijos que se indican en la tabla pueden emplearse (aunque no es obligatorio) para utilizar las librer&iacute;as en nuestras aplicaciones.</p>
<p>
<strong>EJEMPLO</strong>
</p>
<p>Para utilizar, por ejemplo, los tags del &aacute;rea <span class="codefrag">core</span> en una p&aacute;gina JSP, seguimos pasos similares a los realizados para utilizar las librer&iacute;as de tags vistas anteriormente:</p>
<ul>
		
<li>
			
<p>Colocar al principio de cada p&aacute;gina JSP donde vayamos a utilizar la librer&iacute;a <span class="codefrag">core</span> la l&iacute;nea:</p>
			
<pre class="code">&lt;%@ taglib uri="/jstl-core" prefix="c" %&gt;</pre>
			
<p>donde la <span class="codefrag">uri</span> y el <span class="codefrag">prefix</span> tendr&aacute;n los valores que queramos darles, si bien la URI se recomienda que sea la indicada en las tablas superiores, para no tener que utilizar fichero TLD en nuestra aplicaci&oacute;n</p>
		
</li>
        
<li>
			
<p>Las librer&iacute;as JSTL vienen en dos versiones: los ficheros TLD para la librer&iacute;a JSTL-EL vienen nombrados como <span class="codefrag">prefix.tld</span> (siendo <span class="codefrag">prefix </span>el prefijo para la librer&iacute;a), y los de la librer&iacute;a JSTL-RT vienen nombrados como <span class="codefrag">prefix-rt.tld</span>. As&iacute;, por ejemplo, para indicar en el descriptor de despliegue (<span class="codefrag">web.xml</span>) que vamos a utilizar la librer&iacute;a de <span class="codefrag">core</span>, pondr&iacute;amos algo como:</p>

<pre class="code">&lt;taglib&gt; 
	&lt;taglib-uri&gt;/jstl-c&lt;/taglib-uri&gt; 
	&lt;taglib-location&gt;
	/WEB-INF/c.tld
	&lt;/taglib-location&gt; 
&lt;/taglib&gt;</pre>
			
<p>Si utilizamos las <span class="codefrag">uris</span> absolutas que se han indicado anteriormente, no tenemos que a&ntilde;adir este elemento <span class="codefrag">&lt;taglib&gt;</span>en el descriptor de despliegue. El contenedor JSP localiza autom&aacute;ticamente el TLD.</p>
		
</li>
        
<li>Finalmente, tenemos que tener accesible una implementaci&oacute;n de la librer&iacute;a que vamos a utilizar. Hay que copiar los ficheros JAR correspondientes en el directorio <span class="codefrag">WEB-INF/lib</span> de nuestra aplicaci&oacute;n, si el servidor web no las tiene directamente disponibles</li>
		
<li>
			
<p>Podemos utilizar las dos librer&iacute;as conjuntamente, como en este ejemplo, que utiliza las dos librer&iacute;as de internacionalizaci&oacute;n (prefijo <span class="codefrag">fmt</span>):</p>

<pre class="code">&lt;fmt:message key="clave"&gt;
	&lt;fmt:param value="${miParametro}"/&gt;
	&lt;fmt_rt:param value="&lt;%= miParametro %&gt;"/&gt;
&lt;/fmt:message&gt;</pre>
		
</li>
	
</ul>
</div>
           

<a name="N1017D"></a><a name="La+librer%C3%ADa+Core"></a>
<h2 class="underlined_10">La librer&iacute;a Core</h2>
<div class="section">
<p>Los tags <span class="codefrag">core</span> incluyen tags de prop&oacute;sito general. En esta librer&iacute;a se tienen etiquetas para: </p>
<ul>
		
<li>Funciones de prop&oacute;sito general: evaluar expresiones, establecer valores de par&aacute;metros, etc.</li>
		
<li>Funciones de control de flujo: condiciones para ejecutar unos bloques de c&oacute;digo u otro, iteradores, etc.</li>
		
<li>Funciones de acceso a URLs: para importar URLS en la p&aacute;gina actual, etc.</li>
	
</ul>
<p>Los tags de esta librer&iacute;a se presentan con el prefijo "<strong>c</strong>". </p>
<a name="N1019B"></a><a name="Tags+de+prop%C3%B3sito+general"></a>
<h3 class="underlined_5">Tags de prop&oacute;sito general</h3>
<p>
<strong>out</strong>
</p>
<p>El tag <strong>out</strong> eval&uacute;a el resultado de una expresi&oacute;n y lo pone en el objeto <span class="codefrag">JspWriter </span>actual. Es equivalente a la sintaxis <span class="codefrag">&lt;%= ... %&gt; </span>de JSP, y tambi&eacute;n a poner directamente una expresi&oacute;n <strong>${...}</strong> en su lugar, aunque admite algunos atributos adicionales.</p>
<p>SINTAXIS:</p>
<p>Dar el valor por defecto mediante un atributo <span class="codefrag">default</span>:</p>
<pre class="code">&lt;c:out value="valor" 
 [escapeXML="true|false"] 
 [default="valor"]/&gt;</pre>
<p>Dar el valor por defecto mediante el cuerpo del tag:</p>
<pre class="code">&lt;c:out value="valor" 
 [escapeXML="true|false"]&gt;
	Valor por defecto
&lt;/c:out&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>value</strong>: expresi&oacute;n que se tiene que evaluar.</li>
			
<li>
<strong>escapeXML</strong>: a <span class="codefrag">true</span> (valor por defecto) indica que los caracteres &lt;, &gt;, &amp;, ', " que haya en la cadena resultado se deben convertir a sus c&oacute;digos correspondientes (&amp;lt;, &amp;gt;, &amp;amp;, &amp;#039;, &amp;#034;, respectivamente).</li>
			
<li>
<strong>default</strong>: valor por defecto si el resultado es <span class="codefrag">null</span>. Se puede indicar por el atributo o por el cuerpo del tag.</li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:out value="${datos.ciudad}" 
 default="desconocida"/&gt;</pre>
<p>Sacar&iacute;a el valor del campo <span class="codefrag">ciudad</span> del objeto <span class="codefrag">datos</span>, o mostrar&iacute;a "<span class="codefrag">desconocida</span>" si dicho valor es nulo.</p>
<p>
<strong>set</strong>
</p>
<p>El tag <strong>set </strong>establece el valor de un atributo en cualquier campo JSP (<span class="codefrag">page, request, session, application</span>). Si el atributo no existe, se crea. </p>
<p>SINTAXIS:</p>
<p>Dar valor a una variable utilizando el atributo <span class="codefrag">value</span>:</p>
<pre class="code">&lt;c:set value="valor" var="variable" 
 [scope="page|request|session|application"]/&gt;</pre>
<p>Dar valor a una variable utilizando el cuerpo del tag:</p>
<pre class="code">&lt;c:set var="variable" 
 [scope="page|request|session|application"]&gt;
	Valor
&lt;/c:set&gt;</pre>
<p>Dar valor a una propiedad de un objeto utilizando el atributo <span class="codefrag">value</span>:</p>
<pre class="code">&lt;c:set value="valor" target="objeto" 
 property="propiedad"/&gt;</pre>
<p>Dar valor a una propiedad de un objeto utilizando el cuerpo del tag:</p>
<pre class="code">&lt;c:set target="objeto" property="propiedad"&gt;
	Valor
&lt;/c:set&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>value</strong>: valor que se asigna. Podemos dar el valor con este atributo o con el cuerpo del tag.</li>
			
<li>
<strong>var</strong>: variable a la que se asigna el valor.</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable a la que se asigna el valor.</li>
			
<li>
<strong>target</strong>: objeto al que se le modifica una propiedad. Debe ser un objeto JavaBeans con una propiedad <span class="codefrag">propiedad</span> que pueda establecerse, o un objeto <span class="codefrag">java.util.Map</span>.</li>
			
<li>
<strong>property</strong>: propiedad a la que se le asigna valor en el objeto <span class="codefrag">target</span>.</li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:set var="foo" value="2"/&gt;
...
&lt;c:out value="${foo}"/&gt;</pre>
<p>Asignar&iacute;a a la variable <span class="codefrag">foo</span> el valor "2", y luego mostrar&iacute;a el valor por pantalla.</p>
<p>
<strong>Otras Etiquetas</strong>
</p>
<p>Existen otras etiquetas, como <strong>remove</strong> o <strong>catch</strong>, que no se comentan aqu&iacute;.</p>
<a name="N1026B"></a><a name="Tags+de+control+de+flujo"></a>
<h3 class="underlined_5">Tags de control de flujo</h3>
<p>
<strong>if</strong>
</p>
<p>El tag <strong>if </strong>permite ejecutar su c&oacute;digo si se cumple la condici&oacute;n que contiene su atributo <span class="codefrag">test.</span>
</p>
<p>SINTAXIS:</p>
<p>Sin cuerpo:</p>
<pre class="code">&lt;c:if test="condicion" var="variable" 
 [scope="page|request|session|application"]/&gt;</pre>
<p>Con cuerpo:</p>
<pre class="code">&lt;c:if test="condicion" [var="variable"] 
 [scope="page|request|session|application"]&gt;
	Cuerpo
&lt;/c:if&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>test</strong>: condicion que debe cumplirse para ejecutar el <span class="codefrag">if</span>.</li>
			
<li>
<strong>var</strong>: variable donde se guarda el resultado de evaluar la expresi&oacute;n. El tipo de esta variable debe ser <span class="codefrag">Boolean</span>.</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable a la que se asigna el valor de la condici&oacute;n.</li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:if test="${visitas &gt; 1000}"&gt;
&lt;h1&gt;&iexcl;Mas de 1000 visitas!&lt;/h1&gt;
&lt;/c:if&gt;</pre>
<p>Sacar&iacute;a el mensaje "<span class="codefrag">&iexcl;Mas de 1000 visitas!</span>" si el contador <span class="codefrag">visitas</span> fuese mayor que 1000.</p>
<p>
<strong>choose</strong>
</p>
<p>El tag <strong>choose </strong>permite definir varios bloques de c&oacute;digo y ejecutar uno de ellos en funci&oacute;n de una condici&oacute;n<span class="codefrag">. </span>Dentro del <span class="codefrag">choose</span> puede haber espacios en blanco, una o varias etiquetas <strong>when</strong> y cero o una etiquetas <strong>otherwise</strong>.</p>
<p>El funcionamiento es el siguiente: se ejecutar&aacute; el c&oacute;digo de la primera etiqueta <strong>when </strong>que cumpla la condici&oacute;n de su atributo <strong>test</strong>. Si ninguna etiqueta <span class="codefrag">when</span> cumple su condici&oacute;n, se ejecutar&aacute; el c&oacute;digo de la etiqueta <strong>otherwise</strong> (esta etiqueta, si aparece, debe ser la &uacute;ltima hija de <span class="codefrag">choose</span>).</p>
<p>SINTAXIS:</p>
<pre class="code">&lt;c:choose&gt;
	&lt;c:when test="condicion1"&gt;
		codigo1
	&lt;/c:when&gt;
	&lt;c:when test="condicion2"&gt;
		codigo2
	&lt;/c:when&gt;
	...
	&lt;c:when test="condicionN"&gt;
		codigoN
	&lt;/c:when&gt;
	&lt;c:otherwise&gt;
		codigo
	&lt;/c:otherwhise&gt;
&lt;/c:choose&gt;</pre>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:choose&gt;
	&lt;c:when test="${a &lt; 0}"&gt;
	&lt;h1&gt;a menor que 0&lt;/h1&gt;
	&lt;/c:when&gt;
	&lt;c:when test="${a &gt; 10}"&gt;
	&lt;h1&gt;a mayor que 10&lt;/h1&gt;
	&lt;/c:when&gt;
	&lt;c:otherwise&gt;
	&lt;h1&gt;a entre 1 y 10&lt;/h1&gt;
	&lt;/c:otherwhise&gt;
&lt;/c:choose&gt;</pre>
<p>Sacar&iacute;a el mensaje "<span class="codefrag">a es menor que 0</span>" si la variable a es menor que 0, el mensaje "<span class="codefrag">a es mayor que 10</span>" si es mayor que 10, y el mensaje "<span class="codefrag">a esta entre 1 y 10</span>" si no se cumple ninguna de las dos anteriores.</p>
<p>
<strong>forEach</strong>
</p>
<p>El tag <strong>forEach </strong>permite repetir su c&oacute;digo recorriendo un conjunto de objetos, o durante un n&uacute;mero determinado de iteraciones.</p>
<p>SINTAXIS:</p>
<p>Para iterar sobre un conjunto de objetos:</p>
<pre class="code">&lt;c:forEach [var="variable"] items="conjunto" 
[varStatus="variableEstado"] [begin="comienzo"] 
[end="final"] [step="incremento"]&gt;
	codigo
&lt;/c:forEach&gt;</pre>
<p>Para iterar un determinado n&uacute;mero de veces:</p>
<pre class="code">&lt;c:forEach [var="variable"] 
 [varStatus="variableEstado"] begin="comienzo" 
 end="final" [step="incremento"]&gt;
	codigo
&lt;/c:forEach&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>var</strong>: variable donde guardar el elemento actual que se est&aacute; explorando en la iteraci&oacute;n. El tipo de este objeto depende del tipo de conjunto que se est&eacute; recorriendo.</li>
			
<li>
				
<p>
<strong>items</strong>: conjunto de elementos que recorre la iteraci&oacute;n. Pueden recorrerse varios tipos:</p>
				
<ul>
					
<li>
<strong>Array</strong>: tanto de tipos primitivos como de tipos complejos. Para los tipos primitivos, cada dato se convierte en su correspondiente <span class="codefrag">wrapper</span> (<span class="codefrag">Integer</span> para <span class="codefrag">int</span>, <span class="codefrag">Float</span> para <span class="codefrag">float</span>, etc)</li>
					
<li>
<strong>java.util.Collection</strong>: mediante el m&eacute;todo <span class="codefrag">iterator()</span> se obtiene el conjunto, que se procesa en el orden que devuelve dicho m&eacute;todo.</li>
					
<li>
<strong>java.util.Iterator</strong>
</li>
					
<li>
<strong>java.util.Enumeration</strong>
</li>
					
<li>
<strong>java.util.Map</strong>:el objeto del atributo <span class="codefrag">var</span> es entonces de tipo <span class="codefrag">Map.Entry</span>, y se obtiene un <span class="codefrag">Set</span> con los mapeos. Llamando al m&eacute;todo <span class="codefrag">iterator()</span> del mismo se obtiene el conjunto a recorrer.</li>
					
<li>
<strong>String</strong>: la cadena representa un conjunto de valores separados por comas, que se van recorriendo en el orden en que est&aacute;n.</li>
				
</ul>
			
</li>
			
<li>
<strong>varStatus</strong>: variable donde guardar el estado actual de la iteraci&oacute;n. Es del tipo <span class="codefrag">javax.servlet.jsp.jstl.core.LoopTagStatus</span>.</li>
			
<li>
<strong>begin</strong>: indica el valor a partir del cual comenzar la iteraci&oacute;n. Si se est&aacute; recorriendo un conjunto de objetos, indica el &iacute;ndice del primer objeto a explorar (el primero es el 0), y si no, indica el valor inicial del contador. Si se indica este atributo, debe ser mayor o igual que 0.</li>
			
<li>
<strong>end</strong>: indica el valor donde terminar la iteraci&oacute;n. Si se est&aacute; recorriendo un conjunto de objetos, indica el &iacute;ndice del &uacute;ltimo objeto a explorar (inclusive), y si no, indica el valor final del contador. Si se indica este atributo, debe ser mayor o igual que <span class="codefrag">begin</span>.</li>
			
<li>
<strong>step</strong>: indica cu&aacute;ntas unidades incrementar el contador cada iteraci&oacute;n, para ir de <span class="codefrag">begin</span> a <span class="codefrag">end</span>. Por defecto es 1 unidad. Si se indica este atributo, debe ser mayor o igual que 1.</li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:forEach var="item" 
 items="${cart.items}"&gt; 
	&lt;tr&gt; 
		&lt;td&gt;
		&lt;c:out value="${item.valor}"/&gt;
		&lt;/td&gt; 
	&lt;/tr&gt;
&lt;/c:forEach&gt;</pre>
<p>Muestra el valor de todos los <span class="codefrag">items</span>.</p>
<p>
<strong>forTokens</strong> 
</p>
<p>El tag <strong>forTokens</strong> es similar al tag <strong>foreach</strong>, pero permite recorrer una serie de <span class="codefrag">tokens</span> (cadenas de caracteres), separadas por el/los delimitador(es) que se indique(n). </p>
<p>SINTAXIS</p>
<p>La sintaxis es la misma que <span class="codefrag">foreach</span>, salvo que se tiene un atributo <strong>delims</strong>, obligatorio. </p>
<p>ATRIBUTOS</p>
<ul>
			
<li>
<strong>var</strong>: igual que para <span class="codefrag">foreach</span>
</li>
			
<li>
<strong>items</strong>: cadena que contiene los tokens a recorrer</li>
			
<li>
<strong>delims</strong>:conjunto de delimitadores que se utilizan para separar los tokens de la cadena de entrada (colocados igual que los utiliza un <span class="codefrag">StringTokenizer</span>).</li>
			
<li>
<strong>varStatus</strong>: igual que para <span class="codefrag">foreach</span>
</li>
			
<li>
<strong>begin</strong>: indica el &iacute;ndice del token a partir del cual comenzar la iteraci&oacute;n.</li>
			
<li>
<strong>end</strong>: indica el &iacute;ndice del token donde terminar la iteraci&oacute;n.</li>
			
<li>
<strong>step</strong>: igual que para <span class="codefrag">foreach</span>.</li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:forTokens var="item"
 items="un#token otro#otromas" delims="# "&gt; 
	&lt;tr&gt; 
		&lt;td&gt;
		&lt;c:out value="${item}"/&gt;
		&lt;/td&gt; 
	&lt;/tr&gt;
&lt;/c:forEach&gt;</pre>
<p>Definimos dos separadores: el '#' y el espacio ' '. As&iacute; habr&aacute; 4 iteraciones, recorriendo los tokens "un", "token", "otro" y "otromas".</p>
<a name="N103EE"></a><a name="Tags+de+manejo+de+URLs"></a>
<h3 class="underlined_5">Tags de manejo de URLs</h3>
<p>
<strong>import</strong>
</p>
<p>El tag <strong>import </strong>permite importar el contenido de una URL.</p>
<p>SINTAXIS:</p>
<p>Para copiar el contenido de la URL en una cadena:</p>
<pre class="code">&lt;c:import url="url" [context="contexto"] 
 [var="variable"] 
 [scope="page|request|session|application"] 
 [charEncoding="codificacion"]&gt;
	cuerpo para tags "param" opcionales
&lt;/c:import&gt;</pre>
<p>Para copiar el contenido de la URL en un <span class="codefrag">Reader</span>:</p>
<pre class="code">&lt;c:import url="url" [context="contexto"] 
 varReader="variableReader" 
 [charEncoding="codificacion"]&gt;
	codigo para leer del Reader
&lt;/c:import&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>url</strong>: URL de la que importar datos</li>
			
<li>
<strong>context</strong>: contexto para URLs que pertenecen a contextos distintos al actual.  </li>
			
<li>
<strong>var</strong>: variable (<span class="codefrag">String</span>) donde guardar el contenido de la URL</li>
			
<li>
<strong>varReader</strong>: variable (<span class="codefrag">Reader</span>) donde guardar el contenido de la URL</li>
			
<li>
<strong>scope</strong>: &aacute;mbito para la variable <span class="codefrag">var</span>
</li>
			
<li>
<strong>charEncoding</strong>: codificaci&oacute;n de caracteres de la URL</li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:import url="http://www.ua.es" 
 var="universidad"&gt;
	&lt;c:out value="${universidad}"/&gt;
&lt;/c:import&gt;</pre>
<p>Obtiene y muestra el contenido de la URL indicada.</p>
<p>
<strong>param</strong>
</p>
<p>El tag <strong>param </strong>se utiliza dentro del tag <strong>import</strong> y de otros tags (<span class="codefrag">redirect, url</span>) para indicar par&aacute;metros de la URL solicitada. Dentro del tag <span class="codefrag">import</span> s&oacute;lo se utiliza si la URL se guarda en una cadena. Para los <span class="codefrag">Readers</span> no se emplean par&aacute;metros.</p>
<p>SINTAXIS:</p>
<p>Sin cuerpo:</p>
<pre class="code">&lt;c:param name="nombre" value="valor"/&gt;</pre>
<p>Con cuerpo:</p>
<pre class="code">&lt;c:param name="nombre"&gt;
	Valor
&lt;/c:param&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>name</strong>: nombre del par&aacute;metro</li>
			
<li>
<strong>value</strong>: valor del par&aacute;metro. Puede indicarse bien mediante este atributo, bien en el cuerpo del tag. </li>
		
</ul>
<p>EJEMPLO:</p>
<pre class="code">&lt;c:import url="http://localhost/mipagina.jsp" 
 var="universidad"&gt; 
	&lt;c:param name="id" value="12"/&gt;
&lt;/c:import&gt;</pre>
<p>Obtiene la p&aacute;gina <span class="codefrag">mipagina.jsp?id=12 </span>(le pasa como par&aacute;metro <span class="codefrag">id</span> el valor 12).</p>
<p>
<strong>Otras Etiquetas</strong>
</p>
<p>Existen otras etiquetas, como <strong>url</strong> o <strong>redirect</strong>, que no se comentan aqu&iacute;.</p>
<a name="N1049D"></a><a name="Ejemplo"></a>
<h3 class="underlined_5">Ejemplo</h3>
<p>Vemos c&oacute;mo quedar&iacute;a el ejemplo visto en la sesi&oacute;n anterior para la librer&iacute;a <span class="codefrag">request</span> adaptado a la librer&iacute;a <span class="codefrag">core</span>. Partiendo del mismo formulario inicial:</p>
<pre class="code">&lt;html&gt;
&lt;body&gt;
	&lt;form action="request.jsp"&gt;
		Nombre: 
		&lt;input type="text" name="nombre"&gt;
		&lt;br&gt;
		Descripcion: 
		&lt;input type="text" name="descripcion"&gt;
		&lt;br&gt;
		&lt;input type="submit" value="Enviar"&gt;
	&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>Para obtener los par&aacute;metros podr&iacute;amos tener una p&aacute;gina como esta:</p>
<pre class="code">&lt;%@ taglib uri="core" prefix="c" %&gt;

&lt;html&gt;
&lt;body&gt;
	Nombre: &lt;c:out value="${param.nombre}"/&gt;
	&lt;br&gt;
	&lt;c:if test="${not empty param.descripcion}"&gt;
		Descripcion: &lt;c:out value="${param.descripcion}"/&gt;
	&lt;/c:if&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>Hemos utilizado en este caso, como ejemplo, los tags <span class="codefrag">out</span> e <span class="codefrag">if</span> (para comprobar si hay par&aacute;metro <span class="codefrag">descripcion</span>). En este &uacute;ltimo caso, utilizamos el operador <span class="codefrag">empty</span> en el lenguaje de expresiones, para ver si hay o no valor.</p>
</div>
           

<a name="N104C8"></a><a name="La+librer%C3%ADa+SQL"></a>
<h2 class="underlined_10">La librer&iacute;a SQL</h2>
<div class="section">
<p>Los tags de la librer&iacute;a SQL permiten acceder y manipular informaci&oacute;n de bases de datos relacionales. Vienen definidos con el prefijo "<strong>sql</strong>". </p>
<p>Con esta librer&iacute;a podremos: </p>
<ul>
		
<li>Establecer la base de datos a la que acceder</li>
		
<li>Realizar consultas a bases de datos (<span class="codefrag">select</span>)</li>
		
<li>Acceder a los resultados de las consultas realizadas</li>
		
<li>Realizar actualizaciones sobre la base de datos (<span class="codefrag">insert, update, delete</span>)</li>
		
<li>Agrupar operaciones en una sola transacci&oacute;n</li>
	
</ul>
<p>Estas acciones se realizan sobre objetos de tipo <span class="codefrag">javax.sql.DataSource</span>, que proporciona conexiones a la fuente de datos que representa. As&iacute;, se obtiene un objeto <span class="codefrag">Connection</span> de dicho <span class="codefrag">DataSource</span>, y con &eacute;l podremos ejecutar sentencias y obtener resultados. Podemos definir el <span class="codefrag">DataSource</span> mediante la etiqueta <span class="codefrag">setDataSource </span>y luego acceder a ese <span class="codefrag">DataSource</span> con los atributos <span class="codefrag">dataSource</span> de las etiquetas de la librer&iacute;a.</p>
<a name="N10507"></a><a name="Etiquetas+de+la+librer%C3%ADa"></a>
<h3 class="underlined_5">Etiquetas de la librer&iacute;a</h3>
<p>
<strong>setDataSource</strong>
</p>
<p>El tag <strong>setDataSource </strong>permite definir el objeto <span class="codefrag">DataSource</span> con el que trabajar, y dejarlo asignado en una variable.</p>
<p>SINTAXIS:</p>
<pre class="code">&lt;sql:setDataSource {dataSource="DataSource" | 
 url="url" [driver="driver"] [user="usuario"] 
 [password="password"]} [var="variable"]
 [scope="page|request|session|application"]/&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>dataSource</strong>: objeto <span class="codefrag">DataSource</span> al que queremos enlazar (en caso de que est&eacute; creado de antemano).</li>
			
<li>
<strong>url</strong>: URL de la base de datos a acceder</li>
			
<li>
<strong>driver</strong>: driver con que conectar con la base de datos</li>
			
<li>
<strong>user</strong>: nombre de usuario con que conectar a la base de datos</li>
			
<li>
<strong>password</strong>: password con que conectar a la base de datos</li>
			
<li>
<strong>var</strong>: variable donde guardar el <span class="codefrag">DataSource</span> que se obtenga</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable <span class="codefrag">var</span>
</li>
		
</ul>
<p>Notar que se puede obtener el <span class="codefrag">DataSource</span> tanto indic&aacute;ndolo directamente en el atributo <span class="codefrag">dataSource</span> como indicando <span class="codefrag">url</span>, <span class="codefrag">driver</span>, <span class="codefrag">user</span> y <span class="codefrag">password</span> (los tres &uacute;ltimos opcionales).</p>
<p>
<strong>query</strong>
</p>
<p>El tag <strong>query </strong>permite definir una consulta (<span class="codefrag">select</span>) en una base de datos.</p>
<p>SINTAXIS:</p>
<p>Sin cuerpo:</p>
<pre class="code">&lt;sql:query sql="consulta" var="variable" 
 [scope="page|request|session|application"] 
 [dataSource="DataSource"] [maxRows="max"] 
 [startRow="inicio"]/&gt;</pre>
<p>Con cuerpo donde indicar par&aacute;metros de la consulta:</p>
<pre class="code">&lt;sql:query sql="consulta" var="variable" 
 [scope="page|request|session|application"] 
 [dataSource="DataSource"] [maxRows="max"] 
 [startRow="inicio"]&gt;
	Campos &lt;sql:param&gt;
&lt;/sql:query&gt;</pre>
<p>Con cuerpo donde indicar la propia consulta y los par&aacute;metros de la consulta:</p>
<pre class="code">&lt;sql:query var="variable" 
 [scope="page|request|session|application"] 
 [dataSource="DataSource"] [maxRows="max"] 
 [startRow="inicio"]&gt;
	Consulta
	Campos &lt;sql:param&gt;
&lt;/sql:query&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>sql</strong>: consulta a realizar (en formato SQL). Puede indicarse la consulta tanto en este atributo como en el cuerpo de la etiqueta.</li>
			
<li>
<strong>dataSource</strong>: objeto <span class="codefrag">DataSource</span> asociado a la base de datos a la que se accede. Si especificamos este campo, no podemos incluir esta etiqueta dentro de una transacci&oacute;n (etiqueta <span class="codefrag">transaction</span>).</li>
			
<li>
<strong>maxRows</strong>: m&aacute;ximo n&uacute;mero de filas que se devuelven como resultado</li>
			
<li>
<strong>startRow</strong>: fila a partir de la cual devolver resultados. Por defecto es la 0.</li>
			
<li>
<strong>var</strong>: variable donde guardar el resultado. Es de tipo <span class="codefrag">javax.servlet.jsp.jstl.sql.Result</span>.</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable <span class="codefrag">var</span>.</li>
		
</ul>
<p>
<strong>update</strong>
</p>
<p>El tag <strong>update </strong>permite definir una actualizaci&oacute;n (<span class="codefrag">insert, update, delete</span>) en una base de datos.</p>
<p>SINTAXIS:</p>
<p>Sin cuerpo:</p>
<pre class="code">&lt;sql:update sql="actualizacion" 
 [dataSource="DataSource"] [var="variable"] 
 [scope="page|request|session|application"]/&gt;</pre>
<p>Con cuerpo donde indicar par&aacute;metros de la actualizaci&oacute;n:</p>
<pre class="code">&lt;sql:update sql="actualizacion" 
 [dataSource="DataSource"] [var="variable"] 
 [scope="page|request|session|application"]&gt;
	Campos &lt;sql:param&gt;
&lt;/sql:update&gt;</pre>
<p>Con cuerpo donde indicar la propia actualizaci&oacute;n y los par&aacute;metros de la misma:</p>
<pre class="code">&lt;sql:update [dataSource="DataSource"] [var="variable"] 
 [scope="page|request|session|application"]&gt;
	Actualizaci&oacute;n
	Campos &lt;sql:param&gt;
&lt;/sql:update&gt;</pre>
<p>
<strong>ATRIBUTOS:</strong>
</p>
<ul>
			
<li>
<strong>sql</strong>: actualizaci&oacute;n a realizar (en formato SQL). Puede indicarse tanto en este atributo como en el cuerpo de la etiqueta.</li>
			
<li>
<strong>dataSource</strong>: objeto <span class="codefrag">DataSource</span> asociado a la base de datos a la que se accede. Si especificamos este campo, no podemos incluir esta etiqueta dentro de una transacci&oacute;n (etiqueta <span class="codefrag">transaction</span>).</li>
			
<li>
<strong>var</strong>: variable donde guardar el resultado. Es de tipo <span class="codefrag">Integer</span> (se devuelve el n&uacute;mero de filas afectadas por la actualizaci&oacute;n).</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable <span class="codefrag">var</span>.</li>
		
</ul>
<p>
<strong>transaction</strong>
</p>
<p>El tag <strong>transaction </strong>permite agrupar dentro de &eacute;l varios tags <strong>query</strong> y/o <strong>update</strong>, de forma que se define una transacci&oacute;n con ellos.</p>
<p>SINTAXIS:</p>
<pre class="code">&lt;sql:transaction [dataSource="DataSource"] 
 [isolation="nivel"]&gt;
	Conjunto de etiquetas <span class="codefrag">query</span> y/o <span class="codefrag">update
</span>&lt;/sql:transaction&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>dataSource</strong>: objeto <span class="codefrag">DataSource</span> asociado a la base de datos a la que se accede. Se utiliza este <span class="codefrag">DataSource</span> por todas las operaciones <span class="codefrag">query</span> y <span class="codefrag">update</span> que se definan dentro.</li>
			
<li>
<strong>isolation</strong>: nivel de aislamiento de la transacci&oacute;n, que puede ser <span class="codefrag">"read_committed"</span>, <span class="codefrag">"read_uncommitted"</span>, <span class="codefrag">"repeatable_read"</span><strong> </strong>o <span class="codefrag">"serializable"</span>.</li>
		
</ul>
<p>
<strong>param</strong>
</p>
<p>El tag <strong>param </strong>permite definir par&aacute;metros a la hora de ejecutar consultas (<span class="codefrag">query</span>) o actualizaciones (<span class="codefrag">update</span>). As&iacute;, se sustituyen las marcas "?" que pueda haber en consultas o actualizaciones, por los valores de los par&aacute;metros que se indiquen.</p>
<p>SINTAXIS:</p>
<p>Sin cuerpo:</p>
<pre class="code">&lt;sql:param value="valor"/&gt;</pre>
<p>Con cuerpo:</p>
<pre class="code">&lt;sql:param&gt;
	Valor
&lt;/sql:param&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>value</strong>: valor del par&aacute;metro. Puede indicarse mediante este atributo o como cuerpo del tag.</li>
		
</ul>
<p>Los valores de los par&aacute;metros se sustituyen en las etiquetas en el orden en que se van definiendo. Veremos un ejemplo m&aacute;s adelante.</p>
<p>
<strong>Otras Etiquetas</strong>
</p>
<p>Se tienen otras etiquetas, como <strong>dateParam</strong>, que es igual que <span class="codefrag">param</span> pero para par&aacute;metros de tipo <span class="codefrag">Date</span> (fechas). No la veremos con m&aacute;s detalle aqu&iacute;.</p>
<p>
<strong>EJEMPLO</strong>
</p>
<p>Vemos un ejemplo de uso de las etiquetas explicadas.</p>
<ul>
			
<li>
				
<p>Creamos un <span class="codefrag">DataSource</span> mediante una etiqueta <span class="codefrag">setDataSource, </span>que se conecta a la base de datos <span class="codefrag">miBD</span>, de MySQL. Guardamos el <span class="codefrag">DataSource</span> en la variable <span class="codefrag">miDataSource</span>:</p>

<pre class="code">&lt;sql:setDataSource 
	url="jdbc:mysql//localhost/miBD" 
	driver="org.gjt.mm.mysql.Driver"
	user="root" password="mysql"
	var="miDataSource"
/&gt;</pre>
			
</li>
			
<li>
				
<p>Ejecutamos una consulta (<span class="codefrag">query</span>)<span class="codefrag"> </span>que muestra todos los nombres de la tabla <span class="codefrag">nombres</span>. Guardamos el resultado en la variable <span class="codefrag">miConsulta</span>:</p>

<pre class="code">&lt;sql:query var="miConsulta" 
 dataSource="${miDataSource}"&gt;
	SELECT nombre FROM nombres
&lt;/sql:query&gt;

&lt;c:foreach var="fila" items="${miConsulta.rows}"&gt;
	&lt;c:out value="${fila.nombre}"/&gt;&lt;br&gt;
&lt;/c:foreach&gt;</pre>
			
</li>
			
<li>
				
<p>Ejecutamos una actualizaci&oacute;n que actualice el nombre que tenga id = 1 o id = 2:</p>

<pre class="code">&lt;sql:update dataSource="${miDataSource}"&gt;
	UPDATE nombres SET nombre='pepe' 
	WHERE id=1 OR id=2
&lt;/sql:update&gt;</pre>
			
</li>
			
<li>
				
<p>Utilizamos dos etiquetas <span class="codefrag">param</span> para pasar como par&aacute;metros los <span class="codefrag">id</span> de los nombres que se tienen que actualizar:</p>

<pre class="code">&lt;sql:update dataSource="${miDataSource}"&gt;
	UPDATE nombres SET nombre='pepe' 
	WHERE id=? OR id=?
	&lt;sql:param value="${param.id1}"/&gt;
	&lt;sql:param value="${param.id2}"/&gt;
&lt;/sql:update&gt;</pre>
				
<p>Se sustituir&iacute;a la primera ? por el primer <span class="codefrag">param</span> y la segunda ? por el segundo <span class="codefrag">param</span>. Los dos par&aacute;metros se toman en este ejemplo de la petici&oacute;n <span class="codefrag">request</span>. Pueden tomarse de cualquier otro sitio (constantes, variables, etc).</p>
			
</li>
			
<li>
				
<p>Vemos c&oacute;mo quedar&iacute;an las dos operaciones anteriores en una transacci&oacute;n (<span class="codefrag">transaction</span>):</p>

<pre class="code">&lt;sql:transaction dataSource="${miDataSource}"&gt;

	&lt;sql:query var="miConsulta"&gt;
		SELECT nombre FROM nombres
	&lt;/sql:query&gt;

	&lt;c:foreach var="fila" 
	 items="${miConsulta.rows}"&gt;
		&lt;c:out value="${fila.nombre}"/&gt;&lt;br&gt;
	&lt;/c:foreach&gt;

	&lt;sql:update&gt;
		UPDATE nombres SET nombre='pepe' 
		WHERE id=? OR id=?
		&lt;sql:param value="${param.id1}"/&gt;
		&lt;sql:param value="${param.id2}"/&gt;
	&lt;/sql:update&gt;
<span class="codefrag">
</span>&lt;/sql:transaction&gt;</pre>
			
</li>
		
</ul>
<a name="N106FE"></a><a name="Ejemplo-N106FE"></a>
<h3 class="underlined_5">Ejemplo</h3>
<p>Vemos c&oacute;mo quedar&iacute;a el ejemplo visto en la sesi&oacute;n anterior para la librer&iacute;a <span class="codefrag">dbtags</span> adaptado a la librer&iacute;a <span class="codefrag">sql</span>. </p>
<pre class="code">&lt;%@ taglib uri="sql" prefix="sql" %&gt;
&lt;%@ taglib uri="core" prefix="c" %&gt;

&lt;html&gt;
&lt;body&gt;
	&lt;sql:setDataSource url="jdbc:mysql://localhost/prueba" 
	 driver="org.gjt.mm.mysql.Driver" 
	 user="root" password="mysql" var="miDataSource"/&gt;

	&lt;sql:query var="miConsulta" dataSource="${miDataSource}"&gt;
		SELECT * FROM datos
	&lt;/sql:query&gt;

	&lt;c:forEach var="fila" items="${miConsulta.rows}"&gt;
	Nombre: &lt;c:out value="${fila.nombre}"/&gt;&lt;br&gt;
	Descripcion: &lt;c:out value="${fila.descripcion}"/&gt;&lt;br&gt;
	&lt;/c:forEach&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>Utilizamos la librer&iacute;a <span class="codefrag">sql </span>y la <span class="codefrag">core</span> para recorrer todos los registros encontrados.</p>
</div>


<a name="N1071C"></a><a name="La+librer%C3%ADa+de+internacionalizaci%C3%B3n"></a>
<h2 class="underlined_10">La librer&iacute;a de internacionalizaci&oacute;n</h2>
<div class="section">
<p>Los tags de la librer&iacute;a de <strong> internacionalizaci&oacute;n</strong><strong> </strong>(o <span class="codefrag">I18n</span>)  permiten adaptar aplicaciones Web a las convenciones de idioma y formato de los clientes para un determinado origen (<span class="codefrag">locale</span>). Los tags de esta librer&iacute;a se presentan con el prefijo "<strong>fmt</strong>". </p>
<p>En la librer&iacute;a tenemos tags para la <strong>internacionalizaci&oacute;n</strong> propiamente dicha, y para el <strong>formato</strong> de determinados elementos seg&uacute;n la regi&oacute;n (podremos formatear n&uacute;meros, fechas, monedas, etc, dependiendo del idioma o regi&oacute;n que se trate). </p>
<a name="N1073C"></a><a name="Etiquetas+de+la+librer%C3%ADa-N1073C"></a>
<h3 class="underlined_5">Etiquetas de la librer&iacute;a</h3>
<p>Algunas etiquetas interesantes de esta librer&iacute;a son: </p>
<p>
<strong>formatNumber</strong>
</p>
<p>El tag <strong>formatNumber </strong>permite dar formato a un n&uacute;mero, e indicar, por ejemplo, con cu&aacute;ntos decimales queremos que se muestre.</p>
<p>SINTAXIS:</p>
<pre class="code">&lt;fmt:formatNumber [value="numero"] [type="number|currency|percentage"]
 [pattern="patron"] [groupingUsed="true|false"]
 [maxIntegerDigits="cantidad"] [minIntegerDigits="cantidad"]
 [maxFractionDigits="cantidad"] [minFracionDigits="cantidad"] 
 [var="nombreVariable"] [scope="ambito"]... /&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>value</strong>: el valor del n&uacute;mero que queremos formatear. Podr&aacute; ser un valor constante ("<span class="codefrag">2.34</span>"), o uno encapsulado en una variable en lenguaje de expresiones ("<span class="codefrag">${numero}</span>").</li>
			
<li>
<strong>type</strong>: indica el tipo de n&uacute;mero que se quiere formatear: <span class="codefrag">number</span> (n&uacute;mero gen&eacute;rico), <span class="codefrag">currency</span> (moneda) o <span class="codefrag">percentage</span> (para porcentajes).</li>
			
<li>
<strong>pattern</strong>: indica un patr&oacute;n propio con el que formatear el n&uacute;mero. Un ejemplo de uso ser&iacute;a "<span class="codefrag">#.###</span>", que dejar&iacute;a 3 decimales, y al menos 1 entero.</li>
			
<li>
<strong>groupingUsed</strong>: a <span class="codefrag">true</span> indica que se separen las cifras de mil en mil, con puntos (2.032.135), y a <span class="codefrag">false</span> indica que no se utilicen los puntos para separar (2032135).</li>
			
<li>
<strong>maxIntegerDigits</strong> y <strong>minIntegerDigits</strong> establecen cu&aacute;ntas cifras tendr&aacute; como mucho y como poco (respectivamente) la parte entera.</li>
			
<li>
<strong>maxFractionDigits </strong>y<strong> minFractionDigits</strong> establecen el n&uacute;mero de cifras como m&aacute;ximo y como m&iacute;nimo (respectivamente) de la parte decimal.</li>
			
<li>
<strong>var</strong>: nombre de la variable donde guardar el n&uacute;mero formateado (si se quiere almacenar temporalmente)</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable (como los campos <span class="codefrag">scope </span>vistos en otras etiquetas).</li>
			
<li>Adem&aacute;s, la etiqueta tiene otros atributos (para indicar monedas y otros elementos), que no se comentan aqu&iacute;.</li>
		
</ul>
<p>
<strong>formatDate</strong>
</p>
<p>El tag <strong>formatDate </strong>permite dar formato a una fecha y mostrar las partes de ella que queramos, y en el orden que queramos.</p>
<p>SINTAXIS:</p>
<pre class="code">&lt;fmt:formatDate [value="fecha"] [type="time|date|both"]
 [dateStyle="default|short|medium|long|full"]
 [timeStyle="default|short|medium|long|full"]
 [pattern="patron"] [timeZone="zona"]
 [var="nombreVariable"] [scope="ambito"]... /&gt;</pre>
<p>ATRIBUTOS:</p>
<ul>
			
<li>
<strong>value</strong>: el valor de la fecha. Normalmente vendr&aacute; en una variable ("<span class="codefrag">${fecha}</span>").</li>
			
<li>
<strong>type</strong>: indica el tipo de fecha que se quiere formatear: fecha, hora o ambos.</li>
			
<li>
<strong>dateStyle</strong>: formatea la fecha con uno de los formatos predeterminados que tiene</li>
			
<li>
<strong>timeStyle</strong>: formatea la hora con uno de los formatos predeterminados que tiene</li>
			
<li>
<strong>pattern</strong>: indica un patr&oacute;n propio con el que formatear la fecha.</li>
			
<li>
<strong>timeZone</strong>: cadena de texto descriptiva de la zona horaria para la que queremos formatear la fecha.</li>
			
<li>
<strong>var</strong>: nombre de la variable donde guardar el n&uacute;mero formateado (si se quiere almacenar temporalmente)</li>
			
<li>
<strong>scope</strong>: &aacute;mbito de la variable (como los campos <span class="codefrag">scope </span>vistos en otras etiquetas).</li>
		
</ul>
<a name="N107EE"></a><a name="Ejemplo-N107EE"></a>
<h3 class="underlined_5">Ejemplo</h3>
<p>Vemos c&oacute;mo formatear un n&uacute;mero almacenado en la variable <span class="codefrag">num</span>, para que se muestre con 3 decimales siempre: </p>
<pre class="code">&lt;fmt:formatNumber value="${num}" maxFractionDigits="3" minFractionDigits="3"/&gt;</pre>
<p>Formateamos ahora una fecha guardada en la variable <span class="codefrag">miFecha</span>, para mostrarla con:</p>
<p>
<span class="codefrag">d&iacute;a/mes/a&ntilde;o - horas:minutos</span>:<span class="codefrag">segundos</span>
</p>
<pre class="code">&lt;fmt:formatDate value="${miFecha}" pattern="dd/MM/yyyy-hh:mm:ss"/&gt;</pre>
</div>

<a name="N10811"></a><a name="La+librer%C3%ADa+XML+y+la+librer%C3%ADa+de+funciones"></a>
<h2 class="underlined_10">La librer&iacute;a XML y la librer&iacute;a de funciones</h2>
<div class="section">
<p>Los tags de la librer&iacute;a de <strong> XML</strong> permiten tener acceso y procesar el contenido de documentos XML, utilizando la recomendaci&oacute;n XPath del W3C como un lenguaje de expresiones local. Esta librer&iacute;a se utiliza con el prefijo "<strong>x</strong>". </p>
<p>Dentro de la librer&iacute;a, distinguimos entre los tags <strong>principales</strong> (que nos permiten explorar el contenido de un fichero XML), tags de <strong>control de flujo</strong> (para realizar c&oacute;digo en funci&oacute;n de dicho contenido), y tags de <strong>transformaci&oacute;n</strong> (que permite transformar ficheros XML aplicando hojas de estilo XSLT). </p>
<p>Por otro lado, JSTL dispone tambi&eacute;n de un conjunto de <strong>funciones</strong> que pueden emplearse desde dentro del lenguaje de expresiones, y permiten sobre todo manipular cadenas, para sustituir caracteres, concatenar, etc. </p>
<p>Para utilizar estas funciones, cargar&iacute;amos la directiva <span class="codefrag">taglib</span> correspondiente: </p>
<pre class="code">&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %&gt;</pre>
<p>Y luego utilizar&iacute;amos las funciones que haya disponibles, dentro de una expresi&oacute;n del lenguaje: </p>
<pre class="code">La cadena tiene &lt;c:out value="${fn:length(miCadena)}"/&gt; caracteres</pre>
</div>

<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006 Depto. CCIA</div>
</div>
</body>
</html>
