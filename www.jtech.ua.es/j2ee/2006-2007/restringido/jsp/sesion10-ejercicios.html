<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de creaci&oacute;n de librer&iacute;as de tags</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Servlets y JSP" src="images/baner_j2ee_der.gif" title="Servlets y JSP"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Servlets y JSP</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Servlets y JSP</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Servlets y JSP">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-apuntes.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-apuntes.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-apuntes.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-apuntes.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="sesion09-apuntes.html">Sesion 9</a>
</div>
<div class="menuitem">
<a href="sesion10-apuntes.html">Sesion 10</a>
</div>
<div class="menuitem">
<a href="sesion11-apuntes.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-apuntes.html">Sesion 12</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="sesion05-ejercicios.html">Sesion 5</a>
</div>
<div class="menuitem">
<a href="sesion06-ejercicios.html">Sesion 6</a>
</div>
<div class="menuitem">
<a href="sesion07-ejercicios.html">Sesion 7</a>
</div>
<div class="menuitem">
<a href="sesion08-ejercicios.html">Sesion 8</a>
</div>
<div class="menuitem">
<a href="sesion09-ejercicios.html">Sesion 9</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 10</div>
</div>
<div class="menuitem">
<a href="sesion11-ejercicios.html">Sesion 11</a>
</div>
<div class="menuitem">
<a href="sesion12-ejercicios.html">Sesion 12</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion10-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de creaci&oacute;n de librer&iacute;as de tags</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Gestor+de+tags+para+un+tag+que+formatee+n%C3%BAmeros+reales">Gestor de tags para un tag que formatee n&uacute;meros reales</a>
</li>
<li>
<a href="#Configuraci%C3%B3n+y+prueba+de+nuestro+tag">Configuraci&oacute;n y prueba de nuestro tag</a>
</li>
<li>
<a href="#%28*%29+Iterador+sobre+una+cadena">(*) Iterador sobre una cadena</a>
</li>
</ul>
</div>


<a name="N1000C"></a><a name="Gestor+de+tags+para+un+tag+que+formatee+n%C3%BAmeros+reales"></a>
<h2 class="underlined_10">Gestor de tags para un tag que formatee n&uacute;meros reales</h2>
<div class="section">
<p>En la plantilla tenemos una aplicaci&oacute;n <span class="codefrag">jsp-sesion10</span>, y en su directorio de fuentes tenemos una clase Java llamada <span class="codefrag">es.ua.jtech.jsp.sesion10.libtags1.FormateaDoubleTag</span>. Dicha clase est&aacute; vac&iacute;a, pero deber&aacute; contener el c&oacute;digo necesario para desarrollar un tag llamado <span class="codefrag">formateadouble</span>. Dicho tag admitir&aacute; dos atributos:</p>
<ul> 
		
<li>Uno llamado <span class="codefrag">valor</span>, que contendr&aacute; un valor real</li>
		
<li>Uno llamado <span class="codefrag">decimales</span>, que indicar&aacute; un n&uacute;mero de decimales concreto (un valor entero: 0, 1, 2... etc).</li>
	
</ul>
<p>Lo que har&aacute; el tag ser&aacute; formatear el valor real que le pasamos en <span class="codefrag">valor</span>, para sacarlo en la p&aacute;gina con tantos decimales como indiquemos en <span class="codefrag">decimales</span>. El tag no tendr&aacute; cuerpo.</p>
<p>Para hacer eso, podemos utilizar la clase <span class="codefrag">java.text.NumberFormat</span> de Java, que permite indicar con cu&aacute;ntos decimales queremos formatear un determinado n&uacute;mero:</p>
<pre class="code">NumberFormat nf=NumberFormat.getInstance();
nf.setMaximumFractionDigits(2);
nf.setMinimumFractionDigits(2);
...
System.out.println (nf.format(2.34786));			// Sacar&iacute;a 2.35
System.out.println (nf.format(2.7));				// Sacar&iacute;a 2.70</pre>
<p>Deberemos rellenar la clase, con los m&eacute;todos <span class="codefrag">doStartTag()</span>, <span class="codefrag">doEndTag()</span> y los m&eacute;todos para acceder y establecer el valor de los campos y atributos que se tengan. Podemos fijarnos en el tag <span class="codefrag">Saludo</span> visto en teor&iacute;a como ejemplo.</p>
</div>

<a name="N1004D"></a><a name="Configuraci%C3%B3n+y+prueba+de+nuestro+tag"></a>
<h2 class="underlined_10">Configuraci&oacute;n y prueba de nuestro tag</h2>
<div class="section">
<p>Una vez hecha la clase del tag, vamos a probarla en una p&aacute;gina JSP. Para ello:</p>
<ul>
		
<li>
			
<p>Creamos el fichero TLD (<span class="codefrag">libtags1.tld</span>)<span class="codefrag"> </span>que d&eacute; soporte a la librer&iacute;a. Dicho fichero s&oacute;lo tendr&aacute; informaci&oacute;n del tag que hemos creado, indicando su nombre, atributos, y caracter&iacute;sticas. </p>

<pre class="code">&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;
&lt;!DOCTYPE taglib PUBLIC "-//Sun Microsystems, Inc.  ... 
&lt;taglib&gt; 

	&lt;tlibversion&gt;1.0&lt;/tlibversion&gt; 
	&lt;jspversion&gt;1.1&lt;/jspversion&gt;
	&lt;shortname&gt;lt1&lt;/shortname&gt;
	&lt;uri&gt;libtags1&lt;/uri&gt;
	&lt;info&gt;Ejercicio de libreria propia&lt;/info&gt; 

	&lt;tag&gt; 
		&lt;name&gt;formateadouble&lt;/name&gt; 
		&lt;tagclass&gt;...&lt;/tagclass&gt;
		&lt;bodycontent&gt;...&lt;/bodycontent&gt;
		&lt;info&gt;Formatea un double con n decimales&lt;/info&gt;
		&lt;attribute&gt; 
			&lt;name&gt;valor&lt;/name&gt;
			&lt;required&gt;...&lt;/required&gt;
			&lt;rtexprvalue&gt;...&lt;/rtexprvalue&gt;
		&lt;/attribute&gt; 	
		&lt;attribute&gt; 
			&lt;name&gt;decimales&lt;/name&gt;
			&lt;required&gt;...&lt;/required&gt;
			&lt;rtexprvalue&gt;...&lt;/rtexprvalue&gt;
		&lt;/attribute&gt; 	
	&lt;/tag&gt;

&lt;/taglib&gt;</pre>
           
			
<p>Las etiquetas que tienen puntos suspensivos (<span class="codefrag">...</span>) deben rellenarse adecuadamente: nombre de la clase que implementa el tag (<span class="codefrag">tagclass</span>), tipo de contenido (<span class="codefrag">bodycontent</span>), y caracter&iacute;sticas de los atributos: el primero (<span class="codefrag">valor</span>) ser&aacute; requerido, y admitir&aacute; expresiones <span class="codefrag">&lt;%=...%&gt;</span>, y el segundo (<span class="codefrag">decimales</span>) no ser&aacute; requerido (tomar&aacute; valor de 0 decimales, por defecto), y no admitir&aacute; dichas expresiones.</p>
			
<p>Copiamos dicho fichero en el directorio <span class="codefrag">WEB-INF</span> de la aplicaci&oacute;n.</p>
		
</li>
		
<li>
			
<p>Modificamos el fichero descriptor (<span class="codefrag">web.xml</span>) para a&ntilde;adir el fichero TLD anterior:</p>

<pre class="code">&lt;taglib&gt;
	&lt;taglib-uri&gt;libtags1&lt;/taglib-uri&gt;
	&lt;taglib-location&gt;/WEB-INF/libtags1.tld&lt;/taglib-location&gt;
&lt;/taglib&gt;</pre>
		
</li>
		
<li>
			
<p>Creamos una p&aacute;gina <strong>pruebaformato.jsp</strong>, que invoque al tag anterior:</p>

<pre class="code">&lt;%@ taglib uri="libtags1" prefix="lt1"%&gt;

...
	Numero con 3 decimales:
	&lt;lt1:formateadouble valor="2.35879" decimales="3"/&gt;
...</pre>
           
			
<p>La llamamos con:</p>
			
<pre class="code">http://localhost:8080/appmistags/pruebaformato.jsp</pre>
			
<p>Y deber&iacute;a devolver 2.359 para el caso anterior.</p>
		
</li>
	
</ul>
</div>


<a name="N100A9"></a><a name="%28*%29+Iterador+sobre+una+cadena"></a>
<h2 class="underlined_10">(*) Iterador sobre una cadena</h2>
<div class="section">
<p>Construid sobre la librer&iacute;a anterior una etiqueta llamada <span class="codefrag">iteraCadena </span>de tipo <span class="codefrag">BodyTag </span>(que permita iterar sobre su contenido), que tome como par&aacute;metro un atributo <span class="codefrag">cadena</span>, que sea un <span class="codefrag">String</span>. La etiqueta tendr&aacute; a su vez una subetiqueta llamada <span class="codefrag">carActual </span>que sacar&aacute; por pantalla el car&aacute;cter en la cadena correspondiente a la iteraci&oacute;n actual. De esta forma, un c&oacute;digo como: </p>
<pre class="code">&lt;%@ taglib uri="libtags1" prefix="lt1"%&gt;

...
	&lt;lt1:iteraCadena cadena="miCad"&gt;
		&lt;lt1:carActual/&gt; - 
	&lt;/lt1:iteraCadena&gt;
...</pre>
<p>deber&iacute;a sacar por pantalla: <em>m - i - C - a - d - </em>
</p>
</div>




<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2006 Depto. CCIA</div>
</div>
</body>
</html>
