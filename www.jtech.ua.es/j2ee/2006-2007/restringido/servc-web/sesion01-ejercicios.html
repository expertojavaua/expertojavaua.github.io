<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de introducci&oacute;n a los Servicios Web</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://www.jtech.ua.es/j2ee"><img class="logoImage" alt="J2EE" src="images/baner_j2ee_izq.gif" title="Curso Especialista Universitario J2EE"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Servicios Web" src="images/baner_j2ee_der.gif" title="Servicios Web"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">M&oacute;dulos</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Servicios Web</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Servicios Web</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Servicios Web">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html" title="Roadmap">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menupage">
<div class="menupagetitle">Sesion 1</div>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-ejercicios.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion01-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de introducci&oacute;n a los Servicios Web</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Invocaci%C3%B3n+de+Servicios+Web">Invocaci&oacute;n de Servicios Web</a>
</li>
<li>
<a href="#Cliente+para+servicio+web+Hola+Mundo">Cliente para servicio web Hola Mundo</a>
</li>
<li>
<a href="#Clientes+para+otros+servicios+web+%28*%29">Clientes para otros servicios web (*)</a>
</li>
</ul>
</div>


<a name="N1000C"></a><a name="Invocaci%C3%B3n+de+Servicios+Web"></a>
<h2 class="underlined_10">Invocaci&oacute;n de Servicios Web</h2>
<div class="section">
<p>La p&aacute;gina <span class="codefrag">http://www.xmethods.net</span> contiene 
  una serie de Servicios Web de demostraci&oacute;n. En la secci&oacute;n <em>XMethods 
  Demo Services</em>, en la parte inferior de la p&aacute;gina, tenemos una lista 
  de servicios que podremos integrar en nuestras aplicaciones. </p>
<p>
<em>a)</em> Pulsar sobre el servicio <em>Currency Exchange Rate</em> para obtener informaci&oacute;n 
  sobre &eacute;l. Esto nos llevar&aacute; a una p&aacute;gina con documentaci&oacute;n 
  sobre este servicio, adem&aacute;s de un enlace al documento WSDL que lo describe.</p>
<ul>
  
<li>Leer la documentaci&oacute;n del servicio. &iquest;Qu&eacute; funci&oacute;n 
    realiza?</li>

</ul>
<ul>
  
<li>Descargar el documento WSDL y editarlo. &iquest;Qu&eacute; operaciones nos 
    ofrece el servicio? &iquest;Qu&eacute; par&aacute;metros toman y qu&eacute; nos devuelven?</li>

</ul>
<ul>
  
<li> Si pulsamos sobre el link <em>Analyze WSDL</em>, junto al link al documento 
    WSDL, podremos ver los datos que aporta este documento de forma desglosada. 
    Podemos ver el nombre del servicio, el puerto, las operaciones y los par&aacute;metros 
    de entrada y datos devueltos por cada una de ellas.</li>
  
<li>Buscar en este documento la informaci&oacute;n sobre: 
    <ul>
      
<li>Nombre del servicio y puerto.</li>
      
<li>Operaciones que ofrece el servicio.</li>
      
<li>Par&aacute;metros y datos devueltos por las operaciones.</li>
    
</ul>
  
</li>

</ul>
<p>
<em>b)</em> Vamos a invocar el servicio mediante el cliente de prueba gen&eacute;rico de Weblogic 
(<em>Weblogic Test Client</em>). Para ello deberemos poner en marcha el servidor de aplicaciones e ir 
a la siguiente direcci&oacute;n para acceder al cliente de prueba:</p>
<pre class="code">http://localhost:7001/wls_utc</pre>
<p>Introducir la URL donde se encuentra el documento WSDL que describe el servicio y 
probar a invocarlo con diferentes par&aacute;metros.</p>
<ul>
  
<li>Veremos una interfaz web con la lista de las operaciones que ofrece el servicio, en este caso 
    tenemos s&oacute;lo la operaci&oacute;n <span class="codefrag">getRate</span>.  Deberemos 
    proporcionar los par&aacute;metros de entrada que toma este m&eacute;todo, 
    que ser&aacute;n el pa&iacute;s de origen y el pa&iacute;s de destino para la conversi&oacute;n monetaria, 
	y a continuaci&oacute;n pulsar sobre el bot&oacute;n para invocar la operaci&oacute;n.</li>
	  
<li>Si queremos convertir la divisa europea (euro) a la de EEUU (d&oacute;lar), 
    	&iquest;qu&eacute; operaci&oacute;n y qu&eacute; par&aacute;metros debemos 
	    proporcionar?
	  </li>
  
<li>Una vez invocada la operaci&oacute;n nos mostrar&aacute; el resultado devuelto y los mensajes 
  SOAP que se han utilizado para llamar al servicio. 
  </li>

</ul>
<p>
<em>c)</em> Observar los mensajes SOAP de petici&oacute;n y respuesta utilizados. Relacionar los elementos de estos mensajes con los elementos 
del documento WSDL que describe la interfaz del servicio.</p>
<ul>
      
<li>&iquest;Qu&eacute; elementos encontramos en el mensaje de petici&oacute;n?</li>
      
<li>&iquest;Y en el de respuesta?</li>
    
</ul>
</div>

<a name="N10074"></a><a name="Cliente+para+servicio+web+Hola+Mundo"></a>
<h2 class="underlined_10">Cliente para servicio web Hola Mundo</h2>
<div class="section">
<p>Vamos a crear un cliente para un servicio web sencillo. Se trata 
  de un <em>"Hola mundo!"</em> en forma de servicio. Podemos encontrar el documento WSDL
  que define este servicio en la direcci&oacute;n <span class="codefrag">http://jtech.ua.es/HolaMundo/wsdl/HolaMundoSW.wsdl</span>. Se pide:</p>
<p>
<em>a) </em> Invocar el servicio utilizando el cliente de prueba de Weblogic. Observar los
mensajes SOAP de petici&oacute;n y respuesta utilizados.</p>
<p>
<em>b)</em> Hemos accedido al servicio utilizando una herramienta gen&eacute;rica para probar Servicios Web. 
  Sin embargo, la ventaja que nos ofrecen los Servicios 
  Web es que podremos integrarlos en cualquier aplicaci&oacute;n cliente, independientemente 
  de la plataforma y del lenguaje sobre el que la desarrollemos.</p>
<p>Vamos a invocar el servicio utilizando la aplicaci&oacute;n cliente propia contenida en el 
proyecto <span class="codefrag">servcweb-sesion01-weblogic</span> de BEA Workshop. La aplicaci&oacute;n se puede ejecutar utilizando
 el objetivo <span class="codefrag">run</span> de ant, o ejecutando la clase <span class="codefrag">Main</span> directamente desde el entorno como aplicaci&oacute;n Java.</p>
<p>
<em>c)</em> En la clase <span class="codefrag">MainDebug</span> tenemos un cliente alternativo en el que se muestran los mensajes
SOAP de petici&oacute;n y respuesta que se intercambian para utilizar el servicio. Ejecutar dicha clase (o el objetivo
<span class="codefrag">run-debug</span> de ant) y observar el contenido de estos 
mensajes. Relacionar el contenido de estos mensajes con el del documento WSDL que define el servicio.</p>
<p>
<em>d)</em> Observar el c&oacute;digo fuente de la clase <span class="codefrag">Main</span>. Relacionar los elementos que se utilizan en esta clase (objetos
que se instancian, m&eacute;todos invocados, etc) con los elementos del fichero WSDL.</p>
<p>
<em>e)</em> Crear un cliente b&aacute;sico para este servicio utilizando Netbeans. El cliente deber&aacute; ser una
aplicaci&oacute;n Java que invoque el servicio y que muestre en la consola el resultado obtenido. Se crear&aacute;
como un proyecto Java de nombre <span class="codefrag">servcweb-sesion01-hola</span>.</p>
</div>



<a name="N100B5"></a><a name="Clientes+para+otros+servicios+web+%28*%29"></a>
<h2 class="underlined_10">Clientes para otros servicios web (*)</h2>
<div class="section">
<p>Vamos a crear una serie de clientes para diferentes servicios web utilizando Netbeans.</p>
<p>a) Desarrollar un cliente para el servicio de cambio de moneda (<em>Currency Exchange Rate</em>) de
	XMethods, dentro de un proyecto Java de nombre <span class="codefrag">servcweb-sesion01-currency</span>. Podemos la URL del documento WSDL del servicio desde la p&aacute;gina 
    de <em>XMethods</em>. Esta direcci&oacute;n es la siguiente:</p>
<pre class="code">http://www.xmethods.net/sd/2001/CurrencyExchangeService.wsdl</pre>
<p>Generar el cliente para este servicio utilizando la librer&iacute;a JAX-WS. &iquest;Qu&eacute; ocurre y a qu&eacute; es debido?
	Seleccionar la opci&oacute;n adecuada para que el servicio se pueda generar correctamente.</p>
<p>Si nos fijamos en el documento WSDL o en las clases generadas 
    veremos que el servicio tiene como nombre <span class="codefrag">CurrencyExchangeService</span> y 
    el tipo de puerto al que vamos a acceder se llama <span class="codefrag">CurrencyExchangePortType</span>. 
    Introducir en la clase principal de la aplicaci&oacute;n el c&oacute;digo que invoque la operaci&oacute;n <span class="codefrag">getRate()</span>
    del servicio y muestre el resultado en la consola. Esta operaci&oacute;n toma dos par&aacute;metros: el pa&iacute;s de origen 
    y el de destino (por ejemplo <span class="codefrag">"euro"</span> o <span class="codefrag">"usa"</span>). Ejecutar el cliente y comprobar
    que funciona correctamente.</p>
<p>
<em>b)</em> Vamos a utilizar los servicios web que ofrece Google, que nos permitir&aacute;n integrar 
	su motor de b&uacute;squeda en nuestras aplicaciones. Podemos encontrar el documento WSDL que define el 
	servicio en la siguiente direcci&oacute;n:</p>
<pre class="code">http://api.google.com/GoogleSearch.wsdl</pre>
<p>Generar el cliente del servicio e invocar el m&eacute;todo de b&uacute;squeda <span class="codefrag">doGoogleSearch</span>, dentro
	de un proyecto Java de nombre <span class="codefrag">servcweb-sesion01-google</span>. Podemos 
	invocarlo con los siguientes par&aacute;metros:</p>
<pre class="code">
<strong>GoogleSearchResult</strong> result = 
    googleSearchPort.<strong>doGoogleSearch</strong>(
            "iuH+5SdQFHIYv18KNcIjkg6RvfIUNYc6", 
            "J2EE", 0, 10, true, "", false, 
            "", "UTF8", "UTF8");</pre>
<p>Donde el primer par&aacute;metro es un identificador del usuario que accede al servicio, y el segundo es la 
	cadena de b&uacute;squeda. El resto de par&aacute;metros se utilizan para tratar cuestiones como la paginaci&oacute;n de los 
	resultados o su codificaci&oacute;n. Como resultado nos devuelve un objeto <span class="codefrag">GoogleSearchResult</span> del
	cual podremos obtener la lista de p&aacute;ginas encontradas. Mostrar de cada una de ellas su t&iacute;tulo, su descripci&oacute;n
	(<em>snippet</em>) y su URL.</p>
<p>
<em>c)</em> Vamos a realizar un cliente que acceda a los Servicios Web que ofrece <em>Amazon.com</em> para 
  	realizar b&uacute;squedas de productos en esta tienda, dentro de un proyecto Java de nombre
  	<span class="codefrag">servcweb-sesion01-amazon</span>. Este es un servicio bastante m&aacute;s complejo que los anteriores, por lo 
    que necesitaremos documentaci&oacute;n adicional para crear nuestro cliente. 
    Podemos obtener documentaci&oacute;n sobre estos servicios en la direcci&oacute;n:</p>
<pre class="code">http://aws.amazon.com</pre>
<p>Para utilizar estos servicios necesitaremos registrarnos como desarrolladores, y obtener 
	un c&oacute;digo (<em>token</em>) que nos identifique 
  	cuando utilizamos los servicios de <em>Amazon</em>. Este c&oacute;digo puede 
  	ser obtenido en la p&aacute;gina anterior.</p>
<div class="frame note">
<div class="label">Nota</div>
<div class="content">Para las pruebas que vamos a realizar no es necesario obtener 
  	dicho c&oacute;digo, ya que a continuaci&oacute;n se proporciona uno
  	en el fragmento de c&oacute;digo de ejemplo.</div>
</div>
<p>Generar el cliente del servicio Amazon a partir del documento WSDL que lo define. Vamos a utilizar el servicio 
  	<em>Amazon E-Commerce Service</em>, cuyo documento WSDL puede ser consultado directamente 
  	en la direcci&oacute;n:</p>
<pre class="code">http://webservices.amazon.com/AWSECommerceService/AWSECommerceService.wsdl</pre>
<p>Invocar desde el cliente la operaci&oacute;n <span class="codefrag">itemSearch</span> para hacer una b&uacute;squeda de art&iacute;culos. 
	Concretamente los art&iacute;culos que buscaremos ser&aacute;n DVDs, y realizaremos una b&uacute;squeda por director. Dado que
	la API de Amazon es bastante compleja, a continuaci&oacute;n se muestra el c&oacute;digo que deber&iacute;amos utilizar para
	invocar esta operaci&oacute;n (se proporciona un <em>token</em> de desarrollador para que no sea necesario registrarse
	en la web):</p>
<pre class="code">String marketplaceDomain = null;
String awsAccessKeyId = "15JCR9XWMPTGV91JC1R2";
String subscriptionId = null;
String associateTag = null;
String xmlEscaping = null;
String validate = null;
ItemSearchRequest shared = null;
List&lt;ItemSearchRequest&gt; request = null;
Holder&lt;OperationRequest&gt; operationRequest = null;
Holder&lt;List&lt;Items&gt;&gt; items = new Holder&lt;List&lt;Items&gt;&gt;();
            
shared = new ItemSearchRequest();
shared.setSearchIndex("DVD");
shared.setDirector("Kubrick");
shared.getResponseGroup().add("Offers");
shared.getResponseGroup().add("Medium");
            
port.<strong>itemSearch</strong>(marketplaceDomain, awsAccessKeyId, 
                subscriptionId, associateTag, xmlEscaping, 
                validate, shared, request, operationRequest, items);

List&lt;Items&gt; listaResultados = items.value;
for(Items resultado: listaResultados) {
    List&lt;Item&gt; listaArticulos = resultado.getItem();
    for(Item articulo: listaArticulos) {
        ItemAttributes atributos = articulo.getItemAttributes();
        System.out.println("Titulo: " + atributos.getTitle());

        List&lt;String&gt; directores = atributos.getDirector();
        for(String director: directores) {
            System.out.print(director + "; ");
        }

        System.out.println("Precio: " + 
            (atributos.getListPrice()!=null?
                atributos.getListPrice().getFormattedPrice():
                "no disponible"));
    }
}</pre>
<p>Ejecutar la aplicaci&oacute;n y comprobar que obtiene correctamente la lista de pel&iacute;culas.</p>
</div>



<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2007 Depto. CCIA</div>
</div>
</body>
</html>
