<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7">
<meta name="Forrest-skin-name" content="pelt">
<title>Ejercicios de desarrollo, despliegue y pruebas de aplicaciones web con Maven</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<div class="header">
<div class="grouplogo">
<a href="http://web.ua.es/especialistajava"><img class="logoImage" alt="jtech" src="images/baner_j2ee_izq.gif" title="Especialista Universitario Java Enterprise"></a>
</div>
<div class="projectlogoA1">
<a href="http://www.dccia.ua.es/"><img class="logoImage" alt="Servidores Web" src="images/baner_j2ee_der.gif" title="Servidores Web"></a>
</div>
<ul id="tabs">
<li>
<a class="base-not-selected" href="javascript:location.href='../index.html'">Home</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-web.html'">Aplicaciones Web</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../aplic-ent.html'">Aplicaciones Enterprise</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../charlas.html'">Charlas</a>
</li>
<li>
<a class="base-not-selected" href="javascript:location.href='../proy-int/index.html'">Proyecto</a>
</li>
<li class="current">
<a class="base-selected" href="index.html">Servidores Web</a>
</li>
</ul>
</div>
</div>
<div id="main">
<div id="publishedStrip">
<div id="level2tabs"></div>
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="breadtrail">
             
             &nbsp;
           </div>
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Servidores Web</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html" title="Servidores Web">&Iacute;ndice</a>
</div>
<div onclick="SwitchMenu('menu_1.1.2', 'skin/')" id="menu_1.1.2Title" class="menutitle">Teor&iacute;a</div>
<div id="menu_1.1.2" class="menuitemgroup">
<div class="menuitem">
<a href="sesion01-apuntes.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-apuntes.html">Sesion 2</a>
</div>
<div class="menuitem">
<a href="sesion03-apuntes.html">Sesion 3</a>
</div>
<div class="menuitem">
<a href="sesion04-apuntes.html">Sesion 4</a>
</div>
<div class="menuitem">
<a href="roadmap-apuntes.html">Roadmap</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.3', 'skin/')" id="menu_selected_1.1.3Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Ejercicios</div>
<div id="menu_selected_1.1.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="sesion01-ejercicios.html">Sesion 1</a>
</div>
<div class="menuitem">
<a href="sesion02-ejercicios.html">Sesion 2</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sesion 3</div>
</div>
<div class="menuitem">
<a href="sesion04-ejercicios.html">Sesion 4</a>
</div>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<div id="credit2"></div>
</div>
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="sesion03-ejercicios.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Ejercicios de desarrollo, despliegue y pruebas de aplicaciones web con Maven</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Creaci%C3%B3n+de+un+proyecto+web+en+Eclipse+basado+en+Maven+%281+pto%29">Creaci&oacute;n de un proyecto web en Eclipse basado en Maven (1 pto)</a>
</li>
<li>
<a href="#Despliegue+de+la+aplicaci%C3%B3n+en+Maven+usando+Cargo+%281+pto%29">Despliegue de la aplicaci&oacute;n en Maven usando Cargo (1 pto)</a>
</li>
<li>
<a href="#Pruebas+funcionales+con+JWebUnit+%281+pto%29">Pruebas funcionales con JWebUnit (1 pto)</a>
</li>
</ul>
</div>

<div class="frame warning">
<div class="label">Instalaci&oacute;n del extra de m2eclipse para WTP</div>
<div class="content">
Antes de realizar los ejercicios de esta sesi&oacute;n deber&iacute;as instalar el extra para WTP del plugin m2eclipse, que estamos
usando para poder importar proyectos Maven a este entorno. Consulta los apuntes para ver el proceso.
Si no instalas este extra no podr&aacute;s ejecutar el proyecto web desde Eclipse, solo desde Maven. Eso s&iacute;, aunque no tengas el extra instalado podr&aacute;s compilarlo desde Eclipse sin problemas
y al menos estar seguro de que no tiene errores de compilaci&oacute;n</div>
</div>

<a name="N10010"></a><a name="Creaci%C3%B3n+de+un+proyecto+web+en+Eclipse+basado+en+Maven+%281+pto%29"></a>
<h2 class="underlined_10">Creaci&oacute;n de un proyecto web en Eclipse basado en Maven (1 pto)</h2>
<div class="section">
<p>Vamos a crear una peque&ntilde;a aplicaci&oacute;n web que va a convertir una cantidad de dinero entre pesetas y euros. La aplicaci&oacute;n
tendr&aacute; un HTML con un formulario para escribir los datos y un servlet para calcular y mostrar el resultado.</p>
<p>Deb&eacute;is realizar los siguientes pasos:</p>
<ol>

<li>
<strong>Crear el proyecto:</strong> <span class="codefrag">File &gt; New &gt; Other...</span> y dentro de "Maven" escoger <span class="codefrag">Maven Project</span>. 
<ul>

<li>En la pantalla de selecci&oacute;n del arquetipo, escoger 
<span class="codefrag">webapp-jee5</span>. Este arquetipo ya tiene configurada la versi&oacute;n adecuada del API de servlets (2.5) y la del c&oacute;digo generado
por el compilador Java (1.5).</li>

<li>En la &uacute;ltima pantalla del asistente, poner como groupId <span class="codefrag">es.ua.jtech</span>
y como artifactId <span class="codefrag">conversor</span>
</li>

</ul>

</li>

<li>
<strong>Incluir el c&oacute;digo fuente:</strong> 

<ul>

<li>Tomar el "index.html" incluido en las plantillas de la sesi&oacute;n y copiarlo a la carpeta "Web Resources" del proyecto. El "index.jsp" que
contiene "Web Resources" deb&eacute;is eliminarlo (si no lo hac&eacute;is aparecer&aacute; como p&aacute;gina principal en lugar del index.html).</li>

<li>Crear un servlet llamado Conversor: <span class="codefrag">File &gt; New &gt; Servlet</span>. En la pantalla del asistente debes poner como
package "es.ua.jtech" y como nombre de la clase "ConversorServlet". No darle al bot&oacute;n "Finish" sino a "Next" para que nos cree autom&aacute;ticamente
el mapeo del servlet en el web.xml. En esta segunda pantalla del asistente puedes aceptar los valores por defecto (asociar con la URL "/ConversorServlet")</li>

<li>Sustituye el c&oacute;digo fuente del servlet generado por el c&oacute;digo incluido en el fichero "ConversorServlet.txt" de las plantillas de la sesi&oacute;n.</li>

</ul>
</li>

<li>
<strong>Ejecutar el proyecto:</strong> ejecuta el proyecto desde Eclipse como es habitual y comprueba que funciona correctamente. CUIDADO: esto no podr&aacute;s hacerlo
si no has instalado el extra del plugin m2eclipse.</li>

</ol>
</div>

<a name="N10054"></a><a name="Despliegue+de+la+aplicaci%C3%B3n+en+Maven+usando+Cargo+%281+pto%29"></a>
<h2 class="underlined_10">Despliegue de la aplicaci&oacute;n en Maven usando Cargo (1 pto)</h2>
<div class="section">
<ol>

<li>Incluye en el "pom.xml" la configuraci&oacute;n del plugin de Cargo como se explica en el apartado "Despliegue de aplicaciones web con maven" de los apuntes.</li>

<li>Desde un terminal mu&eacute;vete al directorio del proyecto y ejecuta
<pre class="code">
mvn install cargo:start
</pre>
para ejecutar la aplicaci&oacute;n en Tomcat. La primera vez tardar&aacute; un rato ya que tiene que bajarse Cargo y todas sus dependencias. Abre una ventana del navegador y comprueba que la aplicaci&oacute;n funciona. Puedes parar el servidor pulsando Crtl-C en la terminal desde la que 
lo has arrancado o ejecutando mvn cargo:stop desde otra terminal y desde el directorio del proyecto
</li>

<li>Comenta todo lo relativo a la "configuration" en el plugin anterior (es decir, solo deber&iacute;a quedar el "groupId" y
el "artifactId"). No lo  borres, solo ponlo entre comentarios (&lt;!-- y --&gt;). De este modo usar&aacute;s la configuraci&oacute;n por defecto de Cargo, que es el servidor Jetty. Arranca de nuevo la aplicaci&oacute;n
y comprueba que funciona en este servidor.</li>

</ol>
</div>

<a name="N1006B"></a><a name="Pruebas+funcionales+con+JWebUnit+%281+pto%29"></a>
<h2 class="underlined_10">Pruebas funcionales con JWebUnit (1 pto)</h2>
<div class="section">
<ol>

<li>Si has hecho el ejercicio 2, haz una copia del fichero pom.xml como "pom_ejer2.xml". As&iacute; quedar&aacute; una copia de lo que hiciste en el ejercicio anterior, 
ya que vas a modificar de nuevo el pom.xml.</li>

<li>Incluye en el pom.xml la nueva configuraci&oacute;n del plugin de Cargo. Esta configuraci&oacute;n gestionar&aacute;
el arranque y parada autom&aacute;ticos del servidor en la fase de "integration-test" (cuidado, tienes que sustituir la
configuraci&oacute;n  de Cargo que has puesto en el ejercicio 2, esta nueva incluye tambi&eacute;n la anterior )
<pre class="code">

&lt;plugin&gt;
	&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;
	&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;
	&lt;configuration&gt;
		&lt;wait&gt;false&lt;/wait&gt;
		&lt;container&gt;
			&lt;containerId&gt;tomcat6x&lt;/containerId&gt;
			&lt;home&gt;/opt/apache-tomcat-6.0.29&lt;/home&gt;
		&lt;/container&gt;
		&lt;configuration&gt;
			&lt;home&gt;${project.build.directory}/tomcat6x&lt;/home&gt;
		&lt;/configuration&gt;
	&lt;/configuration&gt;
	&lt;executions&gt;
		&lt;execution&gt;
			&lt;id&gt;start&lt;/id&gt;
			&lt;phase&gt;pre-integration-test&lt;/phase&gt;
			&lt;goals&gt;
				&lt;goal&gt;start&lt;/goal&gt;
			&lt;/goals&gt;
		&lt;/execution&gt;
		&lt;execution&gt;
			&lt;id&gt;stop&lt;/id&gt;
			&lt;phase&gt;post-integration-test&lt;/phase&gt;
			&lt;goals&gt;
				&lt;goal&gt;stop&lt;/goal&gt;
			&lt;/goals&gt;
		&lt;/execution&gt;
	&lt;/executions&gt;
&lt;/plugin&gt;

</pre>

</li>

<li>
Incluye la configuraci&oacute;n del plugin "surefire" para que se usen los test del directorio "it" en la fase
de integraci&oacute;n:
<pre class="code">
&lt;plugin&gt;
 &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
 &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
 &lt;configuration&gt;
  &lt;!--
	Excluir los test de integraci&oacute;n de la fase de test
	(fase de pruebas unitarias)
  --&gt;
  &lt;excludes&gt;
     &lt;exclude&gt;**/it/**&lt;/exclude&gt;
  &lt;/excludes&gt;
 &lt;/configuration&gt;
 &lt;executions&gt;
   &lt;execution&gt;
      &lt;phase&gt;integration-test&lt;/phase&gt;
         &lt;goals&gt;
            &lt;goal&gt;test&lt;/goal&gt;
         &lt;/goals&gt;
         &lt;configuration&gt;
            &lt;!--
                Incluir los test de integraci&oacute;n en la fase
                integration-test
            --&gt;
            &lt;excludes&gt;
               &lt;exclude&gt;none&lt;/exclude&gt;
            &lt;/excludes&gt;
            &lt;includes&gt;
               &lt;include&gt;**/it/**&lt;/include&gt;
            &lt;/includes&gt;
         &lt;/configuration&gt;
   &lt;/execution&gt;
 &lt;/executions&gt;
&lt;/plugin&gt;

</pre>

</li>

<li>Incluye la dependencia de JWebUnit en la secci&oacute;n de <span class="codefrag">&lt;dependencies&gt;</span>

<pre class="code">
&lt;dependency&gt;
	&lt;groupId&gt;net.sourceforge.jwebunit&lt;/groupId&gt;
	&lt;artifactId&gt;jwebunit-htmlunit-plugin&lt;/artifactId&gt;
	&lt;version&gt;2.2&lt;/version&gt;
	&lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</pre>

</li>

<li>Escribe la clase de prueba:
<ul>

<li>Crea una nueva clase llamada <span class="codefrag">ConversorTest</span> que herede de <span class="codefrag">WebTestCase</span> y resida en el package <strong>es.ua.jtech.conversor.it</strong> pero
aseg&uacute;rate de que se mete en la carpeta <span class="codefrag">src/test/java</span>, y no <span class="codefrag">src/main/java</span>, ya que es un test.
</li> 

<li>Fij&aacute;ndote en el ejemplo de test JWebUnit de los apuntes, escribe el m&eacute;todo <span class="codefrag">setUp</span> estableciendo como URL base "http://localhost:8080/conversor" </li>

<li>Escribe un m&eacute;todo de prueba llamado <span class="codefrag">testConversor</span> que introduzca un valor en euros en el campo "cantidad", env&iacute;e el formulario y compruebe que en la p&aacute;gina
resultante aparece el resultado correcto.</li>

</ul>

</li>

</ol>
</div>



<p class="pageBreakAfter"></p>


</div>
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("<text>Last Published:</text> " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2010-11 Dpto. Ciencia de la Computaci&oacute;n e IA</div>
</div>
</body>
</html>
